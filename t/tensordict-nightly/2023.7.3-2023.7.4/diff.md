# Comparing `tmp/tensordict_nightly-2023.7.3-cp39-cp39-win_amd64.whl.zip` & `tmp/tensordict_nightly-2023.7.4-cp39-cp39-win_amd64.whl.zip`

## zipinfo {}

```diff
@@ -1,30 +1,30 @@
-Zip file size: 197723 bytes, number of entries: 28
--rw-rw-rw-  2.0 fat     1140 b- defN 23-Jul-03 13:49 tensordict/__init__.py
--rw-rw-rw-  2.0 fat     6156 b- defN 23-Jul-03 13:49 tensordict/_contextlib.py
--rw-rw-rw-  2.0 fat   109568 b- defN 23-Jul-03 13:52 tensordict/_tensordict.pyd
--rw-rw-rw-  2.0 fat    31293 b- defN 23-Jul-03 13:49 tensordict/memmap.py
--rw-rw-rw-  2.0 fat    35510 b- defN 23-Jul-03 13:49 tensordict/persistent.py
--rw-rw-rw-  2.0 fat    33661 b- defN 23-Jul-03 13:49 tensordict/tensorclass.py
--rw-rw-rw-  2.0 fat   314746 b- defN 23-Jul-03 13:49 tensordict/tensordict.py
--rw-rw-rw-  2.0 fat    40598 b- defN 23-Jul-03 13:49 tensordict/utils.py
--rw-rw-rw-  2.0 fat       86 b- defN 23-Jul-03 13:51 tensordict/version.py
--rw-rw-rw-  2.0 fat     1366 b- defN 23-Jul-03 13:49 tensordict/nn/__init__.py
--rw-rw-rw-  2.0 fat    50079 b- defN 23-Jul-03 13:49 tensordict/nn/common.py
--rw-rw-rw-  2.0 fat    24892 b- defN 23-Jul-03 13:49 tensordict/nn/functional_modules.py
--rw-rw-rw-  2.0 fat    22813 b- defN 23-Jul-03 13:49 tensordict/nn/probabilistic.py
--rw-rw-rw-  2.0 fat    20014 b- defN 23-Jul-03 13:49 tensordict/nn/sequence.py
--rw-rw-rw-  2.0 fat    10896 b- defN 23-Jul-03 13:49 tensordict/nn/utils.py
--rw-rw-rw-  2.0 fat      512 b- defN 23-Jul-03 13:49 tensordict/nn/distributions/__init__.py
--rw-rw-rw-  2.0 fat     7272 b- defN 23-Jul-03 13:49 tensordict/nn/distributions/continuous.py
--rw-rw-rw-  2.0 fat     2667 b- defN 23-Jul-03 13:49 tensordict/nn/distributions/discrete.py
--rw-rw-rw-  2.0 fat     6694 b- defN 23-Jul-03 13:49 tensordict/nn/distributions/truncated_normal.py
--rw-rw-rw-  2.0 fat     1266 b- defN 23-Jul-03 13:49 tensordict/nn/distributions/utils.py
--rw-rw-rw-  2.0 fat      393 b- defN 23-Jul-03 13:49 tensordict/prototype/__init__.py
--rw-rw-rw-  2.0 fat     7702 b- defN 23-Jul-03 13:49 tensordict/prototype/fx.py
--rw-rw-rw-  2.0 fat      764 b- defN 23-Jul-03 13:49 tensordict/prototype/tensorclass.py
--rw-rw-rw-  2.0 fat     1119 b- defN 23-Jul-03 13:52 tensordict_nightly-2023.7.3.dist-info/LICENSE
--rw-rw-rw-  2.0 fat    15788 b- defN 23-Jul-03 13:52 tensordict_nightly-2023.7.3.dist-info/METADATA
--rw-rw-rw-  2.0 fat      100 b- defN 23-Jul-03 13:52 tensordict_nightly-2023.7.3.dist-info/WHEEL
--rw-rw-rw-  2.0 fat       11 b- defN 23-Jul-03 13:52 tensordict_nightly-2023.7.3.dist-info/top_level.txt
--rw-rw-r--  2.0 fat     2438 b- defN 23-Jul-03 13:52 tensordict_nightly-2023.7.3.dist-info/RECORD
-28 files, 749544 bytes uncompressed, 193793 bytes compressed:  74.1%
+Zip file size: 199232 bytes, number of entries: 28
+-rw-rw-rw-  2.0 fat     1206 b- defN 23-Jul-04 13:49 tensordict/__init__.py
+-rw-rw-rw-  2.0 fat     6156 b- defN 23-Jul-04 13:49 tensordict/_contextlib.py
+-rw-rw-rw-  2.0 fat   113664 b- defN 23-Jul-04 13:52 tensordict/_tensordict.pyd
+-rw-rw-rw-  2.0 fat    31293 b- defN 23-Jul-04 13:49 tensordict/memmap.py
+-rw-rw-rw-  2.0 fat    35510 b- defN 23-Jul-04 13:49 tensordict/persistent.py
+-rw-rw-rw-  2.0 fat    33661 b- defN 23-Jul-04 13:49 tensordict/tensorclass.py
+-rw-rw-rw-  2.0 fat   315134 b- defN 23-Jul-04 13:49 tensordict/tensordict.py
+-rw-rw-rw-  2.0 fat    40692 b- defN 23-Jul-04 13:49 tensordict/utils.py
+-rw-rw-rw-  2.0 fat       86 b- defN 23-Jul-04 13:52 tensordict/version.py
+-rw-rw-rw-  2.0 fat     1366 b- defN 23-Jul-04 13:49 tensordict/nn/__init__.py
+-rw-rw-rw-  2.0 fat    50048 b- defN 23-Jul-04 13:49 tensordict/nn/common.py
+-rw-rw-rw-  2.0 fat    24892 b- defN 23-Jul-04 13:49 tensordict/nn/functional_modules.py
+-rw-rw-rw-  2.0 fat    22813 b- defN 23-Jul-04 13:49 tensordict/nn/probabilistic.py
+-rw-rw-rw-  2.0 fat    20014 b- defN 23-Jul-04 13:49 tensordict/nn/sequence.py
+-rw-rw-rw-  2.0 fat    10896 b- defN 23-Jul-04 13:49 tensordict/nn/utils.py
+-rw-rw-rw-  2.0 fat      512 b- defN 23-Jul-04 13:49 tensordict/nn/distributions/__init__.py
+-rw-rw-rw-  2.0 fat     7272 b- defN 23-Jul-04 13:49 tensordict/nn/distributions/continuous.py
+-rw-rw-rw-  2.0 fat     2667 b- defN 23-Jul-04 13:49 tensordict/nn/distributions/discrete.py
+-rw-rw-rw-  2.0 fat     6694 b- defN 23-Jul-04 13:49 tensordict/nn/distributions/truncated_normal.py
+-rw-rw-rw-  2.0 fat     1266 b- defN 23-Jul-04 13:49 tensordict/nn/distributions/utils.py
+-rw-rw-rw-  2.0 fat      393 b- defN 23-Jul-04 13:49 tensordict/prototype/__init__.py
+-rw-rw-rw-  2.0 fat     7702 b- defN 23-Jul-04 13:49 tensordict/prototype/fx.py
+-rw-rw-rw-  2.0 fat      764 b- defN 23-Jul-04 13:49 tensordict/prototype/tensorclass.py
+-rw-rw-rw-  2.0 fat     1119 b- defN 23-Jul-04 13:52 tensordict_nightly-2023.7.4.dist-info/LICENSE
+-rw-rw-rw-  2.0 fat    15788 b- defN 23-Jul-04 13:52 tensordict_nightly-2023.7.4.dist-info/METADATA
+-rw-rw-rw-  2.0 fat      100 b- defN 23-Jul-04 13:52 tensordict_nightly-2023.7.4.dist-info/WHEEL
+-rw-rw-rw-  2.0 fat       11 b- defN 23-Jul-04 13:52 tensordict_nightly-2023.7.4.dist-info/top_level.txt
+-rw-rw-r--  2.0 fat     2438 b- defN 23-Jul-04 13:52 tensordict_nightly-2023.7.4.dist-info/RECORD
+28 files, 754157 bytes uncompressed, 195302 bytes compressed:  74.1%
```

## zipnote {}

```diff
@@ -63,23 +63,23 @@
 
 Filename: tensordict/prototype/fx.py
 Comment: 
 
 Filename: tensordict/prototype/tensorclass.py
 Comment: 
 
-Filename: tensordict_nightly-2023.7.3.dist-info/LICENSE
+Filename: tensordict_nightly-2023.7.4.dist-info/LICENSE
 Comment: 
 
-Filename: tensordict_nightly-2023.7.3.dist-info/METADATA
+Filename: tensordict_nightly-2023.7.4.dist-info/METADATA
 Comment: 
 
-Filename: tensordict_nightly-2023.7.3.dist-info/WHEEL
+Filename: tensordict_nightly-2023.7.4.dist-info/WHEEL
 Comment: 
 
-Filename: tensordict_nightly-2023.7.3.dist-info/top_level.txt
+Filename: tensordict_nightly-2023.7.4.dist-info/top_level.txt
 Comment: 
 
-Filename: tensordict_nightly-2023.7.3.dist-info/RECORD
+Filename: tensordict_nightly-2023.7.4.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## tensordict/__init__.py

```diff
@@ -22,14 +22,15 @@
 from tensordict.utils import is_tensorclass
 
 try:
     from tensordict.version import __version__
 except ImportError:
     __version__ = None
 
+from tensordict._tensordict import unravel_key, unravel_key_list
 
 __all__ = [
     "LazyStackedTensorDict",
     "MemmapTensor",
     "SubTensorDict",
     "TensorDict",
     "TensorDictBase",
```

## tensordict/tensordict.py

```diff
@@ -3125,14 +3125,15 @@
             tensordict_out = TensorDict(
                 {},
                 batch_size=self.batch_size,
                 device=self.device,
                 _run_checks=False,
                 _is_shared=self.is_shared(),
                 _is_memmap=self.is_memmap(),
+                names=self.names,
             )
             for key, value in self.items():
                 if key in to_flatten:
                     inner_tensordict = self.get(key).flatten_keys(
                         separator=separator, inplace=inplace
                     )
                     for inner_key, inner_item in inner_tensordict.items():
@@ -3159,26 +3160,32 @@
                     if separator not in key[1:-1]
                 },
                 batch_size=self.batch_size,
                 device=self.device,
                 _run_checks=False,
                 _is_shared=self.is_shared(),
                 _is_memmap=self.is_memmap(),
+                names=self.names,
             )
         else:
             out = self
 
         keys = set(out.keys())
         for key, list_of_keys in to_unflatten.items():
             if key in keys:
                 raise KeyError(
                     "Unflattening key(s) in tensordict will override existing unflattened key"
                 )
 
-            tensordict = TensorDict({}, batch_size=self.batch_size, device=self.device)
+            tensordict = TensorDict(
+                {},
+                batch_size=self.batch_size,
+                device=self.device,
+                names=self.names,
+            )
             if key in self.keys():
                 tensordict.update(self[key])
             for old_key, new_key in list_of_keys:
                 value = self[old_key]
                 tensordict[new_key] = value
                 if inplace:
                     del self[old_key]
@@ -7725,14 +7732,16 @@
         names = copy(self._source.names)
         dim = self.custom_op_kwargs.get("dim")
         names.insert(dim, None)
         return names
 
     @names.setter
     def names(self, value):
+        if value[: self.batch_dims] == self.names:
+            return
         raise RuntimeError(
             "Names of a lazy tensordict cannot be modified. Call to_tensordict() first."
         )
 
 
 class _SqueezedTensorDict(_CustomOpTensorDict):
     """A lazy view on a squeezed TensorDict.
@@ -7773,14 +7782,16 @@
         dim = self.custom_op_kwargs["dim"]
         if self._source.batch_size[dim] == 1:
             del names[dim]
         return names
 
     @names.setter
     def names(self, value):
+        if value[: self.batch_dims] == self.names:
+            return
         raise RuntimeError(
             "Names of a lazy tensordict cannot be modified. Call to_tensordict() first."
         )
 
 
 class _ViewedTensorDict(_CustomOpTensorDict):
     def _update_custom_op_kwargs(self, source_tensor: Tensor) -> dict[str, Any]:
@@ -8000,14 +8011,16 @@
     @property
     def names(self):
         names = copy(self._source.names)
         return [names[i] for i in self.custom_op_kwargs["dims"]]
 
     @names.setter
     def names(self, value):
+        if value[: self.batch_dims] == self.names:
+            return
         raise RuntimeError(
             "Names of a lazy tensordict cannot be modified. Call to_tensordict() first."
         )
 
 
 def _get_repr(tensor: Tensor) -> str:
     s = ", ".join(
```

## tensordict/utils.py

```diff
@@ -19,15 +19,19 @@
 from numbers import Number
 from typing import Any, Callable, List, Sequence, Tuple, TYPE_CHECKING, Union
 
 import numpy as np
 import torch
 
 from packaging.version import parse
-from tensordict._tensordict import unravel_keys
+from tensordict._tensordict import (  # noqa: F401
+    unravel_key,
+    unravel_key_list,  # noqa: F401
+    unravel_keys,  # noqa: F401
+)
 from torch import Tensor
 
 if TYPE_CHECKING:
     from tensordict.memmap import MemmapTensor
     from tensordict.tensordict import TensorDictBase
 
 try:
```

## tensordict/version.py

```diff
@@ -1,2 +1,2 @@
-__version__ = '2023.07.03'
-git_version = '3bb784d8841f938d0026bf98d0059f7cca4f124e'
+__version__ = '2023.07.04'
+git_version = '30600abf7452f138ec0e19e6aa867176b860616d'
```

## tensordict/nn/common.py

```diff
@@ -298,15 +298,14 @@
         tensordict_out: TensorDictBase,
     ):
         if not isinstance(tensordict_out, TensorDictBase):
             raise RuntimeError(
                 "You are likely using tensordict.nn.dispatch with keyword arguments with an older (< 2.0) version of pytorch. "
                 "This is currently not supported. Please use unnamed arguments or upgrade pytorch."
             )
-        print(tensordict_out)
         # detect dispatch calls
         in_keys = module.in_keys
         is_dispatched = self._detect_dispatch(tensordict_in, in_keys)
         out_keys = self.out_keys
         # if dispatch filtered the out keys as they should we're happy
         if is_dispatched:
             if (not isinstance(tensordict_out, tuple) and len(out_keys) == 1) or (
```

## Comparing `tensordict_nightly-2023.7.3.dist-info/LICENSE` & `tensordict_nightly-2023.7.4.dist-info/LICENSE`

 * *Files identical despite different names*

## Comparing `tensordict_nightly-2023.7.3.dist-info/METADATA` & `tensordict_nightly-2023.7.4.dist-info/METADATA`

 * *Files 0% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: tensordict-nightly
-Version: 2023.7.3
+Version: 2023.7.4
 Summary: UNKNOWN
 Home-page: https://github.com/pytorch-labs/tensordict
 Author: tensordict contributors
 Author-email: vmoens@fb.com
 License: BSD
 Platform: UNKNOWN
 Classifier: Programming Language :: Python :: 3.7
```

### html2text {}

```diff
@@ -1,8 +1,8 @@
-Metadata-Version: 2.1 Name: tensordict-nightly Version: 2023.7.3 Summary:
+Metadata-Version: 2.1 Name: tensordict-nightly Version: 2023.7.4 Summary:
 UNKNOWN Home-page: https://github.com/pytorch-labs/tensordict Author:
 tensordict contributors Author-email: vmoens@fb.com License: BSD Platform:
 UNKNOWN Classifier: Programming Language :: Python :: 3.7 Classifier:
 Programming Language :: Python :: 3.8 Classifier: Programming Language ::
 Python :: 3.9 Classifier: Programming Language :: Python :: 3.10 Classifier:
 Development Status :: 4 - Beta Description-Content-Type: text/markdown License-
 File: LICENSE Requires-Dist: torch Requires-Dist: numpy Requires-Dist:
```

## Comparing `tensordict_nightly-2023.7.3.dist-info/RECORD` & `tensordict_nightly-2023.7.4.dist-info/RECORD`

 * *Files 6% similar despite different names*

```diff
@@ -1,28 +1,28 @@
-tensordict/__init__.py,sha256=c6XjpmX3nJvaHHIKLThEQVqzg7dw5Am6fdadDi1AVcY,1140
+tensordict/__init__.py,sha256=ytaPVEcwv6XL4tl1qrUFmX_0fPaaz5asm3G__DwcQU0,1206
 tensordict/_contextlib.py,sha256=yao_SZSgKUJt6dXHtAc5ZFJzAmm_NQQFYgR1rjDg0k8,6156
-tensordict/_tensordict.pyd,sha256=VRU64sNsIDkV5i7GRuO5Z9xlJMWE2qXq7lbJ-8ac8tg,109568
+tensordict/_tensordict.pyd,sha256=lF-vBFO1R5kbjvW3bOyBeVacqOvsqfN625sGGL2bHeQ,113664
 tensordict/memmap.py,sha256=t_1vr_qFN25rOLbzg0y783mMd7y96SbLW06IoZRR4ck,31293
 tensordict/persistent.py,sha256=_pu400CMkYTuPt1FLbXmflO6CKJdcLMUTSv5spxiwwQ,35510
 tensordict/tensorclass.py,sha256=SP_NCfCgZWx6QpWuPFvI8suSLsx91Z9jFaPJPP-BqN4,33661
-tensordict/tensordict.py,sha256=VJJnZ5rAE_0Osksag_gj5I1ZO7bf3gZd7OdApB66mV4,314746
-tensordict/utils.py,sha256=JGVeC0Ol5mJaRlWMrMoczI96akrLO2Xhjy2yTv4tBbs,40598
-tensordict/version.py,sha256=jZMNeRrJhB7PSmitQJ-hRm_qeHLfB37Rc7L5kqe2z5o,86
+tensordict/tensordict.py,sha256=w-MlrYS-PxgyP5HnVuqmBvlSb_omFmZblIj_s_gVaFI,315134
+tensordict/utils.py,sha256=UiA7fvxHojq262uFPyH0Cy3v9fPI_FwXXGgaQZK4FYI,40692
+tensordict/version.py,sha256=xhQD-qiVK_llq0gwM1AMclI1KMF_oS-ENn8-tHL510Q,86
 tensordict/nn/__init__.py,sha256=IQE4Xm3ydZ_D6eXtY_AKcJxfXJkNPrZcqEMIR6fA9YU,1366
-tensordict/nn/common.py,sha256=RMaPYNZNNdcIS27SFetN3nphkcfftiRKPSHIDIrGLgs,50079
+tensordict/nn/common.py,sha256=CroauluwaW_k_VsdBxqYXqUvUfsIpEbNoScHeB8Yt48,50048
 tensordict/nn/functional_modules.py,sha256=tgOKWUHSZ6VU1QgFxcoC1HaH7Z2v3CXdjRJlVnZ50SQ,24892
 tensordict/nn/probabilistic.py,sha256=WkHqxDhWKOaVf7xkZtXHCYe4Uf7ujiYzS_uTuvc1Fbg,22813
 tensordict/nn/sequence.py,sha256=EhSjt-mjvsQJQXc1LVZHQcOWRIcCEMh8ctDPP2PgVsg,20014
 tensordict/nn/utils.py,sha256=5uS9WJC-Bdwuq2_SDnrGzBj3gpboB2IS_fxbAe_isX0,10896
 tensordict/nn/distributions/__init__.py,sha256=vDaCGSo1Zo8HHUBxjeS5E6ov-sTFN766V9jGmInVSQE,512
 tensordict/nn/distributions/continuous.py,sha256=lFpgk2QN9a8WLCIdT2rUAWwLlXmnRQrwepppb0YNKeM,7272
 tensordict/nn/distributions/discrete.py,sha256=VrcrSPr9YyBDKagOphYTAgpiQqlwfpf4-8t3TsrJyPQ,2667
 tensordict/nn/distributions/truncated_normal.py,sha256=f--2ISj15TTUlLcUzMh1e50yADuh-vKMFbrzLqwUv7I,6694
 tensordict/nn/distributions/utils.py,sha256=3vEDATr12hUk9OYYKf4dzPmNMmLzKHQuZPsdWcPVfi4,1266
 tensordict/prototype/__init__.py,sha256=XBECOVFLLCiUsvNwwByWkz-U87nt7oJXPp2iIIA5Ysk,393
 tensordict/prototype/fx.py,sha256=-pXvyXUoRQQEPtl1nDvshmCA4T8X4LCUcaufGJwQr28,7702
 tensordict/prototype/tensorclass.py,sha256=4yIxnvcebszIUNXHmKTq9P85AyD8_aUhoJxr-p2m7K4,764
-tensordict_nightly-2023.7.3.dist-info/LICENSE,sha256=PGO-oZsq4EzhE1-WQS2xGiEF3UCVb9YawfQ09cIMV_8,1119
-tensordict_nightly-2023.7.3.dist-info/METADATA,sha256=xWgcXMQC-bkMpqQ1HAeY3_hUDhGnXata_OMo9x87Ap0,15788
-tensordict_nightly-2023.7.3.dist-info/WHEEL,sha256=eep6QWEFiQfg2wcclssb_WY-D33AnLYLnEKGA9Rn-VU,100
-tensordict_nightly-2023.7.3.dist-info/top_level.txt,sha256=4EMgKpsnmq04uFLPJXf8tMQb1POT8QqR1pR74y5wycc,11
-tensordict_nightly-2023.7.3.dist-info/RECORD,,
+tensordict_nightly-2023.7.4.dist-info/LICENSE,sha256=PGO-oZsq4EzhE1-WQS2xGiEF3UCVb9YawfQ09cIMV_8,1119
+tensordict_nightly-2023.7.4.dist-info/METADATA,sha256=JdgUpw3TillWoeWRsKjZrhslG8pEhxS2Dd_CZyFED3c,15788
+tensordict_nightly-2023.7.4.dist-info/WHEEL,sha256=eep6QWEFiQfg2wcclssb_WY-D33AnLYLnEKGA9Rn-VU,100
+tensordict_nightly-2023.7.4.dist-info/top_level.txt,sha256=4EMgKpsnmq04uFLPJXf8tMQb1POT8QqR1pR74y5wycc,11
+tensordict_nightly-2023.7.4.dist-info/RECORD,,
```

