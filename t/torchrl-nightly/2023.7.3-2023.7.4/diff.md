# Comparing `tmp/torchrl_nightly-2023.7.3-cp39-cp39-win_amd64.whl.zip` & `tmp/torchrl_nightly-2023.7.4-cp39-cp39-win_amd64.whl.zip`

## zipinfo {}

```diff
@@ -1,138 +1,138 @@
-Zip file size: 620383 bytes, number of entries: 136
--rw-rw-rw-  2.0 fat      183 b- defN 23-Jul-03 11:19 build_tools/__init__.py
--rw-rw-rw-  2.0 fat      245 b- defN 23-Jul-03 11:19 build_tools/setup_helpers/__init__.py
--rw-rw-rw-  2.0 fat     6085 b- defN 23-Jul-03 11:19 build_tools/setup_helpers/extension.py
--rw-rw-rw-  2.0 fat      957 b- defN 23-Jul-03 11:19 torchrl/__init__.py
--rw-rw-rw-  2.0 fat      868 b- defN 23-Jul-03 11:19 torchrl/_extension.py
--rw-rw-rw-  2.0 fat   346112 b- defN 23-Jul-03 11:21 torchrl/_torchrl.pyd
--rw-rw-rw-  2.0 fat    18043 b- defN 23-Jul-03 11:19 torchrl/_utils.py
--rw-rw-rw-  2.0 fat       84 b- defN 23-Jul-03 11:20 torchrl/version.py
--rw-rw-rw-  2.0 fat      366 b- defN 23-Jul-03 11:19 torchrl/collectors/__init__.py
--rw-rw-rw-  2.0 fat    97839 b- defN 23-Jul-03 11:19 torchrl/collectors/collectors.py
--rw-rw-rw-  2.0 fat     3847 b- defN 23-Jul-03 11:19 torchrl/collectors/utils.py
--rw-rw-rw-  2.0 fat      412 b- defN 23-Jul-03 11:19 torchrl/collectors/distributed/__init__.py
--rw-rw-rw-  2.0 fat      674 b- defN 23-Jul-03 11:19 torchrl/collectors/distributed/default_configs.py
--rw-rw-rw-  2.0 fat    34086 b- defN 23-Jul-03 11:19 torchrl/collectors/distributed/generic.py
--rw-rw-rw-  2.0 fat    27837 b- defN 23-Jul-03 11:19 torchrl/collectors/distributed/ray.py
--rw-rw-rw-  2.0 fat    27697 b- defN 23-Jul-03 11:19 torchrl/collectors/distributed/rpc.py
--rw-rw-rw-  2.0 fat    20055 b- defN 23-Jul-03 11:19 torchrl/collectors/distributed/sync.py
--rw-rw-rw-  2.0 fat     6244 b- defN 23-Jul-03 11:19 torchrl/collectors/distributed/utils.py
--rw-rw-rw-  2.0 fat     1236 b- defN 23-Jul-03 11:19 torchrl/data/__init__.py
--rw-rw-rw-  2.0 fat   123749 b- defN 23-Jul-03 11:19 torchrl/data/tensor_specs.py
--rw-rw-rw-  2.0 fat     2061 b- defN 23-Jul-03 11:19 torchrl/data/utils.py
--rw-rw-rw-  2.0 fat       84 b- defN 23-Jul-03 11:19 torchrl/data/datasets/__init__.py
--rw-rw-rw-  2.0 fat    12415 b- defN 23-Jul-03 11:19 torchrl/data/datasets/d4rl.py
--rw-rw-rw-  2.0 fat     6333 b- defN 23-Jul-03 11:19 torchrl/data/datasets/openml.py
--rw-rw-rw-  2.0 fat      219 b- defN 23-Jul-03 11:19 torchrl/data/postprocs/__init__.py
--rw-rw-rw-  2.0 fat     9361 b- defN 23-Jul-03 11:19 torchrl/data/postprocs/postprocs.py
--rw-rw-rw-  2.0 fat      694 b- defN 23-Jul-03 11:19 torchrl/data/replay_buffers/__init__.py
--rw-rw-rw-  2.0 fat    42400 b- defN 23-Jul-03 11:19 torchrl/data/replay_buffers/replay_buffers.py
--rw-rw-rw-  2.0 fat    12186 b- defN 23-Jul-03 11:19 torchrl/data/replay_buffers/samplers.py
--rw-rw-rw-  2.0 fat    25590 b- defN 23-Jul-03 11:19 torchrl/data/replay_buffers/storages.py
--rw-rw-rw-  2.0 fat     1904 b- defN 23-Jul-03 11:19 torchrl/data/replay_buffers/utils.py
--rw-rw-rw-  2.0 fat     2959 b- defN 23-Jul-03 11:19 torchrl/data/replay_buffers/writers.py
--rw-rw-rw-  2.0 fat      464 b- defN 23-Jul-03 11:19 torchrl/data/rlhf/__init__.py
--rw-rw-rw-  2.0 fat    20494 b- defN 23-Jul-03 11:19 torchrl/data/rlhf/dataset.py
--rw-rw-rw-  2.0 fat     8223 b- defN 23-Jul-03 11:19 torchrl/data/rlhf/prompt.py
--rw-rw-rw-  2.0 fat     8416 b- defN 23-Jul-03 11:19 torchrl/data/rlhf/reward.py
--rw-rw-rw-  2.0 fat    18364 b- defN 23-Jul-03 11:19 torchrl/data/rlhf/utils.py
--rw-rw-rw-  2.0 fat     1539 b- defN 23-Jul-03 11:19 torchrl/envs/__init__.py
--rw-rw-rw-  2.0 fat    61271 b- defN 23-Jul-03 11:19 torchrl/envs/common.py
--rw-rw-rw-  2.0 fat     7603 b- defN 23-Jul-03 11:19 torchrl/envs/env_creator.py
--rw-rw-rw-  2.0 fat    12877 b- defN 23-Jul-03 11:19 torchrl/envs/gym_like.py
--rw-rw-rw-  2.0 fat    21453 b- defN 23-Jul-03 11:19 torchrl/envs/utils.py
--rw-rw-rw-  2.0 fat    56773 b- defN 23-Jul-03 11:19 torchrl/envs/vec_env.py
--rw-rw-rw-  2.0 fat      183 b- defN 23-Jul-03 11:19 torchrl/envs/libs/__init__.py
--rw-rw-rw-  2.0 fat    15480 b- defN 23-Jul-03 11:19 torchrl/envs/libs/brax.py
--rw-rw-rw-  2.0 fat    11234 b- defN 23-Jul-03 11:19 torchrl/envs/libs/dm_control.py
--rw-rw-rw-  2.0 fat    25980 b- defN 23-Jul-03 11:19 torchrl/envs/libs/gym.py
--rw-rw-rw-  2.0 fat     2857 b- defN 23-Jul-03 11:19 torchrl/envs/libs/habitat.py
--rw-rw-rw-  2.0 fat     4975 b- defN 23-Jul-03 11:19 torchrl/envs/libs/jax_utils.py
--rw-rw-rw-  2.0 fat    12877 b- defN 23-Jul-03 11:19 torchrl/envs/libs/jumanji.py
--rw-rw-rw-  2.0 fat     5260 b- defN 23-Jul-03 11:19 torchrl/envs/libs/openml.py
--rw-rw-rw-  2.0 fat     5316 b- defN 23-Jul-03 11:19 torchrl/envs/libs/utils.py
--rw-rw-rw-  2.0 fat    18538 b- defN 23-Jul-03 11:19 torchrl/envs/libs/vmas.py
--rw-rw-rw-  2.0 fat      224 b- defN 23-Jul-03 11:19 torchrl/envs/model_based/__init__.py
--rw-rw-rw-  2.0 fat     8168 b- defN 23-Jul-03 11:19 torchrl/envs/model_based/common.py
--rw-rw-rw-  2.0 fat     2875 b- defN 23-Jul-03 11:19 torchrl/envs/model_based/dreamer.py
--rw-rw-rw-  2.0 fat     1077 b- defN 23-Jul-03 11:19 torchrl/envs/transforms/__init__.py
--rw-rw-rw-  2.0 fat     1485 b- defN 23-Jul-03 11:19 torchrl/envs/transforms/functional.py
--rw-rw-rw-  2.0 fat    13723 b- defN 23-Jul-03 11:19 torchrl/envs/transforms/r3m.py
--rw-rw-rw-  2.0 fat     8280 b- defN 23-Jul-03 11:19 torchrl/envs/transforms/rlhf.py
--rw-rw-rw-  2.0 fat   173665 b- defN 23-Jul-03 11:19 torchrl/envs/transforms/transforms.py
--rw-rw-rw-  2.0 fat      408 b- defN 23-Jul-03 11:19 torchrl/envs/transforms/utils.py
--rw-rw-rw-  2.0 fat    14084 b- defN 23-Jul-03 11:19 torchrl/envs/transforms/vip.py
--rw-rw-rw-  2.0 fat     1468 b- defN 23-Jul-03 11:19 torchrl/modules/__init__.py
--rw-rw-rw-  2.0 fat      600 b- defN 23-Jul-03 11:19 torchrl/modules/distributions/__init__.py
--rw-rw-rw-  2.0 fat    21386 b- defN 23-Jul-03 11:19 torchrl/modules/distributions/continuous.py
--rw-rw-rw-  2.0 fat     9293 b- defN 23-Jul-03 11:19 torchrl/modules/distributions/discrete.py
--rw-rw-rw-  2.0 fat     5988 b- defN 23-Jul-03 11:19 torchrl/modules/distributions/truncated_normal.py
--rw-rw-rw-  2.0 fat     6129 b- defN 23-Jul-03 11:19 torchrl/modules/distributions/utils.py
--rw-rw-rw-  2.0 fat      580 b- defN 23-Jul-03 11:19 torchrl/modules/models/__init__.py
--rw-rw-rw-  2.0 fat    21885 b- defN 23-Jul-03 11:19 torchrl/modules/models/exploration.py
--rw-rw-rw-  2.0 fat    13977 b- defN 23-Jul-03 11:19 torchrl/modules/models/model_based.py
--rw-rw-rw-  2.0 fat    45664 b- defN 23-Jul-03 11:19 torchrl/modules/models/models.py
--rw-rw-rw-  2.0 fat     6476 b- defN 23-Jul-03 11:19 torchrl/modules/models/rlhf.py
--rw-rw-rw-  2.0 fat     4023 b- defN 23-Jul-03 11:19 torchrl/modules/models/utils.py
--rw-rw-rw-  2.0 fat      281 b- defN 23-Jul-03 11:19 torchrl/modules/planners/__init__.py
--rw-rw-rw-  2.0 fat     9572 b- defN 23-Jul-03 11:19 torchrl/modules/planners/cem.py
--rw-rw-rw-  2.0 fat     2455 b- defN 23-Jul-03 11:19 torchrl/modules/planners/common.py
--rw-rw-rw-  2.0 fat    10683 b- defN 23-Jul-03 11:19 torchrl/modules/planners/mppi.py
--rw-rw-rw-  2.0 fat      925 b- defN 23-Jul-03 11:19 torchrl/modules/tensordict_module/__init__.py
--rw-rw-rw-  2.0 fat    80502 b- defN 23-Jul-03 11:19 torchrl/modules/tensordict_module/actors.py
--rw-rw-rw-  2.0 fat    19005 b- defN 23-Jul-03 11:19 torchrl/modules/tensordict_module/common.py
--rw-rw-rw-  2.0 fat    24584 b- defN 23-Jul-03 11:19 torchrl/modules/tensordict_module/exploration.py
--rw-rw-rw-  2.0 fat    11468 b- defN 23-Jul-03 11:19 torchrl/modules/tensordict_module/probabilistic.py
--rw-rw-rw-  2.0 fat    18299 b- defN 23-Jul-03 11:19 torchrl/modules/tensordict_module/rnn.py
--rw-rw-rw-  2.0 fat     5835 b- defN 23-Jul-03 11:19 torchrl/modules/tensordict_module/sequence.py
--rw-rw-rw-  2.0 fat     1360 b- defN 23-Jul-03 11:19 torchrl/modules/tensordict_module/world_models.py
--rw-rw-rw-  2.0 fat     3984 b- defN 23-Jul-03 11:19 torchrl/modules/utils/__init__.py
--rw-rw-rw-  2.0 fat     2435 b- defN 23-Jul-03 11:19 torchrl/modules/utils/mappings.py
--rw-rw-rw-  2.0 fat     1368 b- defN 23-Jul-03 11:19 torchrl/modules/utils/utils.py
--rw-rw-rw-  2.0 fat      921 b- defN 23-Jul-03 11:19 torchrl/objectives/__init__.py
--rw-rw-rw-  2.0 fat    18048 b- defN 23-Jul-03 11:19 torchrl/objectives/a2c.py
--rw-rw-rw-  2.0 fat    26506 b- defN 23-Jul-03 11:19 torchrl/objectives/common.py
--rw-rw-rw-  2.0 fat    31752 b- defN 23-Jul-03 11:19 torchrl/objectives/cql.py
--rw-rw-rw-  2.0 fat    15521 b- defN 23-Jul-03 11:19 torchrl/objectives/ddpg.py
--rw-rw-rw-  2.0 fat    18160 b- defN 23-Jul-03 11:19 torchrl/objectives/deprecated.py
--rw-rw-rw-  2.0 fat    24635 b- defN 23-Jul-03 11:19 torchrl/objectives/dqn.py
--rw-rw-rw-  2.0 fat    17407 b- defN 23-Jul-03 11:19 torchrl/objectives/dreamer.py
--rw-rw-rw-  2.0 fat     2119 b- defN 23-Jul-03 11:19 torchrl/objectives/functional.py
--rw-rw-rw-  2.0 fat    20386 b- defN 23-Jul-03 11:19 torchrl/objectives/iql.py
--rw-rw-rw-  2.0 fat    39608 b- defN 23-Jul-03 11:19 torchrl/objectives/ppo.py
--rw-rw-rw-  2.0 fat    25718 b- defN 23-Jul-03 11:19 torchrl/objectives/redq.py
--rw-rw-rw-  2.0 fat    15351 b- defN 23-Jul-03 11:19 torchrl/objectives/reinforce.py
--rw-rw-rw-  2.0 fat    53114 b- defN 23-Jul-03 11:19 torchrl/objectives/sac.py
--rw-rw-rw-  2.0 fat    20434 b- defN 23-Jul-03 11:19 torchrl/objectives/td3.py
--rw-rw-rw-  2.0 fat    17171 b- defN 23-Jul-03 11:19 torchrl/objectives/utils.py
--rw-rw-rw-  2.0 fat      371 b- defN 23-Jul-03 11:19 torchrl/objectives/value/__init__.py
--rw-rw-rw-  2.0 fat    54255 b- defN 23-Jul-03 11:19 torchrl/objectives/value/advantages.py
--rw-rw-rw-  2.0 fat    40208 b- defN 23-Jul-03 11:19 torchrl/objectives/value/functional.py
--rw-rw-rw-  2.0 fat      317 b- defN 23-Jul-03 11:19 torchrl/objectives/value/pg.py
--rw-rw-rw-  2.0 fat    13251 b- defN 23-Jul-03 11:19 torchrl/objectives/value/utils.py
--rw-rw-rw-  2.0 fat     1724 b- defN 23-Jul-03 11:19 torchrl/objectives/value/vtrace.py
--rw-rw-rw-  2.0 fat      242 b- defN 23-Jul-03 11:19 torchrl/record/__init__.py
--rw-rw-rw-  2.0 fat     6839 b- defN 23-Jul-03 11:19 torchrl/record/recorder.py
--rw-rw-rw-  2.0 fat      413 b- defN 23-Jul-03 11:19 torchrl/record/loggers/__init__.py
--rw-rw-rw-  2.0 fat     1156 b- defN 23-Jul-03 11:19 torchrl/record/loggers/common.py
--rw-rw-rw-  2.0 fat     4870 b- defN 23-Jul-03 11:19 torchrl/record/loggers/csv.py
--rw-rw-rw-  2.0 fat     4505 b- defN 23-Jul-03 11:19 torchrl/record/loggers/mlflow.py
--rw-rw-rw-  2.0 fat     4489 b- defN 23-Jul-03 11:19 torchrl/record/loggers/tensorboard.py
--rw-rw-rw-  2.0 fat     2248 b- defN 23-Jul-03 11:19 torchrl/record/loggers/utils.py
--rw-rw-rw-  2.0 fat     6917 b- defN 23-Jul-03 11:19 torchrl/record/loggers/wandb.py
--rw-rw-rw-  2.0 fat      467 b- defN 23-Jul-03 11:19 torchrl/trainers/__init__.py
--rw-rw-rw-  2.0 fat    52042 b- defN 23-Jul-03 11:19 torchrl/trainers/trainers.py
--rw-rw-rw-  2.0 fat      734 b- defN 23-Jul-03 11:19 torchrl/trainers/helpers/__init__.py
--rw-rw-rw-  2.0 fat    19309 b- defN 23-Jul-03 11:19 torchrl/trainers/helpers/collectors.py
--rw-rw-rw-  2.0 fat    22900 b- defN 23-Jul-03 11:19 torchrl/trainers/helpers/envs.py
--rw-rw-rw-  2.0 fat     1206 b- defN 23-Jul-03 11:19 torchrl/trainers/helpers/logger.py
--rw-rw-rw-  2.0 fat     6920 b- defN 23-Jul-03 11:19 torchrl/trainers/helpers/losses.py
--rw-rw-rw-  2.0 fat    32564 b- defN 23-Jul-03 11:19 torchrl/trainers/helpers/models.py
--rw-rw-rw-  2.0 fat     1939 b- defN 23-Jul-03 11:19 torchrl/trainers/helpers/replay_buffer.py
--rw-rw-rw-  2.0 fat    12076 b- defN 23-Jul-03 11:19 torchrl/trainers/helpers/trainers.py
--rw-rw-rw-  2.0 fat     1119 b- defN 23-Jul-03 11:21 torchrl_nightly-2023.7.3.dist-info/LICENSE
--rw-rw-rw-  2.0 fat    28923 b- defN 23-Jul-03 11:21 torchrl_nightly-2023.7.3.dist-info/METADATA
--rw-rw-rw-  2.0 fat      100 b- defN 23-Jul-03 11:21 torchrl_nightly-2023.7.3.dist-info/WHEEL
--rw-rw-rw-  2.0 fat       20 b- defN 23-Jul-03 11:21 torchrl_nightly-2023.7.3.dist-info/top_level.txt
--rw-rw-r--  2.0 fat    12163 b- defN 23-Jul-03 11:21 torchrl_nightly-2023.7.3.dist-info/RECORD
-136 files, 2388354 bytes uncompressed, 601157 bytes compressed:  74.8%
+Zip file size: 620596 bytes, number of entries: 136
+-rw-rw-rw-  2.0 fat      183 b- defN 23-Jul-04 11:19 build_tools/__init__.py
+-rw-rw-rw-  2.0 fat      245 b- defN 23-Jul-04 11:19 build_tools/setup_helpers/__init__.py
+-rw-rw-rw-  2.0 fat     6085 b- defN 23-Jul-04 11:19 build_tools/setup_helpers/extension.py
+-rw-rw-rw-  2.0 fat      957 b- defN 23-Jul-04 11:19 torchrl/__init__.py
+-rw-rw-rw-  2.0 fat      868 b- defN 23-Jul-04 11:19 torchrl/_extension.py
+-rw-rw-rw-  2.0 fat   346112 b- defN 23-Jul-04 11:22 torchrl/_torchrl.pyd
+-rw-rw-rw-  2.0 fat    18043 b- defN 23-Jul-04 11:19 torchrl/_utils.py
+-rw-rw-rw-  2.0 fat       84 b- defN 23-Jul-04 11:21 torchrl/version.py
+-rw-rw-rw-  2.0 fat      366 b- defN 23-Jul-04 11:19 torchrl/collectors/__init__.py
+-rw-rw-rw-  2.0 fat    97839 b- defN 23-Jul-04 11:19 torchrl/collectors/collectors.py
+-rw-rw-rw-  2.0 fat     3847 b- defN 23-Jul-04 11:19 torchrl/collectors/utils.py
+-rw-rw-rw-  2.0 fat      412 b- defN 23-Jul-04 11:19 torchrl/collectors/distributed/__init__.py
+-rw-rw-rw-  2.0 fat      674 b- defN 23-Jul-04 11:19 torchrl/collectors/distributed/default_configs.py
+-rw-rw-rw-  2.0 fat    34086 b- defN 23-Jul-04 11:19 torchrl/collectors/distributed/generic.py
+-rw-rw-rw-  2.0 fat    27837 b- defN 23-Jul-04 11:19 torchrl/collectors/distributed/ray.py
+-rw-rw-rw-  2.0 fat    27697 b- defN 23-Jul-04 11:19 torchrl/collectors/distributed/rpc.py
+-rw-rw-rw-  2.0 fat    20055 b- defN 23-Jul-04 11:19 torchrl/collectors/distributed/sync.py
+-rw-rw-rw-  2.0 fat     6244 b- defN 23-Jul-04 11:19 torchrl/collectors/distributed/utils.py
+-rw-rw-rw-  2.0 fat     1236 b- defN 23-Jul-04 11:19 torchrl/data/__init__.py
+-rw-rw-rw-  2.0 fat   123749 b- defN 23-Jul-04 11:19 torchrl/data/tensor_specs.py
+-rw-rw-rw-  2.0 fat     2061 b- defN 23-Jul-04 11:19 torchrl/data/utils.py
+-rw-rw-rw-  2.0 fat       84 b- defN 23-Jul-04 11:19 torchrl/data/datasets/__init__.py
+-rw-rw-rw-  2.0 fat    12415 b- defN 23-Jul-04 11:19 torchrl/data/datasets/d4rl.py
+-rw-rw-rw-  2.0 fat     6333 b- defN 23-Jul-04 11:19 torchrl/data/datasets/openml.py
+-rw-rw-rw-  2.0 fat      219 b- defN 23-Jul-04 11:19 torchrl/data/postprocs/__init__.py
+-rw-rw-rw-  2.0 fat     9361 b- defN 23-Jul-04 11:19 torchrl/data/postprocs/postprocs.py
+-rw-rw-rw-  2.0 fat      694 b- defN 23-Jul-04 11:19 torchrl/data/replay_buffers/__init__.py
+-rw-rw-rw-  2.0 fat    42400 b- defN 23-Jul-04 11:19 torchrl/data/replay_buffers/replay_buffers.py
+-rw-rw-rw-  2.0 fat    12186 b- defN 23-Jul-04 11:19 torchrl/data/replay_buffers/samplers.py
+-rw-rw-rw-  2.0 fat    25590 b- defN 23-Jul-04 11:19 torchrl/data/replay_buffers/storages.py
+-rw-rw-rw-  2.0 fat     1904 b- defN 23-Jul-04 11:19 torchrl/data/replay_buffers/utils.py
+-rw-rw-rw-  2.0 fat     2959 b- defN 23-Jul-04 11:19 torchrl/data/replay_buffers/writers.py
+-rw-rw-rw-  2.0 fat      464 b- defN 23-Jul-04 11:19 torchrl/data/rlhf/__init__.py
+-rw-rw-rw-  2.0 fat    20494 b- defN 23-Jul-04 11:19 torchrl/data/rlhf/dataset.py
+-rw-rw-rw-  2.0 fat     8223 b- defN 23-Jul-04 11:19 torchrl/data/rlhf/prompt.py
+-rw-rw-rw-  2.0 fat     8416 b- defN 23-Jul-04 11:19 torchrl/data/rlhf/reward.py
+-rw-rw-rw-  2.0 fat    18364 b- defN 23-Jul-04 11:19 torchrl/data/rlhf/utils.py
+-rw-rw-rw-  2.0 fat     1539 b- defN 23-Jul-04 11:19 torchrl/envs/__init__.py
+-rw-rw-rw-  2.0 fat    61356 b- defN 23-Jul-04 11:19 torchrl/envs/common.py
+-rw-rw-rw-  2.0 fat     7603 b- defN 23-Jul-04 11:19 torchrl/envs/env_creator.py
+-rw-rw-rw-  2.0 fat    12877 b- defN 23-Jul-04 11:19 torchrl/envs/gym_like.py
+-rw-rw-rw-  2.0 fat    21656 b- defN 23-Jul-04 11:19 torchrl/envs/utils.py
+-rw-rw-rw-  2.0 fat    56996 b- defN 23-Jul-04 11:19 torchrl/envs/vec_env.py
+-rw-rw-rw-  2.0 fat      183 b- defN 23-Jul-04 11:19 torchrl/envs/libs/__init__.py
+-rw-rw-rw-  2.0 fat    15480 b- defN 23-Jul-04 11:19 torchrl/envs/libs/brax.py
+-rw-rw-rw-  2.0 fat    11234 b- defN 23-Jul-04 11:19 torchrl/envs/libs/dm_control.py
+-rw-rw-rw-  2.0 fat    25980 b- defN 23-Jul-04 11:19 torchrl/envs/libs/gym.py
+-rw-rw-rw-  2.0 fat     2857 b- defN 23-Jul-04 11:19 torchrl/envs/libs/habitat.py
+-rw-rw-rw-  2.0 fat     4975 b- defN 23-Jul-04 11:19 torchrl/envs/libs/jax_utils.py
+-rw-rw-rw-  2.0 fat    12877 b- defN 23-Jul-04 11:19 torchrl/envs/libs/jumanji.py
+-rw-rw-rw-  2.0 fat     5260 b- defN 23-Jul-04 11:19 torchrl/envs/libs/openml.py
+-rw-rw-rw-  2.0 fat     5316 b- defN 23-Jul-04 11:19 torchrl/envs/libs/utils.py
+-rw-rw-rw-  2.0 fat    18538 b- defN 23-Jul-04 11:19 torchrl/envs/libs/vmas.py
+-rw-rw-rw-  2.0 fat      224 b- defN 23-Jul-04 11:19 torchrl/envs/model_based/__init__.py
+-rw-rw-rw-  2.0 fat     8168 b- defN 23-Jul-04 11:19 torchrl/envs/model_based/common.py
+-rw-rw-rw-  2.0 fat     2875 b- defN 23-Jul-04 11:19 torchrl/envs/model_based/dreamer.py
+-rw-rw-rw-  2.0 fat     1077 b- defN 23-Jul-04 11:19 torchrl/envs/transforms/__init__.py
+-rw-rw-rw-  2.0 fat     1485 b- defN 23-Jul-04 11:19 torchrl/envs/transforms/functional.py
+-rw-rw-rw-  2.0 fat    13723 b- defN 23-Jul-04 11:19 torchrl/envs/transforms/r3m.py
+-rw-rw-rw-  2.0 fat     8280 b- defN 23-Jul-04 11:19 torchrl/envs/transforms/rlhf.py
+-rw-rw-rw-  2.0 fat   173665 b- defN 23-Jul-04 11:19 torchrl/envs/transforms/transforms.py
+-rw-rw-rw-  2.0 fat      408 b- defN 23-Jul-04 11:19 torchrl/envs/transforms/utils.py
+-rw-rw-rw-  2.0 fat    14084 b- defN 23-Jul-04 11:19 torchrl/envs/transforms/vip.py
+-rw-rw-rw-  2.0 fat     1468 b- defN 23-Jul-04 11:19 torchrl/modules/__init__.py
+-rw-rw-rw-  2.0 fat      600 b- defN 23-Jul-04 11:19 torchrl/modules/distributions/__init__.py
+-rw-rw-rw-  2.0 fat    21386 b- defN 23-Jul-04 11:19 torchrl/modules/distributions/continuous.py
+-rw-rw-rw-  2.0 fat     9293 b- defN 23-Jul-04 11:19 torchrl/modules/distributions/discrete.py
+-rw-rw-rw-  2.0 fat     5988 b- defN 23-Jul-04 11:19 torchrl/modules/distributions/truncated_normal.py
+-rw-rw-rw-  2.0 fat     6129 b- defN 23-Jul-04 11:19 torchrl/modules/distributions/utils.py
+-rw-rw-rw-  2.0 fat      580 b- defN 23-Jul-04 11:19 torchrl/modules/models/__init__.py
+-rw-rw-rw-  2.0 fat    21885 b- defN 23-Jul-04 11:19 torchrl/modules/models/exploration.py
+-rw-rw-rw-  2.0 fat    14010 b- defN 23-Jul-04 11:19 torchrl/modules/models/model_based.py
+-rw-rw-rw-  2.0 fat    45664 b- defN 23-Jul-04 11:19 torchrl/modules/models/models.py
+-rw-rw-rw-  2.0 fat     6476 b- defN 23-Jul-04 11:19 torchrl/modules/models/rlhf.py
+-rw-rw-rw-  2.0 fat     4023 b- defN 23-Jul-04 11:19 torchrl/modules/models/utils.py
+-rw-rw-rw-  2.0 fat      281 b- defN 23-Jul-04 11:19 torchrl/modules/planners/__init__.py
+-rw-rw-rw-  2.0 fat     9572 b- defN 23-Jul-04 11:19 torchrl/modules/planners/cem.py
+-rw-rw-rw-  2.0 fat     2455 b- defN 23-Jul-04 11:19 torchrl/modules/planners/common.py
+-rw-rw-rw-  2.0 fat    10683 b- defN 23-Jul-04 11:19 torchrl/modules/planners/mppi.py
+-rw-rw-rw-  2.0 fat      925 b- defN 23-Jul-04 11:19 torchrl/modules/tensordict_module/__init__.py
+-rw-rw-rw-  2.0 fat    80502 b- defN 23-Jul-04 11:19 torchrl/modules/tensordict_module/actors.py
+-rw-rw-rw-  2.0 fat    19333 b- defN 23-Jul-04 11:19 torchrl/modules/tensordict_module/common.py
+-rw-rw-rw-  2.0 fat    24584 b- defN 23-Jul-04 11:19 torchrl/modules/tensordict_module/exploration.py
+-rw-rw-rw-  2.0 fat    11468 b- defN 23-Jul-04 11:19 torchrl/modules/tensordict_module/probabilistic.py
+-rw-rw-rw-  2.0 fat    18299 b- defN 23-Jul-04 11:19 torchrl/modules/tensordict_module/rnn.py
+-rw-rw-rw-  2.0 fat     5835 b- defN 23-Jul-04 11:19 torchrl/modules/tensordict_module/sequence.py
+-rw-rw-rw-  2.0 fat     1360 b- defN 23-Jul-04 11:19 torchrl/modules/tensordict_module/world_models.py
+-rw-rw-rw-  2.0 fat     3984 b- defN 23-Jul-04 11:19 torchrl/modules/utils/__init__.py
+-rw-rw-rw-  2.0 fat     2435 b- defN 23-Jul-04 11:19 torchrl/modules/utils/mappings.py
+-rw-rw-rw-  2.0 fat     1368 b- defN 23-Jul-04 11:19 torchrl/modules/utils/utils.py
+-rw-rw-rw-  2.0 fat      921 b- defN 23-Jul-04 11:19 torchrl/objectives/__init__.py
+-rw-rw-rw-  2.0 fat    18048 b- defN 23-Jul-04 11:19 torchrl/objectives/a2c.py
+-rw-rw-rw-  2.0 fat    26507 b- defN 23-Jul-04 11:19 torchrl/objectives/common.py
+-rw-rw-rw-  2.0 fat    31752 b- defN 23-Jul-04 11:19 torchrl/objectives/cql.py
+-rw-rw-rw-  2.0 fat    15521 b- defN 23-Jul-04 11:19 torchrl/objectives/ddpg.py
+-rw-rw-rw-  2.0 fat    18160 b- defN 23-Jul-04 11:19 torchrl/objectives/deprecated.py
+-rw-rw-rw-  2.0 fat    24635 b- defN 23-Jul-04 11:19 torchrl/objectives/dqn.py
+-rw-rw-rw-  2.0 fat    17407 b- defN 23-Jul-04 11:19 torchrl/objectives/dreamer.py
+-rw-rw-rw-  2.0 fat     2119 b- defN 23-Jul-04 11:19 torchrl/objectives/functional.py
+-rw-rw-rw-  2.0 fat    20386 b- defN 23-Jul-04 11:19 torchrl/objectives/iql.py
+-rw-rw-rw-  2.0 fat    39608 b- defN 23-Jul-04 11:19 torchrl/objectives/ppo.py
+-rw-rw-rw-  2.0 fat    25718 b- defN 23-Jul-04 11:19 torchrl/objectives/redq.py
+-rw-rw-rw-  2.0 fat    15351 b- defN 23-Jul-04 11:19 torchrl/objectives/reinforce.py
+-rw-rw-rw-  2.0 fat    53114 b- defN 23-Jul-04 11:19 torchrl/objectives/sac.py
+-rw-rw-rw-  2.0 fat    20434 b- defN 23-Jul-04 11:19 torchrl/objectives/td3.py
+-rw-rw-rw-  2.0 fat    17171 b- defN 23-Jul-04 11:19 torchrl/objectives/utils.py
+-rw-rw-rw-  2.0 fat      371 b- defN 23-Jul-04 11:19 torchrl/objectives/value/__init__.py
+-rw-rw-rw-  2.0 fat    54924 b- defN 23-Jul-04 11:19 torchrl/objectives/value/advantages.py
+-rw-rw-rw-  2.0 fat    40208 b- defN 23-Jul-04 11:19 torchrl/objectives/value/functional.py
+-rw-rw-rw-  2.0 fat      317 b- defN 23-Jul-04 11:19 torchrl/objectives/value/pg.py
+-rw-rw-rw-  2.0 fat    13251 b- defN 23-Jul-04 11:19 torchrl/objectives/value/utils.py
+-rw-rw-rw-  2.0 fat     1724 b- defN 23-Jul-04 11:19 torchrl/objectives/value/vtrace.py
+-rw-rw-rw-  2.0 fat      242 b- defN 23-Jul-04 11:19 torchrl/record/__init__.py
+-rw-rw-rw-  2.0 fat     6839 b- defN 23-Jul-04 11:19 torchrl/record/recorder.py
+-rw-rw-rw-  2.0 fat      413 b- defN 23-Jul-04 11:19 torchrl/record/loggers/__init__.py
+-rw-rw-rw-  2.0 fat     1156 b- defN 23-Jul-04 11:19 torchrl/record/loggers/common.py
+-rw-rw-rw-  2.0 fat     4870 b- defN 23-Jul-04 11:19 torchrl/record/loggers/csv.py
+-rw-rw-rw-  2.0 fat     4505 b- defN 23-Jul-04 11:19 torchrl/record/loggers/mlflow.py
+-rw-rw-rw-  2.0 fat     4489 b- defN 23-Jul-04 11:19 torchrl/record/loggers/tensorboard.py
+-rw-rw-rw-  2.0 fat     2248 b- defN 23-Jul-04 11:19 torchrl/record/loggers/utils.py
+-rw-rw-rw-  2.0 fat     6917 b- defN 23-Jul-04 11:19 torchrl/record/loggers/wandb.py
+-rw-rw-rw-  2.0 fat      467 b- defN 23-Jul-04 11:19 torchrl/trainers/__init__.py
+-rw-rw-rw-  2.0 fat    52042 b- defN 23-Jul-04 11:19 torchrl/trainers/trainers.py
+-rw-rw-rw-  2.0 fat      734 b- defN 23-Jul-04 11:19 torchrl/trainers/helpers/__init__.py
+-rw-rw-rw-  2.0 fat    19309 b- defN 23-Jul-04 11:19 torchrl/trainers/helpers/collectors.py
+-rw-rw-rw-  2.0 fat    22900 b- defN 23-Jul-04 11:19 torchrl/trainers/helpers/envs.py
+-rw-rw-rw-  2.0 fat     1206 b- defN 23-Jul-04 11:19 torchrl/trainers/helpers/logger.py
+-rw-rw-rw-  2.0 fat     6920 b- defN 23-Jul-04 11:19 torchrl/trainers/helpers/losses.py
+-rw-rw-rw-  2.0 fat    32564 b- defN 23-Jul-04 11:19 torchrl/trainers/helpers/models.py
+-rw-rw-rw-  2.0 fat     1939 b- defN 23-Jul-04 11:19 torchrl/trainers/helpers/replay_buffer.py
+-rw-rw-rw-  2.0 fat    12076 b- defN 23-Jul-04 11:19 torchrl/trainers/helpers/trainers.py
+-rw-rw-rw-  2.0 fat     1119 b- defN 23-Jul-04 11:22 torchrl_nightly-2023.7.4.dist-info/LICENSE
+-rw-rw-rw-  2.0 fat    28923 b- defN 23-Jul-04 11:22 torchrl_nightly-2023.7.4.dist-info/METADATA
+-rw-rw-rw-  2.0 fat      100 b- defN 23-Jul-04 11:22 torchrl_nightly-2023.7.4.dist-info/WHEEL
+-rw-rw-rw-  2.0 fat       20 b- defN 23-Jul-04 11:22 torchrl_nightly-2023.7.4.dist-info/top_level.txt
+-rw-rw-r--  2.0 fat    12163 b- defN 23-Jul-04 11:22 torchrl_nightly-2023.7.4.dist-info/RECORD
+136 files, 2389896 bytes uncompressed, 601370 bytes compressed:  74.9%
```

## zipnote {}

```diff
@@ -387,23 +387,23 @@
 
 Filename: torchrl/trainers/helpers/replay_buffer.py
 Comment: 
 
 Filename: torchrl/trainers/helpers/trainers.py
 Comment: 
 
-Filename: torchrl_nightly-2023.7.3.dist-info/LICENSE
+Filename: torchrl_nightly-2023.7.4.dist-info/LICENSE
 Comment: 
 
-Filename: torchrl_nightly-2023.7.3.dist-info/METADATA
+Filename: torchrl_nightly-2023.7.4.dist-info/METADATA
 Comment: 
 
-Filename: torchrl_nightly-2023.7.3.dist-info/WHEEL
+Filename: torchrl_nightly-2023.7.4.dist-info/WHEEL
 Comment: 
 
-Filename: torchrl_nightly-2023.7.3.dist-info/top_level.txt
+Filename: torchrl_nightly-2023.7.4.dist-info/top_level.txt
 Comment: 
 
-Filename: torchrl_nightly-2023.7.3.dist-info/RECORD
+Filename: torchrl_nightly-2023.7.4.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## torchrl/version.py

```diff
@@ -1,2 +1,2 @@
-__version__ = '2023.7.3'
-git_version = '8700e15f3eb67f8a91317c547fd17d945c098aff'
+__version__ = '2023.7.4'
+git_version = 'd12afa0673e009bcf456490d672b44194a92e1ee'
```

## torchrl/envs/common.py

```diff
@@ -8,15 +8,15 @@
 import abc
 from copy import deepcopy
 from typing import Any, Callable, Dict, Iterator, Optional, Union
 
 import numpy as np
 import torch
 import torch.nn as nn
-from tensordict.tensordict import TensorDict, TensorDictBase
+from tensordict.tensordict import TensorDictBase
 
 from torchrl._utils import prod, seed_generator
 
 from torchrl.data.tensor_specs import (
     CompositeSpec,
     DiscreteTensorSpec,
     TensorSpec,
@@ -1029,30 +1029,29 @@
 
         Returns:
             a tensordict object with the "action" entry updated with a random
             sample from the action-spec.
 
         """
         shape = torch.Size([])
-        if tensordict is None:
-            tensordict = TensorDict(
-                {}, device=self.device, batch_size=self.batch_size, _run_checks=False
-            )
-
-        if not self.batch_locked and not self.batch_size:
+        if not self.batch_locked and not self.batch_size and tensordict is not None:
             shape = tensordict.shape
+        elif not self.batch_locked and not self.batch_size:
+            shape = torch.Size([])
         elif not self.batch_locked and tensordict.shape != self.batch_size:
             raise RuntimeError(
                 "The input tensordict and the env have a different batch size: "
                 f"env.batch_size={self.batch_size} and tensordict.batch_size={tensordict.shape}. "
                 f"Non batch-locked environment require the env batch-size to be either empty or to"
                 f" match the tensordict one."
             )
-        action = self.action_spec.rand(shape)
-        tensordict.set(self.action_key, action)
+        r = self.input_spec["_action_spec"].rand(shape)
+        if tensordict is None:
+            return r
+        tensordict.update(r)
         return tensordict
 
     def rand_step(self, tensordict: Optional[TensorDictBase] = None) -> TensorDictBase:
         """Performs a random step in the environment given the action_spec attribute.
 
         Args:
             tensordict (TensorDictBase, optional): tensordict where the resulting info should be written.
@@ -1226,38 +1225,39 @@
         if policy is None:
 
             def policy(td):
                 self.rand_action(td)
                 return td
 
         tensordicts = []
-        done_key = self.done_key
-        if not isinstance(done_key, tuple):
-            done_key = (done_key,)
         for i in range(max_steps):
             if auto_cast_to_device:
                 tensordict = tensordict.to(policy_device, non_blocking=True)
             tensordict = policy(tensordict)
             if auto_cast_to_device:
                 tensordict = tensordict.to(env_device, non_blocking=True)
             tensordict = self.step(tensordict)
 
             tensordicts.append(tensordict.clone(False))
-            done = tensordict.get(("next", *done_key))
+            done = tensordict.get(("next", self.done_key))
             truncated = tensordict.get(
                 ("next", "truncated"),
                 default=torch.zeros((), device=done.device, dtype=torch.bool),
             )
             done = done | truncated
             if (break_when_any_done and done.any()) or i == max_steps - 1:
                 break
             tensordict = step_mdp(
                 tensordict,
                 keep_other=True,
-                exclude_action=False,
+                exclude_action=True,
+                exclude_reward=True,
+                reward_key=self.reward_key,
+                action_key=self.action_key,
+                done_key=self.done_key,
             )
             if not break_when_any_done and done.any():
                 _reset = done.clone()
                 tensordict.set("_reset", _reset)
                 self.reset(tensordict)
 
             if callback is not None:
@@ -1302,44 +1302,42 @@
         return super().to(device)
 
     def fake_tensordict(self) -> TensorDictBase:
         """Returns a fake tensordict with key-value pairs that match in shape, device and dtype what can be expected during an environment rollout."""
         state_spec = self.state_spec
         observation_spec = self.observation_spec
         action_spec = self.input_spec["_action_spec"]
+        # instantiates reward_spec if needed
         _ = self.reward_spec
         reward_spec = self.output_spec["_reward_spec"]
+        # instantiates done_spec if needed
         _ = self.done_spec
         done_spec = self.output_spec["_done_spec"]
 
         fake_obs = observation_spec.zero()
-        fake_input = state_spec.zero()
-        fake_input = fake_input.update(action_spec.zero())
+
+        fake_state = state_spec.zero()
+        fake_action = action_spec.zero()
+        fake_input = fake_state.update(fake_action)
 
         # the input and output key may match, but the output prevails
         # Hence we generate the input, and override using the output
-        fake_in_out = fake_input.clone().update(fake_obs)
+        fake_in_out = fake_input.update(fake_obs)
 
         fake_reward = reward_spec.zero()
         fake_done = done_spec.zero()
 
         next_output = fake_obs.clone()
         next_output.update(fake_reward)
         next_output.update(fake_done)
-
         fake_in_out.update(fake_done.clone())
 
-        fake_td = TensorDict(
-            {
-                **fake_in_out,
-                "next": next_output,
-            },
-            batch_size=self.batch_size,
-            device=self.device,
-        )
+        fake_td = fake_in_out.set("next", next_output)
+        fake_td.batch_size = self.batch_size
+        fake_td = fake_td.to(self.device)
         return fake_td
 
 
 class _EnvWrapper(EnvBase, metaclass=abc.ABCMeta):
     """Abstract environment wrapper class.
 
     Unlike EnvBase, _EnvWrapper comes with a :obj:`_build_env` private method that will be called upon instantiation.
```

## torchrl/envs/utils.py

```diff
@@ -219,25 +219,30 @@
 
     if next_tensordict is not None:
         return next_tensordict.update(out)
     else:
         return out
 
 
-def _set_single_key(source, dest, key):
+def _set_single_key(source, dest, key, clone=False):
+    # key should be already unraveled
+    if isinstance(key, str):
+        key = (key,)
     for k in key:
         val = source.get(k)
         if is_tensor_collection(val):
             new_val = dest.get(k, None)
             if new_val is None:
                 new_val = _clone_no_keys(val)
                 dest._set(k, new_val)
             source = val
             dest = new_val
         else:
+            if clone:
+                val = val.clone()
             dest._set(k, val)
 
 
 def _set(source, dest, key, total_key, excluded):
     total_key = total_key + (key,)
     non_empty = False
     if total_key not in excluded:
@@ -478,14 +483,15 @@
 
     def __get__(self, owner_self, owner_cls):
         return self.fget(owner_cls)
 
 
 def _sort_keys(element):
     if isinstance(element, tuple):
+        element = unravel_keys(element)
         return "_-|-_".join(element)
     return element
 
 
 def make_composite_from_td(data):
     """Creates a CompositeSpec instance from a tensordict, assuming all values are unbounded.
```

## torchrl/envs/vec_env.py

```diff
@@ -16,29 +16,29 @@
 from typing import Any, Callable, Dict, List, Optional, Sequence, Tuple, Union
 from warnings import warn
 
 import numpy as np
 import torch
 from tensordict import TensorDict
 from tensordict.tensordict import LazyStackedTensorDict, TensorDictBase
+from tensordict.utils import unravel_keys
 from torch import multiprocessing as mp
 
 from torchrl._utils import _check_for_faulty_process, VERBOSE
 from torchrl.data.tensor_specs import (
     CompositeSpec,
     DiscreteTensorSpec,
     TensorSpec,
     UnboundedContinuousTensorSpec,
 )
 from torchrl.data.utils import CloudpickleWrapper, DEVICE_TYPING
 from torchrl.envs.common import _EnvWrapper, EnvBase
 from torchrl.envs.env_creator import get_env_metadata
 
-from torchrl.envs.utils import _sort_keys
-
+from torchrl.envs.utils import _set_single_key, _sort_keys
 
 _has_envpool = importlib.util.find_spec("envpool")
 
 
 def _check_start(fun):
     def decorated_fun(self: _BatchedEnv, *args, **kwargs):
         if self.is_closed:
@@ -320,68 +320,69 @@
                     "batched environment base tensordict has the wrong shape"
                 )
         else:
             shared_tensordict_parent = self._env_tensordict.clone()
 
         if self._single_task:
             self.env_input_keys = sorted(
-                list(self.input_spec["_action_spec"].keys(True))
-                + list(self.state_spec.keys(True)),
+                list(self.input_spec["_action_spec"].keys(True, True))
+                + list(self.state_spec.keys(True, True)),
                 key=_sort_keys,
             )
             self.env_output_keys = []
             self.env_obs_keys = []
-            for key in self.output_spec["_observation_spec"].keys(True):
-                if isinstance(key, str):
-                    key = (key,)
-                self.env_output_keys.append(("next", *key))
+            for key in self.output_spec["_observation_spec"].keys(True, True):
+                self.env_output_keys.append(unravel_keys(("next", key)))
                 self.env_obs_keys.append(key)
-            self.env_output_keys.append(("next", "reward"))
-            self.env_output_keys.append(("next", "done"))
+            self.env_output_keys.append(unravel_keys(("next", self.reward_key)))
+            self.env_output_keys.append(unravel_keys(("next", self.done_key)))
         else:
             env_input_keys = set()
             for meta_data in self.meta_data:
                 if meta_data.specs["input_spec", "_state_spec"] is not None:
                     env_input_keys = env_input_keys.union(
-                        meta_data.specs["input_spec", "_state_spec"].keys(True)
+                        meta_data.specs["input_spec", "_state_spec"].keys(True, True)
                     )
                 env_input_keys = env_input_keys.union(
-                    meta_data.specs["input_spec", "_action_spec"].keys(True)
+                    meta_data.specs["input_spec", "_action_spec"].keys(True, True)
                 )
             env_output_keys = set()
             env_obs_keys = set()
             for meta_data in self.meta_data:
                 env_obs_keys = env_obs_keys.union(
                     key
                     for key in meta_data.specs["output_spec"]["_observation_spec"].keys(
-                        True
+                        True, True
                     )
                 )
                 env_output_keys = env_output_keys.union(
-                    ("next", key) if isinstance(key, str) else ("next", *key)
+                    unravel_keys(("next", key))
                     for key in meta_data.specs["output_spec"]["_observation_spec"].keys(
-                        True
+                        True, True
                     )
                 )
             env_output_keys = env_output_keys.union(
-                {("next", "reward"), ("next", "done")}
+                {
+                    unravel_keys(("next", self.reward_key)),
+                    unravel_keys(("next", self.done_key)),
+                }
             )
             self.env_obs_keys = sorted(env_obs_keys, key=_sort_keys)
             self.env_input_keys = sorted(env_input_keys, key=_sort_keys)
             self.env_output_keys = sorted(env_output_keys, key=_sort_keys)
 
         self._selected_keys = (
             set(self.env_output_keys)
             .union(self.env_input_keys)
             .union(self.env_obs_keys)
         )
-        self._selected_keys.add("done")
+        self._selected_keys.add(self.done_key)
         self._selected_keys.add("_reset")
 
-        self._selected_reset_keys = self.env_obs_keys + ["done"] + ["_reset"]
+        self._selected_reset_keys = self.env_obs_keys + [self.done_key] + ["_reset"]
         self._selected_step_keys = self.env_output_keys
 
         if self._single_task:
             shared_tensordict_parent = shared_tensordict_parent.select(
                 *self._selected_keys,
                 strict=False,
             )
@@ -546,15 +547,15 @@
                 out_td.select(*self.env_input_keys, *self.env_output_keys)
             )
         # We must pass a clone of the tensordict, as the values of this tensordict
         # will be modified in-place at further steps
         if self._single_task:
             out = TensorDict({}, batch_size=self.shared_tensordict_parent.shape)
             for key in self._selected_step_keys:
-                out._set(key, self.shared_tensordict_parent.get(key).clone())
+                _set_single_key(self.shared_tensordict_parent, out, key, clone=True)
         else:
             # strict=False ensures that non-homogeneous keys are still there
             out = self.shared_tensordict_parent.select(
                 *self._selected_step_keys, strict=False
             ).clone()
         return out
 
@@ -615,15 +616,15 @@
             )
 
         if self._single_task:
             # select + clone creates 2 tds, but we can create one only
             out = TensorDict({}, batch_size=self.shared_tensordict_parent.shape)
             for key in self._selected_reset_keys:
                 if key != "_reset":
-                    out._set(key, self.shared_tensordict_parent.get(key).clone())
+                    _set_single_key(self.shared_tensordict_parent, out, key, clone=True)
             return out
         else:
             return self.shared_tensordict_parent.select(
                 *[key for key in self._selected_reset_keys if key != "_reset"],
                 strict=False,
             ).clone()
 
@@ -786,15 +787,15 @@
             if data is not None:
                 self.shared_tensordicts[i].update_(data)
         # We must pass a clone of the tensordict, as the values of this tensordict
         # will be modified in-place at further steps
         if self._single_task:
             out = TensorDict({}, batch_size=self.shared_tensordict_parent.shape)
             for key in self._selected_step_keys:
-                out._set(key, self.shared_tensordict_parent.get(key).clone())
+                _set_single_key(self.shared_tensordict_parent, out, key, clone=True)
         else:
             # strict=False ensures that non-homogeneous keys are still there
             out = self.shared_tensordict_parent.select(
                 *self._selected_step_keys, strict=False
             ).clone()
         return out
 
@@ -849,15 +850,15 @@
             if data is not None:
                 self.shared_tensordicts[i].update_(data)
         if self._single_task:
             # select + clone creates 2 tds, but we can create one only
             out = TensorDict({}, batch_size=self.shared_tensordict_parent.shape)
             for key in self._selected_reset_keys:
                 if key != "_reset":
-                    out._set(key, self.shared_tensordict_parent.get(key).clone())
+                    _set_single_key(self.shared_tensordict_parent, out, key, clone=True)
             return out
         else:
             return self.shared_tensordict_parent.select(
                 *[key for key in self._selected_reset_keys if key != "_reset"],
                 strict=False,
             ).clone()
 
@@ -1183,15 +1184,15 @@
             reset_data = self._env.reset()
         tensordict_out = self._transform_reset_output(reset_data, reset_workers)
         self.is_closed = False
         return tensordict_out
 
     @torch.no_grad()
     def _step(self, tensordict: TensorDictBase) -> TensorDictBase:
-        action = tensordict.get("action")
+        action = tensordict.get(self.action_key)
         # Action needs to be moved to CPU and converted to numpy before being passed to envpool
         action = action.to(torch.device("cpu"))
         step_output = self._env.step(action.numpy())
         tensordict_out = self._transform_step_output(step_output)
         return tensordict_out.select().set("next", tensordict_out)
 
     def _get_action_spec(self) -> TensorSpec:
@@ -1281,25 +1282,25 @@
         else:
             # All workers were reset - rewrite the whole observation buffer
             self.obs = TensorDict(
                 self._treevalue_or_numpy_to_tensor_or_dict(observation), self.batch_size
             )
 
         obs = self.obs.clone(False)
-        obs.update({"done": self.done_spec.zero()})
+        obs.update({self.done_key: self.done_spec.zero()})
         return obs
 
     def _transform_step_output(
         self, envpool_output: Tuple[Any, Any, Any, ...]
     ) -> TensorDict:
         """Process output of envpool env.step."""
         obs, reward, done, *_ = envpool_output
 
         obs = self._treevalue_or_numpy_to_tensor_or_dict(obs)
-        obs.update({"reward": torch.tensor(reward), "done": done})
+        obs.update({self.reward_key: torch.tensor(reward), self.done_key: done})
         self.obs = tensordict_out = TensorDict(
             obs,
             batch_size=self.batch_size,
             device=self.device,
         )
         return tensordict_out
```

## torchrl/modules/models/model_based.py

```diff
@@ -2,15 +2,15 @@
 #
 # This source code is licensed under the MIT license found in the
 # LICENSE file in the root directory of this source tree.
 import warnings
 
 import torch
 from packaging import version
-from tensordict.nn import TensorDictModule
+from tensordict.nn import TensorDictModule, TensorDictModuleBase
 from torch import nn
 
 from torchrl.envs.utils import step_mdp
 from torchrl.modules.distributions import NormalParamWrapper
 from torchrl.modules.models.models import MLP
 from torchrl.modules.tensordict_module.sequence import SafeSequential
 
@@ -182,15 +182,15 @@
         latent = latent.view(-1, D, 1, 1)
         obs_decoded = self.decoder(latent)
         _, C, H, W = obs_decoded.shape
         obs_decoded = obs_decoded.view(*batch_sizes, C, H, W)
         return obs_decoded
 
 
-class RSSMRollout(nn.Module):
+class RSSMRollout(TensorDictModuleBase):
     """Rollout the RSSM network.
 
     Given a set of encoded observations and actions, this module will rollout the RSSM network to compute all the intermediate
     states and beliefs.
     The previous posterior is used as the prior for the next time step.
     The forward method returns a stack of all intermediate states and beliefs.
```

## torchrl/modules/tensordict_module/common.py

```diff
@@ -1,14 +1,15 @@
 # Copyright (c) Meta Platforms, Inc. and affiliates.
 #
 # This source code is licensed under the MIT license found in the
 # LICENSE file in the root directory of this source tree.
 
 from __future__ import annotations
 
+import importlib.util
 import inspect
 import re
 import warnings
 from typing import Iterable, Optional, Type, Union
 
 import torch
 
@@ -17,20 +18,18 @@
 
 from torch import nn
 
 from torchrl.data.tensor_specs import CompositeSpec, TensorSpec
 
 from torchrl.data.utils import DEVICE_TYPING
 
-_has_functorch = False
-try:
+_has_functorch = importlib.util.find_spec("functorch") is not None
+if _has_functorch:
     from functorch import FunctionalModule, FunctionalModuleWithBuffers
-
-    _has_functorch = True
-except ImportError:
+else:
     warnings.warn(
         "failed to import functorch. TorchRL's features that do not require "
         "functional programming should work, but functionality and performance "
         "may be affected. Consider installing functorch and/or upgrating pytorch."
     )
 
     class FunctionalModule:  # noqa: D101
@@ -216,15 +215,15 @@
             if len(self.out_keys) > 1:
                 raise RuntimeError(
                     f"got more than one out_key for the TensorDictModule: {self.out_keys},\nbut only one spec. "
                     "Consider using a CompositeSpec object or no spec at all."
                 )
             spec = CompositeSpec(**{self.out_keys[0]: spec})
         elif spec is not None and isinstance(spec, CompositeSpec):
-            if "_" in spec.keys():
+            if "_" in spec.keys() and spec["_"] is not None:
                 warnings.warn('got a spec with key "_": it will be ignored')
         elif spec is None:
             spec = CompositeSpec()
 
         if set(spec.keys(True, True)) != set(self.out_keys):
             # then assume that all the non indicated specs are None
             for key in self.out_keys:
@@ -429,22 +428,30 @@
         >>> lam(sample_in)
         >>> vm = VmapModule(lam, 0)
         >>> vm(sample_in_td)
         >>> assert (sample_in_td["x"][:, 0] == sample_in_td["y"]).all()
     """
 
     def __init__(self, module: TensorDictModuleBase, vmap_dim=None):
+        if not _has_functorch:
+            raise ImportError("VmapModule requires torch>=1.13.")
         super().__init__()
         self.in_keys = module.in_keys
         self.out_keys = module.out_keys
         self.module = module
         self.vmap_dim = vmap_dim
+        if torch.__version__ >= "2.0":
+            self._vmap = torch.vmap
+        else:
+            import functorch
+
+            self._vmap = functorch.vmap
 
     def forward(self, tensordict):
         # TODO: there is a risk of segfault if input is not a tensordict.
         # We should investigate (possibly prevent it c++ side?)
         vmap_dim = self.vmap_dim
         if vmap_dim is None:
             ndim = tensordict.ndim
             vmap_dim = ndim - 1
-        td = torch.vmap(self.module, (vmap_dim,), (vmap_dim,))(tensordict)
+        td = self._vmap(self.module, (vmap_dim,), (vmap_dim,))(tensordict)
         return tensordict.update(td)
```

## torchrl/objectives/common.py

```diff
@@ -426,15 +426,15 @@
         param_name = network_name + "_params"
         if target_name in self.__dict__:
             target_params = getattr(self, target_name)
             if target_params is not None:
                 if not self._has_update_associated and RL_WARNINGS:
                     warnings.warn(
                         "No target network updater has been associated "
-                        "with this loss module, but target parameters have been found."
+                        "with this loss module, but target parameters have been found. "
                         "While this is supported, it is expected that the target network "
                         "updates will be manually performed. You can deactivate this warning "
                         "by turning the RL_WARNINGS env variable to False.",
                         category=UserWarning,
                     )
                 # get targets and update
                 for key in target_params.keys(True, True):
```

## torchrl/objectives/value/advantages.py

```diff
@@ -71,45 +71,59 @@
     params: TensorDictBase,
     next_params: TensorDictBase,
     single_call: bool,
     value_key: NestedKey,
     detach_next: bool,
 ):
     in_keys = value_net.in_keys
-    for i, name in enumerate(data.names):
-        if name == "time":
-            ndim = i + 1
-            break
-    else:
-        if RL_WARNINGS:
-            warnings.warn(
-                "Got a tensordict without a time-marked dimension, assuming time is along the last dimension. "
-                "This warning can be turned off by setting the environment variable RL_WARNINGS to False."
-            )
-        ndim = i + 1
     if single_call:
-        # get data at t and last of t+1
-        data_in = torch.cat(
-            [
-                data.select(*in_keys, value_key, strict=False),
-                data.get("next").select(*in_keys, value_key, strict=False)[..., -1:],
-            ],
-            -1,
-        )
+        for i, name in enumerate(data.names):
+            if name == "time":
+                ndim = i + 1
+                break
+        else:
+            ndim = None
+        if ndim is not None:
+            # get data at t and last of t+1
+            idx0 = (slice(None),) * (ndim - 1) + (slice(-1, None),)
+            idx = (slice(None),) * (ndim - 1) + (slice(None, -1),)
+            idx_ = (slice(None),) * (ndim - 1) + (slice(1, None),)
+            data_in = torch.cat(
+                [
+                    data.select(*in_keys, value_key, strict=False),
+                    data.get("next").select(*in_keys, value_key, strict=False)[idx0],
+                ],
+                ndim - 1,
+            )
+        else:
+            if RL_WARNINGS:
+                warnings.warn(
+                    "Got a tensordict without a time-marked dimension, assuming time is along the last dimension. "
+                    "This warning can be turned off by setting the environment variable RL_WARNINGS to False."
+                )
+            ndim = data.ndim
+            idx = (slice(None),) * (ndim - 1) + (slice(None, data.shape[ndim - 1]),)
+            idx_ = (slice(None),) * (ndim - 1) + (slice(data.shape[ndim - 1], None),)
+            data_in = torch.cat(
+                [
+                    data.select(*in_keys, value_key, strict=False),
+                    data.get("next").select(*in_keys, value_key, strict=False),
+                ],
+                ndim - 1,
+            )
+
         # next_params should be None or be identical to params
         if next_params is not None and next_params is not params:
             raise ValueError(
                 "the value at t and t+1 cannot be retrieved in a single call without recurring to vmap when both params and next params are passed."
             )
         if params is not None:
             value_est = value_net(data_in, params).get(value_key)
         else:
             value_est = value_net(data_in).get(value_key)
-        idx = (slice(None),) * (ndim - 1) + (slice(None, -1),)
-        idx_ = (slice(None),) * (ndim - 1) + (slice(1, None),)
         value, value_ = value_est[idx], value_est[idx_]
     else:
         data_in = torch.stack(
             [
                 data.select(*in_keys, value_key, strict=False),
                 data.get("next").select(*in_keys, value_key, strict=False),
             ],
```

## Comparing `torchrl_nightly-2023.7.3.dist-info/LICENSE` & `torchrl_nightly-2023.7.4.dist-info/LICENSE`

 * *Files identical despite different names*

## Comparing `torchrl_nightly-2023.7.3.dist-info/METADATA` & `torchrl_nightly-2023.7.4.dist-info/METADATA`

 * *Files 0% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: torchrl-nightly
-Version: 2023.7.3
+Version: 2023.7.4
 Summary: UNKNOWN
 Home-page: https://github.com/pytorch/rl
 Author: torchrl contributors
 Author-email: vmoens@fb.com
 License: BSD
 Platform: UNKNOWN
 Classifier: Programming Language :: Python :: 3.7
```

### html2text {}

```diff
@@ -1,8 +1,8 @@
-Metadata-Version: 2.1 Name: torchrl-nightly Version: 2023.7.3 Summary: UNKNOWN
+Metadata-Version: 2.1 Name: torchrl-nightly Version: 2023.7.4 Summary: UNKNOWN
 Home-page: https://github.com/pytorch/rl Author: torchrl contributors Author-
 email: vmoens@fb.com License: BSD Platform: UNKNOWN Classifier: Programming
 Language :: Python :: 3.7 Classifier: Programming Language :: Python :: 3.8
 Classifier: Programming Language :: Python :: 3.9 Classifier: Programming
 Language :: Python :: 3.10 Classifier: License :: OSI Approved :: MIT License
 Classifier: Operating System :: OS Independent Classifier: Development Status
 :: 4 - Beta Classifier: Intended Audience :: Developers Classifier: Intended
```

## Comparing `torchrl_nightly-2023.7.3.dist-info/RECORD` & `torchrl_nightly-2023.7.4.dist-info/RECORD`

 * *Files 10% similar despite different names*

```diff
@@ -1,15 +1,15 @@
 build_tools/__init__.py,sha256=5xRGSM4YMr794wxfVj_SQly2cyHNyhXTdXdWUZJoM2M,183
 build_tools/setup_helpers/__init__.py,sha256=uwhUMyZq6dm1J5T_rjItc0aZb8-WSJFYd81pU3aJQsE,245
 build_tools/setup_helpers/extension.py,sha256=8u0VrdMo3WzXp1V9KrB_tq2EfkGkWncQ6G8yzW8gcyo,6085
 torchrl/__init__.py,sha256=cOWCLNeRq7gnOXqFzcFKPm93wefcLaa1LgWRe59xmUI,957
 torchrl/_extension.py,sha256=N01cFr5HT6P8G81alGHUWFGVWHHeTgJAJT88Lz6MZRk,868
-torchrl/_torchrl.pyd,sha256=oMc4inb_zBkX2Ix8K92HCT8RyWtoct4ZnlOCc5HIykw,346112
+torchrl/_torchrl.pyd,sha256=_-f-_OGWsrj2Zg9mrPRyGylPdvEx3s1ANU0-UaRi0K4,346112
 torchrl/_utils.py,sha256=uhW2cBE20VylyaI9uh-P8sruSBPSM0-s_E8h2jX3gYQ,18043
-torchrl/version.py,sha256=_j9ytI5XjLlo32ZdZQqd7CiruyfnNXXBhrFkT6fCzv8,84
+torchrl/version.py,sha256=znoEJCLFBS2ajqhC2KJdtAeTIBVLOsKl7KbxBDE1ji4,84
 torchrl/collectors/__init__.py,sha256=Wbyd0dYtj4Oe-XLTlT5VG4yl0cHhLjXjmxA-8L0bjp8,366
 torchrl/collectors/collectors.py,sha256=pJGmVnlvzI4Es6XzOSKxqTe_8Y6eZfyciNu-nKIuAFc,97839
 torchrl/collectors/utils.py,sha256=D9ggquoMMQhvasgRNTMBvZicMpRvYKOzp2zwWVIviQo,3847
 torchrl/collectors/distributed/__init__.py,sha256=5qoBlS2wvrEFc9SRGwNMDcvCJ_XukVLyyvX7MwN9slU,412
 torchrl/collectors/distributed/default_configs.py,sha256=RkY8hmAzDttCXAjfoqdvAsCSwaXdtN4AGWJ70hSUmic,674
 torchrl/collectors/distributed/generic.py,sha256=QPJtNsB6niAbVkvhLoWwjGkNp6uKvew3tK1Y69NQgQM,34086
 torchrl/collectors/distributed/ray.py,sha256=j_9OOcoMsVSg11MhHMKqR5WR4XHuD_JRCzVq4_ZvNyE,27837
@@ -32,19 +32,19 @@
 torchrl/data/replay_buffers/writers.py,sha256=gRnA07G77ApXWG3Aj73VOsv1UxVHkKUSGsPCh8lKLis,2959
 torchrl/data/rlhf/__init__.py,sha256=BwaqWndEKAlhSZymwc6sptDNxuS6LTRmjJOxkZNkWAY,464
 torchrl/data/rlhf/dataset.py,sha256=4IncqKw9H7zkb8TSoIf2IHIrFPIH0_37fWcF8T8slxs,20494
 torchrl/data/rlhf/prompt.py,sha256=Cgjms66zhaSaA0R3oksEakJb1KNC9e3XDxJYP48cESc,8223
 torchrl/data/rlhf/reward.py,sha256=9BJzaRm24VQC5kCFatGcPt8mSyGlVK2x_w0_hYT9o9U,8416
 torchrl/data/rlhf/utils.py,sha256=4srVJTdykA2OOXzWPaKMKP5xdWTYsrJkdXaM3ubt9Nc,18364
 torchrl/envs/__init__.py,sha256=tmqew8jnXXYCS8gLYKUPJtirR-M_JSnXUfE6DCG-Ga4,1539
-torchrl/envs/common.py,sha256=Nt0TujN9miSaPpnZSUK-20Tjhtqu8Pcst0VdQBOkyzc,61271
+torchrl/envs/common.py,sha256=X-GFJSfKXxoJOki9_HID4RKDr9AyV6WaAK6AitqOj0E,61356
 torchrl/envs/env_creator.py,sha256=4YHoWHyRxzbBJjLPo3kFL_1rRCAKCcHkNCQBYEXbhR4,7603
 torchrl/envs/gym_like.py,sha256=QUCxRQOrpGF1We1pw_OiIW8n4dvgvjr3_beGwHrv-VU,12877
-torchrl/envs/utils.py,sha256=-Tc8SICiGLu8wZw2FeWku2qiohoJDMu6GhKoa8HDOkY,21453
-torchrl/envs/vec_env.py,sha256=tCl1WAF-kD3lkUdlPDTFc9_CB43nuB9zob7kHrZ0fTY,56773
+torchrl/envs/utils.py,sha256=ivYSWX2sv79O5TMwQe22baURyim2QfN5FewVkOZKdcs,21656
+torchrl/envs/vec_env.py,sha256=ATEsKCrzTRS6dYudZc4fJoflKzpe4eLRQyFu6DMeJM4,56996
 torchrl/envs/libs/__init__.py,sha256=5xRGSM4YMr794wxfVj_SQly2cyHNyhXTdXdWUZJoM2M,183
 torchrl/envs/libs/brax.py,sha256=pMctyP2WE721lX5NFGSWf-brtAF3uS7c0lr9XXVtfk4,15480
 torchrl/envs/libs/dm_control.py,sha256=EDfIN_iMZn8s20nUW_uNXdL9BkH66UMLPWO8ruP01C8,11234
 torchrl/envs/libs/gym.py,sha256=aVue17kYYzYzUVzqHTk8slkYcdfV0FToXUz-10Ahd_k,25980
 torchrl/envs/libs/habitat.py,sha256=z2Wh3F4jWZGvdU5_3Sl4NQf3jVinqzTMYyyfJnfVXJ8,2857
 torchrl/envs/libs/jax_utils.py,sha256=cO4zOcjRdxWCwKjJ1klo7FYQEsR3OnHVdD1mGOaBZw8,4975
 torchrl/envs/libs/jumanji.py,sha256=Dkkp3NuttfOw-XIsVGj4VvFYXiBIS3b-O0Pg2P3brPY,12877
@@ -65,51 +65,51 @@
 torchrl/modules/distributions/__init__.py,sha256=qmiRUETpiycLvNHxbKtPl4_ZCbPDyAQPghdNOfxd8PI,600
 torchrl/modules/distributions/continuous.py,sha256=xXWONvXIqWAu7X7DPgpQcqNfnBlmZo8TXs4Zfnp4vV4,21386
 torchrl/modules/distributions/discrete.py,sha256=axz7CvwYEEBZB7sabLLhDCplT0P5ohUYLrcSgzcw560,9293
 torchrl/modules/distributions/truncated_normal.py,sha256=NQ1p5oFGCr-jojzVEHM_gDanMQItqocgtrCg5u8BErI,5988
 torchrl/modules/distributions/utils.py,sha256=J4_lM4lt6oWvc3VQ_7PpCMD-buXW_biU6YkdWFM5zKc,6129
 torchrl/modules/models/__init__.py,sha256=9F6tvu3wZP1JgzmqPjssOtxdtRYgnZZZvJc1C8ia7EM,580
 torchrl/modules/models/exploration.py,sha256=pLMymCt_T6n6YKC4ne6U1J2kBanQRCnd_VJ8_WKSoG8,21885
-torchrl/modules/models/model_based.py,sha256=CKHGvqKblqV_5WOdLMYOks9x3At-x-_gnUIg4iiQTkY,13977
+torchrl/modules/models/model_based.py,sha256=z-ZdzgR6bqKDm3y8BUTRDrG_CX7lHUcziEsr-LfF3kA,14010
 torchrl/modules/models/models.py,sha256=3rJPNLJVwGj-zas8OISghI2cdxQ-1UahC53ZtmxFp6I,45664
 torchrl/modules/models/rlhf.py,sha256=iAcmLfCNVXoCmPFye41LbV7XHbvuhTRiGB7UH1jQmT0,6476
 torchrl/modules/models/utils.py,sha256=TKji7lSi_1jgEqqC6kJ-TOOgNuVbbk2seM348uK7THk,4023
 torchrl/modules/planners/__init__.py,sha256=xxRLqxJcXo38KjFeZiNuSoD8l6u-kPsZ4PRsWCdzqZA,281
 torchrl/modules/planners/cem.py,sha256=vJWn7h0x1UcqhMNgo1k2YVVMF6IKerPy3yghE3PJaOs,9572
 torchrl/modules/planners/common.py,sha256=FbL8WstVp1QY8_YHlaH3EFpsd9I_CMn1JWx7z5SlbRk,2455
 torchrl/modules/planners/mppi.py,sha256=cKkB8ql7D82khYSdbSxxyHa8Ph3j2ciaPfazdolKHv4,10683
 torchrl/modules/tensordict_module/__init__.py,sha256=lCb5DruexzgDL6rxC3KdzXjDX13NWM-YuIfWtwkKcDo,925
 torchrl/modules/tensordict_module/actors.py,sha256=19lSFc9C9jfJes6LKiScs1DoyCGDwy_3XGV5xinx5tw,80502
-torchrl/modules/tensordict_module/common.py,sha256=wZOX-OcK9BYQTa1bXJwYHdXvzW6-Dz4LAv2f6ICuy4c,19005
+torchrl/modules/tensordict_module/common.py,sha256=5hoHuxpz3Fx4mta5bp-VEaKRUAKeTdma_ARytzvOcIE,19333
 torchrl/modules/tensordict_module/exploration.py,sha256=22qnd-gMZ14pStU-xyoK8d2U3R-RzzCZ-KHAPVM-0yg,24584
 torchrl/modules/tensordict_module/probabilistic.py,sha256=Ik9zisYTBrXynGgNwRJU_TJoMn56DCxGYwvZKT6UqDA,11468
 torchrl/modules/tensordict_module/rnn.py,sha256=u3psIBCz7Vv9y8_tJL8caPez6PLrT4QmuHgwqv52aAI,18299
 torchrl/modules/tensordict_module/sequence.py,sha256=VuNg8aMJhLQLy9HDw0xwBOozsNj_Fm5rSyMt2QntdQ8,5835
 torchrl/modules/tensordict_module/world_models.py,sha256=9qlJKd1GDKeVtkTNRg9eUpx6AGzKCiABOVX40jxUnqU,1360
 torchrl/modules/utils/__init__.py,sha256=YDiFNwjc0U8SD_WoTpTroQ-J2aaXuaTLnkR1sP8EXjk,3984
 torchrl/modules/utils/mappings.py,sha256=ZurH7TLCDroHVzRTFcBajy6btc-dECLNh_pP1iM0ne4,2435
 torchrl/modules/utils/utils.py,sha256=IOXtM_-Ru-wvmZCQNNZCeIJhwnYB40vtP2cLdFPHq5Q,1368
 torchrl/objectives/__init__.py,sha256=-FNcDWwiDX5iy-rwroT28MbIPynLN3IBt-rpM_bY0Zg,921
 torchrl/objectives/a2c.py,sha256=GrlnvrA0m9Rqa9q2jMZRmg6P1xEgAw6Dq9po1Hcxa3Q,18048
-torchrl/objectives/common.py,sha256=jSKsmb5OYMcbblyX4UIyKJJ18nkjxnTsXdl9YFDMgMg,26506
+torchrl/objectives/common.py,sha256=tjZNMkww8V20uv24NEYjcokIrWaH2C5BGXN6tKCILC0,26507
 torchrl/objectives/cql.py,sha256=6CNL0vkQQARswiPSItTNKWYXO2QXBO-5u1jCqiJZqpQ,31752
 torchrl/objectives/ddpg.py,sha256=9X6PBbTsrQkuUCMLui6nL18AfY0MUA12ZIk6AEvI9CQ,15521
 torchrl/objectives/deprecated.py,sha256=e1Z1P8fu5DR4rLFOdbuT8IM77IfvMDPWs0o54Iwm3ms,18160
 torchrl/objectives/dqn.py,sha256=YtAp-FkFGQVfW2SBS7Lb0Bl2zgO9Xm0Lhbg2ksIJnZM,24635
 torchrl/objectives/dreamer.py,sha256=3zhG_cni5VKcEo06ykHtje0FSdsCmaJUvGBdOEZKqmY,17407
 torchrl/objectives/functional.py,sha256=BzT7OBk-FOoIYPaXBx73eOHAeEc6LnjRJeL472AWMHI,2119
 torchrl/objectives/iql.py,sha256=g3qJwTZJVtac1fAunft7v0PE3ir8FgUBS5mIls2HeJY,20386
 torchrl/objectives/ppo.py,sha256=EiPNwu3x_kmOYzV7h_y3EKAsHtuqOHmy9fMS8iwvqdo,39608
 torchrl/objectives/redq.py,sha256=2FTig6flW10fbjgtLFOm5MGqPDjg4iqxNtclOeulYF0,25718
 torchrl/objectives/reinforce.py,sha256=aNAdzLyNN80F5umcAqemud6W1Q-xDHAcFn98yLzdS4Y,15351
 torchrl/objectives/sac.py,sha256=eSefN0jn_wKz0R6E7SyzJ63HNAXBOWQYO-ximVh9Kak,53114
 torchrl/objectives/td3.py,sha256=kAa4W1_CSFdy8uGor5Ek2b1v3VXrNBJNJKFLWjk_r68,20434
 torchrl/objectives/utils.py,sha256=myRQWfcFuCTmGM_44TGolLRC0KeAfNS9WmfpIg7DoPM,17171
 torchrl/objectives/value/__init__.py,sha256=3YD7d9rTodAFMFj74ugS-25CaDU2b6mVv466Sx1iNiw,371
-torchrl/objectives/value/advantages.py,sha256=EitSrRLh-FB_eY29pN4tg98S8YnUeIXCAgCV8I7xsPA,54255
+torchrl/objectives/value/advantages.py,sha256=S9QnGk8rrwKsT4Km8NxPL0m5iY5MEHAzl5xisjHTILE,54924
 torchrl/objectives/value/functional.py,sha256=td0Sar1zBZjdt5cZJzBq0rZq7MMiGOKmUP-cH3dWPI4,40208
 torchrl/objectives/value/pg.py,sha256=fM3XbHBkiT1FTfENSF8RkkZ3ZTJOLaaXTA99E74KQlU,317
 torchrl/objectives/value/utils.py,sha256=ABpKGUMt2mBziM1z2wIuYUYM3RdPlQX3y0RYZ2uosv4,13251
 torchrl/objectives/value/vtrace.py,sha256=hEc0WuYrixYDM7c7w_P7yU0NVGEkOXcqBQaanGeRqX8,1724
 torchrl/record/__init__.py,sha256=T0-JvaHHfgq8BsZtVFKcLfOYj-j9Ssws7dXvUKBX3pE,242
 torchrl/record/recorder.py,sha256=9h0h_6lw0ZZ6qstbGVJsdDpRY9aw6CXTgRhC3n8GNV4,6839
 torchrl/record/loggers/__init__.py,sha256=KsUdcrrM7nPvyHaSDvoqFsVRux1sFpsWi12y76zvt0c,413
@@ -125,12 +125,12 @@
 torchrl/trainers/helpers/collectors.py,sha256=bA0vf2EZk-CNOMSXV2N1Kqlfsr4EQPGceO_FaGM1iAY,19309
 torchrl/trainers/helpers/envs.py,sha256=-YCb__OimJANsmHtnOw3_vnxhuuw7BRPDpqRm_xq-us,22900
 torchrl/trainers/helpers/logger.py,sha256=aRoSh9zpXy46MTqhqZBoCuKZko2LN-SePiAWgX9W5iA,1206
 torchrl/trainers/helpers/losses.py,sha256=zEjIzUc1cLaZ7YTleLle-WBpn69zX4vq-VNFORPQk74,6920
 torchrl/trainers/helpers/models.py,sha256=l5QtmvE-D5IC9gU0gJm_CIk_VHOFgX12pw-3B5z393I,32564
 torchrl/trainers/helpers/replay_buffer.py,sha256=R9kriPfZOJ1s-kaGkn2w4tcZH2iC-u22pWQwqqw3c-A,1939
 torchrl/trainers/helpers/trainers.py,sha256=H76tq76L5t-6S-z22F9RAYjxiOO2RSNvs4IXuPn22Ok,12076
-torchrl_nightly-2023.7.3.dist-info/LICENSE,sha256=PGO-oZsq4EzhE1-WQS2xGiEF3UCVb9YawfQ09cIMV_8,1119
-torchrl_nightly-2023.7.3.dist-info/METADATA,sha256=VTlJj0alThqmxuJZUlzsDuxfKJqDMd96FzjPFSDZkqQ,28923
-torchrl_nightly-2023.7.3.dist-info/WHEEL,sha256=eep6QWEFiQfg2wcclssb_WY-D33AnLYLnEKGA9Rn-VU,100
-torchrl_nightly-2023.7.3.dist-info/top_level.txt,sha256=JeTJ1jV7QJwLcUS1nr21aPn_wb-XlAZ9c-z_EH472JA,20
-torchrl_nightly-2023.7.3.dist-info/RECORD,,
+torchrl_nightly-2023.7.4.dist-info/LICENSE,sha256=PGO-oZsq4EzhE1-WQS2xGiEF3UCVb9YawfQ09cIMV_8,1119
+torchrl_nightly-2023.7.4.dist-info/METADATA,sha256=hUXjW0gKIl_Z-x8L3ZZlMB-BVoUnCneOHXYSlMKNDBM,28923
+torchrl_nightly-2023.7.4.dist-info/WHEEL,sha256=eep6QWEFiQfg2wcclssb_WY-D33AnLYLnEKGA9Rn-VU,100
+torchrl_nightly-2023.7.4.dist-info/top_level.txt,sha256=JeTJ1jV7QJwLcUS1nr21aPn_wb-XlAZ9c-z_EH472JA,20
+torchrl_nightly-2023.7.4.dist-info/RECORD,,
```

