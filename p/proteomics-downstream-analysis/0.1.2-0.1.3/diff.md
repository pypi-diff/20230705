# Comparing `tmp/proteomics_downstream_analysis-0.1.2.tar.gz` & `tmp/proteomics_downstream_analysis-0.1.3.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "proteomics_downstream_analysis-0.1.2.tar", last modified: Tue Jul  4 19:01:59 2023, max compression
+gzip compressed data, was "proteomics_downstream_analysis-0.1.3.tar", last modified: Wed Jul  5 15:48:22 2023, max compression
```

## Comparing `proteomics_downstream_analysis-0.1.2.tar` & `proteomics_downstream_analysis-0.1.3.tar`

 * *Command `'html2text {}'` failed with exit code 1. (No output)*

```diff
@@ -2,16 +2,16 @@
 00000010: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000020: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000060: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
 00000070: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00000080: 3030 3030 3033 3400 3030 3030 3030 3030  0000034.00000000
-00000090: 3030 3000 3031 3032 3132 0020 7800 0000  000.010212. x...
+00000080: 3030 3030 3033 3300 3030 3030 3030 3030  0000033.00000000
+00000090: 3030 3000 3031 3032 3131 0020 7800 0000  000.010211. x...
 000000a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000000b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000000c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000000d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000000e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000000f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000100: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
@@ -26,16 +26,16 @@
 00000190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000001a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000001b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000001c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000001d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000001e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000001f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00000200: 3238 206d 7469 6d65 3d31 3638 3834 3937  28 mtime=1688497
-00000210: 3331 392e 3830 3535 3933 350a 0000 0000  319.8055935.....
+00000200: 3237 206d 7469 6d65 3d31 3638 3835 3732  27 mtime=1688572
+00000210: 3130 322e 3531 3438 3134 0a00 0000 0000  102.514814......
 00000220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000260: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000270: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000280: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -60,22 +60,22 @@
 000003b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000003c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000003d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000003e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000003f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000400: 7072 6f74 656f 6d69 6373 5f64 6f77 6e73  proteomics_downs
 00000410: 7472 6561 6d5f 616e 616c 7973 6973 2d30  tream_analysis-0
-00000420: 2e31 2e32 2f00 0000 0000 0000 0000 0000  .1.2/...........
+00000420: 2e31 2e33 2f00 0000 0000 0000 0000 0000  .1.3/...........
 00000430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000460: 0000 0000 3030 3030 3735 3500 3030 3031  ....0000755.0001
 00000470: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
-00000480: 3030 3030 3030 3000 3134 3435 3130 3636  0000000.14451066
-00000490: 3235 3000 3031 3734 3530 0020 3500 0000  250.017450. 5...
+00000480: 3030 3030 3030 3000 3134 3435 3133 3130  0000000.14451310
+00000490: 3330 3700 3031 3734 3434 0020 3500 0000  307.017444. 5...
 000004a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000004b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000004c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000004d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000004e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000004f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000500: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
@@ -122,16 +122,16 @@
 00000790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000007a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000007b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000007c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000007d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000007e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000007f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00000800: 3232 206d 7469 6d65 3d31 3638 3834 3937  22 mtime=1688497
-00000810: 3330 392e 300a 0000 0000 0000 0000 0000  309.0...........
+00000800: 3232 206d 7469 6d65 3d31 3638 3835 3732  22 mtime=1688572
+00000810: 3039 322e 300a 0000 0000 0000 0000 0000  092.0...........
 00000820: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000860: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000870: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000880: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -156,22 +156,22 @@
 000009b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000009c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000009d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000009e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000009f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000a00: 7072 6f74 656f 6d69 6373 5f64 6f77 6e73  proteomics_downs
 00000a10: 7472 6561 6d5f 616e 616c 7973 6973 2d30  tream_analysis-0
-00000a20: 2e31 2e32 2f4c 4943 454e 5345 0000 0000  .1.2/LICENSE....
+00000a20: 2e31 2e33 2f4c 4943 454e 5345 0000 0000  .1.3/LICENSE....
 00000a30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000a40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000a50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000a60: 0000 0000 3030 3030 3634 3400 3030 3031  ....0000644.0001
 00000a70: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
-00000a80: 3030 3032 3034 3500 3134 3435 3130 3636  0002045.14451066
-00000a90: 3233 3500 3032 3034 3631 0020 3000 0000  235.020461. 0...
+00000a80: 3030 3032 3034 3500 3134 3435 3133 3130  0002045.14451310
+00000a90: 3237 3400 3032 3034 3535 0020 3000 0000  274.020455. 0...
 00000aa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000ab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000ac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000ad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000ae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000af0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000b00: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
@@ -290,16 +290,16 @@
 00001210: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001260: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
 00001270: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00001280: 3030 3030 3033 3400 3030 3030 3030 3030  0000034.00000000
-00001290: 3030 3000 3031 3032 3132 0020 7800 0000  000.010212. x...
+00001280: 3030 3030 3033 3300 3030 3030 3030 3030  0000033.00000000
+00001290: 3030 3000 3031 3032 3131 0020 7800 0000  000.010211. x...
 000012a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000012b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000012c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000012d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000012e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000012f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001300: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
@@ -314,16 +314,16 @@
 00001390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000013a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000013b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000013c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000013d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000013e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000013f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00001400: 3238 206d 7469 6d65 3d31 3638 3834 3937  28 mtime=1688497
-00001410: 3331 392e 3830 3535 3933 350a 0000 0000  319.8055935.....
+00001400: 3237 206d 7469 6d65 3d31 3638 3835 3732  27 mtime=1688572
+00001410: 3130 322e 3531 3438 3134 0a00 0000 0000  102.514814......
 00001420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001460: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001470: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001480: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -348,22 +348,22 @@
 000015b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000015c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000015d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000015e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000015f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001600: 7072 6f74 656f 6d69 6373 5f64 6f77 6e73  proteomics_downs
 00001610: 7472 6561 6d5f 616e 616c 7973 6973 2d30  tream_analysis-0
-00001620: 2e31 2e32 2f50 4b47 2d49 4e46 4f00 0000  .1.2/PKG-INFO...
+00001620: 2e31 2e33 2f50 4b47 2d49 4e46 4f00 0000  .1.3/PKG-INFO...
 00001630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001660: 0000 0000 3030 3030 3634 3400 3030 3031  ....0000644.0001
 00001670: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
-00001680: 3030 3037 3136 3600 3134 3435 3130 3636  0007166.14451066
-00001690: 3235 3000 3032 3035 3537 0020 3000 0000  250.020557. 0...
+00001680: 3030 3037 3136 3600 3134 3435 3133 3130  0007166.14451310
+00001690: 3330 3700 3032 3035 3533 0020 3000 0000  307.020553. 0...
 000016a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000016b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000016c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000016d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000016e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000016f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001700: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
@@ -382,15 +382,15 @@
 000017d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000017e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000017f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001800: 4d65 7461 6461 7461 2d56 6572 7369 6f6e  Metadata-Version
 00001810: 3a20 322e 310a 4e61 6d65 3a20 7072 6f74  : 2.1.Name: prot
 00001820: 656f 6d69 6373 5f64 6f77 6e73 7472 6561  eomics_downstrea
 00001830: 6d5f 616e 616c 7973 6973 0a56 6572 7369  m_analysis.Versi
-00001840: 6f6e 3a20 302e 312e 320a 5375 6d6d 6172  on: 0.1.2.Summar
+00001840: 6f6e 3a20 302e 312e 330a 5375 6d6d 6172  on: 0.1.3.Summar
 00001850: 793a 2041 2070 6163 6b61 6765 2066 6f72  y: A package for
 00001860: 2064 6f77 6e73 7472 6561 6d20 6461 7461   downstream data
 00001870: 2061 6e61 6c79 7369 7320 6f66 2070 726f   analysis of pro
 00001880: 7465 6f6d 6963 7320 6461 7461 0a48 6f6d  teomics data.Hom
 00001890: 652d 7061 6765 3a20 6874 7470 733a 2f2f  e-page: https://
 000018a0: 6769 7468 7562 2e63 6f6d 2f76 7564 7563  github.com/vuduc
 000018b0: 7475 6e67 2f70 726f 7465 6f6d 6963 732d  tung/proteomics-
@@ -666,16 +666,16 @@
 00002990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000029a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000029b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000029c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000029d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000029e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000029f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00002a00: 3232 206d 7469 6d65 3d31 3638 3834 3937  22 mtime=1688497
-00002a10: 3330 392e 300a 0000 0000 0000 0000 0000  309.0...........
+00002a00: 3232 206d 7469 6d65 3d31 3638 3835 3732  22 mtime=1688572
+00002a10: 3039 322e 300a 0000 0000 0000 0000 0000  092.0...........
 00002a20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00002a30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00002a40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00002a50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00002a60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00002a70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00002a80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -700,22 +700,22 @@
 00002bb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00002bc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00002bd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00002be0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00002bf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00002c00: 7072 6f74 656f 6d69 6373 5f64 6f77 6e73  proteomics_downs
 00002c10: 7472 6561 6d5f 616e 616c 7973 6973 2d30  tream_analysis-0
-00002c20: 2e31 2e32 2f52 4541 444d 452e 6d64 0000  .1.2/README.md..
+00002c20: 2e31 2e33 2f52 4541 444d 452e 6d64 0000  .1.3/README.md..
 00002c30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00002c40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00002c50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00002c60: 0000 0000 3030 3030 3634 3400 3030 3031  ....0000644.0001
 00002c70: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
-00002c80: 3030 3036 3236 3700 3134 3435 3130 3636  0006267.14451066
-00002c90: 3233 3500 3032 3037 3435 0020 3000 0000  235.020745. 0...
+00002c80: 3030 3036 3236 3700 3134 3435 3133 3130  0006267.14451310
+00002c90: 3237 3400 3032 3037 3431 0020 3000 0000  274.020741. 0...
 00002ca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00002cb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00002cc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00002cd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00002ce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00002cf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00002d00: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
@@ -962,16 +962,16 @@
 00003c10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003c20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003c30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003c40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003c50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003c60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
 00003c70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00003c80: 3030 3030 3033 3400 3030 3030 3030 3030  0000034.00000000
-00003c90: 3030 3000 3031 3032 3132 0020 7800 0000  000.010212. x...
+00003c80: 3030 3030 3033 3300 3030 3030 3030 3030  0000033.00000000
+00003c90: 3030 3000 3031 3032 3131 0020 7800 0000  000.010211. x...
 00003ca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003cb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003cc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003cd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003ce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003cf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003d00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
@@ -986,16 +986,16 @@
 00003d90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003da0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003db0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003dc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003dd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003de0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003df0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003e00: 3238 206d 7469 6d65 3d31 3638 3834 3937  28 mtime=1688497
-00003e10: 3331 392e 3830 3535 3933 350a 0000 0000  319.8055935.....
+00003e00: 3237 206d 7469 6d65 3d31 3638 3835 3732  27 mtime=1688572
+00003e10: 3130 322e 3531 3438 3134 0a00 0000 0000  102.514814......
 00003e20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003e30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003e40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003e50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003e60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003e70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003e80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -1020,22 +1020,22 @@
 00003fb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003fd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003fe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003ff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004000: 7072 6f74 656f 6d69 6373 5f64 6f77 6e73  proteomics_downs
 00004010: 7472 6561 6d5f 616e 616c 7973 6973 2d30  tream_analysis-0
-00004020: 2e31 2e32 2f70 726f 7465 6f6d 6963 735f  .1.2/proteomics_
+00004020: 2e31 2e33 2f70 726f 7465 6f6d 6963 735f  .1.3/proteomics_
 00004030: 646f 776e 7374 7265 616d 5f61 6e61 6c79  downstream_analy
 00004040: 7369 732f 0000 0000 0000 0000 0000 0000  sis/............
 00004050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004060: 0000 0000 3030 3030 3735 3500 3030 3031  ....0000755.0001
 00004070: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
-00004080: 3030 3030 3030 3000 3134 3435 3130 3636  0000000.14451066
-00004090: 3235 3000 3032 3630 3032 0020 3500 0000  250.026002. 5...
+00004080: 3030 3030 3030 3000 3134 3435 3133 3130  0000000.14451310
+00004090: 3330 3700 3032 3537 3736 0020 3500 0000  307.025776. 5...
 000040a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000040b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000040c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000040d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000040e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000040f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004100: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
@@ -1082,16 +1082,16 @@
 00004390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000043a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000043b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000043c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000043d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000043e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000043f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00004400: 3232 206d 7469 6d65 3d31 3638 3834 3937  22 mtime=1688497
-00004410: 3330 392e 300a 0000 0000 0000 0000 0000  309.0...........
+00004400: 3232 206d 7469 6d65 3d31 3638 3835 3732  22 mtime=1688572
+00004410: 3039 322e 300a 0000 0000 0000 0000 0000  092.0...........
 00004420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004460: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004470: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004480: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -1116,22 +1116,22 @@
 000045b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000045c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000045d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000045e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000045f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004600: 7072 6f74 656f 6d69 6373 5f64 6f77 6e73  proteomics_downs
 00004610: 7472 6561 6d5f 616e 616c 7973 6973 2d30  tream_analysis-0
-00004620: 2e31 2e32 2f70 726f 7465 6f6d 6963 735f  .1.2/proteomics_
+00004620: 2e31 2e33 2f70 726f 7465 6f6d 6963 735f  .1.3/proteomics_
 00004630: 646f 776e 7374 7265 616d 5f61 6e61 6c79  downstream_analy
 00004640: 7369 732f 5f5f 696e 6974 5f5f 2e70 7900  sis/__init__.py.
 00004650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004660: 0000 0000 3030 3030 3634 3400 3030 3031  ....0000644.0001
 00004670: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
-00004680: 3030 3030 3335 3000 3134 3435 3130 3636  0000350.14451066
-00004690: 3233 3500 3033 3031 3134 0020 3000 0000  235.030114. 0...
+00004680: 3030 3030 3335 3000 3134 3435 3133 3130  0000350.14451310
+00004690: 3237 3400 3033 3031 3130 0020 3000 0000  274.030110. 0...
 000046a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000046b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000046c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000046d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000046e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000046f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004700: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
@@ -1210,16 +1210,16 @@
 00004b90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004ba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004bb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004bc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004bd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004be0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004bf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00004c00: 3232 206d 7469 6d65 3d31 3638 3834 3937  22 mtime=1688497
-00004c10: 3330 392e 300a 0000 0000 0000 0000 0000  309.0...........
+00004c00: 3232 206d 7469 6d65 3d31 3638 3835 3732  22 mtime=1688572
+00004c10: 3039 322e 300a 0000 0000 0000 0000 0000  092.0...........
 00004c20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004c30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004c40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004c50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004c60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004c70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004c80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -1244,22 +1244,22 @@
 00004db0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004dc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004dd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004de0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004df0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004e00: 7072 6f74 656f 6d69 6373 5f64 6f77 6e73  proteomics_downs
 00004e10: 7472 6561 6d5f 616e 616c 7973 6973 2d30  tream_analysis-0
-00004e20: 2e31 2e32 2f70 726f 7465 6f6d 6963 735f  .1.2/proteomics_
+00004e20: 2e31 2e33 2f70 726f 7465 6f6d 6963 735f  .1.3/proteomics_
 00004e30: 646f 776e 7374 7265 616d 5f61 6e61 6c79  downstream_analy
 00004e40: 7369 732f 636f 6e74 616d 696e 6174 696f  sis/contaminatio
 00004e50: 6e2e 7079 0000 0000 0000 0000 0000 0000  n.py............
 00004e60: 0000 0000 3030 3030 3634 3400 3030 3031  ....0000644.0001
 00004e70: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
-00004e80: 3030 3331 3530 3700 3134 3435 3130 3636  0031507.14451066
-00004e90: 3233 3500 3033 3132 3330 0020 3000 0000  235.031230. 0...
+00004e80: 3030 3331 3530 3700 3134 3435 3133 3130  0031507.14451310
+00004e90: 3237 3400 3033 3132 3234 0020 3000 0000  274.031224. 0...
 00004ea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004eb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004ec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004ed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004ee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004ef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004f00: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
@@ -2138,16 +2138,16 @@
 00008590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000085a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000085b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000085c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000085d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000085e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000085f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008600: 3232 206d 7469 6d65 3d31 3638 3834 3937  22 mtime=1688497
-00008610: 3330 392e 300a 0000 0000 0000 0000 0000  309.0...........
+00008600: 3232 206d 7469 6d65 3d31 3638 3835 3732  22 mtime=1688572
+00008610: 3039 322e 300a 0000 0000 0000 0000 0000  092.0...........
 00008620: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008660: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008670: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008680: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -2172,22 +2172,22 @@
 000087b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000087c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000087d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000087e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000087f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008800: 7072 6f74 656f 6d69 6373 5f64 6f77 6e73  proteomics_downs
 00008810: 7472 6561 6d5f 616e 616c 7973 6973 2d30  tream_analysis-0
-00008820: 2e31 2e32 2f70 726f 7465 6f6d 6963 735f  .1.2/proteomics_
+00008820: 2e31 2e33 2f70 726f 7465 6f6d 6963 735f  .1.3/proteomics_
 00008830: 646f 776e 7374 7265 616d 5f61 6e61 6c79  downstream_analy
 00008840: 7369 732f 6461 7461 7175 616c 6974 7969  sis/dataqualityi
 00008850: 6e66 6f72 6d61 7469 6f6e 2e70 7900 0000  nformation.py...
 00008860: 0000 0000 3030 3030 3634 3400 3030 3031  ....0000644.0001
 00008870: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
-00008880: 3030 3336 3333 3200 3134 3435 3130 3636  0036332.14451066
-00008890: 3233 3500 3033 3331 3536 0020 3000 0000  235.033156. 0...
+00008880: 3030 3336 3333 3200 3134 3435 3133 3130  0036332.14451310
+00008890: 3237 3400 3033 3331 3532 0020 3000 0000  274.033152. 0...
 000088a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000088b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000088c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000088d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000088e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000088f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008900: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
@@ -3226,16 +3226,16 @@
 0000c990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c9a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c9b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c9c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c9d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c9e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c9f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ca00: 3232 206d 7469 6d65 3d31 3638 3834 3937  22 mtime=1688497
-0000ca10: 3330 392e 300a 0000 0000 0000 0000 0000  309.0...........
+0000ca00: 3232 206d 7469 6d65 3d31 3638 3835 3732  22 mtime=1688572
+0000ca10: 3039 322e 300a 0000 0000 0000 0000 0000  092.0...........
 0000ca20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000ca30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000ca40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000ca50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000ca60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000ca70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000ca80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -3260,22 +3260,22 @@
 0000cbb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000cbc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000cbd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000cbe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000cbf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000cc00: 7072 6f74 656f 6d69 6373 5f64 6f77 6e73  proteomics_downs
 0000cc10: 7472 6561 6d5f 616e 616c 7973 6973 2d30  tream_analysis-0
-0000cc20: 2e31 2e32 2f70 726f 7465 6f6d 6963 735f  .1.2/proteomics_
+0000cc20: 2e31 2e33 2f70 726f 7465 6f6d 6963 735f  .1.3/proteomics_
 0000cc30: 646f 776e 7374 7265 616d 5f61 6e61 6c79  downstream_analy
 0000cc40: 7369 732f 6469 616e 6e64 6174 612e 7079  sis/dianndata.py
 0000cc50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000cc60: 0000 0000 3030 3030 3634 3400 3030 3031  ....0000644.0001
 0000cc70: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
-0000cc80: 3030 3036 3633 3700 3134 3435 3130 3636  0006637.14451066
-0000cc90: 3233 3500 3033 3033 3136 0020 3000 0000  235.030316. 0...
+0000cc80: 3030 3130 3531 3100 3134 3435 3133 3130  0010511.14451310
+0000cc90: 3237 3400 3033 3032 3734 0020 3000 0000  274.030274. 0...
 0000cca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000ccb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000ccc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000ccd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000cce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000ccf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000cd00: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
@@ -3291,3088 +3291,3088 @@
 0000cda0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000cdb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000cdc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000cdd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000cde0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000cdf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000ce00: 696d 706f 7274 2070 616e 6461 7320 6173  import pandas as
-0000ce10: 2070 640a 6672 6f6d 2070 726f 7465 6f6d   pd.from proteom
-0000ce20: 6963 735f 646f 776e 7374 7265 616d 5f61  ics_downstream_a
-0000ce30: 6e61 6c79 7369 732e 7072 6570 726f 6365  nalysis.preproce
-0000ce40: 7373 6f72 2069 6d70 6f72 7420 5072 6570  ssor import Prep
-0000ce50: 726f 6365 7373 6f72 0a66 726f 6d20 7072  rocessor.from pr
-0000ce60: 6f74 656f 6d69 6373 5f64 6f77 6e73 7472  oteomics_downstr
-0000ce70: 6561 6d5f 616e 616c 7973 6973 2e6d 756c  eam_analysis.mul
-0000ce80: 7469 6c65 7665 6c64 6174 6120 696d 706f  tileveldata impo
-0000ce90: 7274 204d 756c 7469 4c65 7665 6c44 6174  rt MultiLevelDat
-0000cea0: 610a 6672 6f6d 2070 726f 7465 6f6d 6963  a.from proteomic
-0000ceb0: 735f 646f 776e 7374 7265 616d 5f61 6e61  s_downstream_ana
-0000cec0: 6c79 7369 732e 6469 6d65 6e73 696f 6e61  lysis.dimensiona
-0000ced0: 6c69 7479 7265 6475 6374 696f 6e20 696d  lityreduction im
-0000cee0: 706f 7274 2044 696d 656e 7369 6f6e 616c  port Dimensional
-0000cef0: 6974 7952 6564 7563 7469 6f6e 0a66 726f  ityReduction.fro
-0000cf00: 6d20 7072 6f74 656f 6d69 6373 5f64 6f77  m proteomics_dow
-0000cf10: 6e73 7472 6561 6d5f 616e 616c 7973 6973  nstream_analysis
-0000cf20: 2e63 6f6e 7461 6d69 6e61 7469 6f6e 2069  .contamination i
-0000cf30: 6d70 6f72 7420 436f 6e74 616d 696e 6174  mport Contaminat
-0000cf40: 696f 6e41 6e61 6c79 7369 730a 6672 6f6d  ionAnalysis.from
-0000cf50: 2070 726f 7465 6f6d 6963 735f 646f 776e   proteomics_down
-0000cf60: 7374 7265 616d 5f61 6e61 6c79 7369 732e  stream_analysis.
-0000cf70: 7374 6174 6973 7469 6373 2069 6d70 6f72  statistics impor
-0000cf80: 7420 5374 6174 6973 7469 6373 0a66 726f  t Statistics.fro
-0000cf90: 6d20 7072 6f74 656f 6d69 6373 5f64 6f77  m proteomics_dow
-0000cfa0: 6e73 7472 6561 6d5f 616e 616c 7973 6973  nstream_analysis
-0000cfb0: 2e76 6973 7561 6c69 7a65 7220 696d 706f  .visualizer impo
-0000cfc0: 7274 2056 6973 7561 6c69 7a65 720a 6672  rt Visualizer.fr
-0000cfd0: 6f6d 2070 726f 7465 6f6d 6963 735f 646f  om proteomics_do
-0000cfe0: 776e 7374 7265 616d 5f61 6e61 6c79 7369  wnstream_analysi
-0000cff0: 732e 6461 7461 7175 616c 6974 7969 6e66  s.dataqualityinf
-0000d000: 6f72 6d61 7469 6f6e 2069 6d70 6f72 7420  ormation import 
-0000d010: 4461 7461 5175 616c 6974 7949 6e66 6f72  DataQualityInfor
-0000d020: 6d61 7469 6f6e 0a0a 636c 6173 7320 4469  mation..class Di
-0000d030: 616e 6e44 6174 6128 4d75 6c74 694c 6576  annData(MultiLev
-0000d040: 656c 4461 7461 2c20 4469 6d65 6e73 696f  elData, Dimensio
-0000d050: 6e61 6c69 7479 5265 6475 6374 696f 6e2c  nalityReduction,
-0000d060: 2043 6f6e 7461 6d69 6e61 7469 6f6e 416e   ContaminationAn
-0000d070: 616c 7973 6973 2c20 5374 6174 6973 7469  alysis, Statisti
-0000d080: 6373 2c20 5669 7375 616c 697a 6572 2c20  cs, Visualizer, 
-0000d090: 4461 7461 5175 616c 6974 7949 6e66 6f72  DataQualityInfor
-0000d0a0: 6d61 7469 6f6e 293a 0a20 2020 200a 2020  mation):.    .  
-0000d0b0: 2020 2222 2220 5468 6973 2063 6c61 7373    """ This class
-0000d0c0: 2065 6e63 6170 7375 6c61 7465 7320 6d65   encapsulates me
-0000d0d0: 7468 6f64 7320 666f 7220 4449 414e 4e20  thods for DIANN 
-0000d0e0: 6f75 7470 7574 2074 6162 6c65 7320 2222  output tables ""
-0000d0f0: 220a 2020 2020 0a20 2020 2064 6566 205f  ".    .    def _
-0000d100: 5f69 6e69 745f 5f28 7365 6c66 2c20 6669  _init__(self, fi
-0000d110: 6c65 7061 7468 3d4e 6f6e 6529 3a0a 0a20  lepath=None):.. 
-0000d120: 2020 2020 2020 2073 656c 662e 7469 746c         self.titl
-0000d130: 6520 3d5b 5d0a 2020 2020 2020 2020 7365  e =[].        se
-0000d140: 6c66 2e64 6174 6173 6574 7320 3d20 5b5d  lf.datasets = []
-0000d150: 0a0a 2020 2020 2020 2020 6966 2066 696c  ..        if fil
-0000d160: 6570 6174 6820 6973 204e 6f6e 653a 0a20  epath is None:. 
-0000d170: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0000d180: 5f50 7265 7072 6f63 6573 736f 7220 3d20  _Preprocessor = 
-0000d190: 5072 6570 726f 6365 7373 6f72 2829 0a20  Preprocessor(). 
-0000d1a0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0000d1b0: 6461 7461 7365 7473 203d 205b 5d0a 2020  datasets = [].  
-0000d1c0: 2020 2020 2020 2020 2020 0a20 2020 2020            .     
-0000d1d0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-0000d1e0: 2020 2020 2073 656c 662e 5f50 7265 7072       self._Prepr
-0000d1f0: 6f63 6573 736f 7220 3d20 5072 6570 726f  ocessor = Prepro
-0000d200: 6365 7373 6f72 2829 0a20 2020 2020 2020  cessor().       
-0000d210: 2020 2020 2073 656c 662e 6461 7461 203d       self.data =
-0000d220: 2070 642e 7265 6164 5f63 7376 2866 696c   pd.read_csv(fil
-0000d230: 6570 6174 682c 2064 656c 696d 6974 6572  epath, delimiter
-0000d240: 3d27 5c74 2729 0a20 2020 2020 2020 2020  ='\t').         
-0000d250: 2020 2073 656c 662e 6461 7461 7365 7473     self.datasets
-0000d260: 203d 205b 5d0a 0a20 2020 2064 6566 2075   = []..    def u
-0000d270: 7064 6174 655f 636f 6c5f 6e61 6d65 7328  pdate_col_names(
-0000d280: 7365 6c66 2c20 636f 6c5f 6e61 6d65 7329  self, col_names)
-0000d290: 3a0a 2020 2020 2020 2020 2020 2020 0a20  :.            . 
-0000d2a0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-0000d2b0: 2020 2043 6861 6e67 6520 7468 6520 636f     Change the co
-0000d2c0: 6c75 6d73 206e 616d 6573 206f 6620 4449  lums names of DI
-0000d2d0: 414e 4e20 6f75 7470 7574 2074 6162 6c65  ANN output table
-0000d2e0: 730a 2020 2020 2020 2020 5265 706c 6963  s.        Replic
-0000d2f0: 6174 6573 2077 696c 6c20 6861 7665 2073  ates will have s
-0000d300: 616d 6520 6e61 6d65 0a0a 2020 2020 2020  ame name..      
-0000d310: 2020 5061 7261 6d65 7465 7273 0a20 2020    Parameters.   
-0000d320: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a       ----------.
-0000d330: 2020 2020 2020 2020 636f 6c5f 6e61 6d65          col_name
-0000d340: 7320 3a20 6c69 7374 0a20 2020 2020 2020  s : list.       
-0000d350: 2020 2020 204c 6973 7420 6f66 2063 6f6c       List of col
-0000d360: 756d 6e20 6e61 6d65 730a 0a20 2020 2020  umn names..     
-0000d370: 2020 2052 6574 7572 6e73 0a20 2020 2020     Returns.     
-0000d380: 2020 202d 2d2d 2d2d 2d2d 0a20 2020 2020     -------.     
-0000d390: 2020 2073 656c 662e 6461 7461 203a 2070     self.data : p
-0000d3a0: 616e 6461 732e 4461 7461 4672 616d 650a  andas.DataFrame.
-0000d3b0: 2020 2020 2020 2020 2020 2020 5570 6461              Upda
-0000d3c0: 7465 6420 4449 414e 4e20 6f75 7470 7574  ted DIANN output
-0000d3d0: 2074 6162 6c65 2077 6974 6820 6e65 7720   table with new 
-0000d3e0: 636f 6c75 6d6e 206e 616d 6573 0a20 2020  column names.   
-0000d3f0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-0000d400: 200a 2020 2020 2020 2020 7365 6c66 2e64   .        self.d
-0000d410: 6174 612e 636f 6c75 6d6e 7320 3d20 5b27  ata.columns = ['
-0000d420: 5072 6f74 6569 6e2e 4772 6f75 7027 2c0a  Protein.Group',.
-0000d430: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d440: 2020 2020 2020 2020 2020 2020 2027 5072               'Pr
-0000d450: 6f74 6569 6e2e 4964 7327 2c0a 2020 2020  otein.Ids',.    
-0000d460: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d470: 2020 2020 2020 2020 2027 5072 6f74 6569           'Protei
-0000d480: 6e2e 4e61 6d65 7327 2c0a 2020 2020 2020  n.Names',.      
-0000d490: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d4a0: 2020 2020 2020 2027 4765 6e65 7327 2c20         'Genes', 
-0000d4b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000d4c0: 2020 2020 2020 2020 2020 2020 2020 2746                'F
-0000d4d0: 6972 7374 2e50 726f 7465 696e 2e44 6573  irst.Protein.Des
-0000d4e0: 6372 6970 7469 6f6e 275d 202b 2063 6f6c  cription'] + col
-0000d4f0: 5f6e 616d 6573 0a20 2020 200a 2020 2020  _names.    .    
-0000d500: 6465 6620 6472 6f70 5f63 6f6c 2873 656c  def drop_col(sel
-0000d510: 662c 2063 6f6c 5f6e 616d 6529 3a0a 2020  f, col_name):.  
-0000d520: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-0000d530: 2020 4472 6f70 2063 6f6c 756d 6e73 2066    Drop columns f
-0000d540: 726f 6d20 4449 414e 4e20 6f75 7470 7574  rom DIANN output
-0000d550: 2074 6162 6c65 730a 2020 2020 2020 2020   tables.        
-0000d560: 5061 7261 6d65 7465 7273 0a20 2020 2020  Parameters.     
-0000d570: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020     ----------.  
-0000d580: 2020 2020 2020 636f 6c5f 6e61 6d65 203a        col_name :
-0000d590: 2073 7472 0a20 2020 2020 2020 2020 2020   str.           
-0000d5a0: 2043 6f6c 756d 6e20 6e61 6d65 2074 6f20   Column name to 
-0000d5b0: 6265 2064 726f 7070 6564 0a20 2020 2020  be dropped.     
-0000d5c0: 2020 200a 2020 2020 2020 2020 5265 7475     .        Retu
-0000d5d0: 726e 730a 2020 2020 2020 2020 2d2d 2d2d  rns.        ----
-0000d5e0: 2d2d 2d0a 2020 2020 2020 2020 7365 6c66  ---.        self
-0000d5f0: 2e64 6174 6120 3a20 7061 6e64 6173 2e44  .data : pandas.D
-0000d600: 6174 6146 7261 6d65 0a20 2020 2020 2020  ataFrame.       
-0000d610: 2020 2020 2055 7064 6174 6564 2044 4941       Updated DIA
-0000d620: 4e4e 206f 7574 7075 7420 7461 626c 6520  NN output table 
-0000d630: 7769 7468 2064 726f 7070 6564 2063 6f6c  with dropped col
-0000d640: 756d 6e0a 2020 2020 2020 2020 2222 220a  umn.        """.
-0000d650: 2020 2020 2020 2020 7365 6c66 2e64 6174          self.dat
-0000d660: 6120 3d20 7365 6c66 2e64 6174 612e 6472  a = self.data.dr
-0000d670: 6f70 2863 6f6c 5f6e 616d 652c 2061 7869  op(col_name, axi
-0000d680: 733d 3129 0a20 2020 2020 2020 2072 6574  s=1).        ret
-0000d690: 7572 6e20 7365 6c66 2e64 6174 610a 2020  urn self.data.  
-0000d6a0: 2020 0a20 2020 2064 6566 2070 7265 7072    .    def prepr
-0000d6b0: 6f63 6573 7369 6e67 2873 656c 6629 3a0a  ocessing(self):.
-0000d6c0: 2020 2020 2020 2020 0a20 2020 2020 2020          .       
-0000d6d0: 2022 2222 0a20 2020 2020 2020 2050 7265   """.        Pre
-0000d6e0: 706f 6365 7373 2064 6174 610a 2020 2020  pocess data.    
-0000d6f0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-0000d700: 7365 6c66 2e64 6174 6120 3d20 7365 6c66  self.data = self
-0000d710: 2e5f 5072 6570 726f 6365 7373 6f72 2e5f  ._Preprocessor._
-0000d720: 7072 6f63 6573 7328 7365 6c66 2e64 6174  process(self.dat
-0000d730: 6129 0a0a 2020 2020 6465 6620 6368 616e  a)..    def chan
-0000d740: 6765 5f64 7479 7065 7328 7365 6c66 293a  ge_dtypes(self):
-0000d750: 0a0a 2020 2020 2020 2020 2222 2220 0a20  ..        """ . 
-0000d760: 2020 2020 2020 2043 6861 6e67 6520 6461         Change da
-0000d770: 7461 2074 7970 6573 206f 6620 636f 6c75  ta types of colu
-0000d780: 6d6e 730a 2020 2020 2020 2020 2222 220a  mns.        """.
-0000d790: 2020 2020 2020 2020 7365 6c66 2e64 6174          self.dat
-0000d7a0: 6120 3d20 7365 6c66 2e5f 5072 6570 726f  a = self._Prepro
-0000d7b0: 6365 7373 6f72 2e5f 6368 616e 6765 5f64  cessor._change_d
-0000d7c0: 7479 7065 7328 7365 6c66 2e64 6174 6129  types(self.data)
-0000d7d0: 0a0a 2020 2020 6465 6620 6164 645f 6461  ..    def add_da
-0000d7e0: 7461 2873 656c 662c 2064 6174 612c 2074  ta(self, data, t
-0000d7f0: 6974 6c65 293a 0a0a 2020 2020 2020 2020  itle):..        
-0000d800: 2222 220a 2020 2020 2020 2020 4164 6420  """.        Add 
-0000d810: 6461 7461 2074 6f20 7468 6520 6461 7461  data to the data
-0000d820: 7365 7473 206c 6973 740a 0a20 2020 2020  sets list..     
-0000d830: 2020 2050 6172 616d 6574 6572 730a 2020     Parameters.  
-0000d840: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
-0000d850: 0a20 2020 2020 2020 2064 6174 6120 3a20  .        data : 
-0000d860: 2070 616e 6461 732e 4461 7461 4672 616d   pandas.DataFram
-0000d870: 650a 2020 2020 2020 2020 2020 2020 4461  e.            Da
-0000d880: 7461 2074 6f20 6265 2061 6464 6564 0a20  ta to be added. 
-0000d890: 2020 2020 2020 2020 2020 200a 2020 2020             .    
-0000d8a0: 2020 2020 7469 746c 6520 3a20 7374 720a      title : str.
-0000d8b0: 2020 2020 2020 2020 2020 2020 5469 746c              Titl
-0000d8c0: 6520 6f66 2074 6865 2064 6174 610a 0a20  e of the data.. 
-0000d8d0: 2020 2020 2020 2052 6574 7572 6e73 0a20         Returns. 
-0000d8e0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 0a20         -------. 
-0000d8f0: 2020 2020 2020 2073 656c 662e 6461 7461         self.data
-0000d900: 7365 7473 203a 206c 6973 740a 2020 2020  sets : list.    
-0000d910: 2020 2020 2020 2020 4c69 7374 206f 6620          List of 
-0000d920: 6461 7461 7365 7473 0a20 2020 2020 2020  datasets.       
-0000d930: 2073 656c 662e 7469 746c 6520 3a20 6c69   self.title : li
-0000d940: 7374 0a20 2020 2020 2020 2020 2020 204c  st.            L
-0000d950: 6973 7420 6f66 2064 6174 6120 7469 746c  ist of data titl
-0000d960: 6573 0a20 2020 2020 2020 2022 2222 0a0a  es.        """..
-0000d970: 2020 2020 2020 2020 7365 6c66 2e64 6174          self.dat
-0000d980: 6173 6574 732e 6170 7065 6e64 2864 6174  asets.append(dat
-0000d990: 6129 0a20 2020 2020 2020 2073 656c 662e  a).        self.
-0000d9a0: 7469 746c 652e 6170 7065 6e64 2874 6974  title.append(tit
-0000d9b0: 6c65 290a 2020 2020 2020 2020 7072 696e  le).        prin
-0000d9c0: 7428 2744 6174 6120 7769 7468 2074 6865  t('Data with the
-0000d9d0: 2074 6974 6c65 2022 7b7d 2220 6973 2061   title "{}" is a
-0000d9e0: 6464 6564 272e 666f 726d 6174 2874 6974  dded'.format(tit
-0000d9f0: 6c65 2929 0a20 2020 2020 2020 2070 7269  le)).        pri
-0000da00: 6e74 2827 546f 7461 6c20 6e75 6d62 6572  nt('Total number
-0000da10: 206f 6620 6461 7461 7365 7473 3a20 227b   of datasets: "{
-0000da20: 7d22 272e 666f 726d 6174 286c 656e 2873  }"'.format(len(s
-0000da30: 656c 662e 6461 7461 7365 7473 2929 290a  elf.datasets))).
-0000da40: 0a20 2020 2064 6566 2064 656c 5f64 6174  .    def del_dat
-0000da50: 6128 7365 6c66 2c20 696e 6465 7829 3a0a  a(self, index):.
-0000da60: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-0000da70: 2020 2020 2044 656c 6574 6520 6461 7461       Delete data
-0000da80: 2066 726f 6d20 7468 6520 6461 7461 7365   from the datase
-0000da90: 7473 206c 6973 740a 0a20 2020 2020 2020  ts list..       
-0000daa0: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
-0000dab0: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20      ----------. 
-0000dac0: 2020 2020 2020 2069 6e64 6578 203a 2069         index : i
-0000dad0: 6e74 0a20 2020 2020 2020 2020 2020 2049  nt.            I
-0000dae0: 6e64 6578 206f 6620 7468 6520 6461 7461  ndex of the data
-0000daf0: 2074 6f20 6265 2064 656c 6574 6564 0a0a   to be deleted..
-0000db00: 2020 2020 2020 2020 5265 7475 726e 730a          Returns.
-0000db10: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d0a          -------.
-0000db20: 2020 2020 2020 2020 7365 6c66 2e64 6174          self.dat
-0000db30: 6173 6574 7320 3a20 6c69 7374 0a20 2020  asets : list.   
-0000db40: 2020 2020 2020 2020 204c 6973 7420 6f66           List of
-0000db50: 2064 6174 6173 6574 7320 7769 7468 6f75   datasets withou
-0000db60: 7420 7468 6520 6465 6c65 7465 6420 6461  t the deleted da
-0000db70: 7461 0a20 2020 2020 2020 2022 2222 0a20  ta.        """. 
-0000db80: 2020 2020 2020 2064 656c 2073 656c 662e         del self.
-0000db90: 6461 7461 7365 7473 5b69 6e64 6578 5d00  datasets[index].
-0000dba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000dbb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000dbc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000dbd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000dbe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000dbf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000dc00: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-0000dc10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000dc20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000dc30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000dc40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000dc50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000dc60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-0000dc70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-0000dc80: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
-0000dc90: 3030 3000 3031 3032 3133 0020 7800 0000  000.010213. x...
-0000dca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000dcb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000dcc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000dcd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000dce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000dcf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000dd00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-0000dd10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000dd20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000dd30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000dd40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000dd50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000dd60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000dd70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000dd80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000dd90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000dda0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ddb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ddc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ddd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000dde0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ddf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000de00: 3232 206d 7469 6d65 3d31 3638 3834 3937  22 mtime=1688497
-0000de10: 3330 392e 300a 0000 0000 0000 0000 0000  309.0...........
-0000de20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000de30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000de40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000de50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000de60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000de70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000de80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000de90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000dea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000deb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000dec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ded0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000dee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000def0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000df00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000df10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000df20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000df30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000df40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000ce10: 2070 640a 696d 706f 7274 206e 756d 7079   pd.import numpy
+0000ce20: 2061 7320 6e70 0a66 726f 6d20 7072 6f74   as np.from prot
+0000ce30: 656f 6d69 6373 5f64 6f77 6e73 7472 6561  eomics_downstrea
+0000ce40: 6d5f 616e 616c 7973 6973 2e70 7265 7072  m_analysis.prepr
+0000ce50: 6f63 6573 736f 7220 696d 706f 7274 2050  ocessor import P
+0000ce60: 7265 7072 6f63 6573 736f 720a 6672 6f6d  reprocessor.from
+0000ce70: 2070 726f 7465 6f6d 6963 735f 646f 776e   proteomics_down
+0000ce80: 7374 7265 616d 5f61 6e61 6c79 7369 732e  stream_analysis.
+0000ce90: 6d75 6c74 696c 6576 656c 6461 7461 2069  multileveldata i
+0000cea0: 6d70 6f72 7420 4d75 6c74 694c 6576 656c  mport MultiLevel
+0000ceb0: 4461 7461 0a66 726f 6d20 7072 6f74 656f  Data.from proteo
+0000cec0: 6d69 6373 5f64 6f77 6e73 7472 6561 6d5f  mics_downstream_
+0000ced0: 616e 616c 7973 6973 2e64 696d 656e 7369  analysis.dimensi
+0000cee0: 6f6e 616c 6974 7972 6564 7563 7469 6f6e  onalityreduction
+0000cef0: 2069 6d70 6f72 7420 4469 6d65 6e73 696f   import Dimensio
+0000cf00: 6e61 6c69 7479 5265 6475 6374 696f 6e0a  nalityReduction.
+0000cf10: 6672 6f6d 2070 726f 7465 6f6d 6963 735f  from proteomics_
+0000cf20: 646f 776e 7374 7265 616d 5f61 6e61 6c79  downstream_analy
+0000cf30: 7369 732e 636f 6e74 616d 696e 6174 696f  sis.contaminatio
+0000cf40: 6e20 696d 706f 7274 2043 6f6e 7461 6d69  n import Contami
+0000cf50: 6e61 7469 6f6e 416e 616c 7973 6973 0a66  nationAnalysis.f
+0000cf60: 726f 6d20 7072 6f74 656f 6d69 6373 5f64  rom proteomics_d
+0000cf70: 6f77 6e73 7472 6561 6d5f 616e 616c 7973  ownstream_analys
+0000cf80: 6973 2e73 7461 7469 7374 6963 7320 696d  is.statistics im
+0000cf90: 706f 7274 2053 7461 7469 7374 6963 730a  port Statistics.
+0000cfa0: 6672 6f6d 2070 726f 7465 6f6d 6963 735f  from proteomics_
+0000cfb0: 646f 776e 7374 7265 616d 5f61 6e61 6c79  downstream_analy
+0000cfc0: 7369 732e 7669 7375 616c 697a 6572 2069  sis.visualizer i
+0000cfd0: 6d70 6f72 7420 5669 7375 616c 697a 6572  mport Visualizer
+0000cfe0: 0a66 726f 6d20 7072 6f74 656f 6d69 6373  .from proteomics
+0000cff0: 5f64 6f77 6e73 7472 6561 6d5f 616e 616c  _downstream_anal
+0000d000: 7973 6973 2e64 6174 6171 7561 6c69 7479  ysis.dataquality
+0000d010: 696e 666f 726d 6174 696f 6e20 696d 706f  information impo
+0000d020: 7274 2044 6174 6151 7561 6c69 7479 496e  rt DataQualityIn
+0000d030: 666f 726d 6174 696f 6e0a 0a63 6c61 7373  formation..class
+0000d040: 2044 6961 6e6e 4461 7461 284d 756c 7469   DiannData(Multi
+0000d050: 4c65 7665 6c44 6174 612c 2044 696d 656e  LevelData, Dimen
+0000d060: 7369 6f6e 616c 6974 7952 6564 7563 7469  sionalityReducti
+0000d070: 6f6e 2c20 436f 6e74 616d 696e 6174 696f  on, Contaminatio
+0000d080: 6e41 6e61 6c79 7369 732c 2053 7461 7469  nAnalysis, Stati
+0000d090: 7374 6963 732c 2056 6973 7561 6c69 7a65  stics, Visualize
+0000d0a0: 722c 2044 6174 6151 7561 6c69 7479 496e  r, DataQualityIn
+0000d0b0: 666f 726d 6174 696f 6e29 3a0a 2020 2020  formation):.    
+0000d0c0: 0a20 2020 2022 2222 2054 6869 7320 636c  .    """ This cl
+0000d0d0: 6173 7320 656e 6361 7073 756c 6174 6573  ass encapsulates
+0000d0e0: 206d 6574 686f 6473 2066 6f72 2044 4941   methods for DIA
+0000d0f0: 4e4e 206f 7574 7075 7420 7461 626c 6573  NN output tables
+0000d100: 2022 2222 0a20 2020 200a 2020 2020 6465   """.    .    de
+0000d110: 6620 5f5f 696e 6974 5f5f 2873 656c 662c  f __init__(self,
+0000d120: 2066 696c 6570 6174 683d 4e6f 6e65 293a   filepath=None):
+0000d130: 0a0a 2020 2020 2020 2020 7365 6c66 2e74  ..        self.t
+0000d140: 6974 6c65 203d 5b5d 0a20 2020 2020 2020  itle =[].       
+0000d150: 2073 656c 662e 6461 7461 7365 7473 203d   self.datasets =
+0000d160: 205b 5d0a 0a20 2020 2020 2020 2069 6620   []..        if 
+0000d170: 6669 6c65 7061 7468 2069 7320 4e6f 6e65  filepath is None
+0000d180: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
+0000d190: 6c66 2e5f 5072 6570 726f 6365 7373 6f72  lf._Preprocessor
+0000d1a0: 203d 2050 7265 7072 6f63 6573 736f 7228   = Preprocessor(
+0000d1b0: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
+0000d1c0: 6c66 2e64 6174 6173 6574 7320 3d20 5b5d  lf.datasets = []
+0000d1d0: 0a20 2020 2020 2020 2020 2020 200a 2020  .            .  
+0000d1e0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+0000d1f0: 2020 2020 2020 2020 7365 6c66 2e5f 5072          self._Pr
+0000d200: 6570 726f 6365 7373 6f72 203d 2050 7265  eprocessor = Pre
+0000d210: 7072 6f63 6573 736f 7228 290a 2020 2020  processor().    
+0000d220: 2020 2020 2020 2020 7365 6c66 2e64 6174          self.dat
+0000d230: 6120 3d20 7064 2e72 6561 645f 6373 7628  a = pd.read_csv(
+0000d240: 6669 6c65 7061 7468 2c20 6465 6c69 6d69  filepath, delimi
+0000d250: 7465 723d 275c 7427 290a 2020 2020 2020  ter='\t').      
+0000d260: 2020 2020 2020 7365 6c66 2e64 6174 6173        self.datas
+0000d270: 6574 7320 3d20 5b5d 0a0a 2020 2020 6465  ets = []..    de
+0000d280: 6620 7570 6461 7465 5f63 6f6c 5f6e 616d  f update_col_nam
+0000d290: 6573 2873 656c 662c 2063 6f6c 5f6e 616d  es(self, col_nam
+0000d2a0: 6573 293a 0a20 2020 2020 2020 2020 2020  es):.           
+0000d2b0: 200a 2020 2020 2020 2020 2222 220a 2020   .        """.  
+0000d2c0: 2020 2020 2020 4368 616e 6765 2074 6865        Change the
+0000d2d0: 2063 6f6c 756d 7320 6e61 6d65 7320 6f66   colums names of
+0000d2e0: 2044 4941 4e4e 206f 7574 7075 7420 7461   DIANN output ta
+0000d2f0: 626c 6573 0a20 2020 2020 2020 2052 6570  bles.        Rep
+0000d300: 6c69 6361 7465 7320 7769 6c6c 2068 6176  licates will hav
+0000d310: 6520 7361 6d65 206e 616d 650a 0a20 2020  e same name..   
+0000d320: 2020 2020 2050 6172 616d 6574 6572 730a       Parameters.
+0000d330: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+0000d340: 2d2d 0a20 2020 2020 2020 2063 6f6c 5f6e  --.        col_n
+0000d350: 616d 6573 203a 206c 6973 740a 2020 2020  ames : list.    
+0000d360: 2020 2020 2020 2020 4c69 7374 206f 6620          List of 
+0000d370: 636f 6c75 6d6e 206e 616d 6573 0a0a 2020  column names..  
+0000d380: 2020 2020 2020 5265 7475 726e 730a 2020        Returns.  
+0000d390: 2020 2020 2020 2d2d 2d2d 2d2d 2d0a 2020        -------.  
+0000d3a0: 2020 2020 2020 7365 6c66 2e64 6174 6120        self.data 
+0000d3b0: 3a20 7061 6e64 6173 2e44 6174 6146 7261  : pandas.DataFra
+0000d3c0: 6d65 0a20 2020 2020 2020 2020 2020 2055  me.            U
+0000d3d0: 7064 6174 6564 2044 4941 4e4e 206f 7574  pdated DIANN out
+0000d3e0: 7075 7420 7461 626c 6520 7769 7468 206e  put table with n
+0000d3f0: 6577 2063 6f6c 756d 6e20 6e61 6d65 730a  ew column names.
+0000d400: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+0000d410: 2020 2020 0a20 2020 2020 2020 2073 656c      .        sel
+0000d420: 662e 6461 7461 2e63 6f6c 756d 6e73 203d  f.data.columns =
+0000d430: 205b 2750 726f 7465 696e 2e47 726f 7570   ['Protein.Group
+0000d440: 272c 0a20 2020 2020 2020 2020 2020 2020  ',.             
+0000d450: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d460: 2750 726f 7465 696e 2e49 6473 272c 0a20  'Protein.Ids',. 
+0000d470: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d480: 2020 2020 2020 2020 2020 2020 2750 726f              'Pro
+0000d490: 7465 696e 2e4e 616d 6573 272c 0a20 2020  tein.Names',.   
+0000d4a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d4b0: 2020 2020 2020 2020 2020 2747 656e 6573            'Genes
+0000d4c0: 272c 200a 2020 2020 2020 2020 2020 2020  ', .            
+0000d4d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d4e0: 2027 4669 7273 742e 5072 6f74 6569 6e2e   'First.Protein.
+0000d4f0: 4465 7363 7269 7074 696f 6e27 5d20 2b20  Description'] + 
+0000d500: 636f 6c5f 6e61 6d65 730a 2020 2020 0a20  col_names.    . 
+0000d510: 2020 2064 6566 2064 726f 705f 636f 6c28     def drop_col(
+0000d520: 7365 6c66 2c20 636f 6c5f 6e61 6d65 293a  self, col_name):
+0000d530: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+0000d540: 2020 2020 2044 726f 7020 636f 6c75 6d6e       Drop column
+0000d550: 7320 6672 6f6d 2044 4941 4e4e 206f 7574  s from DIANN out
+0000d560: 7075 7420 7461 626c 6573 0a20 2020 2020  put tables.     
+0000d570: 2020 2050 6172 616d 6574 6572 730a 2020     Parameters.  
+0000d580: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+0000d590: 0a20 2020 2020 2020 2063 6f6c 5f6e 616d  .        col_nam
+0000d5a0: 6520 3a20 7374 720a 2020 2020 2020 2020  e : str.        
+0000d5b0: 2020 2020 436f 6c75 6d6e 206e 616d 6520      Column name 
+0000d5c0: 746f 2062 6520 6472 6f70 7065 640a 2020  to be dropped.  
+0000d5d0: 2020 2020 2020 0a20 2020 2020 2020 2052        .        R
+0000d5e0: 6574 7572 6e73 0a20 2020 2020 2020 202d  eturns.        -
+0000d5f0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2073  ------.        s
+0000d600: 656c 662e 6461 7461 203a 2070 616e 6461  elf.data : panda
+0000d610: 732e 4461 7461 4672 616d 650a 2020 2020  s.DataFrame.    
+0000d620: 2020 2020 2020 2020 5570 6461 7465 6420          Updated 
+0000d630: 4449 414e 4e20 6f75 7470 7574 2074 6162  DIANN output tab
+0000d640: 6c65 2077 6974 6820 6472 6f70 7065 6420  le with dropped 
+0000d650: 636f 6c75 6d6e 0a20 2020 2020 2020 2022  column.        "
+0000d660: 2222 0a20 2020 2020 2020 2073 656c 662e  "".        self.
+0000d670: 6461 7461 203d 2073 656c 662e 6461 7461  data = self.data
+0000d680: 2e64 726f 7028 636f 6c5f 6e61 6d65 2c20  .drop(col_name, 
+0000d690: 6178 6973 3d31 290a 2020 2020 2020 2020  axis=1).        
+0000d6a0: 7265 7475 726e 2073 656c 662e 6461 7461  return self.data
+0000d6b0: 0a20 2020 200a 2020 2020 6465 6620 7072  .    .    def pr
+0000d6c0: 6570 726f 6365 7373 696e 6728 7365 6c66  eprocessing(self
+0000d6d0: 293a 0a20 2020 2020 2020 200a 2020 2020  ):.        .    
+0000d6e0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+0000d6f0: 5072 6570 6f63 6573 7320 6461 7461 0a20  Prepocess data. 
+0000d700: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+0000d710: 2020 2073 656c 662e 6461 7461 203d 2073     self.data = s
+0000d720: 656c 662e 5f50 7265 7072 6f63 6573 736f  elf._Preprocesso
+0000d730: 722e 5f70 726f 6365 7373 2873 656c 662e  r._process(self.
+0000d740: 6461 7461 290a 0a20 2020 2064 6566 2063  data)..    def c
+0000d750: 6861 6e67 655f 6474 7970 6573 2873 656c  hange_dtypes(sel
+0000d760: 6629 3a0a 0a20 2020 2020 2020 2022 2222  f):..        """
+0000d770: 200a 2020 2020 2020 2020 4368 616e 6765   .        Change
+0000d780: 2064 6174 6120 7479 7065 7320 6f66 2063   data types of c
+0000d790: 6f6c 756d 6e73 0a20 2020 2020 2020 2022  olumns.        "
+0000d7a0: 2222 0a20 2020 2020 2020 2073 656c 662e  "".        self.
+0000d7b0: 6461 7461 203d 2073 656c 662e 5f50 7265  data = self._Pre
+0000d7c0: 7072 6f63 6573 736f 722e 5f63 6861 6e67  processor._chang
+0000d7d0: 655f 6474 7970 6573 2873 656c 662e 6461  e_dtypes(self.da
+0000d7e0: 7461 290a 0a20 2020 2064 6566 2061 6464  ta)..    def add
+0000d7f0: 5f64 6174 6128 7365 6c66 2c20 6461 7461  _data(self, data
+0000d800: 2c20 7469 746c 6529 3a0a 0a20 2020 2020  , title):..     
+0000d810: 2020 2022 2222 0a20 2020 2020 2020 2041     """.        A
+0000d820: 6464 2064 6174 6120 746f 2074 6865 2064  dd data to the d
+0000d830: 6174 6173 6574 7320 6c69 7374 0a0a 2020  atasets list..  
+0000d840: 2020 2020 2020 5061 7261 6d65 7465 7273        Parameters
+0000d850: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+0000d860: 2d2d 2d0a 2020 2020 2020 2020 6461 7461  ---.        data
+0000d870: 203a 2020 7061 6e64 6173 2e44 6174 6146   :  pandas.DataF
+0000d880: 7261 6d65 0a20 2020 2020 2020 2020 2020  rame.           
+0000d890: 2044 6174 6120 746f 2062 6520 6164 6465   Data to be adde
+0000d8a0: 640a 2020 2020 2020 2020 2020 2020 0a20  d.            . 
+0000d8b0: 2020 2020 2020 2074 6974 6c65 203a 2073         title : s
+0000d8c0: 7472 0a20 2020 2020 2020 2020 2020 2054  tr.            T
+0000d8d0: 6974 6c65 206f 6620 7468 6520 6461 7461  itle of the data
+0000d8e0: 0a0a 2020 2020 2020 2020 5265 7475 726e  ..        Return
+0000d8f0: 730a 2020 2020 2020 2020 2d2d 2d2d 2d2d  s.        ------
+0000d900: 2d0a 2020 2020 2020 2020 7365 6c66 2e64  -.        self.d
+0000d910: 6174 6173 6574 7320 3a20 6c69 7374 0a20  atasets : list. 
+0000d920: 2020 2020 2020 2020 2020 204c 6973 7420             List 
+0000d930: 6f66 2064 6174 6173 6574 730a 2020 2020  of datasets.    
+0000d940: 2020 2020 7365 6c66 2e74 6974 6c65 203a      self.title :
+0000d950: 206c 6973 740a 2020 2020 2020 2020 2020   list.          
+0000d960: 2020 4c69 7374 206f 6620 6461 7461 2074    List of data t
+0000d970: 6974 6c65 730a 2020 2020 2020 2020 2222  itles.        ""
+0000d980: 220a 0a20 2020 2020 2020 2073 656c 662e  "..        self.
+0000d990: 6461 7461 7365 7473 2e61 7070 656e 6428  datasets.append(
+0000d9a0: 6461 7461 290a 2020 2020 2020 2020 7365  data).        se
+0000d9b0: 6c66 2e74 6974 6c65 2e61 7070 656e 6428  lf.title.append(
+0000d9c0: 7469 746c 6529 0a20 2020 2020 2020 2070  title).        p
+0000d9d0: 7269 6e74 2827 4461 7461 2077 6974 6820  rint('Data with 
+0000d9e0: 7468 6520 7469 746c 6520 227b 7d22 2069  the title "{}" i
+0000d9f0: 7320 6164 6465 6427 2e66 6f72 6d61 7428  s added'.format(
+0000da00: 7469 746c 6529 290a 2020 2020 2020 2020  title)).        
+0000da10: 7072 696e 7428 2754 6f74 616c 206e 756d  print('Total num
+0000da20: 6265 7220 6f66 2064 6174 6173 6574 733a  ber of datasets:
+0000da30: 2022 7b7d 2227 2e66 6f72 6d61 7428 6c65   "{}"'.format(le
+0000da40: 6e28 7365 6c66 2e64 6174 6173 6574 7329  n(self.datasets)
+0000da50: 2929 0a0a 2020 2020 6465 6620 6465 6c5f  ))..    def del_
+0000da60: 6461 7461 2873 656c 662c 2069 6e64 6578  data(self, index
+0000da70: 293a 0a0a 2020 2020 2020 2020 2222 220a  ):..        """.
+0000da80: 2020 2020 2020 2020 4465 6c65 7465 2064          Delete d
+0000da90: 6174 6120 6672 6f6d 2074 6865 2064 6174  ata from the dat
+0000daa0: 6173 6574 7320 6c69 7374 0a0a 2020 2020  asets list..    
+0000dab0: 2020 2020 5061 7261 6d65 7465 7273 0a20      Parameters. 
+0000dac0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
+0000dad0: 2d0a 2020 2020 2020 2020 696e 6465 7820  -.        index 
+0000dae0: 3a20 696e 740a 2020 2020 2020 2020 2020  : int.          
+0000daf0: 2020 496e 6465 7820 6f66 2074 6865 2064    Index of the d
+0000db00: 6174 6120 746f 2062 6520 6465 6c65 7465  ata to be delete
+0000db10: 640a 0a20 2020 2020 2020 2052 6574 7572  d..        Retur
+0000db20: 6e73 0a20 2020 2020 2020 202d 2d2d 2d2d  ns.        -----
+0000db30: 2d2d 0a20 2020 2020 2020 2073 656c 662e  --.        self.
+0000db40: 6461 7461 7365 7473 203a 206c 6973 740a  datasets : list.
+0000db50: 2020 2020 2020 2020 2020 2020 4c69 7374              List
+0000db60: 206f 6620 6461 7461 7365 7473 2077 6974   of datasets wit
+0000db70: 686f 7574 2074 6865 2064 656c 6574 6564  hout the deleted
+0000db80: 2064 6174 610a 2020 2020 2020 2020 2222   data.        ""
+0000db90: 220a 2020 2020 2020 2020 6465 6c20 7365  ".        del se
+0000dba0: 6c66 2e64 6174 6173 6574 735b 696e 6465  lf.datasets[inde
+0000dbb0: 785d 0a0a 2020 2020 6465 6620 6672 6f6d  x]..    def from
+0000dbc0: 5f73 7065 6374 726f 6e61 7574 5f74 6f5f  _spectronaut_to_
+0000dbd0: 6469 616e 6e28 7365 6c66 2c20 6669 6c65  diann(self, file
+0000dbe0: 7061 7468 293a 0a20 2020 2020 2020 200a  path):.        .
+0000dbf0: 2020 2020 2020 2020 6461 7461 203d 2070          data = p
+0000dc00: 642e 7265 6164 5f63 7376 2866 696c 6570  d.read_csv(filep
+0000dc10: 6174 6829 0a20 2020 2020 2020 2064 6174  ath).        dat
+0000dc20: 6120 3d20 6461 7461 2e66 696c 7465 7228  a = data.filter(
+0000dc30: 7265 6765 783d 2747 726f 7570 737c 556e  regex='Groups|Un
+0000dc40: 6950 726f 7449 6473 7c50 726f 7465 696e  iProtIds|Protein
+0000dc50: 4e61 6d65 737c 4765 6e65 737c 5072 6f74  Names|Genes|Prot
+0000dc60: 6569 6e44 6573 6372 6970 7469 6f6e 737c  einDescriptions|
+0000dc70: 7261 772e 5047 2e51 7561 6e74 6974 7927  raw.PG.Quantity'
+0000dc80: 290a 0a20 2020 2020 2020 2023 2072 656e  )..        # ren
+0000dc90: 616d 6520 636f 6c75 6d6e 730a 2020 2020  ame columns.    
+0000dca0: 2020 2020 636f 6c5f 7265 6e61 6d65 203d      col_rename =
+0000dcb0: 207b 2750 472e 5072 6f74 6569 6e47 726f   {'PG.ProteinGro
+0000dcc0: 7570 7327 3a27 5072 6f74 6569 6e2e 4772  ups':'Protein.Gr
+0000dcd0: 6f75 7027 2c0a 2020 2020 2020 2020 2020  oup',.          
+0000dce0: 2020 2020 2020 2020 2020 2750 472e 4765            'PG.Ge
+0000dcf0: 6e65 7327 3a27 4765 6e65 7327 2c0a 2020  nes':'Genes',.  
+0000dd00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000dd10: 2020 2750 472e 5072 6f74 6569 6e44 6573    'PG.ProteinDes
+0000dd20: 6372 6970 7469 6f6e 7327 3a20 2746 6972  criptions': 'Fir
+0000dd30: 7374 2e50 726f 7465 696e 2e44 6573 6372  st.Protein.Descr
+0000dd40: 6970 7469 6f6e 272c 0a20 2020 2020 2020  iption',.       
+0000dd50: 2020 2020 2020 2020 2020 2020 2027 5047               'PG
+0000dd60: 2e55 6e69 5072 6f74 4964 7327 3a20 2750  .UniProtIds': 'P
+0000dd70: 726f 7465 696e 2e49 6473 272c 0a20 2020  rotein.Ids',.   
+0000dd80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000dd90: 2027 5047 2e50 726f 7465 696e 4e61 6d65   'PG.ProteinName
+0000dda0: 7327 3a20 2750 726f 7465 696e 2e4e 616d  s': 'Protein.Nam
+0000ddb0: 6573 277d 0a20 2020 2020 2020 2064 6174  es'}.        dat
+0000ddc0: 6120 3d20 6461 7461 2e72 656e 616d 6528  a = data.rename(
+0000ddd0: 636f 6c75 6d6e 7320 3d20 636f 6c5f 7265  columns = col_re
+0000dde0: 6e61 6d65 290a 0a20 2020 2020 2020 2023  name)..        #
+0000ddf0: 2072 656f 7264 6572 2063 6f6c 756d 6e73   reorder columns
+0000de00: 0a20 2020 2020 2020 2072 656f 7264 6572  .        reorder
+0000de10: 203d 205b 2750 726f 7465 696e 2e47 726f   = ['Protein.Gro
+0000de20: 7570 272c 0a20 2020 2020 2020 2020 2020  up',.           
+0000de30: 2020 2020 2027 5072 6f74 6569 6e2e 4964       'Protein.Id
+0000de40: 7327 2c0a 2020 2020 2020 2020 2020 2020  s',.            
+0000de50: 2020 2020 2750 726f 7465 696e 2e4e 616d      'Protein.Nam
+0000de60: 6573 272c 0a20 2020 2020 2020 2020 2020  es',.           
+0000de70: 2020 2020 2027 4765 6e65 7327 2c0a 2020       'Genes',.  
+0000de80: 2020 2020 2020 2020 2020 2020 2020 2746                'F
+0000de90: 6972 7374 2e50 726f 7465 696e 2e44 6573  irst.Protein.Des
+0000dea0: 6372 6970 7469 6f6e 275d 202b 2064 6174  cription'] + dat
+0000deb0: 612e 636f 6c75 6d6e 735b 353a 5d2e 746f  a.columns[5:].to
+0000dec0: 6c69 7374 2829 0a20 2020 2020 2020 2064  list().        d
+0000ded0: 6174 6120 3d20 6461 7461 5b72 656f 7264  ata = data[reord
+0000dee0: 6572 5d0a 0a20 2020 2020 2020 2023 2069  er]..        # i
+0000def0: 6e74 726f 6475 6365 206e 702e 6e61 6e0a  ntroduce np.nan.
+0000df00: 2020 2020 2020 2020 6461 7461 203d 2064          data = d
+0000df10: 6174 612e 7265 706c 6163 6528 2746 696c  ata.replace('Fil
+0000df20: 7465 7265 6427 2c20 6e70 2e6e 616e 290a  tered', np.nan).
+0000df30: 2020 2020 2020 2020 7365 6c66 2e64 6174          self.dat
+0000df40: 6120 3d20 6461 7461 0a00 0000 0000 0000  a = data........
 0000df50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000df60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000df70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000df80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000df90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000dfa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000dfb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000dfc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000dfd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000dfe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000dff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e000: 7072 6f74 656f 6d69 6373 5f64 6f77 6e73  proteomics_downs
-0000e010: 7472 6561 6d5f 616e 616c 7973 6973 2d30  tream_analysis-0
-0000e020: 2e31 2e32 2f70 726f 7465 6f6d 6963 735f  .1.2/proteomics_
-0000e030: 646f 776e 7374 7265 616d 5f61 6e61 6c79  downstream_analy
-0000e040: 7369 732f 6469 6d65 6e73 696f 6e61 6c69  sis/dimensionali
-0000e050: 7479 7265 6475 6374 696f 6e2e 7079 0000  tyreduction.py..
-0000e060: 0000 0000 3030 3030 3634 3400 3030 3031  ....0000644.0001
-0000e070: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
-0000e080: 3030 3434 3630 3600 3134 3435 3130 3636  0044606.14451066
-0000e090: 3233 3500 3033 3333 3336 0020 3000 0000  235.033336. 0...
+0000e000: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+0000e010: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000e020: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000e030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000e040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000e050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000e060: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+0000e070: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+0000e080: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
+0000e090: 3030 3000 3031 3032 3133 0020 7800 0000  000.010213. x...
 0000e0a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000e0b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000e0c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000e0d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000e0e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000e0f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e100: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
+0000e100: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
 0000e110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e120: 0000 0000 0000 0000 0064 6f63 6b65 7200  .........docker.
+0000e120: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000e130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000e140: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000e150: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000e160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000e170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000e180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000e190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000e1a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000e1b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000e1c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000e1d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000e1e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000e1f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e200: 696d 706f 7274 2070 616e 6461 7320 6173  import pandas as
-0000e210: 2070 640a 696d 706f 7274 206e 756d 7079   pd.import numpy
-0000e220: 2061 7320 6e70 0a0a 696d 706f 7274 2073   as np..import s
-0000e230: 6561 626f 726e 2061 7320 736e 730a 696d  eaborn as sns.im
-0000e240: 706f 7274 206d 6174 706c 6f74 6c69 622e  port matplotlib.
-0000e250: 7079 706c 6f74 2061 7320 706c 740a 0a66  pyplot as plt..f
-0000e260: 726f 6d20 736b 6c65 6172 6e2e 7072 6570  rom sklearn.prep
-0000e270: 726f 6365 7373 696e 6720 696d 706f 7274  rocessing import
-0000e280: 2053 7461 6e64 6172 6453 6361 6c65 720a   StandardScaler.
-0000e290: 6672 6f6d 2073 6b6c 6561 726e 2e64 6563  from sklearn.dec
-0000e2a0: 6f6d 706f 7369 7469 6f6e 2069 6d70 6f72  omposition impor
-0000e2b0: 7420 5043 410a 6672 6f6d 2073 6b6c 6561  t PCA.from sklea
-0000e2c0: 726e 2e6d 616e 6966 6f6c 6420 696d 706f  rn.manifold impo
-0000e2d0: 7274 2054 534e 450a 0a69 6d70 6f72 7420  rt TSNE..import 
-0000e2e0: 756d 6170 2061 7320 6d70 0a0a 6672 6f6d  umap as mp..from
-0000e2f0: 2061 646a 7573 7454 6578 7420 696d 706f   adjustText impo
-0000e300: 7274 2061 646a 7573 745f 7465 7874 0a0a  rt adjust_text..
-0000e310: 6672 6f6d 2070 6c6f 746c 792e 7375 6270  from plotly.subp
-0000e320: 6c6f 7473 2069 6d70 6f72 7420 6d61 6b65  lots import make
-0000e330: 5f73 7562 706c 6f74 730a 696d 706f 7274  _subplots.import
-0000e340: 2070 6c6f 746c 792e 6578 7072 6573 7320   plotly.express 
-0000e350: 6173 2070 780a 0a66 726f 6d20 2e75 7469  as px..from .uti
-0000e360: 6c73 2069 6d70 6f72 7420 6973 5f6a 7570  ls import is_jup
-0000e370: 7974 6572 5f6e 6f74 6562 6f6f 6b0a 696d  yter_notebook.im
-0000e380: 706f 7274 2073 7472 6561 6d6c 6974 2061  port streamlit a
-0000e390: 7320 7374 0a0a 636c 6173 7320 4469 6d65  s st..class Dime
-0000e3a0: 6e73 696f 6e61 6c69 7479 5265 6475 6374  nsionalityReduct
-0000e3b0: 696f 6e3a 0a20 2020 2022 2222 2022 2222  ion:.    """ """
-0000e3c0: 0a0a 2020 2020 6465 6620 5f70 6361 2873  ..    def _pca(s
-0000e3d0: 656c 662c 2064 6174 613d 4e6f 6e65 293a  elf, data=None):
-0000e3e0: 0a0a 2020 2020 2020 2020 2222 2247 656e  ..        """Gen
-0000e3f0: 6572 6174 6520 6120 5043 410a 0a20 2020  erate a PCA..   
-0000e400: 2020 2020 2050 6172 616d 6574 6572 730a       Parameters.
-0000e410: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-0000e420: 2d2d 0a20 2020 2020 2020 2064 6174 6120  --.        data 
-0000e430: 3a20 7064 2e44 6174 6146 7261 6d65 0a20  : pd.DataFrame. 
-0000e440: 2020 2020 2020 2020 2020 2020 4461 7461              Data
-0000e450: 2074 6f20 6265 2064 6563 6f6d 706f 7365   to be decompose
-0000e460: 6420 2844 6566 6175 6c74 2076 616c 7565  d (Default value
-0000e470: 203d 204e 6f6e 6529 0a0a 2020 2020 2020   = None)..      
-0000e480: 2020 5265 7475 726e 730a 2020 2020 2020    Returns.      
-0000e490: 2020 2d2d 2d2d 2d2d 2d0a 2020 2020 2020    -------.      
-0000e4a0: 2020 7063 6120 3a20 736b 6c65 6172 6e2e    pca : sklearn.
-0000e4b0: 6465 636f 6d70 6f73 6974 696f 6e2e 5043  decomposition.PC
-0000e4c0: 410a 2020 2020 2020 2020 2020 2020 5043  A.            PC
-0000e4d0: 4120 6f62 6a65 6374 0a20 2020 2020 2020  A object.       
-0000e4e0: 2066 696e 616c 4466 203a 2070 642e 4461   finalDf : pd.Da
-0000e4f0: 7461 4672 616d 650a 2020 2020 2020 2020  taFrame.        
-0000e500: 2020 2020 4461 7461 6672 616d 6520 7769      Dataframe wi
-0000e510: 7468 2070 7269 6e63 6970 616c 2063 6f6d  th principal com
-0000e520: 706f 6e65 6e74 7320 616e 6420 7461 7267  ponents and targ
-0000e530: 6574 2063 6f6c 756d 6e0a 2020 2020 2020  et column.      
-0000e540: 2020 2222 220a 0a20 2020 2020 2020 2069    """..        i
-0000e550: 6620 6973 696e 7374 616e 6365 2864 6174  f isinstance(dat
-0000e560: 612c 2070 642e 4461 7461 4672 616d 6529  a, pd.DataFrame)
-0000e570: 3a0a 2020 2020 2020 2020 2020 2020 6466  :.            df
-0000e580: 203d 2064 6174 612e 7365 6c65 6374 5f64   = data.select_d
-0000e590: 7479 7065 7328 696e 636c 7564 6520 3d5b  types(include =[
-0000e5a0: 2766 6c6f 6174 3634 275d 292e 542e 636f  'float64']).T.co
-0000e5b0: 7079 2829 0a0a 2020 2020 2020 2020 656c  py()..        el
-0000e5c0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-0000e5d0: 2320 7072 6570 6172 6520 7468 6520 6461  # prepare the da
-0000e5e0: 7461 6672 616d 6520 666f 7220 5043 410a  taframe for PCA.
-0000e5f0: 2020 2020 2020 2020 2020 2020 6466 203d              df =
-0000e600: 2073 656c 662e 6461 7461 2e73 656c 6563   self.data.selec
-0000e610: 745f 6474 7970 6573 2869 6e63 6c75 6465  t_dtypes(include
-0000e620: 203d 5b27 666c 6f61 7436 3427 5d29 2e54   =['float64']).T
-0000e630: 2e63 6f70 7928 290a 0a20 2020 2020 2020  .copy()..       
-0000e640: 2023 2070 7265 7061 7265 2066 6561 7475   # prepare featu
-0000e650: 7265 7320 7661 7269 6162 6c65 2028 4765  res variable (Ge
-0000e660: 6e65 7329 0a20 2020 2020 2020 2066 6561  nes).        fea
-0000e670: 7475 7265 7320 3d20 6c69 7374 286e 702e  tures = list(np.
-0000e680: 6172 616e 6765 2864 662e 7368 6170 655b  arange(df.shape[
-0000e690: 315d 2929 0a20 2020 2020 2020 2064 662e  1])).        df.
-0000e6a0: 636f 6c75 6d6e 7320 3d20 6665 6174 7572  columns = featur
-0000e6b0: 6573 0a20 2020 2020 2020 200a 2020 2020  es.        .    
-0000e6c0: 2020 2020 2320 7072 6570 6172 6520 7461      # prepare ta
-0000e6d0: 7267 6574 2063 6f6c 756d 6e20 2873 616d  rget column (sam
-0000e6e0: 706c 6520 7479 7065 7329 0a20 2020 2020  ple types).     
-0000e6f0: 2020 2064 665b 2774 6172 6765 7427 5d20     df['target'] 
-0000e700: 3d20 6466 2e69 6e64 6578 0a20 2020 2020  = df.index.     
-0000e710: 2020 2064 6620 3d20 6466 2e72 6573 6574     df = df.reset
-0000e720: 5f69 6e64 6578 2864 726f 703d 2054 7275  _index(drop= Tru
-0000e730: 6529 0a0a 2020 2020 2020 2020 2320 5365  e)..        # Se
-0000e740: 7061 7261 7469 6e67 206f 7574 2074 6865  parating out the
-0000e750: 2066 6561 7475 7265 730a 2020 2020 2020   features.      
-0000e760: 2020 7820 3d20 6466 2e6c 6f63 5b3a 2c20    x = df.loc[:, 
-0000e770: 6665 6174 7572 6573 5d2e 7661 6c75 6573  features].values
-0000e780: 0a20 2020 2020 2020 200a 2020 2020 2020  .        .      
-0000e790: 2020 2320 5365 7061 7261 7469 6e67 206f    # Separating o
-0000e7a0: 7574 2074 6865 2074 6172 6765 740a 2020  ut the target.  
-0000e7b0: 2020 2020 2020 7920 3d20 6466 2e6c 6f63        y = df.loc
-0000e7c0: 5b3a 2c5b 2774 6172 6765 7427 5d5d 2e76  [:,['target']].v
-0000e7d0: 616c 7565 730a 2020 2020 2020 2020 0a20  alues.        . 
-0000e7e0: 2020 2020 2020 2023 2053 7461 6e64 6172         # Standar
-0000e7f0: 6469 7a69 6e67 2074 6865 2066 6561 7475  dizing the featu
-0000e800: 7265 730a 2020 2020 2020 2020 7820 3d20  res.        x = 
-0000e810: 5374 616e 6461 7264 5363 616c 6572 2829  StandardScaler()
-0000e820: 2e66 6974 5f74 7261 6e73 666f 726d 2878  .fit_transform(x
-0000e830: 290a 2020 2020 2020 2020 7063 6120 3d20  ).        pca = 
-0000e840: 5043 4128 6e5f 636f 6d70 6f6e 656e 7473  PCA(n_components
-0000e850: 3d32 290a 2020 2020 2020 2020 7072 696e  =2).        prin
-0000e860: 6369 7061 6c43 6f6d 706f 6e65 6e74 7320  cipalComponents 
-0000e870: 3d20 7063 612e 6669 745f 7472 616e 7366  = pca.fit_transf
-0000e880: 6f72 6d28 7829 0a20 2020 2020 2020 2070  orm(x).        p
-0000e890: 7269 6e63 6970 616c 4466 203d 2070 642e  rincipalDf = pd.
-0000e8a0: 4461 7461 4672 616d 6528 6461 7461 203d  DataFrame(data =
-0000e8b0: 2070 7269 6e63 6970 616c 436f 6d70 6f6e   principalCompon
-0000e8c0: 656e 7473 0a20 2020 2020 2020 2020 2020  ents.           
-0000e8d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e8e0: 2020 2020 202c 636f 6c75 6d6e 7320 3d20       ,columns = 
-0000e8f0: 5b27 7072 696e 6369 7061 6c20 636f 6d70  ['principal comp
-0000e900: 6f6e 656e 7420 3127 2c20 2770 7269 6e63  onent 1', 'princ
-0000e910: 6970 616c 2063 6f6d 706f 6e65 6e74 2032  ipal component 2
-0000e920: 275d 290a 2020 2020 2020 2020 0a20 2020  ']).        .   
-0000e930: 2020 2020 2066 696e 616c 4466 203d 2070       finalDf = p
-0000e940: 642e 636f 6e63 6174 285b 7072 696e 6369  d.concat([princi
-0000e950: 7061 6c44 662c 2064 665b 5b27 7461 7267  palDf, df[['targ
-0000e960: 6574 275d 5d5d 2c20 6178 6973 203d 2031  et']]], axis = 1
-0000e970: 290a 2020 2020 2020 2020 0a20 2020 2020  ).        .     
-0000e980: 2020 2072 6574 7572 6e20 7063 612c 2066     return pca, f
-0000e990: 696e 616c 4466 0a0a 2020 2020 6465 6620  inalDf..    def 
-0000e9a0: 7063 615f 706c 6f74 2873 656c 662c 206e  pca_plot(self, n
-0000e9b0: 5f72 6f77 733d 312c 206e 5f63 6f6c 733d  _rows=1, n_cols=
-0000e9c0: 312c 2074 6974 6c65 733d 5b27 275d 2c20  1, titles=[''], 
-0000e9d0: 6669 6773 697a 653d 2835 2c20 3529 2c20  figsize=(5, 5), 
-0000e9e0: 7361 7665 6669 673d 4661 6c73 6529 3a0a  savefig=False):.
-0000e9f0: 2020 2020 2020 2020 0a20 2020 2020 2020          .       
-0000ea00: 2022 2222 0a20 2020 2020 2020 2050 6c6f   """.        Plo
-0000ea10: 7420 5043 4120 666f 7220 6f6e 6520 6f72  t PCA for one or
-0000ea20: 206d 6f72 6520 6461 7461 7365 7473 2e0a   more datasets..
-0000ea30: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
-0000ea40: 6572 730a 2020 2020 2020 2020 2d2d 2d2d  ers.        ----
-0000ea50: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 206e  ------.        n
-0000ea60: 5f72 6f77 7320 3a20 696e 740a 2020 2020  _rows : int.    
-0000ea70: 2020 2020 2020 2020 204e 756d 6265 7220           Number 
-0000ea80: 6f66 2072 6f77 7320 696e 2073 7562 706c  of rows in subpl
-0000ea90: 6f74 2028 4465 6661 756c 7420 7661 6c75  ot (Default valu
-0000eaa0: 6520 3d20 3129 0a0a 2020 2020 2020 2020  e = 1)..        
-0000eab0: 6e5f 636f 6c73 203a 2069 6e74 0a20 2020  n_cols : int.   
-0000eac0: 2020 2020 2020 2020 2020 4e75 6d62 6572            Number
-0000ead0: 206f 6620 636f 6c75 6d73 6e20 696e 2073   of columsn in s
-0000eae0: 7562 706c 6f74 2028 4465 6661 756c 7420  ubplot (Default 
-0000eaf0: 7661 6c75 6520 3d20 3129 0a0a 2020 2020  value = 1)..    
-0000eb00: 2020 2020 7469 746c 6573 203a 206c 6973      titles : lis
-0000eb10: 740a 2020 2020 2020 2020 2020 2020 204c  t.             L
-0000eb20: 6973 7420 6f66 2074 6974 6c65 7320 2844  ist of titles (D
-0000eb30: 6566 6175 6c74 2076 616c 7565 203d 205b  efault value = [
-0000eb40: 2727 5d29 0a0a 2020 2020 2020 2020 6669  ''])..        fi
-0000eb50: 6773 697a 6520 3a20 7475 706c 650a 2020  gsize : tuple.  
-0000eb60: 2020 2020 2020 2020 2020 2046 6967 7572             Figur
-0000eb70: 6520 7369 7a65 2028 4465 6661 756c 7420  e size (Default 
-0000eb80: 7661 6c75 6520 3d20 2835 2c35 290a 2020  value = (5,5).  
-0000eb90: 2020 2020 2020 2020 2020 0a20 2020 2020            .     
-0000eba0: 2020 2073 6176 6566 6967 203a 2062 6f6f     savefig : boo
-0000ebb0: 6c0a 2020 2020 2020 2020 2020 2020 2049  l.             I
-0000ebc0: 6620 5472 7565 2c20 7361 7665 2066 6967  f True, save fig
-0000ebd0: 7572 6520 2844 6566 6175 6c74 2076 616c  ure (Default val
-0000ebe0: 7565 203d 2046 616c 7365 290a 0a20 2020  ue = False)..   
-0000ebf0: 2020 2020 2052 6574 7572 6e73 0a20 2020       Returns.   
-0000ec00: 2020 2020 202d 2d2d 2d2d 2d2d 0a20 2020       -------.   
-0000ec10: 2020 2020 206d 6174 706c 6f74 6c69 622e       matplotlib.
-0000ec20: 7079 706c 6f74 2e73 7562 706c 6f74 730a  pyplot.subplots.
-0000ec30: 2020 2020 2020 2020 2222 220a 0a20 2020          """..   
-0000ec40: 2020 2020 2069 6620 6e5f 726f 7773 203d       if n_rows =
-0000ec50: 3d20 3120 616e 6420 6e5f 636f 6c73 203d  = 1 and n_cols =
-0000ec60: 3d20 313a 0a20 2020 2020 2020 2020 2020  = 1:.           
-0000ec70: 2070 6361 5f64 6174 6120 3d20 5b73 656c   pca_data = [sel
-0000ec80: 662e 5f70 6361 2829 5d0a 0a20 2020 2020  f._pca()]..     
-0000ec90: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-0000eca0: 2020 2020 2070 6361 5f64 6174 6120 3d20       pca_data = 
-0000ecb0: 5b73 656c 662e 5f70 6361 2869 2920 666f  [self._pca(i) fo
-0000ecc0: 7220 6920 696e 2073 656c 662e 6461 7461  r i in self.data
-0000ecd0: 7365 7473 5d0a 0a20 2020 2020 2020 2066  sets]..        f
-0000ece0: 6967 2c20 6178 203d 2070 6c74 2e73 7562  ig, ax = plt.sub
-0000ecf0: 706c 6f74 7328 6e5f 726f 7773 2c20 6e5f  plots(n_rows, n_
-0000ed00: 636f 6c73 2c20 6669 6773 697a 653d 6669  cols, figsize=fi
-0000ed10: 6773 697a 6529 0a0a 2020 2020 2020 2020  gsize)..        
-0000ed20: 666f 7220 6461 7461 5f73 6574 2c20 6178  for data_set, ax
-0000ed30: 6573 2c20 7469 746c 6520 696e 207a 6970  es, title in zip
-0000ed40: 2870 6361 5f64 6174 612c 206e 702e 6172  (pca_data, np.ar
-0000ed50: 7261 7928 6178 292e 666c 6174 7465 6e28  ray(ax).flatten(
-0000ed60: 292c 2074 6974 6c65 7329 3a0a 2020 2020  ), titles):.    
-0000ed70: 2020 2020 2020 2020 736e 732e 7363 6174          sns.scat
-0000ed80: 7465 7270 6c6f 7428 6461 7461 3d64 6174  terplot(data=dat
-0000ed90: 615f 7365 745b 315d 2c20 783d 2770 7269  a_set[1], x='pri
-0000eda0: 6e63 6970 616c 2063 6f6d 706f 6e65 6e74  ncipal component
-0000edb0: 2031 272c 2079 3d27 7072 696e 6369 7061   1', y='principa
-0000edc0: 6c20 636f 6d70 6f6e 656e 7420 3227 2c20  l component 2', 
-0000edd0: 6875 653d 2774 6172 6765 7427 2c20 6178  hue='target', ax
-0000ede0: 3d61 7865 7329 0a20 2020 2020 2020 2020  =axes).         
-0000edf0: 2020 2070 6331 203d 2022 252e 3266 2220     pc1 = "%.2f" 
-0000ee00: 2520 2864 6174 615f 7365 745b 305d 2e65  % (data_set[0].e
-0000ee10: 7870 6c61 696e 6564 5f76 6172 6961 6e63  xplained_varianc
-0000ee20: 655f 7261 7469 6f5f 5b30 5d20 2a20 3130  e_ratio_[0] * 10
-0000ee30: 3029 0a20 2020 2020 2020 2020 2020 2070  0).            p
-0000ee40: 6332 203d 2022 252e 3266 2220 2520 2864  c2 = "%.2f" % (d
-0000ee50: 6174 615f 7365 745b 305d 2e65 7870 6c61  ata_set[0].expla
-0000ee60: 696e 6564 5f76 6172 6961 6e63 655f 7261  ined_variance_ra
-0000ee70: 7469 6f5f 5b31 5d20 2a20 3130 3029 0a20  tio_[1] * 100). 
-0000ee80: 2020 2020 2020 2020 2020 2061 7865 732e             axes.
-0000ee90: 7365 7428 786c 6162 656c 3d66 2750 4331  set(xlabel=f'PC1
-0000eea0: 207b 7063 317d 2527 2c20 796c 6162 656c   {pc1}%', ylabel
-0000eeb0: 3d66 2750 4332 207b 7063 327d 2527 290a  =f'PC2 {pc2}%').
-0000eec0: 2020 2020 2020 2020 2020 2020 6178 6573              axes
-0000eed0: 2e73 6574 5f74 6974 6c65 2874 6974 6c65  .set_title(title
-0000eee0: 290a 2020 2020 2020 2020 2020 2020 6178  ).            ax
-0000eef0: 6573 2e6c 6567 656e 6428 6c6f 633d 2762  es.legend(loc='b
-0000ef00: 6573 7427 290a 2020 2020 2020 2020 2020  est').          
-0000ef10: 2020 736e 732e 6465 7370 696e 6528 290a    sns.despine().
-0000ef20: 0a20 2020 2020 2020 2066 6967 2e74 6967  .        fig.tig
-0000ef30: 6874 5f6c 6179 6f75 7428 290a 0a20 2020  ht_layout()..   
-0000ef40: 2020 2020 2069 6620 7361 7665 6669 673a       if savefig:
-0000ef50: 0a20 2020 2020 2020 2020 2020 2066 6967  .            fig
-0000ef60: 2e73 6176 6566 6967 2827 7063 615f 706c  .savefig('pca_pl
-0000ef70: 6f74 732e 7064 6627 2c20 6262 6f78 5f69  ots.pdf', bbox_i
-0000ef80: 6e63 6865 733d 2774 6967 6874 272c 2074  nches='tight', t
-0000ef90: 7261 6e73 7061 7265 6e74 3d54 7275 6529  ransparent=True)
-0000efa0: 0a20 2020 200a 2020 2020 6465 6620 696e  .    .    def in
-0000efb0: 745f 7063 615f 706c 6f74 2873 656c 662c  t_pca_plot(self,
-0000efc0: 206e 5f72 6f77 733d 312c 206e 5f63 6f6c   n_rows=1, n_col
-0000efd0: 733d 312c 2074 6974 6c65 733d 5b27 275d  s=1, titles=['']
-0000efe0: 2c20 6865 6967 6874 3d35 3030 2c20 7769  , height=500, wi
-0000eff0: 6474 683d 3730 3029 3a0a 0a20 2020 2020  dth=700):..     
-0000f000: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-0000f010: 2020 2050 6c6f 7420 696e 7465 7261 6374     Plot interact
-0000f020: 6976 6520 5043 4120 666f 7220 6f6e 6520  ive PCA for one 
-0000f030: 6f72 206d 6f72 6520 6461 7461 7365 7473  or more datasets
-0000f040: 2e0a 2020 2020 2020 2020 2020 5061 7261  ..          Para
-0000f050: 6d65 7465 7273 0a20 2020 2020 2020 2020  meters.         
-0000f060: 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020   ----------.    
-0000f070: 2020 2020 2020 6e5f 726f 7773 203a 2069        n_rows : i
-0000f080: 6e74 0a20 2020 2020 2020 2020 2020 2020  nt.             
-0000f090: 2020 4e75 6d62 6572 206f 6620 726f 7773    Number of rows
-0000f0a0: 2069 6e20 7375 6270 6c6f 7420 2844 6566   in subplot (Def
-0000f0b0: 6175 6c74 2076 616c 7565 203d 2031 290a  ault value = 1).
-0000f0c0: 0a20 2020 2020 2020 2020 206e 5f63 6f6c  .          n_col
-0000f0d0: 7320 3a20 696e 740a 2020 2020 2020 2020  s : int.        
-0000f0e0: 2020 2020 2020 204e 756d 6265 7220 6f66         Number of
-0000f0f0: 2063 6f6c 756d 6e73 2069 6e20 7375 6270   columns in subp
-0000f100: 6c6f 7420 2844 6566 6175 6c74 2076 616c  lot (Default val
-0000f110: 7565 203d 2031 290a 0a20 2020 2020 2020  ue = 1)..       
-0000f120: 2020 2074 6974 6c65 7320 3a20 6c69 7374     titles : list
-0000f130: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000f140: 4c69 7374 206f 6620 7469 746c 6573 2066  List of titles f
-0000f150: 6f72 2073 7562 706c 6f74 2028 4465 6661  or subplot (Defa
-0000f160: 756c 7420 7661 6c75 6520 3d20 5b27 275d  ult value = ['']
-0000f170: 290a 0a20 2020 2020 2020 2020 2068 6569  )..          hei
-0000f180: 6768 7420 3a20 696e 740a 2020 2020 2020  ght : int.      
-0000f190: 2020 2020 2020 2020 2028 4465 6661 756c           (Defaul
-0000f1a0: 7420 7661 6c75 6520 3d20 3530 3029 0a0a  t value = 500)..
-0000f1b0: 2020 2020 2020 2020 2020 7769 6474 6820            width 
-0000f1c0: 3a20 696e 740a 2020 2020 2020 2020 2020  : int.          
-0000f1d0: 2020 2020 2028 4465 6661 756c 7420 7661       (Default va
-0000f1e0: 6c75 6520 3d20 3730 3029 0a0a 2020 2020  lue = 700)..    
-0000f1f0: 2020 2020 2020 5265 7475 726e 730a 2020        Returns.  
-0000f200: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d0a          -------.
-0000f210: 2020 2020 2020 2020 2020 706c 6f74 6c79            plotly
-0000f220: 2e73 7562 706c 6f74 732e 6d61 6b65 5f73  .subplots.make_s
-0000f230: 7562 706c 6f74 730a 2020 2020 2020 2020  ubplots.        
-0000f240: 2020 2222 220a 0a20 2020 2020 2020 2020    """..         
-0000f250: 2069 6620 6e5f 726f 7773 203d 3d20 3120   if n_rows == 1 
-0000f260: 616e 6420 6e5f 636f 6c73 203d 3d20 313a  and n_cols == 1:
-0000f270: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000f280: 7063 615f 6461 7461 203d 205b 7365 6c66  pca_data = [self
-0000f290: 2e5f 7063 6128 295b 315d 5d0a 2020 2020  ._pca()[1]].    
-0000f2a0: 2020 2020 2020 2020 2020 2070 6361 203d             pca =
-0000f2b0: 205b 7365 6c66 2e5f 7063 6128 295b 305d   [self._pca()[0]
-0000f2c0: 5d0a 0a20 2020 2020 2020 2020 2065 6c73  ]..          els
-0000f2d0: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-0000f2e0: 2020 7063 615f 6461 7461 203d 205b 7365    pca_data = [se
-0000f2f0: 6c66 2e5f 7063 6128 6929 5b31 5d20 666f  lf._pca(i)[1] fo
-0000f300: 7220 6920 696e 2073 656c 662e 6461 7461  r i in self.data
-0000f310: 7365 7473 5d0a 2020 2020 2020 2020 2020  sets].          
-0000f320: 2020 2020 2070 6361 203d 205b 7365 6c66       pca = [self
-0000f330: 2e5f 7063 6128 6929 5b30 5d20 666f 7220  ._pca(i)[0] for 
-0000f340: 6920 696e 2073 656c 662e 6461 7461 7365  i in self.datase
-0000f350: 7473 5d0a 0a20 2020 2020 2020 2020 2066  ts]..          f
-0000f360: 6f72 2069 2069 6e20 7063 615f 6461 7461  or i in pca_data
-0000f370: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0000f380: 2069 5b27 6964 7827 5d20 3d20 692e 696e   i['idx'] = i.in
-0000f390: 6465 780a 0a20 2020 2020 2020 2020 2023  dex..          #
-0000f3a0: 2070 6c6f 7473 203d 205b 7078 2e73 6361   plots = [px.sca
-0000f3b0: 7474 6572 2864 6174 6173 6574 2c20 783d  tter(dataset, x=
-0000f3c0: 2270 7269 6e63 6970 616c 2063 6f6d 706f  "principal compo
-0000f3d0: 6e65 6e74 2031 222c 2079 3d22 7072 696e  nent 1", y="prin
-0000f3e0: 6369 7061 6c20 636f 6d70 6f6e 656e 7420  cipal component 
-0000f3f0: 3222 2c20 0a20 2020 2020 2020 2020 2023  2", .          #
-0000f400: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f410: 2020 2020 2063 6f6c 6f72 3d22 7461 7267       color="targ
-0000f420: 6574 222c 2068 6f76 6572 5f64 6174 613d  et", hover_data=
-0000f430: 5b27 6964 7827 5d2c 2074 656d 706c 6174  ['idx'], templat
-0000f440: 653d 2773 696d 706c 655f 7768 6974 6527  e='simple_white'
-0000f450: 2920 666f 7220 6461 7461 7365 7420 696e  ) for dataset in
-0000f460: 2070 6361 5f64 6174 615d 0a0a 2020 2020   pca_data]..    
-0000f470: 2020 2020 2020 706c 6f74 7320 3d20 5b5d        plots = []
-0000f480: 0a0a 2020 2020 2020 2020 2020 6669 6720  ..          fig 
-0000f490: 3d20 6d61 6b65 5f73 7562 706c 6f74 7328  = make_subplots(
-0000f4a0: 726f 7773 3d6e 5f72 6f77 732c 2063 6f6c  rows=n_rows, col
-0000f4b0: 733d 6e5f 636f 6c73 2c20 7375 6270 6c6f  s=n_cols, subplo
-0000f4c0: 745f 7469 746c 6573 3d74 6974 6c65 7329  t_titles=titles)
-0000f4d0: 0a20 2020 2020 2020 2020 200a 2020 2020  .          .    
-0000f4e0: 2020 2020 2020 666f 7220 6461 7461 7365        for datase
-0000f4f0: 742c 2070 6361 5f63 6f6d 7020 696e 207a  t, pca_comp in z
-0000f500: 6970 2870 6361 5f64 6174 612c 2070 6361  ip(pca_data, pca
-0000f510: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-0000f520: 2020 706c 6f74 203d 2070 782e 7363 6174    plot = px.scat
-0000f530: 7465 7228 6461 7461 7365 742c 2078 3d22  ter(dataset, x="
-0000f540: 7072 696e 6369 7061 6c20 636f 6d70 6f6e  principal compon
-0000f550: 656e 7420 3122 2c20 793d 2270 7269 6e63  ent 1", y="princ
-0000f560: 6970 616c 2063 6f6d 706f 6e65 6e74 2032  ipal component 2
-0000f570: 222c 200a 2020 2020 2020 2020 2020 2020  ", .            
-0000f580: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f590: 2020 636f 6c6f 723d 2274 6172 6765 7422    color="target"
-0000f5a0: 2c20 686f 7665 725f 6461 7461 3d5b 2769  , hover_data=['i
-0000f5b0: 6478 275d 2c20 7465 6d70 6c61 7465 3d27  dx'], template='
-0000f5c0: 7369 6d70 6c65 5f77 6869 7465 2729 0a20  simple_white'). 
-0000f5d0: 2020 2020 2020 2020 2020 2020 2020 0a20                . 
-0000f5e0: 2020 2020 2020 2020 2020 2020 2020 2320                # 
-0000f5f0: 4361 6c63 756c 6174 6520 6578 706c 6169  Calculate explai
-0000f600: 6e65 6420 7661 7269 616e 6365 2066 6f72  ned variance for
-0000f610: 2050 4331 2061 6e64 2050 4332 0a20 2020   PC1 and PC2.   
-0000f620: 2020 2020 2020 2020 2020 2020 7063 315f              pc1_
-0000f630: 6569 6765 6e76 616c 7565 203d 2022 252e  eigenvalue = "%.
-0000f640: 3266 2220 2520 2870 6361 5f63 6f6d 702e  2f" % (pca_comp.
-0000f650: 6578 706c 6169 6e65 645f 7661 7269 616e  explained_varian
-0000f660: 6365 5f72 6174 696f 5f5b 305d 202a 2031  ce_ratio_[0] * 1
-0000f670: 3030 290a 2020 2020 2020 2020 2020 2020  00).            
-0000f680: 2020 2070 6332 5f65 6967 656e 7661 6c75     pc2_eigenvalu
-0000f690: 6520 3d20 2225 2e32 6622 2025 2028 7063  e = "%.2f" % (pc
-0000f6a0: 615f 636f 6d70 2e65 7870 6c61 696e 6564  a_comp.explained
-0000f6b0: 5f76 6172 6961 6e63 655f 7261 7469 6f5f  _variance_ratio_
-0000f6c0: 5b31 5d20 2a20 3130 3029 0a20 2020 2020  [1] * 100).     
-0000f6d0: 2020 2020 2020 2020 2020 0a20 2020 2020            .     
-0000f6e0: 2020 2020 2020 2020 2020 2320 5570 6461            # Upda
-0000f6f0: 7465 2070 6c6f 7420 6178 6573 2074 6974  te plot axes tit
-0000f700: 6c65 730a 2020 2020 2020 2020 2020 2020  les.            
-0000f710: 2020 2066 6967 2e75 7064 6174 655f 7861     fig.update_xa
-0000f720: 7865 7328 7469 746c 655f 7465 7874 3d66  xes(title_text=f
-0000f730: 2750 4331 207b 7063 315f 6569 6765 6e76  'PC1 {pc1_eigenv
-0000f740: 616c 7565 7d20 2527 290a 2020 2020 2020  alue} %').      
-0000f750: 2020 2020 2020 2020 2066 6967 2e75 7064           fig.upd
-0000f760: 6174 655f 7961 7865 7328 7469 746c 655f  ate_yaxes(title_
-0000f770: 7465 7874 3d66 2750 4332 207b 7063 325f  text=f'PC2 {pc2_
-0000f780: 6569 6765 6e76 616c 7565 7d20 2527 290a  eigenvalue} %').
-0000f790: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000f7a0: 706c 6f74 732e 6170 7065 6e64 2870 6c6f  plots.append(plo
-0000f7b0: 7429 0a0a 2020 2020 2020 2020 2020 726f  t)..          ro
-0000f7c0: 775f 636f 6c5f 6e75 6d62 6572 203d 205b  w_col_number = [
-0000f7d0: 2869 2c20 6a29 2066 6f72 2069 2069 6e20  (i, j) for i in 
-0000f7e0: 7261 6e67 6528 312c 206e 5f72 6f77 732b  range(1, n_rows+
-0000f7f0: 3129 2066 6f72 206a 2069 6e20 7261 6e67  1) for j in rang
-0000f800: 6528 312c 206e 5f63 6f6c 732b 3129 5d0a  e(1, n_cols+1)].
-0000f810: 0a20 2020 2020 2020 2020 2066 6f72 2070  .          for p
-0000f820: 6c6f 742c 2072 6f77 5f63 6f6c 2069 6e20  lot, row_col in 
-0000f830: 7a69 7028 706c 6f74 732c 2072 6f77 5f63  zip(plots, row_c
-0000f840: 6f6c 5f6e 756d 6265 7229 3a0a 2020 2020  ol_number):.    
-0000f850: 2020 2020 2020 2020 2020 2066 6f72 2069             for i
-0000f860: 6478 2069 6e20 7261 6e67 6528 6c65 6e28  dx in range(len(
-0000f870: 706c 6f74 5b27 6461 7461 275d 2929 3a0a  plot['data'])):.
-0000f880: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f890: 2020 2020 6669 672e 6170 7065 6e64 5f74      fig.append_t
-0000f8a0: 7261 6365 2870 6c6f 745b 2764 6174 6127  race(plot['data'
-0000f8b0: 5d5b 6964 785d 2c20 726f 773d 726f 775f  ][idx], row=row_
-0000f8c0: 636f 6c5b 305d 2c20 636f 6c3d 726f 775f  col[0], col=row_
-0000f8d0: 636f 6c5b 315d 290a 0a20 2020 2020 2020  col[1])..       
-0000f8e0: 2020 2066 6967 2e75 7064 6174 655f 6c61     fig.update_la
-0000f8f0: 796f 7574 2868 6569 6768 743d 6865 6967  yout(height=heig
-0000f900: 6874 2c20 7769 6474 683d 7769 6474 682c  ht, width=width,
-0000f910: 2074 656d 706c 6174 653d 2773 696d 706c   template='simpl
-0000f920: 655f 7768 6974 6527 290a 2020 2020 2020  e_white').      
-0000f930: 2020 2020 6669 672e 7570 6461 7465 5f74      fig.update_t
-0000f940: 7261 6365 7328 6d61 726b 6572 3d64 6963  races(marker=dic
-0000f950: 7428 7369 7a65 3d31 322c 0a20 2020 2020  t(size=12,.     
-0000f960: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f970: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f980: 2020 206c 696e 653d 6469 6374 2877 6964     line=dict(wid
-0000f990: 7468 3d32 2c0a 2020 2020 2020 2020 2020  th=2,.          
-0000f9a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f9b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f9c0: 2020 2020 2020 2020 636f 6c6f 723d 2744          color='D
-0000f9d0: 6172 6b53 6c61 7465 4772 6579 2729 292c  arkSlateGrey')),
-0000f9e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000f9f0: 2020 2020 2020 2020 2020 7365 6c65 6374            select
-0000fa00: 6f72 3d64 6963 7428 6d6f 6465 3d27 6d61  or=dict(mode='ma
-0000fa10: 726b 6572 7327 2929 0a0a 2020 2020 2020  rkers'))..      
-0000fa20: 2020 2020 2320 5368 6f77 2074 6865 2070      # Show the p
-0000fa30: 6c6f 7420 2020 2020 2020 2020 200a 2020  lot          .  
-0000fa40: 2020 2020 2020 2020 6966 2069 735f 6a75          if is_ju
-0000fa50: 7079 7465 725f 6e6f 7465 626f 6f6b 2829  pyter_notebook()
-0000fa60: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0000fa70: 2066 6967 2e73 686f 7728 290a 2020 2020   fig.show().    
-0000fa80: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-0000fa90: 2020 2020 2020 2020 2020 2073 742e 706c             st.pl
-0000faa0: 6f74 6c79 5f63 6861 7274 2866 6967 2c20  otly_chart(fig, 
-0000fab0: 7573 655f 636f 6e74 6169 6e65 725f 7769  use_container_wi
-0000fac0: 6474 683d 5472 7565 290a 0a20 2020 2064  dth=True)..    d
-0000fad0: 6566 2074 6f70 5f6c 6f61 6469 6e67 7328  ef top_loadings(
-0000fae0: 7365 6c66 2c20 6b29 3a0a 2020 2020 2020  self, k):.      
-0000faf0: 2020 0a20 2020 2020 2020 2022 2222 0a20    .        """. 
-0000fb00: 2020 2020 2020 2047 6574 206b 2066 6561         Get k fea
-0000fb10: 7475 7265 7320 7468 6174 2065 7870 6c61  tures that expla
-0000fb20: 696e 206d 6f73 7420 6f66 2076 6172 6961  in most of varia
-0000fb30: 6e63 6520 696e 2050 4331 2026 2032 0a0a  nce in PC1 & 2..
-0000fb40: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
-0000fb50: 7273 0a20 2020 2020 2020 202d 2d2d 2d2d  rs.        -----
-0000fb60: 2d2d 2d2d 2d0a 2020 2020 2020 2020 6b20  -----.        k 
-0000fb70: 3a20 696e 740a 2020 2020 2020 2020 2020  : int.          
-0000fb80: 2020 4e75 6d62 6572 206f 6620 6d6f 7374    Number of most
-0000fb90: 2069 6d70 6f72 7461 6e74 2066 6561 7475   important featu
-0000fba0: 7265 7320 746f 2072 6574 7572 6e0a 0a20  res to return.. 
-0000fbb0: 2020 2020 2020 2052 6574 7572 6e73 0a20         Returns. 
-0000fbc0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 0a20         -------. 
-0000fbd0: 2020 2020 2020 2074 6f70 203a 206e 756d         top : num
-0000fbe0: 7079 2e6e 6461 7272 6179 0a20 2020 2020  py.ndarray.     
-0000fbf0: 2020 2020 2020 2041 7272 6179 206f 6620         Array of 
-0000fc00: 746f 7020 6b20 6665 6174 7572 6573 0a20  top k features. 
-0000fc10: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-0000fc20: 2020 200a 2020 2020 2020 2020 5820 3d20     .        X = 
-0000fc30: 6e70 2e61 7272 6179 2873 656c 662e 6461  np.array(self.da
-0000fc40: 7461 2e73 656c 6563 745f 6474 7970 6573  ta.select_dtypes
-0000fc50: 2827 666c 6f61 7427 292e 5429 0a0a 2020  ('float').T)..  
-0000fc60: 2020 2020 2020 2320 616e 616c 7973 6973        # analysis
-0000fc70: 0a20 2020 2020 2020 2058 5f73 6361 6c65  .        X_scale
-0000fc80: 6420 3d20 5374 616e 6461 7264 5363 616c  d = StandardScal
-0000fc90: 6572 2829 2e66 6974 5f74 7261 6e73 666f  er().fit_transfo
-0000fca0: 726d 2858 290a 2020 2020 2020 2020 7063  rm(X).        pc
-0000fcb0: 6120 3d20 5043 4128 6e5f 636f 6d70 6f6e  a = PCA(n_compon
-0000fcc0: 656e 7473 3d32 292e 6669 7428 585f 7363  ents=2).fit(X_sc
-0000fcd0: 616c 6564 2920 2020 2020 2020 200a 0a20  aled)        .. 
-0000fce0: 2020 2020 2020 2023 2072 6573 756c 7473         # results
-0000fcf0: 0a20 2020 2020 2020 206c 6f61 6469 6e67  .        loading
-0000fd00: 203d 2070 6361 2e63 6f6d 706f 6e65 6e74   = pca.component
-0000fd10: 735f 2e54 0a20 2020 2020 2020 2020 2020  s_.T.           
-0000fd20: 2020 2020 2020 2020 200a 2020 2020 2020           .      
-0000fd30: 2020 746f 7078 203d 2028 6c6f 6164 696e    topx = (loadin
-0000fd40: 6720 2a2a 2032 295b 3a2c 2030 5d2e 6172  g ** 2)[:, 0].ar
-0000fd50: 6773 6f72 7428 295b 2d6b 3a5d 0a20 2020  gsort()[-k:].   
-0000fd60: 2020 2020 2074 6f70 7920 3d20 286c 6f61       topy = (loa
-0000fd70: 6469 6e67 202a 2a20 3229 5b3a 2c20 315d  ding ** 2)[:, 1]
-0000fd80: 2e61 7267 736f 7274 2829 5b2d 6b3a 5d0a  .argsort()[-k:].
-0000fd90: 2020 2020 2020 2020 746f 7020 3d20 6e70          top = np
-0000fda0: 2e61 7070 656e 6428 746f 7078 2c20 746f  .append(topx, to
-0000fdb0: 7079 290a 2020 2020 2020 2020 0a20 2020  py).        .   
-0000fdc0: 2020 2020 2072 6574 7572 6e20 746f 700a       return top.
-0000fdd0: 2020 2020 0a20 2020 2064 6566 206d 696e      .    def min
-0000fde0: 5f76 6172 5f74 6f70 5f6c 6f61 6469 6e67  _var_top_loading
-0000fdf0: 7328 7365 6c66 2c20 6b2c 2076 6172 6961  s(self, k, varia
-0000fe00: 6e63 6529 3a0a 0a20 2020 2020 2020 2022  nce):..        "
-0000fe10: 2222 0a20 2020 2020 2020 2047 6574 206b  "".        Get k
-0000fe20: 2066 6561 7475 7265 7320 7468 6174 2065   features that e
-0000fe30: 7870 6c61 696e 206d 6f73 7420 6f66 2076  xplain most of v
-0000fe40: 6172 6961 6e63 650a 0a20 2020 2020 2020  ariance..       
-0000fe50: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
-0000fe60: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20      ----------. 
-0000fe70: 2020 2020 2020 206b 203a 2069 6e74 0a20         k : int. 
-0000fe80: 2020 2020 2020 2020 2020 204e 756d 6265             Numbe
-0000fe90: 7220 6f66 206d 6f73 7420 696d 706f 7274  r of most import
-0000fea0: 616e 7420 6665 6174 7572 6573 2074 6f20  ant features to 
-0000feb0: 7265 7475 726e 0a0a 2020 2020 2020 2020  return..        
-0000fec0: 7661 7269 616e 6365 203a 2066 6c6f 6174  variance : float
-0000fed0: 0a20 2020 2020 2020 2020 2020 204d 696e  .            Min
-0000fee0: 696d 756d 2076 6172 6961 6e63 650a 0a20  imum variance.. 
-0000fef0: 2020 2020 2020 2052 6574 7572 6e73 0a20         Returns. 
-0000ff00: 2020 2020 2020 202d 2d2d 2d2d 2d2d 0a20         -------. 
-0000ff10: 2020 2020 2020 2074 6f70 5f66 6561 7475         top_featu
-0000ff20: 7265 7320 3a20 6c69 7374 0a20 2020 2020  res : list.     
-0000ff30: 2020 2020 2020 204c 6973 7420 6f66 2074         List of t
-0000ff40: 6f70 206b 2066 6561 7475 7265 7320 7468  op k features th
-0000ff50: 6174 2065 7870 6c61 696e 206d 6f73 7420  at explain most 
-0000ff60: 6f66 2076 6172 6961 6e63 6520 696e 2050  of variance in P
-0000ff70: 430a 2020 2020 2020 2020 2222 220a 0a20  C.        """.. 
-0000ff80: 2020 2020 2020 2066 6c6f 6174 5f64 6174         float_dat
-0000ff90: 6120 3d20 7365 6c66 2e64 6174 612e 7365  a = self.data.se
-0000ffa0: 6c65 6374 5f64 7479 7065 7328 2766 6c6f  lect_dtypes('flo
-0000ffb0: 6174 2729 2e54 0a20 2020 2020 2020 2066  at').T.        f
-0000ffc0: 6c6f 6174 5f64 6174 6120 3d20 5374 616e  loat_data = Stan
-0000ffd0: 6461 7264 5363 616c 6572 2829 2e66 6974  dardScaler().fit
-0000ffe0: 5f74 7261 6e73 666f 726d 2866 6c6f 6174  _transform(float
-0000fff0: 5f64 6174 6129 0a0a 2020 2020 2020 2020  _data)..        
-00010000: 7063 615f 7769 7468 5f76 6172 6961 6e63  pca_with_varianc
-00010010: 6520 3d20 5043 4128 6e5f 636f 6d70 6f6e  e = PCA(n_compon
-00010020: 656e 7473 3d76 6172 6961 6e63 6529 2e66  ents=variance).f
-00010030: 6974 2866 6c6f 6174 5f64 6174 6129 0a0a  it(float_data)..
-00010040: 2020 2020 2020 2020 6c6f 6164 696e 6720          loading 
-00010050: 3d20 7063 615f 7769 7468 5f76 6172 6961  = pca_with_varia
-00010060: 6e63 652e 636f 6d70 6f6e 656e 7473 5f2e  nce.components_.
-00010070: 540a 0a20 2020 2020 2020 2074 6f70 5f66  T..        top_f
-00010080: 6561 7475 7265 7320 3d20 5b6e 702e 6162  eatures = [np.ab
-00010090: 7328 6c6f 6164 696e 6729 5b3a 2c20 636f  s(loading)[:, co
-000100a0: 6d70 6f6e 656e 745d 2e61 7267 736f 7274  mponent].argsort
-000100b0: 2829 5b2d 6b3a 5d20 666f 7220 636f 6d70  ()[-k:] for comp
-000100c0: 6f6e 656e 7420 696e 2072 616e 6765 286c  onent in range(l
-000100d0: 6f61 6469 6e67 2e73 6861 7065 5b31 5d29  oading.shape[1])
-000100e0: 5d0a 0a20 2020 2020 2020 2074 6f70 5f66  ]..        top_f
-000100f0: 6561 7475 7265 7320 3d20 5b76 616c 7565  eatures = [value
-00010100: 2066 6f72 2074 6f70 5f66 6561 7475 7265   for top_feature
-00010110: 2069 6e20 746f 705f 6665 6174 7572 6573   in top_features
-00010120: 2066 6f72 2076 616c 7565 2069 6e20 746f   for value in to
-00010130: 705f 6665 6174 7572 655d 0a0a 2020 2020  p_feature]..    
-00010140: 2020 2020 7265 7475 726e 2074 6f70 5f66      return top_f
-00010150: 6561 7475 7265 730a 0a20 2020 2064 6566  eatures..    def
-00010160: 2062 6970 6c6f 7428 7365 6c66 2c20 6b3d   biplot(self, k=
-00010170: 352c 206e 5f72 6f77 733d 312c 206e 5f63  5, n_rows=1, n_c
-00010180: 6f6c 733d 312c 2074 6974 6c65 733d 5b27  ols=1, titles=['
-00010190: 275d 2c20 6669 6773 697a 653d 2838 2c33  '], figsize=(8,3
-000101a0: 292c 2073 6176 6566 6967 3d46 616c 7365  ), savefig=False
-000101b0: 293a 0a0a 2020 2020 2020 2020 2222 220a  ):..        """.
-000101c0: 2020 2020 2020 2020 506c 6f74 2062 6970          Plot bip
-000101d0: 6c6f 7420 666f 7220 6f6e 6520 6f72 206d  lot for one or m
-000101e0: 6f72 6520 6461 7461 7365 7473 2e0a 0a20  ore datasets... 
-000101f0: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
-00010200: 730a 2020 2020 2020 2020 2d2d 2d2d 2d2d  s.        ------
-00010210: 2d2d 2d2d 0a20 2020 2020 2020 206b 203a  ----.        k :
-00010220: 2069 6e74 0a20 2020 2020 2020 2020 2020   int.           
-00010230: 2020 4e75 6d62 6572 206f 6620 746f 7020    Number of top 
-00010240: 6c6f 6164 696e 6773 2074 6f20 706c 6f74  loadings to plot
-00010250: 2028 4465 6661 756c 7420 7661 6c75 6520   (Default value 
-00010260: 3d20 3529 0a20 2020 2020 2020 200a 2020  = 5).        .  
-00010270: 2020 2020 2020 6e5f 726f 7773 203a 2069        n_rows : i
-00010280: 6e74 0a20 2020 2020 2020 2020 2020 2020  nt.             
-00010290: 4e75 6d62 6572 206f 6620 726f 7773 2069  Number of rows i
-000102a0: 6e20 7375 6270 6c6f 7420 2844 6566 6175  n subplot (Defau
-000102b0: 6c74 2076 616c 7565 203d 2031 290a 2020  lt value = 1).  
-000102c0: 2020 2020 200a 2020 2020 2020 2020 6e5f       .        n_
-000102d0: 636f 6c73 203a 2069 6e74 0a20 2020 2020  cols : int.     
-000102e0: 2020 2020 2020 2020 4e75 6d62 6572 206f          Number o
-000102f0: 6620 636f 6c75 6d6e 7320 696e 2073 7562  f columns in sub
-00010300: 706c 6f74 2028 4465 6661 756c 7420 7661  plot (Default va
-00010310: 6c75 6520 3d20 3129 0a20 2020 2020 2020  lue = 1).       
-00010320: 200a 2020 2020 2020 2020 7469 746c 6573   .        titles
-00010330: 203a 206c 6973 740a 2020 2020 2020 2020   : list.        
-00010340: 2020 2020 204c 6973 7420 6f66 2074 6974       List of tit
-00010350: 6c65 7320 2844 6566 6175 6c74 2076 616c  les (Default val
-00010360: 7565 203d 205b 2727 5d29 0a20 2020 2020  ue = ['']).     
-00010370: 2020 200a 2020 2020 2020 2020 6669 6773     .        figs
-00010380: 697a 6520 3a20 7475 706c 650a 2020 2020  ize : tuple.    
-00010390: 2020 2020 2020 2020 2046 6967 7572 6520           Figure 
-000103a0: 7369 7a65 2028 4465 6661 756c 7420 7661  size (Default va
-000103b0: 6c75 6520 3d20 2838 2c20 3329 0a20 2020  lue = (8, 3).   
-000103c0: 2020 2020 2020 2020 200a 2020 2020 2020           .      
-000103d0: 2020 7361 7665 6669 6720 3a20 626f 6f6c    savefig : bool
-000103e0: 0a20 2020 2020 2020 2020 2020 2020 4966  .             If
-000103f0: 2054 7275 6520 7361 7665 2066 6967 7572   True save figur
-00010400: 6520 2844 6566 6175 6c74 2076 616c 7565  e (Default value
-00010410: 203d 2046 616c 7365 290a 0a20 2020 2020   = False)..     
-00010420: 2020 2052 6574 7572 6e73 0a20 2020 2020     Returns.     
-00010430: 2020 202d 2d2d 2d2d 2d2d 0a20 2020 2020     -------.     
-00010440: 2020 206d 6174 706c 6f74 6c69 622e 7079     matplotlib.py
-00010450: 706c 6f74 0a20 2020 2020 2020 2022 2222  plot.        """
-00010460: 0a20 2020 2020 2020 200a 2020 2020 2020  .        .      
-00010470: 2020 7461 7267 6574 7320 3d20 5b5d 0a20    targets = []. 
-00010480: 2020 2020 2020 2066 6561 7475 7265 7320         features 
-00010490: 3d20 5b5d 0a20 2020 2020 2020 2073 636f  = [].        sco
-000104a0: 7265 7320 3d20 5b5d 0a20 2020 2020 2020  res = [].       
-000104b0: 2070 7661 7273 203d 205b 5d0a 2020 2020   pvars = [].    
-000104c0: 2020 2020 746f 7073 203d 205b 5d0a 2020      tops = [].  
-000104d0: 2020 2020 2020 6172 726f 7773 203d 205b        arrows = [
-000104e0: 5d0a 0a20 2020 2020 2020 2069 6620 6e5f  ]..        if n_
-000104f0: 726f 7773 203d 3d20 3120 616e 6420 6e5f  rows == 1 and n_
-00010500: 636f 6c73 203d 3d20 313a 0a20 2020 2020  cols == 1:.     
-00010510: 2020 2020 2020 2064 6174 6173 6574 7320         datasets 
-00010520: 3d20 5b73 656c 662e 6461 7461 5d0a 0a20  = [self.data].. 
-00010530: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-00010540: 2020 2020 2020 2020 2064 6174 6173 6574           dataset
-00010550: 7320 3d20 7365 6c66 2e64 6174 6173 6574  s = self.dataset
-00010560: 732e 636f 7079 2829 0a0a 2020 2020 2020  s.copy()..      
-00010570: 2020 666f 7220 6461 7461 2069 6e20 6461    for data in da
-00010580: 7461 7365 7473 3a0a 0a20 2020 2020 2020  tasets:..       
-00010590: 2020 2020 2023 2064 6174 610a 2020 2020       # data.    
-000105a0: 2020 2020 2020 2020 5820 3d20 6e70 2e61          X = np.a
-000105b0: 7272 6179 2864 6174 612e 7365 6c65 6374  rray(data.select
-000105c0: 5f64 7479 7065 7328 2766 6c6f 6174 2729  _dtypes('float')
-000105d0: 2e54 290a 2020 2020 2020 2020 2020 2020  .T).            
-000105e0: 7461 7267 6574 203d 2064 6174 612e 7365  target = data.se
-000105f0: 6c65 6374 5f64 7479 7065 7328 2766 6c6f  lect_dtypes('flo
-00010600: 6174 2729 2e63 6f6c 756d 6e73 2e74 6f5f  at').columns.to_
-00010610: 6c69 7374 2829 0a20 2020 2020 2020 2020  list().         
-00010620: 2020 2066 6561 7475 7265 203d 2064 6174     feature = dat
-00010630: 615b 2747 656e 6573 275d 2e74 6f5f 6c69  a['Genes'].to_li
-00010640: 7374 2829 0a0a 2020 2020 2020 2020 2020  st()..          
-00010650: 2020 2320 616e 616c 7973 6973 0a20 2020    # analysis.   
-00010660: 2020 2020 2020 2020 2058 5f73 6361 6c65           X_scale
-00010670: 6420 3d20 5374 616e 6461 7264 5363 616c  d = StandardScal
-00010680: 6572 2829 2e66 6974 5f74 7261 6e73 666f  er().fit_transfo
-00010690: 726d 2858 290a 2020 2020 2020 2020 2020  rm(X).          
-000106a0: 2020 7063 6120 3d20 5043 4128 6e5f 636f    pca = PCA(n_co
-000106b0: 6d70 6f6e 656e 7473 3d32 292e 6669 7428  mponents=2).fit(
-000106c0: 585f 7363 616c 6564 290a 2020 2020 2020  X_scaled).      
-000106d0: 2020 2020 2020 585f 7265 6475 6365 6420        X_reduced 
-000106e0: 3d20 7063 612e 7472 616e 7366 6f72 6d28  = pca.transform(
-000106f0: 585f 7363 616c 6564 290a 0a20 2020 2020  X_scaled)..     
-00010700: 2020 2020 2020 2023 2072 6573 756c 7473         # results
-00010710: 0a20 2020 2020 2020 2020 2020 2073 636f  .            sco
-00010720: 7265 203d 2058 5f72 6564 7563 6564 5b3a  re = X_reduced[:
-00010730: 2c20 3a32 5d0a 2020 2020 2020 2020 2020  , :2].          
-00010740: 2020 6c6f 6164 696e 6720 3d20 7063 612e    loading = pca.
-00010750: 636f 6d70 6f6e 656e 7473 5f5b 3a32 5d2e  components_[:2].
-00010760: 540a 2020 2020 2020 2020 2020 2020 7076  T.            pv
-00010770: 6172 203d 2070 6361 2e65 7870 6c61 696e  ar = pca.explain
-00010780: 6564 5f76 6172 6961 6e63 655f 7261 7469  ed_variance_rati
-00010790: 6f5f 5b3a 325d 202a 2031 3030 0a20 2020  o_[:2] * 100.   
-000107a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000107b0: 200a 2020 2020 2020 2020 2020 2020 746f   .            to
-000107c0: 7078 203d 2028 6c6f 6164 696e 6720 2a2a  px = (loading **
-000107d0: 2032 295b 3a2c 2030 5d2e 6172 6773 6f72   2)[:, 0].argsor
-000107e0: 7428 295b 2d6b 3a5d 0a20 2020 2020 2020  t()[-k:].       
-000107f0: 2020 2020 2074 6f70 7920 3d20 286c 6f61       topy = (loa
-00010800: 6469 6e67 202a 2a20 3229 5b3a 2c20 315d  ding ** 2)[:, 1]
-00010810: 2e61 7267 736f 7274 2829 5b2d 6b3a 5d0a  .argsort()[-k:].
-00010820: 2020 2020 2020 2020 2020 2020 746f 7020              top 
-00010830: 3d20 6e70 2e61 7070 656e 6428 746f 7078  = np.append(topx
-00010840: 2c74 6f70 7929 0a20 2020 2020 2020 2020  ,topy).         
-00010850: 2020 2061 7272 6f77 203d 206c 6f61 6469     arrow = loadi
-00010860: 6e67 5b74 6f70 5d0a 0a20 2020 2020 2020  ng[top]..       
-00010870: 2023 2020 2020 2020 2020 2074 6f70 203d   #         top =
-00010880: 2028 6c6f 6164 696e 6720 2a20 7076 6172   (loading * pvar
-00010890: 292e 7375 6d28 6178 6973 3d31 292e 6172  ).sum(axis=1).ar
-000108a0: 6773 6f72 7428 295b 2d6b 3a5d 0a20 2020  gsort()[-k:].   
-000108b0: 2020 2020 2023 2020 2020 2020 2020 2061       #         a
-000108c0: 7272 6f77 203d 206c 6f61 6469 6e67 5b74  rrow = loading[t
-000108d0: 6f70 5d0a 2020 2020 2020 2020 2020 2020  op].            
-000108e0: 0a20 2020 2020 2020 2020 2020 2061 7272  .            arr
-000108f0: 6f77 202f 3d20 6e70 2e73 7172 7428 2861  ow /= np.sqrt((a
-00010900: 7272 6f77 202a 2a20 3229 2e73 756d 2861  rrow ** 2).sum(a
-00010910: 7869 733d 3029 290a 2020 2020 2020 2020  xis=0)).        
-00010920: 2020 2020 6172 726f 7720 2a3d 206e 702e      arrow *= np.
-00010930: 6162 7328 7363 6f72 6529 2e6d 6178 2861  abs(score).max(a
-00010940: 7869 733d 3029 0a20 2020 2020 2020 2020  xis=0).         
-00010950: 2020 200a 2020 2020 2020 2020 2020 2020     .            
-00010960: 7461 7267 6574 732e 6170 7065 6e64 2874  targets.append(t
-00010970: 6172 6765 7429 0a20 2020 2020 2020 2020  arget).         
-00010980: 2020 2066 6561 7475 7265 732e 6170 7065     features.appe
-00010990: 6e64 2866 6561 7475 7265 290a 2020 2020  nd(feature).    
-000109a0: 2020 2020 2020 2020 7363 6f72 6573 2e61          scores.a
-000109b0: 7070 656e 6428 7363 6f72 6529 0a20 2020  ppend(score).   
-000109c0: 2020 2020 2020 2020 2070 7661 7273 2e61           pvars.a
-000109d0: 7070 656e 6428 7076 6172 290a 2020 2020  ppend(pvar).    
-000109e0: 2020 2020 2020 2020 746f 7073 2e61 7070          tops.app
-000109f0: 656e 6428 746f 7029 0a20 2020 2020 2020  end(top).       
-00010a00: 2020 2020 2061 7272 6f77 732e 6170 7065       arrows.appe
-00010a10: 6e64 2861 7272 6f77 290a 2020 2020 2020  nd(arrow).      
-00010a20: 2020 2020 2020 0a20 2020 2020 2020 2066        .        f
-00010a30: 6967 2c20 6178 203d 2070 6c74 2e73 7562  ig, ax = plt.sub
-00010a40: 706c 6f74 7328 6e5f 726f 7773 2c20 6e5f  plots(n_rows, n_
-00010a50: 636f 6c73 2c20 6669 6773 697a 653d 6669  cols, figsize=fi
-00010a60: 6773 697a 6529 0a0a 2020 2020 2020 2020  gsize)..        
-00010a70: 666f 7220 7461 7267 6574 2c20 6665 6174  for target, feat
-00010a80: 7572 652c 2073 636f 7265 2c20 7076 6172  ure, score, pvar
-00010a90: 2c20 746f 702c 2061 7272 6f77 2c20 7469  , top, arrow, ti
-00010aa0: 746c 652c 2061 7865 7320 2069 6e20 7a69  tle, axes  in zi
-00010ab0: 7028 7461 7267 6574 732c 2066 6561 7475  p(targets, featu
-00010ac0: 7265 732c 2073 636f 7265 732c 2070 7661  res, scores, pva
-00010ad0: 7273 2c20 746f 7073 2c20 6172 726f 7773  rs, tops, arrows
-00010ae0: 2c20 7469 746c 6573 2c20 6e70 2e61 7272  , titles, np.arr
-00010af0: 6179 2861 7829 2e66 6c61 7474 656e 2829  ay(ax).flatten()
-00010b00: 293a 0a0a 2020 2020 2020 2020 2020 2020  ):..            
-00010b10: 736e 732e 7363 6174 7465 7270 6c6f 7428  sns.scatterplot(
-00010b20: 783d 7363 6f72 655b 3a2c 2030 5d2c 2079  x=score[:, 0], y
-00010b30: 3d73 636f 7265 5b3a 2c20 315d 2c20 6875  =score[:, 1], hu
-00010b40: 653d 7461 7267 6574 2c20 6178 3d61 7865  e=target, ax=axe
-00010b50: 7329 0a20 2020 2020 2020 2020 2020 2061  s).            a
-00010b60: 7865 732e 7365 745f 7469 746c 6528 7469  xes.set_title(ti
-00010b70: 746c 6529 0a20 2020 2020 2020 2020 2020  tle).           
-00010b80: 2073 6e73 2e64 6573 7069 6e65 2829 0a0a   sns.despine()..
-00010b90: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-00010ba0: 6a20 696e 2061 7272 6f77 3a0a 2020 2020  j in arrow:.    
-00010bb0: 2020 2020 2020 2020 2020 2020 6178 6573              axes
-00010bc0: 2e61 7272 6f77 2830 2c20 302c 202a 6a2c  .arrow(0, 0, *j,
-00010bd0: 2063 6f6c 6f72 3d27 6b27 2c20 7769 6474   color='k', widt
-00010be0: 683d 302e 352c 2065 633d 276e 6f6e 6527  h=0.5, ec='none'
-00010bf0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00010c00: 2020 2020 2020 2020 2020 6c65 6e67 7468            length
-00010c10: 5f69 6e63 6c75 6465 735f 6865 6164 3d54  _includes_head=T
-00010c20: 7275 652c 2061 6c70 6861 3d30 2e35 2c20  rue, alpha=0.5, 
-00010c30: 290a 2020 2020 2020 2020 2020 2020 0a20  ).            . 
-00010c40: 2020 2020 2020 2020 2020 2074 6578 7473             texts
-00010c50: 203d 205b 6178 6573 2e74 6578 7428 2a28   = [axes.text(*(
-00010c60: 6a29 2c20 6665 6174 7572 655b 695d 2c20  j), feature[i], 
-00010c70: 6861 3d27 6365 6e74 6572 272c 2076 613d  ha='center', va=
-00010c80: 2763 656e 7465 7227 2920 666f 7220 692c  'center') for i,
-00010c90: 206a 2069 6e20 7a69 7028 746f 702c 2061   j in zip(top, a
-00010ca0: 7272 6f77 295d 0a20 2020 2020 2020 2020  rrow)].         
-00010cb0: 2020 2061 646a 7573 745f 7465 7874 2874     adjust_text(t
-00010cc0: 6578 7473 2c20 6172 726f 7770 726f 7073  exts, arrowprops
-00010cd0: 203d 2064 6963 7428 6172 726f 7773 7479   = dict(arrowsty
-00010ce0: 6c65 203d 2027 2d27 2c20 636f 6c6f 7220  le = '-', color 
-00010cf0: 3d20 2762 6c61 636b 272c 2061 6c70 6861  = 'black', alpha
-00010d00: 3d30 2e35 292c 2061 783d 6178 6573 290a  =0.5), ax=axes).
-00010d10: 2020 2020 2020 2020 2020 2020 6178 6573              axes
-00010d20: 2e73 6574 2878 6c61 6265 6c3d 6627 5043  .set(xlabel=f'PC
-00010d30: 3120 7b70 7661 725b 305d 3a2e 3266 7d25  1 {pvar[0]:.2f}%
-00010d40: 272c 2079 6c61 6265 6c3d 6627 5043 3220  ', ylabel=f'PC2 
-00010d50: 7b70 7661 725b 315d 3a2e 3266 7d25 2729  {pvar[1]:.2f}%')
-00010d60: 0a0a 2020 2020 2020 2020 6669 672e 7469  ..        fig.ti
-00010d70: 6768 745f 6c61 796f 7574 2829 0a0a 2020  ght_layout()..  
-00010d80: 2020 2020 2020 6966 2073 6176 6566 6967        if savefig
-00010d90: 203d 3d20 5472 7565 3a0a 2020 2020 2020   == True:.      
-00010da0: 2020 2020 2020 6669 672e 7361 7665 6669        fig.savefi
-00010db0: 6728 2762 6970 6c6f 742e 7064 6627 2c20  g('biplot.pdf', 
-00010dc0: 6262 6f78 5f69 6e63 6865 733d 2774 6967  bbox_inches='tig
-00010dd0: 6874 2729 0a0a 2020 2020 6465 6620 5f75  ht')..    def _u
-00010de0: 6d61 7028 7365 6c66 2c20 6461 7461 3d4e  map(self, data=N
-00010df0: 6f6e 652c 206e 5f6e 6569 6768 626f 7273  one, n_neighbors
-00010e00: 3d33 293a 0a0a 2020 2020 2020 2020 2222  =3):..        ""
-00010e10: 220a 2020 2020 2020 2020 4765 6e65 7261  ".        Genera
-00010e20: 7465 2055 4d41 5020 6f62 6a65 6374 0a0a  te UMAP object..
-00010e30: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
-00010e40: 7273 0a20 2020 2020 2020 202d 2d2d 2d2d  rs.        -----
-00010e50: 2d2d 2d2d 2d0a 2020 2020 2020 2020 6461  -----.        da
-00010e60: 7461 203a 2070 642e 4461 7461 4672 616d  ta : pd.DataFram
-00010e70: 650a 2020 2020 2020 2020 2020 2020 2028  e.             (
-00010e80: 4465 6661 756c 7420 7661 6c75 6520 3d20  Default value = 
-00010e90: 4e6f 6e65 290a 0a20 2020 2020 2020 206e  None)..        n
-00010ea0: 5f6e 6569 6768 626f 7273 203a 2069 6e74  _neighbors : int
-00010eb0: 0a20 2020 2020 2020 2020 2020 2020 2844  .             (D
-00010ec0: 6566 6175 6c74 2076 616c 7565 203d 2033  efault value = 3
-00010ed0: 290a 0a20 2020 2020 2020 2052 6574 7572  )..        Retur
-00010ee0: 6e73 0a20 2020 2020 2020 202d 2d2d 2d2d  ns.        -----
-00010ef0: 2d2d 0a20 2020 2020 2020 2070 642e 4461  --.        pd.Da
-00010f00: 7461 4672 616d 650a 2020 2020 2020 2020  taFrame.        
-00010f10: 2222 220a 2020 2020 2020 2020 6966 2069  """.        if i
-00010f20: 7369 6e73 7461 6e63 6528 6461 7461 2c20  sinstance(data, 
-00010f30: 7064 2e44 6174 6146 7261 6d65 293a 0a20  pd.DataFrame):. 
-00010f40: 2020 2020 2020 2020 2020 2064 6620 3d20             df = 
-00010f50: 6461 7461 2e73 656c 6563 745f 6474 7970  data.select_dtyp
-00010f60: 6573 2869 6e63 6c75 6465 203d 5b27 666c  es(include =['fl
-00010f70: 6f61 7436 3427 5d29 2e54 2e63 6f70 7928  oat64']).T.copy(
-00010f80: 290a 2020 2020 2020 2020 656c 7365 3a0a  ).        else:.
-00010f90: 2020 2020 2020 2020 2020 2020 6466 203d              df =
-00010fa0: 2073 656c 662e 6461 7461 2e73 656c 6563   self.data.selec
-00010fb0: 745f 6474 7970 6573 2869 6e63 6c75 6465  t_dtypes(include
-00010fc0: 203d 5b27 666c 6f61 7436 3427 5d29 2e54   =['float64']).T
-00010fd0: 2e63 6f70 7928 290a 0a20 2020 2020 2020  .copy()..       
-00010fe0: 2023 2070 7265 7061 7265 2066 6561 7475   # prepare featu
-00010ff0: 7265 7320 7661 7269 6162 6c65 2028 4765  res variable (Ge
-00011000: 6e65 7329 0a20 2020 2020 2020 2066 6561  nes).        fea
-00011010: 7475 7265 7320 3d20 6c69 7374 286e 702e  tures = list(np.
-00011020: 6172 616e 6765 2864 662e 7368 6170 655b  arange(df.shape[
-00011030: 315d 2929 0a20 2020 2020 2020 2064 662e  1])).        df.
-00011040: 636f 6c75 6d6e 7320 3d20 6665 6174 7572  columns = featur
-00011050: 6573 0a20 2020 2020 2020 200a 2020 2020  es.        .    
-00011060: 2020 2020 2320 7072 6570 6172 6520 7461      # prepare ta
-00011070: 7267 6574 2063 6f6c 756d 6e20 2873 616d  rget column (sam
-00011080: 706c 6520 7479 7065 7329 0a20 2020 2020  ple types).     
-00011090: 2020 2064 665b 2774 6172 6765 7427 5d20     df['target'] 
-000110a0: 3d20 6466 2e69 6e64 6578 0a20 2020 2020  = df.index.     
-000110b0: 2020 2064 6620 3d20 6466 2e72 6573 6574     df = df.reset
-000110c0: 5f69 6e64 6578 2864 726f 703d 2054 7275  _index(drop= Tru
-000110d0: 6529 0a0a 2020 2020 2020 2020 2320 5365  e)..        # Se
-000110e0: 7061 7261 7469 6e67 206f 7574 2074 6865  parating out the
-000110f0: 2066 6561 7475 7265 730a 2020 2020 2020   features.      
-00011100: 2020 7820 3d20 6466 2e6c 6f63 5b3a 2c20    x = df.loc[:, 
-00011110: 6665 6174 7572 6573 5d2e 7661 6c75 6573  features].values
-00011120: 0a20 0a20 2020 2020 2020 2023 2053 7461  . .        # Sta
-00011130: 6e64 6172 6469 7a69 6e67 2074 6865 2066  ndardizing the f
-00011140: 6561 7475 7265 730a 2020 2020 2020 2020  eatures.        
-00011150: 7820 3d20 5374 616e 6461 7264 5363 616c  x = StandardScal
-00011160: 6572 2829 2e66 6974 5f74 7261 6e73 666f  er().fit_transfo
-00011170: 726d 2878 290a 2020 2020 2020 2020 7265  rm(x).        re
-00011180: 6475 6365 7220 3d20 6d70 2e55 4d41 5028  ducer = mp.UMAP(
-00011190: 6e5f 6e65 6967 6862 6f72 733d 6e5f 6e65  n_neighbors=n_ne
-000111a0: 6967 6862 6f72 732c 2072 616e 646f 6d5f  ighbors, random_
-000111b0: 7374 6174 653d 3432 290a 2020 2020 2020  state=42).      
-000111c0: 2020 656d 6265 6464 696e 6720 3d20 7265    embedding = re
-000111d0: 6475 6365 722e 6669 745f 7472 616e 7366  ducer.fit_transf
-000111e0: 6f72 6d28 7829 0a20 2020 2020 2020 2065  orm(x).        e
-000111f0: 6d62 6564 6469 6e67 5f64 6174 6120 3d20  mbedding_data = 
-00011200: 7064 2e44 6174 6146 7261 6d65 2864 6174  pd.DataFrame(dat
-00011210: 6120 3d20 656d 6265 6464 696e 670a 2020  a = embedding.  
-00011220: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011230: 2020 2020 2020 2020 2020 2020 2020 2c63                ,c
-00011240: 6f6c 756d 6e73 203d 205b 2755 4d41 5031  olumns = ['UMAP1
-00011250: 272c 2027 554d 4150 3227 5d29 0a20 2020  ', 'UMAP2']).   
-00011260: 2020 2020 200a 2020 2020 2020 2020 6669       .        fi
-00011270: 6e61 6c44 6620 3d20 7064 2e63 6f6e 6361  nalDf = pd.conca
-00011280: 7428 5b65 6d62 6564 6469 6e67 5f64 6174  t([embedding_dat
-00011290: 612c 2064 665b 5b27 7461 7267 6574 275d  a, df[['target']
-000112a0: 5d5d 2c20 6178 6973 203d 2031 290a 2020  ]], axis = 1).  
-000112b0: 2020 2020 2020 0a20 2020 2020 2020 2072        .        r
-000112c0: 6574 7572 6e20 6669 6e61 6c44 660a 2020  eturn finalDf.  
-000112d0: 2020 0a20 2020 2064 6566 2075 6d61 705f    .    def umap_
-000112e0: 706c 6f74 2873 656c 662c 206e 5f6e 6569  plot(self, n_nei
-000112f0: 6768 626f 7273 3d33 2c20 6e5f 726f 7773  ghbors=3, n_rows
-00011300: 3d31 2c20 6e5f 636f 6c73 3d31 2c20 7469  =1, n_cols=1, ti
-00011310: 746c 6573 3d5b 2727 5d2c 2066 6967 7369  tles=[''], figsi
-00011320: 7a65 3d28 352c 2035 292c 2073 6176 6566  ze=(5, 5), savef
-00011330: 6967 3d46 616c 7365 293a 0a0a 2020 2020  ig=False):..    
-00011340: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00011350: 506c 6f74 2055 4d41 5020 666f 7220 6f6e  Plot UMAP for on
-00011360: 6520 6f72 206d 6f72 6520 6461 7461 7365  e or more datase
-00011370: 7473 2e0a 0a20 2020 2020 2020 2050 6172  ts...        Par
-00011380: 616d 6574 6572 730a 2020 2020 2020 2020  ameters.        
-00011390: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
-000113a0: 2020 206e 5f6e 6569 6768 626f 7273 203a     n_neighbors :
-000113b0: 2069 6e74 0a20 2020 2020 2020 2020 2020   int.           
-000113c0: 2020 2844 6566 6175 6c74 2076 616c 7565    (Default value
-000113d0: 203d 2033 290a 0a20 2020 2020 2020 206e   = 3)..        n
-000113e0: 5f72 6f77 7320 3a20 696e 740a 2020 2020  _rows : int.    
-000113f0: 2020 2020 2020 2020 204e 756d 6265 7220           Number 
-00011400: 6f66 2072 6f77 7320 696e 2073 7562 706c  of rows in subpl
-00011410: 6f74 2028 4465 6661 756c 7420 7661 6c75  ot (Default valu
-00011420: 6520 3d20 3129 0a0a 2020 2020 2020 2020  e = 1)..        
-00011430: 6e5f 636f 6c73 203a 2069 6e74 0a20 2020  n_cols : int.   
-00011440: 2020 2020 2020 2020 2020 4e75 6d62 6572            Number
-00011450: 206f 6620 636f 6c75 6d6e 7320 696e 2073   of columns in s
-00011460: 7562 706c 6f74 2028 4465 6661 756c 7420  ubplot (Default 
-00011470: 7661 6c75 6520 3d20 3129 0a0a 2020 2020  value = 1)..    
-00011480: 2020 2020 7469 746c 6573 203a 206c 6973      titles : lis
-00011490: 740a 2020 2020 2020 2020 2020 2020 204c  t.             L
-000114a0: 6973 7420 6f66 2074 6974 6c65 7320 696e  ist of titles in
-000114b0: 2073 7562 706c 6f74 2028 4465 6661 756c   subplot (Defaul
-000114c0: 7420 7661 6c75 6520 3d20 5b27 275d 290a  t value = ['']).
-000114d0: 0a20 2020 2020 2020 2066 6967 7369 7a65  .        figsize
-000114e0: 203a 2074 7570 6c65 0a20 2020 2020 2020   : tuple.       
-000114f0: 2020 2020 2020 4669 6775 7265 2073 697a        Figure siz
-00011500: 6520 2844 6566 6175 6c74 2076 616c 7565  e (Default value
-00011510: 203d 2028 352c 2035 290a 2020 2020 2020   = (5, 5).      
-00011520: 2020 2020 2020 0a20 2020 2020 2020 2073        .        s
-00011530: 6176 6566 6967 203a 0a20 2020 2020 2020  avefig :.       
-00011540: 2020 2020 2020 2844 6566 6175 6c74 2076        (Default v
-00011550: 616c 7565 203d 2046 616c 7365 290a 0a20  alue = False).. 
-00011560: 2020 2020 2020 2052 6574 7572 6e73 0a20         Returns. 
-00011570: 2020 2020 2020 202d 2d2d 2d2d 2d2d 0a20         -------. 
-00011580: 2020 2020 2020 206d 6174 706c 6f74 6c69         matplotli
-00011590: 622e 7079 706c 6f74 0a20 2020 2020 2020  b.pyplot.       
-000115a0: 2022 2222 0a20 2020 2020 2020 200a 2020   """.        .  
-000115b0: 2020 2020 2020 6966 206e 5f72 6f77 7320        if n_rows 
-000115c0: 3d3d 2031 2061 6e64 206e 5f63 6f6c 7320  == 1 and n_cols 
-000115d0: 3d3d 2031 3a0a 2020 2020 2020 2020 2020  == 1:.          
-000115e0: 2020 6461 7461 7365 7473 203d 205b 7365    datasets = [se
-000115f0: 6c66 2e64 6174 615d 0a0a 2020 2020 2020  lf.data]..      
-00011600: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-00011610: 2020 2020 2064 6174 6173 6574 7320 3d20       datasets = 
-00011620: 7365 6c66 2e64 6174 6173 6574 732e 636f  self.datasets.co
-00011630: 7079 2829 0a0a 2020 2020 2020 2020 2320  py()..        # 
-00011640: 706c 6f74 2074 6865 2070 6361 0a20 2020  plot the pca.   
-00011650: 2020 2020 2075 6d61 705f 6461 7461 7365       umap_datase
-00011660: 7473 203d 205b 7365 6c66 2e5f 756d 6170  ts = [self._umap
-00011670: 2864 6174 613d 692c 206e 5f6e 6569 6768  (data=i, n_neigh
-00011680: 626f 7273 3d6e 5f6e 6569 6768 626f 7273  bors=n_neighbors
-00011690: 2920 666f 7220 6920 696e 2064 6174 6173  ) for i in datas
-000116a0: 6574 735d 0a0a 2020 2020 2020 2020 6669  ets]..        fi
-000116b0: 672c 2061 7820 3d20 706c 742e 7375 6270  g, ax = plt.subp
-000116c0: 6c6f 7473 286e 5f72 6f77 732c 206e 5f63  lots(n_rows, n_c
-000116d0: 6f6c 732c 2066 6967 7369 7a65 3d66 6967  ols, figsize=fig
-000116e0: 7369 7a65 290a 0a20 2020 2020 2020 2066  size)..        f
-000116f0: 6f72 2075 6d61 705f 6461 7461 2c20 6178  or umap_data, ax
-00011700: 6573 2c20 7469 746c 6520 696e 207a 6970  es, title in zip
-00011710: 2875 6d61 705f 6461 7461 7365 7473 2c20  (umap_datasets, 
-00011720: 6e70 2e61 7272 6179 2861 7829 2e66 6c61  np.array(ax).fla
-00011730: 7474 656e 2829 2c20 7469 746c 6573 293a  tten(), titles):
-00011740: 0a20 2020 2020 2020 2020 2020 2073 6e73  .            sns
-00011750: 2e73 6361 7474 6572 706c 6f74 2864 6174  .scatterplot(dat
-00011760: 6120 3d20 756d 6170 5f64 6174 612c 2078  a = umap_data, x
-00011770: 203d 2027 554d 4150 3127 2c20 7920 3d20   = 'UMAP1', y = 
-00011780: 2755 4d41 5032 272c 2068 7565 203d 2027  'UMAP2', hue = '
-00011790: 7461 7267 6574 272c 2061 783d 6178 6573  target', ax=axes
-000117a0: 290a 2020 2020 2020 2020 2020 2020 6178  ).            ax
-000117b0: 6573 2e73 6574 5f74 6974 6c65 2874 6974  es.set_title(tit
-000117c0: 6c65 290a 2020 2020 2020 2020 2020 2020  le).            
-000117d0: 6178 6573 2e6c 6567 656e 6428 6c6f 633d  axes.legend(loc=
-000117e0: 2762 6573 7427 290a 2020 2020 2020 2020  'best').        
-000117f0: 2020 2020 736e 732e 6465 7370 696e 6528      sns.despine(
-00011800: 290a 2020 2020 2020 2020 0a20 2020 2020  ).        .     
-00011810: 2020 2066 6967 2e74 6967 6874 5f6c 6179     fig.tight_lay
-00011820: 6f75 7428 290a 2020 2020 2020 2020 0a20  out().        . 
-00011830: 2020 2020 2020 2069 6620 7361 7665 6669         if savefi
-00011840: 6720 3d3d 2054 7275 653a 0a20 2020 2020  g == True:.     
-00011850: 2020 2020 2020 2066 6967 2e73 6176 6566         fig.savef
-00011860: 6967 2827 756d 6170 5f66 6967 732e 7064  ig('umap_figs.pd
-00011870: 6627 2c20 6262 6f78 5f69 6e63 6865 733d  f', bbox_inches=
-00011880: 2774 6967 6874 272c 2074 7261 6e73 7061  'tight', transpa
-00011890: 7265 6e74 3d54 7275 6529 0a0a 2020 2020  rent=True)..    
-000118a0: 6465 6620 5f74 736e 6528 7365 6c66 2c20  def _tsne(self, 
-000118b0: 6461 7461 3d4e 6f6e 652c 2070 6572 706c  data=None, perpl
-000118c0: 6578 6974 793d 3130 2c20 6c65 6172 6e69  exity=10, learni
-000118d0: 6e67 5f72 6174 653d 2761 7574 6f27 2c20  ng_rate='auto', 
-000118e0: 6561 726c 795f 6578 6167 6765 7261 7469  early_exaggerati
-000118f0: 6f6e 3d31 3229 3a0a 0a20 2020 2020 2020  on=12):..       
-00011900: 2022 2222 0a20 2020 2020 2020 2074 2d53   """.        t-S
-00011910: 4e45 2064 696d 656e 7369 6f6e 616c 6974  NE dimensionalit
-00011920: 7920 7265 6475 6374 696f 6e0a 0a20 2020  y reduction..   
-00011930: 2020 2020 2050 6172 616d 6574 6572 730a       Parameters.
-00011940: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-00011950: 2d2d 0a20 2020 2020 2020 2064 6174 6120  --.        data 
-00011960: 3a20 7064 2e44 6174 6146 7261 6d65 0a20  : pd.DataFrame. 
-00011970: 2020 2020 2020 2020 2020 2020 2844 6566              (Def
-00011980: 6175 6c74 2076 616c 7565 203d 204e 6f6e  ault value = Non
-00011990: 6529 0a20 2020 2020 2020 2070 6572 706c  e).        perpl
-000119a0: 6578 6974 7920 3a20 696e 740a 2020 2020  exity : int.    
-000119b0: 2020 2020 2020 2020 2028 4465 6661 756c           (Defaul
-000119c0: 7420 7661 6c75 6520 3d20 3130 290a 2020  t value = 10).  
-000119d0: 2020 2020 2020 6c65 6172 6e69 6e67 5f72        learning_r
-000119e0: 6174 6520 3a20 696e 7420 6f72 2073 7472  ate : int or str
-000119f0: 0a20 2020 2020 2020 2020 2020 2020 2844  .             (D
-00011a00: 6566 6175 6c74 2076 616c 7565 203d 2027  efault value = '
-00011a10: 6175 746f 2729 0a20 2020 2020 2020 2065  auto').        e
-00011a20: 6172 6c79 5f65 7861 6767 6572 6174 696f  arly_exaggeratio
-00011a30: 6e20 3a20 696e 740a 2020 2020 2020 2020  n : int.        
-00011a40: 2020 2020 2028 4465 6661 756c 7420 7661       (Default va
-00011a50: 6c75 6520 3d20 3132 290a 0a20 2020 2020  lue = 12)..     
-00011a60: 2020 2052 6574 7572 6e73 0a20 2020 2020     Returns.     
-00011a70: 2020 202d 2d2d 2d2d 2d2d 0a20 2020 2020     -------.     
-00011a80: 2020 2070 642e 4461 7461 4672 616d 650a     pd.DataFrame.
-00011a90: 2020 2020 2020 2020 2222 220a 0a20 2020          """..   
-00011aa0: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
-00011ab0: 6365 2864 6174 612c 2070 642e 4461 7461  ce(data, pd.Data
-00011ac0: 4672 616d 6529 3a0a 2020 2020 2020 2020  Frame):.        
-00011ad0: 2020 2020 666c 6f61 745f 6461 7461 203d      float_data =
-00011ae0: 2064 6174 612e 7365 6c65 6374 5f64 7479   data.select_dty
-00011af0: 7065 7328 2766 6c6f 6174 2729 2e54 0a20  pes('float').T. 
-00011b00: 2020 2020 2020 200a 2020 2020 2020 2020         .        
-00011b10: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-00011b20: 2020 666c 6f61 745f 6461 7461 203d 2073    float_data = s
-00011b30: 656c 662e 6461 7461 2e73 656c 6563 745f  elf.data.select_
-00011b40: 6474 7970 6573 2827 666c 6f61 7427 292e  dtypes('float').
-00011b50: 540a 2020 2020 2020 2020 0a20 2020 2020  T.        .     
-00011b60: 2020 2066 6561 7475 7265 7320 3d20 666c     features = fl
-00011b70: 6f61 745f 6461 7461 2e69 6e64 6578 2e74  oat_data.index.t
-00011b80: 6f5f 6c69 7374 2829 0a20 2020 2020 2020  o_list().       
-00011b90: 2066 6c6f 6174 5f64 6174 6120 3d20 5374   float_data = St
-00011ba0: 616e 6461 7264 5363 616c 6572 2829 2e66  andardScaler().f
-00011bb0: 6974 5f74 7261 6e73 666f 726d 2866 6c6f  it_transform(flo
-00011bc0: 6174 5f64 6174 6129 0a20 2020 2020 2020  at_data).       
-00011bd0: 2074 736e 655f 6461 7461 203d 2054 534e   tsne_data = TSN
-00011be0: 4528 6e5f 636f 6d70 6f6e 656e 7473 3d32  E(n_components=2
-00011bf0: 2c20 7065 7270 6c65 7869 7479 3d70 6572  , perplexity=per
-00011c00: 706c 6578 6974 792c 206c 6561 726e 696e  plexity, learnin
-00011c10: 675f 7261 7465 3d6c 6561 726e 696e 675f  g_rate=learning_
-00011c20: 7261 7465 2c20 6561 726c 795f 6578 6167  rate, early_exag
-00011c30: 6765 7261 7469 6f6e 3d65 6172 6c79 5f65  geration=early_e
-00011c40: 7861 6767 6572 6174 696f 6e2c 2072 616e  xaggeration, ran
-00011c50: 646f 6d5f 7374 6174 653d 3432 292e 6669  dom_state=42).fi
-00011c60: 745f 7472 616e 7366 6f72 6d28 666c 6f61  t_transform(floa
-00011c70: 745f 6461 7461 290a 2020 2020 2020 2020  t_data).        
-00011c80: 7473 6e65 5f64 6174 6120 3d20 7064 2e44  tsne_data = pd.D
-00011c90: 6174 6146 7261 6d65 2864 6174 613d 7473  ataFrame(data=ts
-00011ca0: 6e65 5f64 6174 612c 2063 6f6c 756d 6e73  ne_data, columns
-00011cb0: 203d 5b27 5453 4e45 2031 272c 2027 5453   =['TSNE 1', 'TS
-00011cc0: 4e45 2032 275d 290a 2020 2020 2020 2020  NE 2']).        
-00011cd0: 7473 6e65 5f64 6174 615b 2766 6561 7475  tsne_data['featu
-00011ce0: 7265 7327 5d20 3d20 6665 6174 7572 6573  res'] = features
-00011cf0: 0a20 2020 2020 2020 200a 2020 2020 2020  .        .      
-00011d00: 2020 7265 7475 726e 2074 736e 655f 6461    return tsne_da
-00011d10: 7461 0a0a 2020 2020 6465 6620 7473 6e65  ta..    def tsne
-00011d20: 5f70 6c6f 7428 7365 6c66 2c20 7065 7270  _plot(self, perp
-00011d30: 6c65 7869 7479 3d31 302c 206c 6561 726e  lexity=10, learn
-00011d40: 696e 675f 7261 7465 3d27 6175 746f 272c  ing_rate='auto',
-00011d50: 2065 6172 6c79 5f65 7861 6767 6572 6174   early_exaggerat
-00011d60: 696f 6e3d 3132 2c20 6e5f 726f 7773 3d31  ion=12, n_rows=1
-00011d70: 2c20 6e5f 636f 6c73 3d31 2c20 7469 746c  , n_cols=1, titl
-00011d80: 6573 3d5b 2727 5d2c 2066 6967 7369 7a65  es=[''], figsize
-00011d90: 3d28 352c 2035 292c 2073 6176 6566 6967  =(5, 5), savefig
-00011da0: 3d46 616c 7365 293a 0a0a 2020 2020 2020  =False):..      
-00011db0: 2020 2222 2250 6c6f 7420 742d 534e 450a    """Plot t-SNE.
-00011dc0: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
-00011dd0: 6572 730a 2020 2020 2020 2020 2d2d 2d2d  ers.        ----
-00011de0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2070  ------.        p
-00011df0: 6572 706c 6578 6974 7920 3a20 696e 740a  erplexity : int.
-00011e00: 2020 2020 2020 2020 2020 2020 2028 4465               (De
-00011e10: 6661 756c 7420 7661 6c75 6520 3d20 3130  fault value = 10
-00011e20: 290a 0a20 2020 2020 2020 206c 6561 726e  )..        learn
-00011e30: 696e 675f 7261 7465 203a 2069 6e74 206f  ing_rate : int o
-00011e40: 7220 7374 720a 2020 2020 2020 2020 2020  r str.          
-00011e50: 2020 2028 4465 6661 756c 7420 7661 6c75     (Default valu
-00011e60: 6520 3d20 2761 7574 6f27 290a 0a20 2020  e = 'auto')..   
-00011e70: 2020 2020 2065 6172 6c79 5f65 7861 6767       early_exagg
-00011e80: 6572 6174 696f 6e20 3a20 696e 740a 2020  eration : int.  
-00011e90: 2020 2020 2020 2020 2020 2028 4465 6661             (Defa
-00011ea0: 756c 7420 7661 6c75 6520 3d20 3132 290a  ult value = 12).
-00011eb0: 0a20 2020 2020 2020 206e 5f72 6f77 7320  .        n_rows 
-00011ec0: 3a20 696e 740a 2020 2020 2020 2020 2020  : int.          
-00011ed0: 2020 204e 756d 6265 7220 6f66 2072 6f77     Number of row
-00011ee0: 7320 696e 2073 7562 706c 6f74 2028 4465  s in subplot (De
-00011ef0: 6661 756c 7420 7661 6c75 6520 3d20 3129  fault value = 1)
-00011f00: 0a0a 2020 2020 2020 2020 6e5f 636f 6c73  ..        n_cols
-00011f10: 203a 2069 6e74 0a20 2020 2020 2020 2020   : int.         
-00011f20: 2020 2020 4e75 6d62 6572 206f 6620 636f      Number of co
-00011f30: 6c75 6d6e 7320 696e 2073 7562 706c 6f74  lumns in subplot
-00011f40: 2028 4465 6661 756c 7420 7661 6c75 6520   (Default value 
-00011f50: 3d20 3129 0a0a 2020 2020 2020 2020 7469  = 1)..        ti
-00011f60: 746c 6573 203a 206c 6973 740a 2020 2020  tles : list.    
-00011f70: 2020 2020 2020 2020 204c 6973 7420 6f66           List of
-00011f80: 2074 6974 6c65 7320 696e 2073 7562 706c   titles in subpl
-00011f90: 6f74 2028 4465 6661 756c 7420 7661 6c75  ot (Default valu
-00011fa0: 6520 3d20 5b27 275d 290a 0a20 2020 2020  e = [''])..     
-00011fb0: 2020 2066 6967 7369 7a65 203a 2074 7570     figsize : tup
-00011fc0: 6c65 0a20 2020 2020 2020 2020 2020 2020  le.             
-00011fd0: 2028 4465 6661 756c 7420 7661 6c75 6520   (Default value 
-00011fe0: 3d20 2835 2c20 3529 203a 0a20 2020 2020  = (5, 5) :.     
-00011ff0: 2020 2020 2020 200a 2020 2020 2020 2020         .        
-00012000: 7361 7665 6669 6720 3a20 626f 6f6c 0a20  savefig : bool. 
-00012010: 2020 2020 2020 2020 2020 2020 4966 2054              If T
-00012020: 7275 652c 2073 6176 6520 6669 6775 7265  rue, save figure
-00012030: 2028 4465 6661 756c 7420 7661 6c75 6520   (Default value 
-00012040: 3d20 4661 6c73 6529 0a0a 2020 2020 2020  = False)..      
-00012050: 2020 5265 7475 726e 730a 2020 2020 2020    Returns.      
-00012060: 2020 2d2d 2d2d 2d2d 2d0a 2020 2020 2020    -------.      
-00012070: 2020 6d61 7470 6c6f 746c 6962 2e70 7970    matplotlib.pyp
-00012080: 6c6f 740a 2020 2020 2020 2020 2222 220a  lot.        """.
-00012090: 0a20 2020 2020 2020 2069 6620 6e5f 726f  .        if n_ro
-000120a0: 7773 203d 3d20 3120 616e 6420 6e5f 636f  ws == 1 and n_co
-000120b0: 6c73 203d 3d20 313a 0a20 2020 2020 2020  ls == 1:.       
-000120c0: 2020 2020 2064 6174 6173 6574 7320 3d20       datasets = 
-000120d0: 5b73 656c 662e 6461 7461 5d0a 2020 2020  [self.data].    
-000120e0: 2020 2020 0a20 2020 2020 2020 2065 6c73      .        els
-000120f0: 653a 0a20 2020 2020 2020 2020 2020 2064  e:.            d
-00012100: 6174 6173 6574 7320 3d20 7365 6c66 2e64  atasets = self.d
-00012110: 6174 6173 6574 732e 636f 7079 2829 0a0a  atasets.copy()..
-00012120: 2020 2020 2020 2020 7473 6e65 5f64 6174          tsne_dat
-00012130: 6173 6574 7320 3d20 5b73 656c 662e 5f74  asets = [self._t
-00012140: 736e 6528 6461 7461 3d69 2c20 7065 7270  sne(data=i, perp
-00012150: 6c65 7869 7479 3d70 6572 706c 6578 6974  lexity=perplexit
-00012160: 792c 206c 6561 726e 696e 675f 7261 7465  y, learning_rate
-00012170: 3d6c 6561 726e 696e 675f 7261 7465 2c20  =learning_rate, 
-00012180: 6561 726c 795f 6578 6167 6765 7261 7469  early_exaggerati
-00012190: 6f6e 3d65 6172 6c79 5f65 7861 6767 6572  on=early_exagger
-000121a0: 6174 696f 6e29 2066 6f72 2069 2069 6e20  ation) for i in 
-000121b0: 6461 7461 7365 7473 5d0a 0a20 2020 2020  datasets]..     
-000121c0: 2020 2066 6967 2c20 6178 203d 2070 6c74     fig, ax = plt
-000121d0: 2e73 7562 706c 6f74 7328 6e5f 726f 7773  .subplots(n_rows
-000121e0: 2c20 6e5f 636f 6c73 2c20 6669 6773 697a  , n_cols, figsiz
-000121f0: 653d 6669 6773 697a 6529 0a0a 2020 2020  e=figsize)..    
-00012200: 2020 2020 666f 7220 7473 6e65 5f64 6174      for tsne_dat
-00012210: 612c 2074 6974 6c65 2c20 6178 6573 2069  a, title, axes i
-00012220: 6e20 7a69 7028 7473 6e65 5f64 6174 6173  n zip(tsne_datas
-00012230: 6574 732c 2074 6974 6c65 732c 206e 702e  ets, titles, np.
-00012240: 6172 7261 7928 6178 292e 666c 6174 7465  array(ax).flatte
-00012250: 6e28 2929 3a0a 2020 2020 2020 2020 2020  n()):.          
-00012260: 2020 736e 732e 7363 6174 7465 7270 6c6f    sns.scatterplo
-00012270: 7428 6461 7461 3d74 736e 655f 6461 7461  t(data=tsne_data
-00012280: 2c20 783d 2754 534e 4520 3127 2c20 793d  , x='TSNE 1', y=
-00012290: 2754 534e 4520 3227 2c20 6875 653d 2766  'TSNE 2', hue='f
-000122a0: 6561 7475 7265 7327 2c20 6178 3d61 7865  eatures', ax=axe
-000122b0: 7329 0a20 2020 2020 2020 2020 2020 2061  s).            a
-000122c0: 7865 732e 7365 745f 7469 746c 6528 7469  xes.set_title(ti
-000122d0: 746c 6529 0a20 2020 2020 2020 2020 2020  tle).           
-000122e0: 2073 6e73 2e64 6573 7069 6e65 2829 0a0a   sns.despine()..
-000122f0: 2020 2020 2020 2020 6966 2073 6176 6566          if savef
-00012300: 6967 203d 3d20 5472 7565 3a0a 2020 2020  ig == True:.    
-00012310: 2020 2020 2020 2020 6669 672e 7361 7666          fig.savf
-00012320: 6967 2827 745f 534e 455f 706c 6f74 2e70  ig('t_SNE_plot.p
-00012330: 6466 272c 2062 626f 785f 696e 6368 6573  df', bbox_inches
-00012340: 3d27 7469 6768 7427 2c20 7472 616e 7370  ='tight', transp
-00012350: 6172 656e 743d 5472 7565 290a 0a20 2020  arent=True)..   
-00012360: 2064 6566 2073 6571 7565 6e74 6961 6c5f   def sequential_
-00012370: 7063 615f 7473 6e65 5f70 6c6f 7428 7365  pca_tsne_plot(se
-00012380: 6c66 2c20 7661 7269 616e 6365 3d30 2e38  lf, variance=0.8
-00012390: 2c20 7065 7270 6c65 7869 7479 3d31 302c  , perplexity=10,
-000123a0: 206c 6561 726e 696e 675f 7261 7465 3d27   learning_rate='
-000123b0: 6175 746f 272c 2065 6172 6c79 5f65 7861  auto', early_exa
-000123c0: 6767 6572 6174 696f 6e3d 3132 2c20 6e5f  ggeration=12, n_
-000123d0: 726f 7773 3d31 2c20 6e5f 636f 6c73 3d31  rows=1, n_cols=1
-000123e0: 2c20 7469 746c 6573 3d5b 2727 5d2c 2066  , titles=[''], f
-000123f0: 6967 7369 7a65 3d28 352c 3529 2c20 7361  igsize=(5,5), sa
-00012400: 7665 6669 673d 4661 6c73 6529 3a0a 0a20  vefig=False):.. 
-00012410: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00012420: 2020 2050 6c6f 7420 7453 4e45 2061 6674     Plot tSNE aft
-00012430: 6572 2050 4341 2064 696d 656e 7369 6f6e  er PCA dimension
-00012440: 616c 6974 7920 7265 6475 6374 696f 6e0a  ality reduction.
-00012450: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
-00012460: 6572 730a 2020 2020 2020 2020 2d2d 2d2d  ers.        ----
-00012470: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2076  ------.        v
-00012480: 6172 6961 6e63 6520 3a20 666c 6f61 740a  ariance : float.
-00012490: 2020 2020 2020 2020 2020 2020 204d 696e               Min
-000124a0: 2076 6172 6961 6e63 6520 666f 7220 5043   variance for PC
-000124b0: 4120 2844 6566 6175 6c74 2076 616c 7565  A (Default value
-000124c0: 203d 2030 2e38 290a 2020 2020 2020 2020   = 0.8).        
-000124d0: 2020 2020 200a 2020 2020 2020 2020 7065       .        pe
-000124e0: 7270 6c65 7869 7479 203a 2069 6e74 0a20  rplexity : int. 
-000124f0: 2020 2020 2020 2020 2020 2020 2844 6566              (Def
-00012500: 6175 6c74 2076 616c 7565 203d 2031 3029  ault value = 10)
-00012510: 0a0a 2020 2020 2020 2020 6c65 6172 6e69  ..        learni
-00012520: 6e67 5f72 6174 6520 3a20 696e 7420 6f72  ng_rate : int or
-00012530: 2073 7472 0a20 2020 2020 2020 2020 2020   str.           
-00012540: 2020 2844 6566 6175 6c74 2076 616c 7565    (Default value
-00012550: 203d 2027 6175 746f 2729 0a0a 2020 2020   = 'auto')..    
-00012560: 2020 2020 6561 726c 795f 6578 6167 6765      early_exagge
-00012570: 7261 7469 6f6e 203a 2069 6e74 0a20 2020  ration : int.   
-00012580: 2020 2020 2020 2020 2020 2844 6566 6175            (Defau
-00012590: 6c74 2076 616c 7565 203d 2031 3229 0a0a  lt value = 12)..
-000125a0: 2020 2020 2020 2020 6e5f 726f 7773 203a          n_rows :
-000125b0: 2069 6e74 0a20 2020 2020 2020 2020 2020   int.           
-000125c0: 2020 4e75 6d62 6572 206f 6620 726f 7773    Number of rows
-000125d0: 2069 6e20 7375 6270 6c6f 7420 2844 6566   in subplot (Def
-000125e0: 6175 6c74 2076 616c 7565 203d 2031 290a  ault value = 1).
-000125f0: 0a20 2020 2020 2020 206e 5f63 6f6c 7320  .        n_cols 
-00012600: 3a20 696e 740a 2020 2020 2020 2020 2020  : int.          
-00012610: 2020 204e 756d 6265 7220 6f66 2063 6f6c     Number of col
-00012620: 756d 736e 2069 6e20 7375 6270 6c6f 7420  umsn in subplot 
-00012630: 2844 6566 6175 6c74 2076 616c 7565 203d  (Default value =
-00012640: 2031 290a 0a20 2020 2020 2020 2074 6974   1)..        tit
-00012650: 6c65 7320 3a20 6c69 7374 0a20 2020 2020  les : list.     
-00012660: 2020 2020 2020 2020 4c69 7374 206f 6620          List of 
-00012670: 7469 7465 6c73 2069 6e20 7375 6270 6c6f  titels in subplo
-00012680: 7420 2844 6566 6175 6c74 2076 616c 7565  t (Default value
-00012690: 203d 205b 2727 5d29 0a0a 2020 2020 2020   = [''])..      
-000126a0: 2020 6669 6773 697a 6520 3a20 7475 706c    figsize : tupl
-000126b0: 650a 2020 2020 2020 2020 2020 2020 2046  e.             F
-000126c0: 6967 7572 6520 7369 7a65 2028 4465 6661  igure size (Defa
-000126d0: 756c 7420 7661 6c75 6520 3d20 2835 2c20  ult value = (5, 
-000126e0: 3529 203a 0a20 2020 2020 2020 2020 2020  5) :.           
-000126f0: 200a 2020 2020 2020 2020 7361 7665 6669   .        savefi
-00012700: 6720 3a20 626f 6f6c 0a20 2020 2020 2020  g : bool.       
-00012710: 2020 2020 2020 4966 2054 7275 652c 2073        If True, s
-00012720: 6176 6566 2066 6967 7572 6520 2844 6566  avef figure (Def
-00012730: 6175 6c74 2076 616c 7565 203d 2046 616c  ault value = Fal
-00012740: 7365 290a 0a20 2020 2020 2020 2052 6574  se)..        Ret
-00012750: 7572 6e73 0a20 2020 2020 2020 202d 2d2d  urns.        ---
-00012760: 2d2d 2d2d 0a20 2020 2020 2020 206d 6174  ----.        mat
-00012770: 706c 6f74 6c69 622e 7079 706c 6f74 0a20  plotlib.pyplot. 
-00012780: 2020 2020 2020 2022 2222 0a0a 2020 2020         """..    
-00012790: 2020 2020 6966 206e 5f72 6f77 7320 3d3d      if n_rows ==
-000127a0: 2031 2061 6e64 206e 5f63 6f6c 7320 3d3d   1 and n_cols ==
-000127b0: 2031 3a0a 2020 2020 2020 2020 2020 2020   1:.            
-000127c0: 6461 7461 7365 7473 203d 205b 7365 6c66  datasets = [self
-000127d0: 2e64 6174 615d 0a0a 2020 2020 2020 2020  .data]..        
-000127e0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-000127f0: 2020 6461 7461 7365 7473 203d 2073 656c    datasets = sel
-00012800: 662e 6461 7461 7365 7473 2e63 6f70 7928  f.datasets.copy(
-00012810: 290a 0a20 2020 2020 2020 2066 6967 2c20  )..        fig, 
-00012820: 6178 203d 2070 6c74 2e73 7562 706c 6f74  ax = plt.subplot
-00012830: 7328 6e5f 726f 7773 2c20 6e5f 636f 6c73  s(n_rows, n_cols
-00012840: 2c20 6669 6773 697a 653d 6669 6773 697a  , figsize=figsiz
-00012850: 6529 0a0a 2020 2020 2020 2020 666f 7220  e)..        for 
-00012860: 6461 7461 2c20 7469 746c 652c 2061 7820  data, title, ax 
-00012870: 696e 207a 6970 2864 6174 6173 6574 732c  in zip(datasets,
-00012880: 2074 6974 6c65 732c 206e 702e 6172 7261   titles, np.arra
-00012890: 7928 6178 292e 666c 6174 7465 6e28 2929  y(ax).flatten())
-000128a0: 3a0a 2020 2020 2020 2020 2020 2020 666c  :.            fl
-000128b0: 6f61 745f 6461 7461 203d 2064 6174 612e  oat_data = data.
-000128c0: 7365 6c65 6374 5f64 7479 7065 7328 2766  select_dtypes('f
-000128d0: 6c6f 6174 2729 2e54 0a20 2020 2020 2020  loat').T.       
-000128e0: 2020 2020 2066 6561 7475 7265 7320 3d20       features = 
-000128f0: 666c 6f61 745f 6461 7461 2e69 6e64 6578  float_data.index
-00012900: 2e74 6f5f 6c69 7374 2829 0a20 2020 2020  .to_list().     
-00012910: 2020 2020 2020 2066 6c6f 6174 5f64 6174         float_dat
-00012920: 6120 3d20 5374 616e 6461 7264 5363 616c  a = StandardScal
-00012930: 6572 2829 2e66 6974 5f74 7261 6e73 666f  er().fit_transfo
-00012940: 726d 2866 6c6f 6174 5f64 6174 6129 0a20  rm(float_data). 
-00012950: 2020 2020 2020 2020 2020 2070 6361 5f72             pca_r
-00012960: 6564 7563 6564 5f64 6174 6120 3d20 5043  educed_data = PC
-00012970: 4128 6e5f 636f 6d70 6f6e 656e 7473 3d76  A(n_components=v
-00012980: 6172 6961 6e63 6529 2e66 6974 5f74 7261  ariance).fit_tra
-00012990: 6e73 666f 726d 2866 6c6f 6174 5f64 6174  nsform(float_dat
-000129a0: 6129 0a0a 2020 2020 2020 2020 2020 2020  a)..            
-000129b0: 7063 615f 6461 7461 203d 2070 642e 4461  pca_data = pd.Da
-000129c0: 7461 4672 616d 6528 7063 615f 7265 6475  taFrame(pca_redu
-000129d0: 6365 645f 6461 7461 2c20 696e 6465 783d  ced_data, index=
-000129e0: 6665 6174 7572 6573 292e 540a 0a20 2020  features).T..   
-000129f0: 2020 2020 2020 2020 2074 736e 655f 6461           tsne_da
-00012a00: 7461 203d 2073 656c 662e 5f74 736e 6528  ta = self._tsne(
-00012a10: 6461 7461 3d70 6361 5f64 6174 612c 2070  data=pca_data, p
-00012a20: 6572 706c 6578 6974 793d 7065 7270 6c65  erplexity=perple
-00012a30: 7869 7479 2c20 6c65 6172 6e69 6e67 5f72  xity, learning_r
-00012a40: 6174 653d 6c65 6172 6e69 6e67 5f72 6174  ate=learning_rat
-00012a50: 652c 2065 6172 6c79 5f65 7861 6767 6572  e, early_exagger
-00012a60: 6174 696f 6e3d 6561 726c 795f 6578 6167  ation=early_exag
-00012a70: 6765 7261 7469 6f6e 290a 0a20 2020 2020  geration)..     
-00012a80: 2020 2020 2020 2073 6e73 2e73 6361 7474         sns.scatt
-00012a90: 6572 706c 6f74 2864 6174 613d 7473 6e65  erplot(data=tsne
-00012aa0: 5f64 6174 612c 2078 3d27 5453 4e45 2031  _data, x='TSNE 1
-00012ab0: 272c 2079 3d27 5453 4e45 2032 272c 2068  ', y='TSNE 2', h
-00012ac0: 7565 3d27 6665 6174 7572 6573 272c 2061  ue='features', a
-00012ad0: 783d 6178 290a 2020 2020 2020 2020 2020  x=ax).          
-00012ae0: 2020 6178 2e73 6574 5f74 6974 6c65 2874    ax.set_title(t
-00012af0: 6974 6c65 290a 2020 2020 2020 2020 2020  itle).          
-00012b00: 2020 736e 732e 6465 7370 696e 6528 290a    sns.despine().
-00012b10: 0a20 2020 2020 2020 2069 6620 7361 7665  .        if save
-00012b20: 6669 6720 3d3d 2054 7275 653a 0a20 2020  fig == True:.   
-00012b30: 2020 2020 2020 2020 2066 6967 2e73 6176           fig.sav
-00012b40: 6566 6967 2827 7365 715f 7063 615f 745f  efig('seq_pca_t_
-00012b50: 534e 455f 706c 6f74 2e70 6466 272c 2062  SNE_plot.pdf', b
-00012b60: 626f 785f 696e 6368 6573 3d27 7469 6768  box_inches='tigh
-00012b70: 7427 2c20 7472 616e 7370 6172 656e 743d  t', transparent=
-00012b80: 5472 7565 290a 0000 0000 0000 0000 0000  True)...........
-00012b90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012ba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012bb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012bc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012bd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012be0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012bf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012c00: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-00012c10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012c20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012c30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012c40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012c50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012c60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-00012c70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00012c80: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
-00012c90: 3030 3000 3031 3032 3133 0020 7800 0000  000.010213. x...
-00012ca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012cb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012cc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012cd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012ce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012cf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012d00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-00012d10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012d20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012d30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012d40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012d50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012d60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012d70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012d80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012d90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012da0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012db0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012dc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012dd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012de0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012df0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012e00: 3232 206d 7469 6d65 3d31 3638 3834 3937  22 mtime=1688497
-00012e10: 3330 392e 300a 0000 0000 0000 0000 0000  309.0...........
-00012e20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012e30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012e40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012e50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012e60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012e70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012e80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012e90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012ea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012eb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012ec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012ed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012ee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012ef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012f00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012f10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012f20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012f30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012f40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012f50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012f60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012f70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012f80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000e200: 3232 206d 7469 6d65 3d31 3638 3835 3732  22 mtime=1688572
+0000e210: 3039 322e 300a 0000 0000 0000 0000 0000  092.0...........
+0000e220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000e230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000e240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000e250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000e260: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000e270: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000e280: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000e290: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000e2a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000e2b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000e2c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000e2d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000e2e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000e2f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000e300: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000e310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000e320: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000e330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000e340: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000e350: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000e360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000e370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000e380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000e390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000e3a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000e3b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000e3c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000e3d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000e3e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000e3f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000e400: 7072 6f74 656f 6d69 6373 5f64 6f77 6e73  proteomics_downs
+0000e410: 7472 6561 6d5f 616e 616c 7973 6973 2d30  tream_analysis-0
+0000e420: 2e31 2e33 2f70 726f 7465 6f6d 6963 735f  .1.3/proteomics_
+0000e430: 646f 776e 7374 7265 616d 5f61 6e61 6c79  downstream_analy
+0000e440: 7369 732f 6469 6d65 6e73 696f 6e61 6c69  sis/dimensionali
+0000e450: 7479 7265 6475 6374 696f 6e2e 7079 0000  tyreduction.py..
+0000e460: 0000 0000 3030 3030 3634 3400 3030 3031  ....0000644.0001
+0000e470: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
+0000e480: 3030 3434 3630 3600 3134 3435 3133 3130  0044606.14451310
+0000e490: 3237 3400 3033 3333 3332 0020 3000 0000  274.033332. 0...
+0000e4a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000e4b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000e4c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000e4d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000e4e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000e4f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000e500: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
+0000e510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000e520: 0000 0000 0000 0000 0064 6f63 6b65 7200  .........docker.
+0000e530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000e540: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000e550: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000e560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000e570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000e580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000e590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000e5a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000e5b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000e5c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000e5d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000e5e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000e5f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000e600: 696d 706f 7274 2070 616e 6461 7320 6173  import pandas as
+0000e610: 2070 640a 696d 706f 7274 206e 756d 7079   pd.import numpy
+0000e620: 2061 7320 6e70 0a0a 696d 706f 7274 2073   as np..import s
+0000e630: 6561 626f 726e 2061 7320 736e 730a 696d  eaborn as sns.im
+0000e640: 706f 7274 206d 6174 706c 6f74 6c69 622e  port matplotlib.
+0000e650: 7079 706c 6f74 2061 7320 706c 740a 0a66  pyplot as plt..f
+0000e660: 726f 6d20 736b 6c65 6172 6e2e 7072 6570  rom sklearn.prep
+0000e670: 726f 6365 7373 696e 6720 696d 706f 7274  rocessing import
+0000e680: 2053 7461 6e64 6172 6453 6361 6c65 720a   StandardScaler.
+0000e690: 6672 6f6d 2073 6b6c 6561 726e 2e64 6563  from sklearn.dec
+0000e6a0: 6f6d 706f 7369 7469 6f6e 2069 6d70 6f72  omposition impor
+0000e6b0: 7420 5043 410a 6672 6f6d 2073 6b6c 6561  t PCA.from sklea
+0000e6c0: 726e 2e6d 616e 6966 6f6c 6420 696d 706f  rn.manifold impo
+0000e6d0: 7274 2054 534e 450a 0a69 6d70 6f72 7420  rt TSNE..import 
+0000e6e0: 756d 6170 2061 7320 6d70 0a0a 6672 6f6d  umap as mp..from
+0000e6f0: 2061 646a 7573 7454 6578 7420 696d 706f   adjustText impo
+0000e700: 7274 2061 646a 7573 745f 7465 7874 0a0a  rt adjust_text..
+0000e710: 6672 6f6d 2070 6c6f 746c 792e 7375 6270  from plotly.subp
+0000e720: 6c6f 7473 2069 6d70 6f72 7420 6d61 6b65  lots import make
+0000e730: 5f73 7562 706c 6f74 730a 696d 706f 7274  _subplots.import
+0000e740: 2070 6c6f 746c 792e 6578 7072 6573 7320   plotly.express 
+0000e750: 6173 2070 780a 0a66 726f 6d20 2e75 7469  as px..from .uti
+0000e760: 6c73 2069 6d70 6f72 7420 6973 5f6a 7570  ls import is_jup
+0000e770: 7974 6572 5f6e 6f74 6562 6f6f 6b0a 696d  yter_notebook.im
+0000e780: 706f 7274 2073 7472 6561 6d6c 6974 2061  port streamlit a
+0000e790: 7320 7374 0a0a 636c 6173 7320 4469 6d65  s st..class Dime
+0000e7a0: 6e73 696f 6e61 6c69 7479 5265 6475 6374  nsionalityReduct
+0000e7b0: 696f 6e3a 0a20 2020 2022 2222 2022 2222  ion:.    """ """
+0000e7c0: 0a0a 2020 2020 6465 6620 5f70 6361 2873  ..    def _pca(s
+0000e7d0: 656c 662c 2064 6174 613d 4e6f 6e65 293a  elf, data=None):
+0000e7e0: 0a0a 2020 2020 2020 2020 2222 2247 656e  ..        """Gen
+0000e7f0: 6572 6174 6520 6120 5043 410a 0a20 2020  erate a PCA..   
+0000e800: 2020 2020 2050 6172 616d 6574 6572 730a       Parameters.
+0000e810: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+0000e820: 2d2d 0a20 2020 2020 2020 2064 6174 6120  --.        data 
+0000e830: 3a20 7064 2e44 6174 6146 7261 6d65 0a20  : pd.DataFrame. 
+0000e840: 2020 2020 2020 2020 2020 2020 4461 7461              Data
+0000e850: 2074 6f20 6265 2064 6563 6f6d 706f 7365   to be decompose
+0000e860: 6420 2844 6566 6175 6c74 2076 616c 7565  d (Default value
+0000e870: 203d 204e 6f6e 6529 0a0a 2020 2020 2020   = None)..      
+0000e880: 2020 5265 7475 726e 730a 2020 2020 2020    Returns.      
+0000e890: 2020 2d2d 2d2d 2d2d 2d0a 2020 2020 2020    -------.      
+0000e8a0: 2020 7063 6120 3a20 736b 6c65 6172 6e2e    pca : sklearn.
+0000e8b0: 6465 636f 6d70 6f73 6974 696f 6e2e 5043  decomposition.PC
+0000e8c0: 410a 2020 2020 2020 2020 2020 2020 5043  A.            PC
+0000e8d0: 4120 6f62 6a65 6374 0a20 2020 2020 2020  A object.       
+0000e8e0: 2066 696e 616c 4466 203a 2070 642e 4461   finalDf : pd.Da
+0000e8f0: 7461 4672 616d 650a 2020 2020 2020 2020  taFrame.        
+0000e900: 2020 2020 4461 7461 6672 616d 6520 7769      Dataframe wi
+0000e910: 7468 2070 7269 6e63 6970 616c 2063 6f6d  th principal com
+0000e920: 706f 6e65 6e74 7320 616e 6420 7461 7267  ponents and targ
+0000e930: 6574 2063 6f6c 756d 6e0a 2020 2020 2020  et column.      
+0000e940: 2020 2222 220a 0a20 2020 2020 2020 2069    """..        i
+0000e950: 6620 6973 696e 7374 616e 6365 2864 6174  f isinstance(dat
+0000e960: 612c 2070 642e 4461 7461 4672 616d 6529  a, pd.DataFrame)
+0000e970: 3a0a 2020 2020 2020 2020 2020 2020 6466  :.            df
+0000e980: 203d 2064 6174 612e 7365 6c65 6374 5f64   = data.select_d
+0000e990: 7479 7065 7328 696e 636c 7564 6520 3d5b  types(include =[
+0000e9a0: 2766 6c6f 6174 3634 275d 292e 542e 636f  'float64']).T.co
+0000e9b0: 7079 2829 0a0a 2020 2020 2020 2020 656c  py()..        el
+0000e9c0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+0000e9d0: 2320 7072 6570 6172 6520 7468 6520 6461  # prepare the da
+0000e9e0: 7461 6672 616d 6520 666f 7220 5043 410a  taframe for PCA.
+0000e9f0: 2020 2020 2020 2020 2020 2020 6466 203d              df =
+0000ea00: 2073 656c 662e 6461 7461 2e73 656c 6563   self.data.selec
+0000ea10: 745f 6474 7970 6573 2869 6e63 6c75 6465  t_dtypes(include
+0000ea20: 203d 5b27 666c 6f61 7436 3427 5d29 2e54   =['float64']).T
+0000ea30: 2e63 6f70 7928 290a 0a20 2020 2020 2020  .copy()..       
+0000ea40: 2023 2070 7265 7061 7265 2066 6561 7475   # prepare featu
+0000ea50: 7265 7320 7661 7269 6162 6c65 2028 4765  res variable (Ge
+0000ea60: 6e65 7329 0a20 2020 2020 2020 2066 6561  nes).        fea
+0000ea70: 7475 7265 7320 3d20 6c69 7374 286e 702e  tures = list(np.
+0000ea80: 6172 616e 6765 2864 662e 7368 6170 655b  arange(df.shape[
+0000ea90: 315d 2929 0a20 2020 2020 2020 2064 662e  1])).        df.
+0000eaa0: 636f 6c75 6d6e 7320 3d20 6665 6174 7572  columns = featur
+0000eab0: 6573 0a20 2020 2020 2020 200a 2020 2020  es.        .    
+0000eac0: 2020 2020 2320 7072 6570 6172 6520 7461      # prepare ta
+0000ead0: 7267 6574 2063 6f6c 756d 6e20 2873 616d  rget column (sam
+0000eae0: 706c 6520 7479 7065 7329 0a20 2020 2020  ple types).     
+0000eaf0: 2020 2064 665b 2774 6172 6765 7427 5d20     df['target'] 
+0000eb00: 3d20 6466 2e69 6e64 6578 0a20 2020 2020  = df.index.     
+0000eb10: 2020 2064 6620 3d20 6466 2e72 6573 6574     df = df.reset
+0000eb20: 5f69 6e64 6578 2864 726f 703d 2054 7275  _index(drop= Tru
+0000eb30: 6529 0a0a 2020 2020 2020 2020 2320 5365  e)..        # Se
+0000eb40: 7061 7261 7469 6e67 206f 7574 2074 6865  parating out the
+0000eb50: 2066 6561 7475 7265 730a 2020 2020 2020   features.      
+0000eb60: 2020 7820 3d20 6466 2e6c 6f63 5b3a 2c20    x = df.loc[:, 
+0000eb70: 6665 6174 7572 6573 5d2e 7661 6c75 6573  features].values
+0000eb80: 0a20 2020 2020 2020 200a 2020 2020 2020  .        .      
+0000eb90: 2020 2320 5365 7061 7261 7469 6e67 206f    # Separating o
+0000eba0: 7574 2074 6865 2074 6172 6765 740a 2020  ut the target.  
+0000ebb0: 2020 2020 2020 7920 3d20 6466 2e6c 6f63        y = df.loc
+0000ebc0: 5b3a 2c5b 2774 6172 6765 7427 5d5d 2e76  [:,['target']].v
+0000ebd0: 616c 7565 730a 2020 2020 2020 2020 0a20  alues.        . 
+0000ebe0: 2020 2020 2020 2023 2053 7461 6e64 6172         # Standar
+0000ebf0: 6469 7a69 6e67 2074 6865 2066 6561 7475  dizing the featu
+0000ec00: 7265 730a 2020 2020 2020 2020 7820 3d20  res.        x = 
+0000ec10: 5374 616e 6461 7264 5363 616c 6572 2829  StandardScaler()
+0000ec20: 2e66 6974 5f74 7261 6e73 666f 726d 2878  .fit_transform(x
+0000ec30: 290a 2020 2020 2020 2020 7063 6120 3d20  ).        pca = 
+0000ec40: 5043 4128 6e5f 636f 6d70 6f6e 656e 7473  PCA(n_components
+0000ec50: 3d32 290a 2020 2020 2020 2020 7072 696e  =2).        prin
+0000ec60: 6369 7061 6c43 6f6d 706f 6e65 6e74 7320  cipalComponents 
+0000ec70: 3d20 7063 612e 6669 745f 7472 616e 7366  = pca.fit_transf
+0000ec80: 6f72 6d28 7829 0a20 2020 2020 2020 2070  orm(x).        p
+0000ec90: 7269 6e63 6970 616c 4466 203d 2070 642e  rincipalDf = pd.
+0000eca0: 4461 7461 4672 616d 6528 6461 7461 203d  DataFrame(data =
+0000ecb0: 2070 7269 6e63 6970 616c 436f 6d70 6f6e   principalCompon
+0000ecc0: 656e 7473 0a20 2020 2020 2020 2020 2020  ents.           
+0000ecd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ece0: 2020 2020 202c 636f 6c75 6d6e 7320 3d20       ,columns = 
+0000ecf0: 5b27 7072 696e 6369 7061 6c20 636f 6d70  ['principal comp
+0000ed00: 6f6e 656e 7420 3127 2c20 2770 7269 6e63  onent 1', 'princ
+0000ed10: 6970 616c 2063 6f6d 706f 6e65 6e74 2032  ipal component 2
+0000ed20: 275d 290a 2020 2020 2020 2020 0a20 2020  ']).        .   
+0000ed30: 2020 2020 2066 696e 616c 4466 203d 2070       finalDf = p
+0000ed40: 642e 636f 6e63 6174 285b 7072 696e 6369  d.concat([princi
+0000ed50: 7061 6c44 662c 2064 665b 5b27 7461 7267  palDf, df[['targ
+0000ed60: 6574 275d 5d5d 2c20 6178 6973 203d 2031  et']]], axis = 1
+0000ed70: 290a 2020 2020 2020 2020 0a20 2020 2020  ).        .     
+0000ed80: 2020 2072 6574 7572 6e20 7063 612c 2066     return pca, f
+0000ed90: 696e 616c 4466 0a0a 2020 2020 6465 6620  inalDf..    def 
+0000eda0: 7063 615f 706c 6f74 2873 656c 662c 206e  pca_plot(self, n
+0000edb0: 5f72 6f77 733d 312c 206e 5f63 6f6c 733d  _rows=1, n_cols=
+0000edc0: 312c 2074 6974 6c65 733d 5b27 275d 2c20  1, titles=[''], 
+0000edd0: 6669 6773 697a 653d 2835 2c20 3529 2c20  figsize=(5, 5), 
+0000ede0: 7361 7665 6669 673d 4661 6c73 6529 3a0a  savefig=False):.
+0000edf0: 2020 2020 2020 2020 0a20 2020 2020 2020          .       
+0000ee00: 2022 2222 0a20 2020 2020 2020 2050 6c6f   """.        Plo
+0000ee10: 7420 5043 4120 666f 7220 6f6e 6520 6f72  t PCA for one or
+0000ee20: 206d 6f72 6520 6461 7461 7365 7473 2e0a   more datasets..
+0000ee30: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
+0000ee40: 6572 730a 2020 2020 2020 2020 2d2d 2d2d  ers.        ----
+0000ee50: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 206e  ------.        n
+0000ee60: 5f72 6f77 7320 3a20 696e 740a 2020 2020  _rows : int.    
+0000ee70: 2020 2020 2020 2020 204e 756d 6265 7220           Number 
+0000ee80: 6f66 2072 6f77 7320 696e 2073 7562 706c  of rows in subpl
+0000ee90: 6f74 2028 4465 6661 756c 7420 7661 6c75  ot (Default valu
+0000eea0: 6520 3d20 3129 0a0a 2020 2020 2020 2020  e = 1)..        
+0000eeb0: 6e5f 636f 6c73 203a 2069 6e74 0a20 2020  n_cols : int.   
+0000eec0: 2020 2020 2020 2020 2020 4e75 6d62 6572            Number
+0000eed0: 206f 6620 636f 6c75 6d73 6e20 696e 2073   of columsn in s
+0000eee0: 7562 706c 6f74 2028 4465 6661 756c 7420  ubplot (Default 
+0000eef0: 7661 6c75 6520 3d20 3129 0a0a 2020 2020  value = 1)..    
+0000ef00: 2020 2020 7469 746c 6573 203a 206c 6973      titles : lis
+0000ef10: 740a 2020 2020 2020 2020 2020 2020 204c  t.             L
+0000ef20: 6973 7420 6f66 2074 6974 6c65 7320 2844  ist of titles (D
+0000ef30: 6566 6175 6c74 2076 616c 7565 203d 205b  efault value = [
+0000ef40: 2727 5d29 0a0a 2020 2020 2020 2020 6669  ''])..        fi
+0000ef50: 6773 697a 6520 3a20 7475 706c 650a 2020  gsize : tuple.  
+0000ef60: 2020 2020 2020 2020 2020 2046 6967 7572             Figur
+0000ef70: 6520 7369 7a65 2028 4465 6661 756c 7420  e size (Default 
+0000ef80: 7661 6c75 6520 3d20 2835 2c35 290a 2020  value = (5,5).  
+0000ef90: 2020 2020 2020 2020 2020 0a20 2020 2020            .     
+0000efa0: 2020 2073 6176 6566 6967 203a 2062 6f6f     savefig : boo
+0000efb0: 6c0a 2020 2020 2020 2020 2020 2020 2049  l.             I
+0000efc0: 6620 5472 7565 2c20 7361 7665 2066 6967  f True, save fig
+0000efd0: 7572 6520 2844 6566 6175 6c74 2076 616c  ure (Default val
+0000efe0: 7565 203d 2046 616c 7365 290a 0a20 2020  ue = False)..   
+0000eff0: 2020 2020 2052 6574 7572 6e73 0a20 2020       Returns.   
+0000f000: 2020 2020 202d 2d2d 2d2d 2d2d 0a20 2020       -------.   
+0000f010: 2020 2020 206d 6174 706c 6f74 6c69 622e       matplotlib.
+0000f020: 7079 706c 6f74 2e73 7562 706c 6f74 730a  pyplot.subplots.
+0000f030: 2020 2020 2020 2020 2222 220a 0a20 2020          """..   
+0000f040: 2020 2020 2069 6620 6e5f 726f 7773 203d       if n_rows =
+0000f050: 3d20 3120 616e 6420 6e5f 636f 6c73 203d  = 1 and n_cols =
+0000f060: 3d20 313a 0a20 2020 2020 2020 2020 2020  = 1:.           
+0000f070: 2070 6361 5f64 6174 6120 3d20 5b73 656c   pca_data = [sel
+0000f080: 662e 5f70 6361 2829 5d0a 0a20 2020 2020  f._pca()]..     
+0000f090: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+0000f0a0: 2020 2020 2070 6361 5f64 6174 6120 3d20       pca_data = 
+0000f0b0: 5b73 656c 662e 5f70 6361 2869 2920 666f  [self._pca(i) fo
+0000f0c0: 7220 6920 696e 2073 656c 662e 6461 7461  r i in self.data
+0000f0d0: 7365 7473 5d0a 0a20 2020 2020 2020 2066  sets]..        f
+0000f0e0: 6967 2c20 6178 203d 2070 6c74 2e73 7562  ig, ax = plt.sub
+0000f0f0: 706c 6f74 7328 6e5f 726f 7773 2c20 6e5f  plots(n_rows, n_
+0000f100: 636f 6c73 2c20 6669 6773 697a 653d 6669  cols, figsize=fi
+0000f110: 6773 697a 6529 0a0a 2020 2020 2020 2020  gsize)..        
+0000f120: 666f 7220 6461 7461 5f73 6574 2c20 6178  for data_set, ax
+0000f130: 6573 2c20 7469 746c 6520 696e 207a 6970  es, title in zip
+0000f140: 2870 6361 5f64 6174 612c 206e 702e 6172  (pca_data, np.ar
+0000f150: 7261 7928 6178 292e 666c 6174 7465 6e28  ray(ax).flatten(
+0000f160: 292c 2074 6974 6c65 7329 3a0a 2020 2020  ), titles):.    
+0000f170: 2020 2020 2020 2020 736e 732e 7363 6174          sns.scat
+0000f180: 7465 7270 6c6f 7428 6461 7461 3d64 6174  terplot(data=dat
+0000f190: 615f 7365 745b 315d 2c20 783d 2770 7269  a_set[1], x='pri
+0000f1a0: 6e63 6970 616c 2063 6f6d 706f 6e65 6e74  ncipal component
+0000f1b0: 2031 272c 2079 3d27 7072 696e 6369 7061   1', y='principa
+0000f1c0: 6c20 636f 6d70 6f6e 656e 7420 3227 2c20  l component 2', 
+0000f1d0: 6875 653d 2774 6172 6765 7427 2c20 6178  hue='target', ax
+0000f1e0: 3d61 7865 7329 0a20 2020 2020 2020 2020  =axes).         
+0000f1f0: 2020 2070 6331 203d 2022 252e 3266 2220     pc1 = "%.2f" 
+0000f200: 2520 2864 6174 615f 7365 745b 305d 2e65  % (data_set[0].e
+0000f210: 7870 6c61 696e 6564 5f76 6172 6961 6e63  xplained_varianc
+0000f220: 655f 7261 7469 6f5f 5b30 5d20 2a20 3130  e_ratio_[0] * 10
+0000f230: 3029 0a20 2020 2020 2020 2020 2020 2070  0).            p
+0000f240: 6332 203d 2022 252e 3266 2220 2520 2864  c2 = "%.2f" % (d
+0000f250: 6174 615f 7365 745b 305d 2e65 7870 6c61  ata_set[0].expla
+0000f260: 696e 6564 5f76 6172 6961 6e63 655f 7261  ined_variance_ra
+0000f270: 7469 6f5f 5b31 5d20 2a20 3130 3029 0a20  tio_[1] * 100). 
+0000f280: 2020 2020 2020 2020 2020 2061 7865 732e             axes.
+0000f290: 7365 7428 786c 6162 656c 3d66 2750 4331  set(xlabel=f'PC1
+0000f2a0: 207b 7063 317d 2527 2c20 796c 6162 656c   {pc1}%', ylabel
+0000f2b0: 3d66 2750 4332 207b 7063 327d 2527 290a  =f'PC2 {pc2}%').
+0000f2c0: 2020 2020 2020 2020 2020 2020 6178 6573              axes
+0000f2d0: 2e73 6574 5f74 6974 6c65 2874 6974 6c65  .set_title(title
+0000f2e0: 290a 2020 2020 2020 2020 2020 2020 6178  ).            ax
+0000f2f0: 6573 2e6c 6567 656e 6428 6c6f 633d 2762  es.legend(loc='b
+0000f300: 6573 7427 290a 2020 2020 2020 2020 2020  est').          
+0000f310: 2020 736e 732e 6465 7370 696e 6528 290a    sns.despine().
+0000f320: 0a20 2020 2020 2020 2066 6967 2e74 6967  .        fig.tig
+0000f330: 6874 5f6c 6179 6f75 7428 290a 0a20 2020  ht_layout()..   
+0000f340: 2020 2020 2069 6620 7361 7665 6669 673a       if savefig:
+0000f350: 0a20 2020 2020 2020 2020 2020 2066 6967  .            fig
+0000f360: 2e73 6176 6566 6967 2827 7063 615f 706c  .savefig('pca_pl
+0000f370: 6f74 732e 7064 6627 2c20 6262 6f78 5f69  ots.pdf', bbox_i
+0000f380: 6e63 6865 733d 2774 6967 6874 272c 2074  nches='tight', t
+0000f390: 7261 6e73 7061 7265 6e74 3d54 7275 6529  ransparent=True)
+0000f3a0: 0a20 2020 200a 2020 2020 6465 6620 696e  .    .    def in
+0000f3b0: 745f 7063 615f 706c 6f74 2873 656c 662c  t_pca_plot(self,
+0000f3c0: 206e 5f72 6f77 733d 312c 206e 5f63 6f6c   n_rows=1, n_col
+0000f3d0: 733d 312c 2074 6974 6c65 733d 5b27 275d  s=1, titles=['']
+0000f3e0: 2c20 6865 6967 6874 3d35 3030 2c20 7769  , height=500, wi
+0000f3f0: 6474 683d 3730 3029 3a0a 0a20 2020 2020  dth=700):..     
+0000f400: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+0000f410: 2020 2050 6c6f 7420 696e 7465 7261 6374     Plot interact
+0000f420: 6976 6520 5043 4120 666f 7220 6f6e 6520  ive PCA for one 
+0000f430: 6f72 206d 6f72 6520 6461 7461 7365 7473  or more datasets
+0000f440: 2e0a 2020 2020 2020 2020 2020 5061 7261  ..          Para
+0000f450: 6d65 7465 7273 0a20 2020 2020 2020 2020  meters.         
+0000f460: 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020   ----------.    
+0000f470: 2020 2020 2020 6e5f 726f 7773 203a 2069        n_rows : i
+0000f480: 6e74 0a20 2020 2020 2020 2020 2020 2020  nt.             
+0000f490: 2020 4e75 6d62 6572 206f 6620 726f 7773    Number of rows
+0000f4a0: 2069 6e20 7375 6270 6c6f 7420 2844 6566   in subplot (Def
+0000f4b0: 6175 6c74 2076 616c 7565 203d 2031 290a  ault value = 1).
+0000f4c0: 0a20 2020 2020 2020 2020 206e 5f63 6f6c  .          n_col
+0000f4d0: 7320 3a20 696e 740a 2020 2020 2020 2020  s : int.        
+0000f4e0: 2020 2020 2020 204e 756d 6265 7220 6f66         Number of
+0000f4f0: 2063 6f6c 756d 6e73 2069 6e20 7375 6270   columns in subp
+0000f500: 6c6f 7420 2844 6566 6175 6c74 2076 616c  lot (Default val
+0000f510: 7565 203d 2031 290a 0a20 2020 2020 2020  ue = 1)..       
+0000f520: 2020 2074 6974 6c65 7320 3a20 6c69 7374     titles : list
+0000f530: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000f540: 4c69 7374 206f 6620 7469 746c 6573 2066  List of titles f
+0000f550: 6f72 2073 7562 706c 6f74 2028 4465 6661  or subplot (Defa
+0000f560: 756c 7420 7661 6c75 6520 3d20 5b27 275d  ult value = ['']
+0000f570: 290a 0a20 2020 2020 2020 2020 2068 6569  )..          hei
+0000f580: 6768 7420 3a20 696e 740a 2020 2020 2020  ght : int.      
+0000f590: 2020 2020 2020 2020 2028 4465 6661 756c           (Defaul
+0000f5a0: 7420 7661 6c75 6520 3d20 3530 3029 0a0a  t value = 500)..
+0000f5b0: 2020 2020 2020 2020 2020 7769 6474 6820            width 
+0000f5c0: 3a20 696e 740a 2020 2020 2020 2020 2020  : int.          
+0000f5d0: 2020 2020 2028 4465 6661 756c 7420 7661       (Default va
+0000f5e0: 6c75 6520 3d20 3730 3029 0a0a 2020 2020  lue = 700)..    
+0000f5f0: 2020 2020 2020 5265 7475 726e 730a 2020        Returns.  
+0000f600: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d0a          -------.
+0000f610: 2020 2020 2020 2020 2020 706c 6f74 6c79            plotly
+0000f620: 2e73 7562 706c 6f74 732e 6d61 6b65 5f73  .subplots.make_s
+0000f630: 7562 706c 6f74 730a 2020 2020 2020 2020  ubplots.        
+0000f640: 2020 2222 220a 0a20 2020 2020 2020 2020    """..         
+0000f650: 2069 6620 6e5f 726f 7773 203d 3d20 3120   if n_rows == 1 
+0000f660: 616e 6420 6e5f 636f 6c73 203d 3d20 313a  and n_cols == 1:
+0000f670: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000f680: 7063 615f 6461 7461 203d 205b 7365 6c66  pca_data = [self
+0000f690: 2e5f 7063 6128 295b 315d 5d0a 2020 2020  ._pca()[1]].    
+0000f6a0: 2020 2020 2020 2020 2020 2070 6361 203d             pca =
+0000f6b0: 205b 7365 6c66 2e5f 7063 6128 295b 305d   [self._pca()[0]
+0000f6c0: 5d0a 0a20 2020 2020 2020 2020 2065 6c73  ]..          els
+0000f6d0: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+0000f6e0: 2020 7063 615f 6461 7461 203d 205b 7365    pca_data = [se
+0000f6f0: 6c66 2e5f 7063 6128 6929 5b31 5d20 666f  lf._pca(i)[1] fo
+0000f700: 7220 6920 696e 2073 656c 662e 6461 7461  r i in self.data
+0000f710: 7365 7473 5d0a 2020 2020 2020 2020 2020  sets].          
+0000f720: 2020 2020 2070 6361 203d 205b 7365 6c66       pca = [self
+0000f730: 2e5f 7063 6128 6929 5b30 5d20 666f 7220  ._pca(i)[0] for 
+0000f740: 6920 696e 2073 656c 662e 6461 7461 7365  i in self.datase
+0000f750: 7473 5d0a 0a20 2020 2020 2020 2020 2066  ts]..          f
+0000f760: 6f72 2069 2069 6e20 7063 615f 6461 7461  or i in pca_data
+0000f770: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0000f780: 2069 5b27 6964 7827 5d20 3d20 692e 696e   i['idx'] = i.in
+0000f790: 6465 780a 0a20 2020 2020 2020 2020 2023  dex..          #
+0000f7a0: 2070 6c6f 7473 203d 205b 7078 2e73 6361   plots = [px.sca
+0000f7b0: 7474 6572 2864 6174 6173 6574 2c20 783d  tter(dataset, x=
+0000f7c0: 2270 7269 6e63 6970 616c 2063 6f6d 706f  "principal compo
+0000f7d0: 6e65 6e74 2031 222c 2079 3d22 7072 696e  nent 1", y="prin
+0000f7e0: 6369 7061 6c20 636f 6d70 6f6e 656e 7420  cipal component 
+0000f7f0: 3222 2c20 0a20 2020 2020 2020 2020 2023  2", .          #
+0000f800: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f810: 2020 2020 2063 6f6c 6f72 3d22 7461 7267       color="targ
+0000f820: 6574 222c 2068 6f76 6572 5f64 6174 613d  et", hover_data=
+0000f830: 5b27 6964 7827 5d2c 2074 656d 706c 6174  ['idx'], templat
+0000f840: 653d 2773 696d 706c 655f 7768 6974 6527  e='simple_white'
+0000f850: 2920 666f 7220 6461 7461 7365 7420 696e  ) for dataset in
+0000f860: 2070 6361 5f64 6174 615d 0a0a 2020 2020   pca_data]..    
+0000f870: 2020 2020 2020 706c 6f74 7320 3d20 5b5d        plots = []
+0000f880: 0a0a 2020 2020 2020 2020 2020 6669 6720  ..          fig 
+0000f890: 3d20 6d61 6b65 5f73 7562 706c 6f74 7328  = make_subplots(
+0000f8a0: 726f 7773 3d6e 5f72 6f77 732c 2063 6f6c  rows=n_rows, col
+0000f8b0: 733d 6e5f 636f 6c73 2c20 7375 6270 6c6f  s=n_cols, subplo
+0000f8c0: 745f 7469 746c 6573 3d74 6974 6c65 7329  t_titles=titles)
+0000f8d0: 0a20 2020 2020 2020 2020 200a 2020 2020  .          .    
+0000f8e0: 2020 2020 2020 666f 7220 6461 7461 7365        for datase
+0000f8f0: 742c 2070 6361 5f63 6f6d 7020 696e 207a  t, pca_comp in z
+0000f900: 6970 2870 6361 5f64 6174 612c 2070 6361  ip(pca_data, pca
+0000f910: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+0000f920: 2020 706c 6f74 203d 2070 782e 7363 6174    plot = px.scat
+0000f930: 7465 7228 6461 7461 7365 742c 2078 3d22  ter(dataset, x="
+0000f940: 7072 696e 6369 7061 6c20 636f 6d70 6f6e  principal compon
+0000f950: 656e 7420 3122 2c20 793d 2270 7269 6e63  ent 1", y="princ
+0000f960: 6970 616c 2063 6f6d 706f 6e65 6e74 2032  ipal component 2
+0000f970: 222c 200a 2020 2020 2020 2020 2020 2020  ", .            
+0000f980: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f990: 2020 636f 6c6f 723d 2274 6172 6765 7422    color="target"
+0000f9a0: 2c20 686f 7665 725f 6461 7461 3d5b 2769  , hover_data=['i
+0000f9b0: 6478 275d 2c20 7465 6d70 6c61 7465 3d27  dx'], template='
+0000f9c0: 7369 6d70 6c65 5f77 6869 7465 2729 0a20  simple_white'). 
+0000f9d0: 2020 2020 2020 2020 2020 2020 2020 0a20                . 
+0000f9e0: 2020 2020 2020 2020 2020 2020 2020 2320                # 
+0000f9f0: 4361 6c63 756c 6174 6520 6578 706c 6169  Calculate explai
+0000fa00: 6e65 6420 7661 7269 616e 6365 2066 6f72  ned variance for
+0000fa10: 2050 4331 2061 6e64 2050 4332 0a20 2020   PC1 and PC2.   
+0000fa20: 2020 2020 2020 2020 2020 2020 7063 315f              pc1_
+0000fa30: 6569 6765 6e76 616c 7565 203d 2022 252e  eigenvalue = "%.
+0000fa40: 3266 2220 2520 2870 6361 5f63 6f6d 702e  2f" % (pca_comp.
+0000fa50: 6578 706c 6169 6e65 645f 7661 7269 616e  explained_varian
+0000fa60: 6365 5f72 6174 696f 5f5b 305d 202a 2031  ce_ratio_[0] * 1
+0000fa70: 3030 290a 2020 2020 2020 2020 2020 2020  00).            
+0000fa80: 2020 2070 6332 5f65 6967 656e 7661 6c75     pc2_eigenvalu
+0000fa90: 6520 3d20 2225 2e32 6622 2025 2028 7063  e = "%.2f" % (pc
+0000faa0: 615f 636f 6d70 2e65 7870 6c61 696e 6564  a_comp.explained
+0000fab0: 5f76 6172 6961 6e63 655f 7261 7469 6f5f  _variance_ratio_
+0000fac0: 5b31 5d20 2a20 3130 3029 0a20 2020 2020  [1] * 100).     
+0000fad0: 2020 2020 2020 2020 2020 0a20 2020 2020            .     
+0000fae0: 2020 2020 2020 2020 2020 2320 5570 6461            # Upda
+0000faf0: 7465 2070 6c6f 7420 6178 6573 2074 6974  te plot axes tit
+0000fb00: 6c65 730a 2020 2020 2020 2020 2020 2020  les.            
+0000fb10: 2020 2066 6967 2e75 7064 6174 655f 7861     fig.update_xa
+0000fb20: 7865 7328 7469 746c 655f 7465 7874 3d66  xes(title_text=f
+0000fb30: 2750 4331 207b 7063 315f 6569 6765 6e76  'PC1 {pc1_eigenv
+0000fb40: 616c 7565 7d20 2527 290a 2020 2020 2020  alue} %').      
+0000fb50: 2020 2020 2020 2020 2066 6967 2e75 7064           fig.upd
+0000fb60: 6174 655f 7961 7865 7328 7469 746c 655f  ate_yaxes(title_
+0000fb70: 7465 7874 3d66 2750 4332 207b 7063 325f  text=f'PC2 {pc2_
+0000fb80: 6569 6765 6e76 616c 7565 7d20 2527 290a  eigenvalue} %').
+0000fb90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000fba0: 706c 6f74 732e 6170 7065 6e64 2870 6c6f  plots.append(plo
+0000fbb0: 7429 0a0a 2020 2020 2020 2020 2020 726f  t)..          ro
+0000fbc0: 775f 636f 6c5f 6e75 6d62 6572 203d 205b  w_col_number = [
+0000fbd0: 2869 2c20 6a29 2066 6f72 2069 2069 6e20  (i, j) for i in 
+0000fbe0: 7261 6e67 6528 312c 206e 5f72 6f77 732b  range(1, n_rows+
+0000fbf0: 3129 2066 6f72 206a 2069 6e20 7261 6e67  1) for j in rang
+0000fc00: 6528 312c 206e 5f63 6f6c 732b 3129 5d0a  e(1, n_cols+1)].
+0000fc10: 0a20 2020 2020 2020 2020 2066 6f72 2070  .          for p
+0000fc20: 6c6f 742c 2072 6f77 5f63 6f6c 2069 6e20  lot, row_col in 
+0000fc30: 7a69 7028 706c 6f74 732c 2072 6f77 5f63  zip(plots, row_c
+0000fc40: 6f6c 5f6e 756d 6265 7229 3a0a 2020 2020  ol_number):.    
+0000fc50: 2020 2020 2020 2020 2020 2066 6f72 2069             for i
+0000fc60: 6478 2069 6e20 7261 6e67 6528 6c65 6e28  dx in range(len(
+0000fc70: 706c 6f74 5b27 6461 7461 275d 2929 3a0a  plot['data'])):.
+0000fc80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000fc90: 2020 2020 6669 672e 6170 7065 6e64 5f74      fig.append_t
+0000fca0: 7261 6365 2870 6c6f 745b 2764 6174 6127  race(plot['data'
+0000fcb0: 5d5b 6964 785d 2c20 726f 773d 726f 775f  ][idx], row=row_
+0000fcc0: 636f 6c5b 305d 2c20 636f 6c3d 726f 775f  col[0], col=row_
+0000fcd0: 636f 6c5b 315d 290a 0a20 2020 2020 2020  col[1])..       
+0000fce0: 2020 2066 6967 2e75 7064 6174 655f 6c61     fig.update_la
+0000fcf0: 796f 7574 2868 6569 6768 743d 6865 6967  yout(height=heig
+0000fd00: 6874 2c20 7769 6474 683d 7769 6474 682c  ht, width=width,
+0000fd10: 2074 656d 706c 6174 653d 2773 696d 706c   template='simpl
+0000fd20: 655f 7768 6974 6527 290a 2020 2020 2020  e_white').      
+0000fd30: 2020 2020 6669 672e 7570 6461 7465 5f74      fig.update_t
+0000fd40: 7261 6365 7328 6d61 726b 6572 3d64 6963  races(marker=dic
+0000fd50: 7428 7369 7a65 3d31 322c 0a20 2020 2020  t(size=12,.     
+0000fd60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000fd70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000fd80: 2020 206c 696e 653d 6469 6374 2877 6964     line=dict(wid
+0000fd90: 7468 3d32 2c0a 2020 2020 2020 2020 2020  th=2,.          
+0000fda0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000fdb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000fdc0: 2020 2020 2020 2020 636f 6c6f 723d 2744          color='D
+0000fdd0: 6172 6b53 6c61 7465 4772 6579 2729 292c  arkSlateGrey')),
+0000fde0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000fdf0: 2020 2020 2020 2020 2020 7365 6c65 6374            select
+0000fe00: 6f72 3d64 6963 7428 6d6f 6465 3d27 6d61  or=dict(mode='ma
+0000fe10: 726b 6572 7327 2929 0a0a 2020 2020 2020  rkers'))..      
+0000fe20: 2020 2020 2320 5368 6f77 2074 6865 2070      # Show the p
+0000fe30: 6c6f 7420 2020 2020 2020 2020 200a 2020  lot          .  
+0000fe40: 2020 2020 2020 2020 6966 2069 735f 6a75          if is_ju
+0000fe50: 7079 7465 725f 6e6f 7465 626f 6f6b 2829  pyter_notebook()
+0000fe60: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0000fe70: 2066 6967 2e73 686f 7728 290a 2020 2020   fig.show().    
+0000fe80: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+0000fe90: 2020 2020 2020 2020 2020 2073 742e 706c             st.pl
+0000fea0: 6f74 6c79 5f63 6861 7274 2866 6967 2c20  otly_chart(fig, 
+0000feb0: 7573 655f 636f 6e74 6169 6e65 725f 7769  use_container_wi
+0000fec0: 6474 683d 5472 7565 290a 0a20 2020 2064  dth=True)..    d
+0000fed0: 6566 2074 6f70 5f6c 6f61 6469 6e67 7328  ef top_loadings(
+0000fee0: 7365 6c66 2c20 6b29 3a0a 2020 2020 2020  self, k):.      
+0000fef0: 2020 0a20 2020 2020 2020 2022 2222 0a20    .        """. 
+0000ff00: 2020 2020 2020 2047 6574 206b 2066 6561         Get k fea
+0000ff10: 7475 7265 7320 7468 6174 2065 7870 6c61  tures that expla
+0000ff20: 696e 206d 6f73 7420 6f66 2076 6172 6961  in most of varia
+0000ff30: 6e63 6520 696e 2050 4331 2026 2032 0a0a  nce in PC1 & 2..
+0000ff40: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
+0000ff50: 7273 0a20 2020 2020 2020 202d 2d2d 2d2d  rs.        -----
+0000ff60: 2d2d 2d2d 2d0a 2020 2020 2020 2020 6b20  -----.        k 
+0000ff70: 3a20 696e 740a 2020 2020 2020 2020 2020  : int.          
+0000ff80: 2020 4e75 6d62 6572 206f 6620 6d6f 7374    Number of most
+0000ff90: 2069 6d70 6f72 7461 6e74 2066 6561 7475   important featu
+0000ffa0: 7265 7320 746f 2072 6574 7572 6e0a 0a20  res to return.. 
+0000ffb0: 2020 2020 2020 2052 6574 7572 6e73 0a20         Returns. 
+0000ffc0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 0a20         -------. 
+0000ffd0: 2020 2020 2020 2074 6f70 203a 206e 756d         top : num
+0000ffe0: 7079 2e6e 6461 7272 6179 0a20 2020 2020  py.ndarray.     
+0000fff0: 2020 2020 2020 2041 7272 6179 206f 6620         Array of 
+00010000: 746f 7020 6b20 6665 6174 7572 6573 0a20  top k features. 
+00010010: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+00010020: 2020 200a 2020 2020 2020 2020 5820 3d20     .        X = 
+00010030: 6e70 2e61 7272 6179 2873 656c 662e 6461  np.array(self.da
+00010040: 7461 2e73 656c 6563 745f 6474 7970 6573  ta.select_dtypes
+00010050: 2827 666c 6f61 7427 292e 5429 0a0a 2020  ('float').T)..  
+00010060: 2020 2020 2020 2320 616e 616c 7973 6973        # analysis
+00010070: 0a20 2020 2020 2020 2058 5f73 6361 6c65  .        X_scale
+00010080: 6420 3d20 5374 616e 6461 7264 5363 616c  d = StandardScal
+00010090: 6572 2829 2e66 6974 5f74 7261 6e73 666f  er().fit_transfo
+000100a0: 726d 2858 290a 2020 2020 2020 2020 7063  rm(X).        pc
+000100b0: 6120 3d20 5043 4128 6e5f 636f 6d70 6f6e  a = PCA(n_compon
+000100c0: 656e 7473 3d32 292e 6669 7428 585f 7363  ents=2).fit(X_sc
+000100d0: 616c 6564 2920 2020 2020 2020 200a 0a20  aled)        .. 
+000100e0: 2020 2020 2020 2023 2072 6573 756c 7473         # results
+000100f0: 0a20 2020 2020 2020 206c 6f61 6469 6e67  .        loading
+00010100: 203d 2070 6361 2e63 6f6d 706f 6e65 6e74   = pca.component
+00010110: 735f 2e54 0a20 2020 2020 2020 2020 2020  s_.T.           
+00010120: 2020 2020 2020 2020 200a 2020 2020 2020           .      
+00010130: 2020 746f 7078 203d 2028 6c6f 6164 696e    topx = (loadin
+00010140: 6720 2a2a 2032 295b 3a2c 2030 5d2e 6172  g ** 2)[:, 0].ar
+00010150: 6773 6f72 7428 295b 2d6b 3a5d 0a20 2020  gsort()[-k:].   
+00010160: 2020 2020 2074 6f70 7920 3d20 286c 6f61       topy = (loa
+00010170: 6469 6e67 202a 2a20 3229 5b3a 2c20 315d  ding ** 2)[:, 1]
+00010180: 2e61 7267 736f 7274 2829 5b2d 6b3a 5d0a  .argsort()[-k:].
+00010190: 2020 2020 2020 2020 746f 7020 3d20 6e70          top = np
+000101a0: 2e61 7070 656e 6428 746f 7078 2c20 746f  .append(topx, to
+000101b0: 7079 290a 2020 2020 2020 2020 0a20 2020  py).        .   
+000101c0: 2020 2020 2072 6574 7572 6e20 746f 700a       return top.
+000101d0: 2020 2020 0a20 2020 2064 6566 206d 696e      .    def min
+000101e0: 5f76 6172 5f74 6f70 5f6c 6f61 6469 6e67  _var_top_loading
+000101f0: 7328 7365 6c66 2c20 6b2c 2076 6172 6961  s(self, k, varia
+00010200: 6e63 6529 3a0a 0a20 2020 2020 2020 2022  nce):..        "
+00010210: 2222 0a20 2020 2020 2020 2047 6574 206b  "".        Get k
+00010220: 2066 6561 7475 7265 7320 7468 6174 2065   features that e
+00010230: 7870 6c61 696e 206d 6f73 7420 6f66 2076  xplain most of v
+00010240: 6172 6961 6e63 650a 0a20 2020 2020 2020  ariance..       
+00010250: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
+00010260: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20      ----------. 
+00010270: 2020 2020 2020 206b 203a 2069 6e74 0a20         k : int. 
+00010280: 2020 2020 2020 2020 2020 204e 756d 6265             Numbe
+00010290: 7220 6f66 206d 6f73 7420 696d 706f 7274  r of most import
+000102a0: 616e 7420 6665 6174 7572 6573 2074 6f20  ant features to 
+000102b0: 7265 7475 726e 0a0a 2020 2020 2020 2020  return..        
+000102c0: 7661 7269 616e 6365 203a 2066 6c6f 6174  variance : float
+000102d0: 0a20 2020 2020 2020 2020 2020 204d 696e  .            Min
+000102e0: 696d 756d 2076 6172 6961 6e63 650a 0a20  imum variance.. 
+000102f0: 2020 2020 2020 2052 6574 7572 6e73 0a20         Returns. 
+00010300: 2020 2020 2020 202d 2d2d 2d2d 2d2d 0a20         -------. 
+00010310: 2020 2020 2020 2074 6f70 5f66 6561 7475         top_featu
+00010320: 7265 7320 3a20 6c69 7374 0a20 2020 2020  res : list.     
+00010330: 2020 2020 2020 204c 6973 7420 6f66 2074         List of t
+00010340: 6f70 206b 2066 6561 7475 7265 7320 7468  op k features th
+00010350: 6174 2065 7870 6c61 696e 206d 6f73 7420  at explain most 
+00010360: 6f66 2076 6172 6961 6e63 6520 696e 2050  of variance in P
+00010370: 430a 2020 2020 2020 2020 2222 220a 0a20  C.        """.. 
+00010380: 2020 2020 2020 2066 6c6f 6174 5f64 6174         float_dat
+00010390: 6120 3d20 7365 6c66 2e64 6174 612e 7365  a = self.data.se
+000103a0: 6c65 6374 5f64 7479 7065 7328 2766 6c6f  lect_dtypes('flo
+000103b0: 6174 2729 2e54 0a20 2020 2020 2020 2066  at').T.        f
+000103c0: 6c6f 6174 5f64 6174 6120 3d20 5374 616e  loat_data = Stan
+000103d0: 6461 7264 5363 616c 6572 2829 2e66 6974  dardScaler().fit
+000103e0: 5f74 7261 6e73 666f 726d 2866 6c6f 6174  _transform(float
+000103f0: 5f64 6174 6129 0a0a 2020 2020 2020 2020  _data)..        
+00010400: 7063 615f 7769 7468 5f76 6172 6961 6e63  pca_with_varianc
+00010410: 6520 3d20 5043 4128 6e5f 636f 6d70 6f6e  e = PCA(n_compon
+00010420: 656e 7473 3d76 6172 6961 6e63 6529 2e66  ents=variance).f
+00010430: 6974 2866 6c6f 6174 5f64 6174 6129 0a0a  it(float_data)..
+00010440: 2020 2020 2020 2020 6c6f 6164 696e 6720          loading 
+00010450: 3d20 7063 615f 7769 7468 5f76 6172 6961  = pca_with_varia
+00010460: 6e63 652e 636f 6d70 6f6e 656e 7473 5f2e  nce.components_.
+00010470: 540a 0a20 2020 2020 2020 2074 6f70 5f66  T..        top_f
+00010480: 6561 7475 7265 7320 3d20 5b6e 702e 6162  eatures = [np.ab
+00010490: 7328 6c6f 6164 696e 6729 5b3a 2c20 636f  s(loading)[:, co
+000104a0: 6d70 6f6e 656e 745d 2e61 7267 736f 7274  mponent].argsort
+000104b0: 2829 5b2d 6b3a 5d20 666f 7220 636f 6d70  ()[-k:] for comp
+000104c0: 6f6e 656e 7420 696e 2072 616e 6765 286c  onent in range(l
+000104d0: 6f61 6469 6e67 2e73 6861 7065 5b31 5d29  oading.shape[1])
+000104e0: 5d0a 0a20 2020 2020 2020 2074 6f70 5f66  ]..        top_f
+000104f0: 6561 7475 7265 7320 3d20 5b76 616c 7565  eatures = [value
+00010500: 2066 6f72 2074 6f70 5f66 6561 7475 7265   for top_feature
+00010510: 2069 6e20 746f 705f 6665 6174 7572 6573   in top_features
+00010520: 2066 6f72 2076 616c 7565 2069 6e20 746f   for value in to
+00010530: 705f 6665 6174 7572 655d 0a0a 2020 2020  p_feature]..    
+00010540: 2020 2020 7265 7475 726e 2074 6f70 5f66      return top_f
+00010550: 6561 7475 7265 730a 0a20 2020 2064 6566  eatures..    def
+00010560: 2062 6970 6c6f 7428 7365 6c66 2c20 6b3d   biplot(self, k=
+00010570: 352c 206e 5f72 6f77 733d 312c 206e 5f63  5, n_rows=1, n_c
+00010580: 6f6c 733d 312c 2074 6974 6c65 733d 5b27  ols=1, titles=['
+00010590: 275d 2c20 6669 6773 697a 653d 2838 2c33  '], figsize=(8,3
+000105a0: 292c 2073 6176 6566 6967 3d46 616c 7365  ), savefig=False
+000105b0: 293a 0a0a 2020 2020 2020 2020 2222 220a  ):..        """.
+000105c0: 2020 2020 2020 2020 506c 6f74 2062 6970          Plot bip
+000105d0: 6c6f 7420 666f 7220 6f6e 6520 6f72 206d  lot for one or m
+000105e0: 6f72 6520 6461 7461 7365 7473 2e0a 0a20  ore datasets... 
+000105f0: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
+00010600: 730a 2020 2020 2020 2020 2d2d 2d2d 2d2d  s.        ------
+00010610: 2d2d 2d2d 0a20 2020 2020 2020 206b 203a  ----.        k :
+00010620: 2069 6e74 0a20 2020 2020 2020 2020 2020   int.           
+00010630: 2020 4e75 6d62 6572 206f 6620 746f 7020    Number of top 
+00010640: 6c6f 6164 696e 6773 2074 6f20 706c 6f74  loadings to plot
+00010650: 2028 4465 6661 756c 7420 7661 6c75 6520   (Default value 
+00010660: 3d20 3529 0a20 2020 2020 2020 200a 2020  = 5).        .  
+00010670: 2020 2020 2020 6e5f 726f 7773 203a 2069        n_rows : i
+00010680: 6e74 0a20 2020 2020 2020 2020 2020 2020  nt.             
+00010690: 4e75 6d62 6572 206f 6620 726f 7773 2069  Number of rows i
+000106a0: 6e20 7375 6270 6c6f 7420 2844 6566 6175  n subplot (Defau
+000106b0: 6c74 2076 616c 7565 203d 2031 290a 2020  lt value = 1).  
+000106c0: 2020 2020 200a 2020 2020 2020 2020 6e5f       .        n_
+000106d0: 636f 6c73 203a 2069 6e74 0a20 2020 2020  cols : int.     
+000106e0: 2020 2020 2020 2020 4e75 6d62 6572 206f          Number o
+000106f0: 6620 636f 6c75 6d6e 7320 696e 2073 7562  f columns in sub
+00010700: 706c 6f74 2028 4465 6661 756c 7420 7661  plot (Default va
+00010710: 6c75 6520 3d20 3129 0a20 2020 2020 2020  lue = 1).       
+00010720: 200a 2020 2020 2020 2020 7469 746c 6573   .        titles
+00010730: 203a 206c 6973 740a 2020 2020 2020 2020   : list.        
+00010740: 2020 2020 204c 6973 7420 6f66 2074 6974       List of tit
+00010750: 6c65 7320 2844 6566 6175 6c74 2076 616c  les (Default val
+00010760: 7565 203d 205b 2727 5d29 0a20 2020 2020  ue = ['']).     
+00010770: 2020 200a 2020 2020 2020 2020 6669 6773     .        figs
+00010780: 697a 6520 3a20 7475 706c 650a 2020 2020  ize : tuple.    
+00010790: 2020 2020 2020 2020 2046 6967 7572 6520           Figure 
+000107a0: 7369 7a65 2028 4465 6661 756c 7420 7661  size (Default va
+000107b0: 6c75 6520 3d20 2838 2c20 3329 0a20 2020  lue = (8, 3).   
+000107c0: 2020 2020 2020 2020 200a 2020 2020 2020           .      
+000107d0: 2020 7361 7665 6669 6720 3a20 626f 6f6c    savefig : bool
+000107e0: 0a20 2020 2020 2020 2020 2020 2020 4966  .             If
+000107f0: 2054 7275 6520 7361 7665 2066 6967 7572   True save figur
+00010800: 6520 2844 6566 6175 6c74 2076 616c 7565  e (Default value
+00010810: 203d 2046 616c 7365 290a 0a20 2020 2020   = False)..     
+00010820: 2020 2052 6574 7572 6e73 0a20 2020 2020     Returns.     
+00010830: 2020 202d 2d2d 2d2d 2d2d 0a20 2020 2020     -------.     
+00010840: 2020 206d 6174 706c 6f74 6c69 622e 7079     matplotlib.py
+00010850: 706c 6f74 0a20 2020 2020 2020 2022 2222  plot.        """
+00010860: 0a20 2020 2020 2020 200a 2020 2020 2020  .        .      
+00010870: 2020 7461 7267 6574 7320 3d20 5b5d 0a20    targets = []. 
+00010880: 2020 2020 2020 2066 6561 7475 7265 7320         features 
+00010890: 3d20 5b5d 0a20 2020 2020 2020 2073 636f  = [].        sco
+000108a0: 7265 7320 3d20 5b5d 0a20 2020 2020 2020  res = [].       
+000108b0: 2070 7661 7273 203d 205b 5d0a 2020 2020   pvars = [].    
+000108c0: 2020 2020 746f 7073 203d 205b 5d0a 2020      tops = [].  
+000108d0: 2020 2020 2020 6172 726f 7773 203d 205b        arrows = [
+000108e0: 5d0a 0a20 2020 2020 2020 2069 6620 6e5f  ]..        if n_
+000108f0: 726f 7773 203d 3d20 3120 616e 6420 6e5f  rows == 1 and n_
+00010900: 636f 6c73 203d 3d20 313a 0a20 2020 2020  cols == 1:.     
+00010910: 2020 2020 2020 2064 6174 6173 6574 7320         datasets 
+00010920: 3d20 5b73 656c 662e 6461 7461 5d0a 0a20  = [self.data].. 
+00010930: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+00010940: 2020 2020 2020 2020 2064 6174 6173 6574           dataset
+00010950: 7320 3d20 7365 6c66 2e64 6174 6173 6574  s = self.dataset
+00010960: 732e 636f 7079 2829 0a0a 2020 2020 2020  s.copy()..      
+00010970: 2020 666f 7220 6461 7461 2069 6e20 6461    for data in da
+00010980: 7461 7365 7473 3a0a 0a20 2020 2020 2020  tasets:..       
+00010990: 2020 2020 2023 2064 6174 610a 2020 2020       # data.    
+000109a0: 2020 2020 2020 2020 5820 3d20 6e70 2e61          X = np.a
+000109b0: 7272 6179 2864 6174 612e 7365 6c65 6374  rray(data.select
+000109c0: 5f64 7479 7065 7328 2766 6c6f 6174 2729  _dtypes('float')
+000109d0: 2e54 290a 2020 2020 2020 2020 2020 2020  .T).            
+000109e0: 7461 7267 6574 203d 2064 6174 612e 7365  target = data.se
+000109f0: 6c65 6374 5f64 7479 7065 7328 2766 6c6f  lect_dtypes('flo
+00010a00: 6174 2729 2e63 6f6c 756d 6e73 2e74 6f5f  at').columns.to_
+00010a10: 6c69 7374 2829 0a20 2020 2020 2020 2020  list().         
+00010a20: 2020 2066 6561 7475 7265 203d 2064 6174     feature = dat
+00010a30: 615b 2747 656e 6573 275d 2e74 6f5f 6c69  a['Genes'].to_li
+00010a40: 7374 2829 0a0a 2020 2020 2020 2020 2020  st()..          
+00010a50: 2020 2320 616e 616c 7973 6973 0a20 2020    # analysis.   
+00010a60: 2020 2020 2020 2020 2058 5f73 6361 6c65           X_scale
+00010a70: 6420 3d20 5374 616e 6461 7264 5363 616c  d = StandardScal
+00010a80: 6572 2829 2e66 6974 5f74 7261 6e73 666f  er().fit_transfo
+00010a90: 726d 2858 290a 2020 2020 2020 2020 2020  rm(X).          
+00010aa0: 2020 7063 6120 3d20 5043 4128 6e5f 636f    pca = PCA(n_co
+00010ab0: 6d70 6f6e 656e 7473 3d32 292e 6669 7428  mponents=2).fit(
+00010ac0: 585f 7363 616c 6564 290a 2020 2020 2020  X_scaled).      
+00010ad0: 2020 2020 2020 585f 7265 6475 6365 6420        X_reduced 
+00010ae0: 3d20 7063 612e 7472 616e 7366 6f72 6d28  = pca.transform(
+00010af0: 585f 7363 616c 6564 290a 0a20 2020 2020  X_scaled)..     
+00010b00: 2020 2020 2020 2023 2072 6573 756c 7473         # results
+00010b10: 0a20 2020 2020 2020 2020 2020 2073 636f  .            sco
+00010b20: 7265 203d 2058 5f72 6564 7563 6564 5b3a  re = X_reduced[:
+00010b30: 2c20 3a32 5d0a 2020 2020 2020 2020 2020  , :2].          
+00010b40: 2020 6c6f 6164 696e 6720 3d20 7063 612e    loading = pca.
+00010b50: 636f 6d70 6f6e 656e 7473 5f5b 3a32 5d2e  components_[:2].
+00010b60: 540a 2020 2020 2020 2020 2020 2020 7076  T.            pv
+00010b70: 6172 203d 2070 6361 2e65 7870 6c61 696e  ar = pca.explain
+00010b80: 6564 5f76 6172 6961 6e63 655f 7261 7469  ed_variance_rati
+00010b90: 6f5f 5b3a 325d 202a 2031 3030 0a20 2020  o_[:2] * 100.   
+00010ba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010bb0: 200a 2020 2020 2020 2020 2020 2020 746f   .            to
+00010bc0: 7078 203d 2028 6c6f 6164 696e 6720 2a2a  px = (loading **
+00010bd0: 2032 295b 3a2c 2030 5d2e 6172 6773 6f72   2)[:, 0].argsor
+00010be0: 7428 295b 2d6b 3a5d 0a20 2020 2020 2020  t()[-k:].       
+00010bf0: 2020 2020 2074 6f70 7920 3d20 286c 6f61       topy = (loa
+00010c00: 6469 6e67 202a 2a20 3229 5b3a 2c20 315d  ding ** 2)[:, 1]
+00010c10: 2e61 7267 736f 7274 2829 5b2d 6b3a 5d0a  .argsort()[-k:].
+00010c20: 2020 2020 2020 2020 2020 2020 746f 7020              top 
+00010c30: 3d20 6e70 2e61 7070 656e 6428 746f 7078  = np.append(topx
+00010c40: 2c74 6f70 7929 0a20 2020 2020 2020 2020  ,topy).         
+00010c50: 2020 2061 7272 6f77 203d 206c 6f61 6469     arrow = loadi
+00010c60: 6e67 5b74 6f70 5d0a 0a20 2020 2020 2020  ng[top]..       
+00010c70: 2023 2020 2020 2020 2020 2074 6f70 203d   #         top =
+00010c80: 2028 6c6f 6164 696e 6720 2a20 7076 6172   (loading * pvar
+00010c90: 292e 7375 6d28 6178 6973 3d31 292e 6172  ).sum(axis=1).ar
+00010ca0: 6773 6f72 7428 295b 2d6b 3a5d 0a20 2020  gsort()[-k:].   
+00010cb0: 2020 2020 2023 2020 2020 2020 2020 2061       #         a
+00010cc0: 7272 6f77 203d 206c 6f61 6469 6e67 5b74  rrow = loading[t
+00010cd0: 6f70 5d0a 2020 2020 2020 2020 2020 2020  op].            
+00010ce0: 0a20 2020 2020 2020 2020 2020 2061 7272  .            arr
+00010cf0: 6f77 202f 3d20 6e70 2e73 7172 7428 2861  ow /= np.sqrt((a
+00010d00: 7272 6f77 202a 2a20 3229 2e73 756d 2861  rrow ** 2).sum(a
+00010d10: 7869 733d 3029 290a 2020 2020 2020 2020  xis=0)).        
+00010d20: 2020 2020 6172 726f 7720 2a3d 206e 702e      arrow *= np.
+00010d30: 6162 7328 7363 6f72 6529 2e6d 6178 2861  abs(score).max(a
+00010d40: 7869 733d 3029 0a20 2020 2020 2020 2020  xis=0).         
+00010d50: 2020 200a 2020 2020 2020 2020 2020 2020     .            
+00010d60: 7461 7267 6574 732e 6170 7065 6e64 2874  targets.append(t
+00010d70: 6172 6765 7429 0a20 2020 2020 2020 2020  arget).         
+00010d80: 2020 2066 6561 7475 7265 732e 6170 7065     features.appe
+00010d90: 6e64 2866 6561 7475 7265 290a 2020 2020  nd(feature).    
+00010da0: 2020 2020 2020 2020 7363 6f72 6573 2e61          scores.a
+00010db0: 7070 656e 6428 7363 6f72 6529 0a20 2020  ppend(score).   
+00010dc0: 2020 2020 2020 2020 2070 7661 7273 2e61           pvars.a
+00010dd0: 7070 656e 6428 7076 6172 290a 2020 2020  ppend(pvar).    
+00010de0: 2020 2020 2020 2020 746f 7073 2e61 7070          tops.app
+00010df0: 656e 6428 746f 7029 0a20 2020 2020 2020  end(top).       
+00010e00: 2020 2020 2061 7272 6f77 732e 6170 7065       arrows.appe
+00010e10: 6e64 2861 7272 6f77 290a 2020 2020 2020  nd(arrow).      
+00010e20: 2020 2020 2020 0a20 2020 2020 2020 2066        .        f
+00010e30: 6967 2c20 6178 203d 2070 6c74 2e73 7562  ig, ax = plt.sub
+00010e40: 706c 6f74 7328 6e5f 726f 7773 2c20 6e5f  plots(n_rows, n_
+00010e50: 636f 6c73 2c20 6669 6773 697a 653d 6669  cols, figsize=fi
+00010e60: 6773 697a 6529 0a0a 2020 2020 2020 2020  gsize)..        
+00010e70: 666f 7220 7461 7267 6574 2c20 6665 6174  for target, feat
+00010e80: 7572 652c 2073 636f 7265 2c20 7076 6172  ure, score, pvar
+00010e90: 2c20 746f 702c 2061 7272 6f77 2c20 7469  , top, arrow, ti
+00010ea0: 746c 652c 2061 7865 7320 2069 6e20 7a69  tle, axes  in zi
+00010eb0: 7028 7461 7267 6574 732c 2066 6561 7475  p(targets, featu
+00010ec0: 7265 732c 2073 636f 7265 732c 2070 7661  res, scores, pva
+00010ed0: 7273 2c20 746f 7073 2c20 6172 726f 7773  rs, tops, arrows
+00010ee0: 2c20 7469 746c 6573 2c20 6e70 2e61 7272  , titles, np.arr
+00010ef0: 6179 2861 7829 2e66 6c61 7474 656e 2829  ay(ax).flatten()
+00010f00: 293a 0a0a 2020 2020 2020 2020 2020 2020  ):..            
+00010f10: 736e 732e 7363 6174 7465 7270 6c6f 7428  sns.scatterplot(
+00010f20: 783d 7363 6f72 655b 3a2c 2030 5d2c 2079  x=score[:, 0], y
+00010f30: 3d73 636f 7265 5b3a 2c20 315d 2c20 6875  =score[:, 1], hu
+00010f40: 653d 7461 7267 6574 2c20 6178 3d61 7865  e=target, ax=axe
+00010f50: 7329 0a20 2020 2020 2020 2020 2020 2061  s).            a
+00010f60: 7865 732e 7365 745f 7469 746c 6528 7469  xes.set_title(ti
+00010f70: 746c 6529 0a20 2020 2020 2020 2020 2020  tle).           
+00010f80: 2073 6e73 2e64 6573 7069 6e65 2829 0a0a   sns.despine()..
+00010f90: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+00010fa0: 6a20 696e 2061 7272 6f77 3a0a 2020 2020  j in arrow:.    
+00010fb0: 2020 2020 2020 2020 2020 2020 6178 6573              axes
+00010fc0: 2e61 7272 6f77 2830 2c20 302c 202a 6a2c  .arrow(0, 0, *j,
+00010fd0: 2063 6f6c 6f72 3d27 6b27 2c20 7769 6474   color='k', widt
+00010fe0: 683d 302e 352c 2065 633d 276e 6f6e 6527  h=0.5, ec='none'
+00010ff0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00011000: 2020 2020 2020 2020 2020 6c65 6e67 7468            length
+00011010: 5f69 6e63 6c75 6465 735f 6865 6164 3d54  _includes_head=T
+00011020: 7275 652c 2061 6c70 6861 3d30 2e35 2c20  rue, alpha=0.5, 
+00011030: 290a 2020 2020 2020 2020 2020 2020 0a20  ).            . 
+00011040: 2020 2020 2020 2020 2020 2074 6578 7473             texts
+00011050: 203d 205b 6178 6573 2e74 6578 7428 2a28   = [axes.text(*(
+00011060: 6a29 2c20 6665 6174 7572 655b 695d 2c20  j), feature[i], 
+00011070: 6861 3d27 6365 6e74 6572 272c 2076 613d  ha='center', va=
+00011080: 2763 656e 7465 7227 2920 666f 7220 692c  'center') for i,
+00011090: 206a 2069 6e20 7a69 7028 746f 702c 2061   j in zip(top, a
+000110a0: 7272 6f77 295d 0a20 2020 2020 2020 2020  rrow)].         
+000110b0: 2020 2061 646a 7573 745f 7465 7874 2874     adjust_text(t
+000110c0: 6578 7473 2c20 6172 726f 7770 726f 7073  exts, arrowprops
+000110d0: 203d 2064 6963 7428 6172 726f 7773 7479   = dict(arrowsty
+000110e0: 6c65 203d 2027 2d27 2c20 636f 6c6f 7220  le = '-', color 
+000110f0: 3d20 2762 6c61 636b 272c 2061 6c70 6861  = 'black', alpha
+00011100: 3d30 2e35 292c 2061 783d 6178 6573 290a  =0.5), ax=axes).
+00011110: 2020 2020 2020 2020 2020 2020 6178 6573              axes
+00011120: 2e73 6574 2878 6c61 6265 6c3d 6627 5043  .set(xlabel=f'PC
+00011130: 3120 7b70 7661 725b 305d 3a2e 3266 7d25  1 {pvar[0]:.2f}%
+00011140: 272c 2079 6c61 6265 6c3d 6627 5043 3220  ', ylabel=f'PC2 
+00011150: 7b70 7661 725b 315d 3a2e 3266 7d25 2729  {pvar[1]:.2f}%')
+00011160: 0a0a 2020 2020 2020 2020 6669 672e 7469  ..        fig.ti
+00011170: 6768 745f 6c61 796f 7574 2829 0a0a 2020  ght_layout()..  
+00011180: 2020 2020 2020 6966 2073 6176 6566 6967        if savefig
+00011190: 203d 3d20 5472 7565 3a0a 2020 2020 2020   == True:.      
+000111a0: 2020 2020 2020 6669 672e 7361 7665 6669        fig.savefi
+000111b0: 6728 2762 6970 6c6f 742e 7064 6627 2c20  g('biplot.pdf', 
+000111c0: 6262 6f78 5f69 6e63 6865 733d 2774 6967  bbox_inches='tig
+000111d0: 6874 2729 0a0a 2020 2020 6465 6620 5f75  ht')..    def _u
+000111e0: 6d61 7028 7365 6c66 2c20 6461 7461 3d4e  map(self, data=N
+000111f0: 6f6e 652c 206e 5f6e 6569 6768 626f 7273  one, n_neighbors
+00011200: 3d33 293a 0a0a 2020 2020 2020 2020 2222  =3):..        ""
+00011210: 220a 2020 2020 2020 2020 4765 6e65 7261  ".        Genera
+00011220: 7465 2055 4d41 5020 6f62 6a65 6374 0a0a  te UMAP object..
+00011230: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
+00011240: 7273 0a20 2020 2020 2020 202d 2d2d 2d2d  rs.        -----
+00011250: 2d2d 2d2d 2d0a 2020 2020 2020 2020 6461  -----.        da
+00011260: 7461 203a 2070 642e 4461 7461 4672 616d  ta : pd.DataFram
+00011270: 650a 2020 2020 2020 2020 2020 2020 2028  e.             (
+00011280: 4465 6661 756c 7420 7661 6c75 6520 3d20  Default value = 
+00011290: 4e6f 6e65 290a 0a20 2020 2020 2020 206e  None)..        n
+000112a0: 5f6e 6569 6768 626f 7273 203a 2069 6e74  _neighbors : int
+000112b0: 0a20 2020 2020 2020 2020 2020 2020 2844  .             (D
+000112c0: 6566 6175 6c74 2076 616c 7565 203d 2033  efault value = 3
+000112d0: 290a 0a20 2020 2020 2020 2052 6574 7572  )..        Retur
+000112e0: 6e73 0a20 2020 2020 2020 202d 2d2d 2d2d  ns.        -----
+000112f0: 2d2d 0a20 2020 2020 2020 2070 642e 4461  --.        pd.Da
+00011300: 7461 4672 616d 650a 2020 2020 2020 2020  taFrame.        
+00011310: 2222 220a 2020 2020 2020 2020 6966 2069  """.        if i
+00011320: 7369 6e73 7461 6e63 6528 6461 7461 2c20  sinstance(data, 
+00011330: 7064 2e44 6174 6146 7261 6d65 293a 0a20  pd.DataFrame):. 
+00011340: 2020 2020 2020 2020 2020 2064 6620 3d20             df = 
+00011350: 6461 7461 2e73 656c 6563 745f 6474 7970  data.select_dtyp
+00011360: 6573 2869 6e63 6c75 6465 203d 5b27 666c  es(include =['fl
+00011370: 6f61 7436 3427 5d29 2e54 2e63 6f70 7928  oat64']).T.copy(
+00011380: 290a 2020 2020 2020 2020 656c 7365 3a0a  ).        else:.
+00011390: 2020 2020 2020 2020 2020 2020 6466 203d              df =
+000113a0: 2073 656c 662e 6461 7461 2e73 656c 6563   self.data.selec
+000113b0: 745f 6474 7970 6573 2869 6e63 6c75 6465  t_dtypes(include
+000113c0: 203d 5b27 666c 6f61 7436 3427 5d29 2e54   =['float64']).T
+000113d0: 2e63 6f70 7928 290a 0a20 2020 2020 2020  .copy()..       
+000113e0: 2023 2070 7265 7061 7265 2066 6561 7475   # prepare featu
+000113f0: 7265 7320 7661 7269 6162 6c65 2028 4765  res variable (Ge
+00011400: 6e65 7329 0a20 2020 2020 2020 2066 6561  nes).        fea
+00011410: 7475 7265 7320 3d20 6c69 7374 286e 702e  tures = list(np.
+00011420: 6172 616e 6765 2864 662e 7368 6170 655b  arange(df.shape[
+00011430: 315d 2929 0a20 2020 2020 2020 2064 662e  1])).        df.
+00011440: 636f 6c75 6d6e 7320 3d20 6665 6174 7572  columns = featur
+00011450: 6573 0a20 2020 2020 2020 200a 2020 2020  es.        .    
+00011460: 2020 2020 2320 7072 6570 6172 6520 7461      # prepare ta
+00011470: 7267 6574 2063 6f6c 756d 6e20 2873 616d  rget column (sam
+00011480: 706c 6520 7479 7065 7329 0a20 2020 2020  ple types).     
+00011490: 2020 2064 665b 2774 6172 6765 7427 5d20     df['target'] 
+000114a0: 3d20 6466 2e69 6e64 6578 0a20 2020 2020  = df.index.     
+000114b0: 2020 2064 6620 3d20 6466 2e72 6573 6574     df = df.reset
+000114c0: 5f69 6e64 6578 2864 726f 703d 2054 7275  _index(drop= Tru
+000114d0: 6529 0a0a 2020 2020 2020 2020 2320 5365  e)..        # Se
+000114e0: 7061 7261 7469 6e67 206f 7574 2074 6865  parating out the
+000114f0: 2066 6561 7475 7265 730a 2020 2020 2020   features.      
+00011500: 2020 7820 3d20 6466 2e6c 6f63 5b3a 2c20    x = df.loc[:, 
+00011510: 6665 6174 7572 6573 5d2e 7661 6c75 6573  features].values
+00011520: 0a20 0a20 2020 2020 2020 2023 2053 7461  . .        # Sta
+00011530: 6e64 6172 6469 7a69 6e67 2074 6865 2066  ndardizing the f
+00011540: 6561 7475 7265 730a 2020 2020 2020 2020  eatures.        
+00011550: 7820 3d20 5374 616e 6461 7264 5363 616c  x = StandardScal
+00011560: 6572 2829 2e66 6974 5f74 7261 6e73 666f  er().fit_transfo
+00011570: 726d 2878 290a 2020 2020 2020 2020 7265  rm(x).        re
+00011580: 6475 6365 7220 3d20 6d70 2e55 4d41 5028  ducer = mp.UMAP(
+00011590: 6e5f 6e65 6967 6862 6f72 733d 6e5f 6e65  n_neighbors=n_ne
+000115a0: 6967 6862 6f72 732c 2072 616e 646f 6d5f  ighbors, random_
+000115b0: 7374 6174 653d 3432 290a 2020 2020 2020  state=42).      
+000115c0: 2020 656d 6265 6464 696e 6720 3d20 7265    embedding = re
+000115d0: 6475 6365 722e 6669 745f 7472 616e 7366  ducer.fit_transf
+000115e0: 6f72 6d28 7829 0a20 2020 2020 2020 2065  orm(x).        e
+000115f0: 6d62 6564 6469 6e67 5f64 6174 6120 3d20  mbedding_data = 
+00011600: 7064 2e44 6174 6146 7261 6d65 2864 6174  pd.DataFrame(dat
+00011610: 6120 3d20 656d 6265 6464 696e 670a 2020  a = embedding.  
+00011620: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011630: 2020 2020 2020 2020 2020 2020 2020 2c63                ,c
+00011640: 6f6c 756d 6e73 203d 205b 2755 4d41 5031  olumns = ['UMAP1
+00011650: 272c 2027 554d 4150 3227 5d29 0a20 2020  ', 'UMAP2']).   
+00011660: 2020 2020 200a 2020 2020 2020 2020 6669       .        fi
+00011670: 6e61 6c44 6620 3d20 7064 2e63 6f6e 6361  nalDf = pd.conca
+00011680: 7428 5b65 6d62 6564 6469 6e67 5f64 6174  t([embedding_dat
+00011690: 612c 2064 665b 5b27 7461 7267 6574 275d  a, df[['target']
+000116a0: 5d5d 2c20 6178 6973 203d 2031 290a 2020  ]], axis = 1).  
+000116b0: 2020 2020 2020 0a20 2020 2020 2020 2072        .        r
+000116c0: 6574 7572 6e20 6669 6e61 6c44 660a 2020  eturn finalDf.  
+000116d0: 2020 0a20 2020 2064 6566 2075 6d61 705f    .    def umap_
+000116e0: 706c 6f74 2873 656c 662c 206e 5f6e 6569  plot(self, n_nei
+000116f0: 6768 626f 7273 3d33 2c20 6e5f 726f 7773  ghbors=3, n_rows
+00011700: 3d31 2c20 6e5f 636f 6c73 3d31 2c20 7469  =1, n_cols=1, ti
+00011710: 746c 6573 3d5b 2727 5d2c 2066 6967 7369  tles=[''], figsi
+00011720: 7a65 3d28 352c 2035 292c 2073 6176 6566  ze=(5, 5), savef
+00011730: 6967 3d46 616c 7365 293a 0a0a 2020 2020  ig=False):..    
+00011740: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+00011750: 506c 6f74 2055 4d41 5020 666f 7220 6f6e  Plot UMAP for on
+00011760: 6520 6f72 206d 6f72 6520 6461 7461 7365  e or more datase
+00011770: 7473 2e0a 0a20 2020 2020 2020 2050 6172  ts...        Par
+00011780: 616d 6574 6572 730a 2020 2020 2020 2020  ameters.        
+00011790: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
+000117a0: 2020 206e 5f6e 6569 6768 626f 7273 203a     n_neighbors :
+000117b0: 2069 6e74 0a20 2020 2020 2020 2020 2020   int.           
+000117c0: 2020 2844 6566 6175 6c74 2076 616c 7565    (Default value
+000117d0: 203d 2033 290a 0a20 2020 2020 2020 206e   = 3)..        n
+000117e0: 5f72 6f77 7320 3a20 696e 740a 2020 2020  _rows : int.    
+000117f0: 2020 2020 2020 2020 204e 756d 6265 7220           Number 
+00011800: 6f66 2072 6f77 7320 696e 2073 7562 706c  of rows in subpl
+00011810: 6f74 2028 4465 6661 756c 7420 7661 6c75  ot (Default valu
+00011820: 6520 3d20 3129 0a0a 2020 2020 2020 2020  e = 1)..        
+00011830: 6e5f 636f 6c73 203a 2069 6e74 0a20 2020  n_cols : int.   
+00011840: 2020 2020 2020 2020 2020 4e75 6d62 6572            Number
+00011850: 206f 6620 636f 6c75 6d6e 7320 696e 2073   of columns in s
+00011860: 7562 706c 6f74 2028 4465 6661 756c 7420  ubplot (Default 
+00011870: 7661 6c75 6520 3d20 3129 0a0a 2020 2020  value = 1)..    
+00011880: 2020 2020 7469 746c 6573 203a 206c 6973      titles : lis
+00011890: 740a 2020 2020 2020 2020 2020 2020 204c  t.             L
+000118a0: 6973 7420 6f66 2074 6974 6c65 7320 696e  ist of titles in
+000118b0: 2073 7562 706c 6f74 2028 4465 6661 756c   subplot (Defaul
+000118c0: 7420 7661 6c75 6520 3d20 5b27 275d 290a  t value = ['']).
+000118d0: 0a20 2020 2020 2020 2066 6967 7369 7a65  .        figsize
+000118e0: 203a 2074 7570 6c65 0a20 2020 2020 2020   : tuple.       
+000118f0: 2020 2020 2020 4669 6775 7265 2073 697a        Figure siz
+00011900: 6520 2844 6566 6175 6c74 2076 616c 7565  e (Default value
+00011910: 203d 2028 352c 2035 290a 2020 2020 2020   = (5, 5).      
+00011920: 2020 2020 2020 0a20 2020 2020 2020 2073        .        s
+00011930: 6176 6566 6967 203a 0a20 2020 2020 2020  avefig :.       
+00011940: 2020 2020 2020 2844 6566 6175 6c74 2076        (Default v
+00011950: 616c 7565 203d 2046 616c 7365 290a 0a20  alue = False).. 
+00011960: 2020 2020 2020 2052 6574 7572 6e73 0a20         Returns. 
+00011970: 2020 2020 2020 202d 2d2d 2d2d 2d2d 0a20         -------. 
+00011980: 2020 2020 2020 206d 6174 706c 6f74 6c69         matplotli
+00011990: 622e 7079 706c 6f74 0a20 2020 2020 2020  b.pyplot.       
+000119a0: 2022 2222 0a20 2020 2020 2020 200a 2020   """.        .  
+000119b0: 2020 2020 2020 6966 206e 5f72 6f77 7320        if n_rows 
+000119c0: 3d3d 2031 2061 6e64 206e 5f63 6f6c 7320  == 1 and n_cols 
+000119d0: 3d3d 2031 3a0a 2020 2020 2020 2020 2020  == 1:.          
+000119e0: 2020 6461 7461 7365 7473 203d 205b 7365    datasets = [se
+000119f0: 6c66 2e64 6174 615d 0a0a 2020 2020 2020  lf.data]..      
+00011a00: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+00011a10: 2020 2020 2064 6174 6173 6574 7320 3d20       datasets = 
+00011a20: 7365 6c66 2e64 6174 6173 6574 732e 636f  self.datasets.co
+00011a30: 7079 2829 0a0a 2020 2020 2020 2020 2320  py()..        # 
+00011a40: 706c 6f74 2074 6865 2070 6361 0a20 2020  plot the pca.   
+00011a50: 2020 2020 2075 6d61 705f 6461 7461 7365       umap_datase
+00011a60: 7473 203d 205b 7365 6c66 2e5f 756d 6170  ts = [self._umap
+00011a70: 2864 6174 613d 692c 206e 5f6e 6569 6768  (data=i, n_neigh
+00011a80: 626f 7273 3d6e 5f6e 6569 6768 626f 7273  bors=n_neighbors
+00011a90: 2920 666f 7220 6920 696e 2064 6174 6173  ) for i in datas
+00011aa0: 6574 735d 0a0a 2020 2020 2020 2020 6669  ets]..        fi
+00011ab0: 672c 2061 7820 3d20 706c 742e 7375 6270  g, ax = plt.subp
+00011ac0: 6c6f 7473 286e 5f72 6f77 732c 206e 5f63  lots(n_rows, n_c
+00011ad0: 6f6c 732c 2066 6967 7369 7a65 3d66 6967  ols, figsize=fig
+00011ae0: 7369 7a65 290a 0a20 2020 2020 2020 2066  size)..        f
+00011af0: 6f72 2075 6d61 705f 6461 7461 2c20 6178  or umap_data, ax
+00011b00: 6573 2c20 7469 746c 6520 696e 207a 6970  es, title in zip
+00011b10: 2875 6d61 705f 6461 7461 7365 7473 2c20  (umap_datasets, 
+00011b20: 6e70 2e61 7272 6179 2861 7829 2e66 6c61  np.array(ax).fla
+00011b30: 7474 656e 2829 2c20 7469 746c 6573 293a  tten(), titles):
+00011b40: 0a20 2020 2020 2020 2020 2020 2073 6e73  .            sns
+00011b50: 2e73 6361 7474 6572 706c 6f74 2864 6174  .scatterplot(dat
+00011b60: 6120 3d20 756d 6170 5f64 6174 612c 2078  a = umap_data, x
+00011b70: 203d 2027 554d 4150 3127 2c20 7920 3d20   = 'UMAP1', y = 
+00011b80: 2755 4d41 5032 272c 2068 7565 203d 2027  'UMAP2', hue = '
+00011b90: 7461 7267 6574 272c 2061 783d 6178 6573  target', ax=axes
+00011ba0: 290a 2020 2020 2020 2020 2020 2020 6178  ).            ax
+00011bb0: 6573 2e73 6574 5f74 6974 6c65 2874 6974  es.set_title(tit
+00011bc0: 6c65 290a 2020 2020 2020 2020 2020 2020  le).            
+00011bd0: 6178 6573 2e6c 6567 656e 6428 6c6f 633d  axes.legend(loc=
+00011be0: 2762 6573 7427 290a 2020 2020 2020 2020  'best').        
+00011bf0: 2020 2020 736e 732e 6465 7370 696e 6528      sns.despine(
+00011c00: 290a 2020 2020 2020 2020 0a20 2020 2020  ).        .     
+00011c10: 2020 2066 6967 2e74 6967 6874 5f6c 6179     fig.tight_lay
+00011c20: 6f75 7428 290a 2020 2020 2020 2020 0a20  out().        . 
+00011c30: 2020 2020 2020 2069 6620 7361 7665 6669         if savefi
+00011c40: 6720 3d3d 2054 7275 653a 0a20 2020 2020  g == True:.     
+00011c50: 2020 2020 2020 2066 6967 2e73 6176 6566         fig.savef
+00011c60: 6967 2827 756d 6170 5f66 6967 732e 7064  ig('umap_figs.pd
+00011c70: 6627 2c20 6262 6f78 5f69 6e63 6865 733d  f', bbox_inches=
+00011c80: 2774 6967 6874 272c 2074 7261 6e73 7061  'tight', transpa
+00011c90: 7265 6e74 3d54 7275 6529 0a0a 2020 2020  rent=True)..    
+00011ca0: 6465 6620 5f74 736e 6528 7365 6c66 2c20  def _tsne(self, 
+00011cb0: 6461 7461 3d4e 6f6e 652c 2070 6572 706c  data=None, perpl
+00011cc0: 6578 6974 793d 3130 2c20 6c65 6172 6e69  exity=10, learni
+00011cd0: 6e67 5f72 6174 653d 2761 7574 6f27 2c20  ng_rate='auto', 
+00011ce0: 6561 726c 795f 6578 6167 6765 7261 7469  early_exaggerati
+00011cf0: 6f6e 3d31 3229 3a0a 0a20 2020 2020 2020  on=12):..       
+00011d00: 2022 2222 0a20 2020 2020 2020 2074 2d53   """.        t-S
+00011d10: 4e45 2064 696d 656e 7369 6f6e 616c 6974  NE dimensionalit
+00011d20: 7920 7265 6475 6374 696f 6e0a 0a20 2020  y reduction..   
+00011d30: 2020 2020 2050 6172 616d 6574 6572 730a       Parameters.
+00011d40: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+00011d50: 2d2d 0a20 2020 2020 2020 2064 6174 6120  --.        data 
+00011d60: 3a20 7064 2e44 6174 6146 7261 6d65 0a20  : pd.DataFrame. 
+00011d70: 2020 2020 2020 2020 2020 2020 2844 6566              (Def
+00011d80: 6175 6c74 2076 616c 7565 203d 204e 6f6e  ault value = Non
+00011d90: 6529 0a20 2020 2020 2020 2070 6572 706c  e).        perpl
+00011da0: 6578 6974 7920 3a20 696e 740a 2020 2020  exity : int.    
+00011db0: 2020 2020 2020 2020 2028 4465 6661 756c           (Defaul
+00011dc0: 7420 7661 6c75 6520 3d20 3130 290a 2020  t value = 10).  
+00011dd0: 2020 2020 2020 6c65 6172 6e69 6e67 5f72        learning_r
+00011de0: 6174 6520 3a20 696e 7420 6f72 2073 7472  ate : int or str
+00011df0: 0a20 2020 2020 2020 2020 2020 2020 2844  .             (D
+00011e00: 6566 6175 6c74 2076 616c 7565 203d 2027  efault value = '
+00011e10: 6175 746f 2729 0a20 2020 2020 2020 2065  auto').        e
+00011e20: 6172 6c79 5f65 7861 6767 6572 6174 696f  arly_exaggeratio
+00011e30: 6e20 3a20 696e 740a 2020 2020 2020 2020  n : int.        
+00011e40: 2020 2020 2028 4465 6661 756c 7420 7661       (Default va
+00011e50: 6c75 6520 3d20 3132 290a 0a20 2020 2020  lue = 12)..     
+00011e60: 2020 2052 6574 7572 6e73 0a20 2020 2020     Returns.     
+00011e70: 2020 202d 2d2d 2d2d 2d2d 0a20 2020 2020     -------.     
+00011e80: 2020 2070 642e 4461 7461 4672 616d 650a     pd.DataFrame.
+00011e90: 2020 2020 2020 2020 2222 220a 0a20 2020          """..   
+00011ea0: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
+00011eb0: 6365 2864 6174 612c 2070 642e 4461 7461  ce(data, pd.Data
+00011ec0: 4672 616d 6529 3a0a 2020 2020 2020 2020  Frame):.        
+00011ed0: 2020 2020 666c 6f61 745f 6461 7461 203d      float_data =
+00011ee0: 2064 6174 612e 7365 6c65 6374 5f64 7479   data.select_dty
+00011ef0: 7065 7328 2766 6c6f 6174 2729 2e54 0a20  pes('float').T. 
+00011f00: 2020 2020 2020 200a 2020 2020 2020 2020         .        
+00011f10: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+00011f20: 2020 666c 6f61 745f 6461 7461 203d 2073    float_data = s
+00011f30: 656c 662e 6461 7461 2e73 656c 6563 745f  elf.data.select_
+00011f40: 6474 7970 6573 2827 666c 6f61 7427 292e  dtypes('float').
+00011f50: 540a 2020 2020 2020 2020 0a20 2020 2020  T.        .     
+00011f60: 2020 2066 6561 7475 7265 7320 3d20 666c     features = fl
+00011f70: 6f61 745f 6461 7461 2e69 6e64 6578 2e74  oat_data.index.t
+00011f80: 6f5f 6c69 7374 2829 0a20 2020 2020 2020  o_list().       
+00011f90: 2066 6c6f 6174 5f64 6174 6120 3d20 5374   float_data = St
+00011fa0: 616e 6461 7264 5363 616c 6572 2829 2e66  andardScaler().f
+00011fb0: 6974 5f74 7261 6e73 666f 726d 2866 6c6f  it_transform(flo
+00011fc0: 6174 5f64 6174 6129 0a20 2020 2020 2020  at_data).       
+00011fd0: 2074 736e 655f 6461 7461 203d 2054 534e   tsne_data = TSN
+00011fe0: 4528 6e5f 636f 6d70 6f6e 656e 7473 3d32  E(n_components=2
+00011ff0: 2c20 7065 7270 6c65 7869 7479 3d70 6572  , perplexity=per
+00012000: 706c 6578 6974 792c 206c 6561 726e 696e  plexity, learnin
+00012010: 675f 7261 7465 3d6c 6561 726e 696e 675f  g_rate=learning_
+00012020: 7261 7465 2c20 6561 726c 795f 6578 6167  rate, early_exag
+00012030: 6765 7261 7469 6f6e 3d65 6172 6c79 5f65  geration=early_e
+00012040: 7861 6767 6572 6174 696f 6e2c 2072 616e  xaggeration, ran
+00012050: 646f 6d5f 7374 6174 653d 3432 292e 6669  dom_state=42).fi
+00012060: 745f 7472 616e 7366 6f72 6d28 666c 6f61  t_transform(floa
+00012070: 745f 6461 7461 290a 2020 2020 2020 2020  t_data).        
+00012080: 7473 6e65 5f64 6174 6120 3d20 7064 2e44  tsne_data = pd.D
+00012090: 6174 6146 7261 6d65 2864 6174 613d 7473  ataFrame(data=ts
+000120a0: 6e65 5f64 6174 612c 2063 6f6c 756d 6e73  ne_data, columns
+000120b0: 203d 5b27 5453 4e45 2031 272c 2027 5453   =['TSNE 1', 'TS
+000120c0: 4e45 2032 275d 290a 2020 2020 2020 2020  NE 2']).        
+000120d0: 7473 6e65 5f64 6174 615b 2766 6561 7475  tsne_data['featu
+000120e0: 7265 7327 5d20 3d20 6665 6174 7572 6573  res'] = features
+000120f0: 0a20 2020 2020 2020 200a 2020 2020 2020  .        .      
+00012100: 2020 7265 7475 726e 2074 736e 655f 6461    return tsne_da
+00012110: 7461 0a0a 2020 2020 6465 6620 7473 6e65  ta..    def tsne
+00012120: 5f70 6c6f 7428 7365 6c66 2c20 7065 7270  _plot(self, perp
+00012130: 6c65 7869 7479 3d31 302c 206c 6561 726e  lexity=10, learn
+00012140: 696e 675f 7261 7465 3d27 6175 746f 272c  ing_rate='auto',
+00012150: 2065 6172 6c79 5f65 7861 6767 6572 6174   early_exaggerat
+00012160: 696f 6e3d 3132 2c20 6e5f 726f 7773 3d31  ion=12, n_rows=1
+00012170: 2c20 6e5f 636f 6c73 3d31 2c20 7469 746c  , n_cols=1, titl
+00012180: 6573 3d5b 2727 5d2c 2066 6967 7369 7a65  es=[''], figsize
+00012190: 3d28 352c 2035 292c 2073 6176 6566 6967  =(5, 5), savefig
+000121a0: 3d46 616c 7365 293a 0a0a 2020 2020 2020  =False):..      
+000121b0: 2020 2222 2250 6c6f 7420 742d 534e 450a    """Plot t-SNE.
+000121c0: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
+000121d0: 6572 730a 2020 2020 2020 2020 2d2d 2d2d  ers.        ----
+000121e0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2070  ------.        p
+000121f0: 6572 706c 6578 6974 7920 3a20 696e 740a  erplexity : int.
+00012200: 2020 2020 2020 2020 2020 2020 2028 4465               (De
+00012210: 6661 756c 7420 7661 6c75 6520 3d20 3130  fault value = 10
+00012220: 290a 0a20 2020 2020 2020 206c 6561 726e  )..        learn
+00012230: 696e 675f 7261 7465 203a 2069 6e74 206f  ing_rate : int o
+00012240: 7220 7374 720a 2020 2020 2020 2020 2020  r str.          
+00012250: 2020 2028 4465 6661 756c 7420 7661 6c75     (Default valu
+00012260: 6520 3d20 2761 7574 6f27 290a 0a20 2020  e = 'auto')..   
+00012270: 2020 2020 2065 6172 6c79 5f65 7861 6767       early_exagg
+00012280: 6572 6174 696f 6e20 3a20 696e 740a 2020  eration : int.  
+00012290: 2020 2020 2020 2020 2020 2028 4465 6661             (Defa
+000122a0: 756c 7420 7661 6c75 6520 3d20 3132 290a  ult value = 12).
+000122b0: 0a20 2020 2020 2020 206e 5f72 6f77 7320  .        n_rows 
+000122c0: 3a20 696e 740a 2020 2020 2020 2020 2020  : int.          
+000122d0: 2020 204e 756d 6265 7220 6f66 2072 6f77     Number of row
+000122e0: 7320 696e 2073 7562 706c 6f74 2028 4465  s in subplot (De
+000122f0: 6661 756c 7420 7661 6c75 6520 3d20 3129  fault value = 1)
+00012300: 0a0a 2020 2020 2020 2020 6e5f 636f 6c73  ..        n_cols
+00012310: 203a 2069 6e74 0a20 2020 2020 2020 2020   : int.         
+00012320: 2020 2020 4e75 6d62 6572 206f 6620 636f      Number of co
+00012330: 6c75 6d6e 7320 696e 2073 7562 706c 6f74  lumns in subplot
+00012340: 2028 4465 6661 756c 7420 7661 6c75 6520   (Default value 
+00012350: 3d20 3129 0a0a 2020 2020 2020 2020 7469  = 1)..        ti
+00012360: 746c 6573 203a 206c 6973 740a 2020 2020  tles : list.    
+00012370: 2020 2020 2020 2020 204c 6973 7420 6f66           List of
+00012380: 2074 6974 6c65 7320 696e 2073 7562 706c   titles in subpl
+00012390: 6f74 2028 4465 6661 756c 7420 7661 6c75  ot (Default valu
+000123a0: 6520 3d20 5b27 275d 290a 0a20 2020 2020  e = [''])..     
+000123b0: 2020 2066 6967 7369 7a65 203a 2074 7570     figsize : tup
+000123c0: 6c65 0a20 2020 2020 2020 2020 2020 2020  le.             
+000123d0: 2028 4465 6661 756c 7420 7661 6c75 6520   (Default value 
+000123e0: 3d20 2835 2c20 3529 203a 0a20 2020 2020  = (5, 5) :.     
+000123f0: 2020 2020 2020 200a 2020 2020 2020 2020         .        
+00012400: 7361 7665 6669 6720 3a20 626f 6f6c 0a20  savefig : bool. 
+00012410: 2020 2020 2020 2020 2020 2020 4966 2054              If T
+00012420: 7275 652c 2073 6176 6520 6669 6775 7265  rue, save figure
+00012430: 2028 4465 6661 756c 7420 7661 6c75 6520   (Default value 
+00012440: 3d20 4661 6c73 6529 0a0a 2020 2020 2020  = False)..      
+00012450: 2020 5265 7475 726e 730a 2020 2020 2020    Returns.      
+00012460: 2020 2d2d 2d2d 2d2d 2d0a 2020 2020 2020    -------.      
+00012470: 2020 6d61 7470 6c6f 746c 6962 2e70 7970    matplotlib.pyp
+00012480: 6c6f 740a 2020 2020 2020 2020 2222 220a  lot.        """.
+00012490: 0a20 2020 2020 2020 2069 6620 6e5f 726f  .        if n_ro
+000124a0: 7773 203d 3d20 3120 616e 6420 6e5f 636f  ws == 1 and n_co
+000124b0: 6c73 203d 3d20 313a 0a20 2020 2020 2020  ls == 1:.       
+000124c0: 2020 2020 2064 6174 6173 6574 7320 3d20       datasets = 
+000124d0: 5b73 656c 662e 6461 7461 5d0a 2020 2020  [self.data].    
+000124e0: 2020 2020 0a20 2020 2020 2020 2065 6c73      .        els
+000124f0: 653a 0a20 2020 2020 2020 2020 2020 2064  e:.            d
+00012500: 6174 6173 6574 7320 3d20 7365 6c66 2e64  atasets = self.d
+00012510: 6174 6173 6574 732e 636f 7079 2829 0a0a  atasets.copy()..
+00012520: 2020 2020 2020 2020 7473 6e65 5f64 6174          tsne_dat
+00012530: 6173 6574 7320 3d20 5b73 656c 662e 5f74  asets = [self._t
+00012540: 736e 6528 6461 7461 3d69 2c20 7065 7270  sne(data=i, perp
+00012550: 6c65 7869 7479 3d70 6572 706c 6578 6974  lexity=perplexit
+00012560: 792c 206c 6561 726e 696e 675f 7261 7465  y, learning_rate
+00012570: 3d6c 6561 726e 696e 675f 7261 7465 2c20  =learning_rate, 
+00012580: 6561 726c 795f 6578 6167 6765 7261 7469  early_exaggerati
+00012590: 6f6e 3d65 6172 6c79 5f65 7861 6767 6572  on=early_exagger
+000125a0: 6174 696f 6e29 2066 6f72 2069 2069 6e20  ation) for i in 
+000125b0: 6461 7461 7365 7473 5d0a 0a20 2020 2020  datasets]..     
+000125c0: 2020 2066 6967 2c20 6178 203d 2070 6c74     fig, ax = plt
+000125d0: 2e73 7562 706c 6f74 7328 6e5f 726f 7773  .subplots(n_rows
+000125e0: 2c20 6e5f 636f 6c73 2c20 6669 6773 697a  , n_cols, figsiz
+000125f0: 653d 6669 6773 697a 6529 0a0a 2020 2020  e=figsize)..    
+00012600: 2020 2020 666f 7220 7473 6e65 5f64 6174      for tsne_dat
+00012610: 612c 2074 6974 6c65 2c20 6178 6573 2069  a, title, axes i
+00012620: 6e20 7a69 7028 7473 6e65 5f64 6174 6173  n zip(tsne_datas
+00012630: 6574 732c 2074 6974 6c65 732c 206e 702e  ets, titles, np.
+00012640: 6172 7261 7928 6178 292e 666c 6174 7465  array(ax).flatte
+00012650: 6e28 2929 3a0a 2020 2020 2020 2020 2020  n()):.          
+00012660: 2020 736e 732e 7363 6174 7465 7270 6c6f    sns.scatterplo
+00012670: 7428 6461 7461 3d74 736e 655f 6461 7461  t(data=tsne_data
+00012680: 2c20 783d 2754 534e 4520 3127 2c20 793d  , x='TSNE 1', y=
+00012690: 2754 534e 4520 3227 2c20 6875 653d 2766  'TSNE 2', hue='f
+000126a0: 6561 7475 7265 7327 2c20 6178 3d61 7865  eatures', ax=axe
+000126b0: 7329 0a20 2020 2020 2020 2020 2020 2061  s).            a
+000126c0: 7865 732e 7365 745f 7469 746c 6528 7469  xes.set_title(ti
+000126d0: 746c 6529 0a20 2020 2020 2020 2020 2020  tle).           
+000126e0: 2073 6e73 2e64 6573 7069 6e65 2829 0a0a   sns.despine()..
+000126f0: 2020 2020 2020 2020 6966 2073 6176 6566          if savef
+00012700: 6967 203d 3d20 5472 7565 3a0a 2020 2020  ig == True:.    
+00012710: 2020 2020 2020 2020 6669 672e 7361 7666          fig.savf
+00012720: 6967 2827 745f 534e 455f 706c 6f74 2e70  ig('t_SNE_plot.p
+00012730: 6466 272c 2062 626f 785f 696e 6368 6573  df', bbox_inches
+00012740: 3d27 7469 6768 7427 2c20 7472 616e 7370  ='tight', transp
+00012750: 6172 656e 743d 5472 7565 290a 0a20 2020  arent=True)..   
+00012760: 2064 6566 2073 6571 7565 6e74 6961 6c5f   def sequential_
+00012770: 7063 615f 7473 6e65 5f70 6c6f 7428 7365  pca_tsne_plot(se
+00012780: 6c66 2c20 7661 7269 616e 6365 3d30 2e38  lf, variance=0.8
+00012790: 2c20 7065 7270 6c65 7869 7479 3d31 302c  , perplexity=10,
+000127a0: 206c 6561 726e 696e 675f 7261 7465 3d27   learning_rate='
+000127b0: 6175 746f 272c 2065 6172 6c79 5f65 7861  auto', early_exa
+000127c0: 6767 6572 6174 696f 6e3d 3132 2c20 6e5f  ggeration=12, n_
+000127d0: 726f 7773 3d31 2c20 6e5f 636f 6c73 3d31  rows=1, n_cols=1
+000127e0: 2c20 7469 746c 6573 3d5b 2727 5d2c 2066  , titles=[''], f
+000127f0: 6967 7369 7a65 3d28 352c 3529 2c20 7361  igsize=(5,5), sa
+00012800: 7665 6669 673d 4661 6c73 6529 3a0a 0a20  vefig=False):.. 
+00012810: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+00012820: 2020 2050 6c6f 7420 7453 4e45 2061 6674     Plot tSNE aft
+00012830: 6572 2050 4341 2064 696d 656e 7369 6f6e  er PCA dimension
+00012840: 616c 6974 7920 7265 6475 6374 696f 6e0a  ality reduction.
+00012850: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
+00012860: 6572 730a 2020 2020 2020 2020 2d2d 2d2d  ers.        ----
+00012870: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2076  ------.        v
+00012880: 6172 6961 6e63 6520 3a20 666c 6f61 740a  ariance : float.
+00012890: 2020 2020 2020 2020 2020 2020 204d 696e               Min
+000128a0: 2076 6172 6961 6e63 6520 666f 7220 5043   variance for PC
+000128b0: 4120 2844 6566 6175 6c74 2076 616c 7565  A (Default value
+000128c0: 203d 2030 2e38 290a 2020 2020 2020 2020   = 0.8).        
+000128d0: 2020 2020 200a 2020 2020 2020 2020 7065       .        pe
+000128e0: 7270 6c65 7869 7479 203a 2069 6e74 0a20  rplexity : int. 
+000128f0: 2020 2020 2020 2020 2020 2020 2844 6566              (Def
+00012900: 6175 6c74 2076 616c 7565 203d 2031 3029  ault value = 10)
+00012910: 0a0a 2020 2020 2020 2020 6c65 6172 6e69  ..        learni
+00012920: 6e67 5f72 6174 6520 3a20 696e 7420 6f72  ng_rate : int or
+00012930: 2073 7472 0a20 2020 2020 2020 2020 2020   str.           
+00012940: 2020 2844 6566 6175 6c74 2076 616c 7565    (Default value
+00012950: 203d 2027 6175 746f 2729 0a0a 2020 2020   = 'auto')..    
+00012960: 2020 2020 6561 726c 795f 6578 6167 6765      early_exagge
+00012970: 7261 7469 6f6e 203a 2069 6e74 0a20 2020  ration : int.   
+00012980: 2020 2020 2020 2020 2020 2844 6566 6175            (Defau
+00012990: 6c74 2076 616c 7565 203d 2031 3229 0a0a  lt value = 12)..
+000129a0: 2020 2020 2020 2020 6e5f 726f 7773 203a          n_rows :
+000129b0: 2069 6e74 0a20 2020 2020 2020 2020 2020   int.           
+000129c0: 2020 4e75 6d62 6572 206f 6620 726f 7773    Number of rows
+000129d0: 2069 6e20 7375 6270 6c6f 7420 2844 6566   in subplot (Def
+000129e0: 6175 6c74 2076 616c 7565 203d 2031 290a  ault value = 1).
+000129f0: 0a20 2020 2020 2020 206e 5f63 6f6c 7320  .        n_cols 
+00012a00: 3a20 696e 740a 2020 2020 2020 2020 2020  : int.          
+00012a10: 2020 204e 756d 6265 7220 6f66 2063 6f6c     Number of col
+00012a20: 756d 736e 2069 6e20 7375 6270 6c6f 7420  umsn in subplot 
+00012a30: 2844 6566 6175 6c74 2076 616c 7565 203d  (Default value =
+00012a40: 2031 290a 0a20 2020 2020 2020 2074 6974   1)..        tit
+00012a50: 6c65 7320 3a20 6c69 7374 0a20 2020 2020  les : list.     
+00012a60: 2020 2020 2020 2020 4c69 7374 206f 6620          List of 
+00012a70: 7469 7465 6c73 2069 6e20 7375 6270 6c6f  titels in subplo
+00012a80: 7420 2844 6566 6175 6c74 2076 616c 7565  t (Default value
+00012a90: 203d 205b 2727 5d29 0a0a 2020 2020 2020   = [''])..      
+00012aa0: 2020 6669 6773 697a 6520 3a20 7475 706c    figsize : tupl
+00012ab0: 650a 2020 2020 2020 2020 2020 2020 2046  e.             F
+00012ac0: 6967 7572 6520 7369 7a65 2028 4465 6661  igure size (Defa
+00012ad0: 756c 7420 7661 6c75 6520 3d20 2835 2c20  ult value = (5, 
+00012ae0: 3529 203a 0a20 2020 2020 2020 2020 2020  5) :.           
+00012af0: 200a 2020 2020 2020 2020 7361 7665 6669   .        savefi
+00012b00: 6720 3a20 626f 6f6c 0a20 2020 2020 2020  g : bool.       
+00012b10: 2020 2020 2020 4966 2054 7275 652c 2073        If True, s
+00012b20: 6176 6566 2066 6967 7572 6520 2844 6566  avef figure (Def
+00012b30: 6175 6c74 2076 616c 7565 203d 2046 616c  ault value = Fal
+00012b40: 7365 290a 0a20 2020 2020 2020 2052 6574  se)..        Ret
+00012b50: 7572 6e73 0a20 2020 2020 2020 202d 2d2d  urns.        ---
+00012b60: 2d2d 2d2d 0a20 2020 2020 2020 206d 6174  ----.        mat
+00012b70: 706c 6f74 6c69 622e 7079 706c 6f74 0a20  plotlib.pyplot. 
+00012b80: 2020 2020 2020 2022 2222 0a0a 2020 2020         """..    
+00012b90: 2020 2020 6966 206e 5f72 6f77 7320 3d3d      if n_rows ==
+00012ba0: 2031 2061 6e64 206e 5f63 6f6c 7320 3d3d   1 and n_cols ==
+00012bb0: 2031 3a0a 2020 2020 2020 2020 2020 2020   1:.            
+00012bc0: 6461 7461 7365 7473 203d 205b 7365 6c66  datasets = [self
+00012bd0: 2e64 6174 615d 0a0a 2020 2020 2020 2020  .data]..        
+00012be0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+00012bf0: 2020 6461 7461 7365 7473 203d 2073 656c    datasets = sel
+00012c00: 662e 6461 7461 7365 7473 2e63 6f70 7928  f.datasets.copy(
+00012c10: 290a 0a20 2020 2020 2020 2066 6967 2c20  )..        fig, 
+00012c20: 6178 203d 2070 6c74 2e73 7562 706c 6f74  ax = plt.subplot
+00012c30: 7328 6e5f 726f 7773 2c20 6e5f 636f 6c73  s(n_rows, n_cols
+00012c40: 2c20 6669 6773 697a 653d 6669 6773 697a  , figsize=figsiz
+00012c50: 6529 0a0a 2020 2020 2020 2020 666f 7220  e)..        for 
+00012c60: 6461 7461 2c20 7469 746c 652c 2061 7820  data, title, ax 
+00012c70: 696e 207a 6970 2864 6174 6173 6574 732c  in zip(datasets,
+00012c80: 2074 6974 6c65 732c 206e 702e 6172 7261   titles, np.arra
+00012c90: 7928 6178 292e 666c 6174 7465 6e28 2929  y(ax).flatten())
+00012ca0: 3a0a 2020 2020 2020 2020 2020 2020 666c  :.            fl
+00012cb0: 6f61 745f 6461 7461 203d 2064 6174 612e  oat_data = data.
+00012cc0: 7365 6c65 6374 5f64 7479 7065 7328 2766  select_dtypes('f
+00012cd0: 6c6f 6174 2729 2e54 0a20 2020 2020 2020  loat').T.       
+00012ce0: 2020 2020 2066 6561 7475 7265 7320 3d20       features = 
+00012cf0: 666c 6f61 745f 6461 7461 2e69 6e64 6578  float_data.index
+00012d00: 2e74 6f5f 6c69 7374 2829 0a20 2020 2020  .to_list().     
+00012d10: 2020 2020 2020 2066 6c6f 6174 5f64 6174         float_dat
+00012d20: 6120 3d20 5374 616e 6461 7264 5363 616c  a = StandardScal
+00012d30: 6572 2829 2e66 6974 5f74 7261 6e73 666f  er().fit_transfo
+00012d40: 726d 2866 6c6f 6174 5f64 6174 6129 0a20  rm(float_data). 
+00012d50: 2020 2020 2020 2020 2020 2070 6361 5f72             pca_r
+00012d60: 6564 7563 6564 5f64 6174 6120 3d20 5043  educed_data = PC
+00012d70: 4128 6e5f 636f 6d70 6f6e 656e 7473 3d76  A(n_components=v
+00012d80: 6172 6961 6e63 6529 2e66 6974 5f74 7261  ariance).fit_tra
+00012d90: 6e73 666f 726d 2866 6c6f 6174 5f64 6174  nsform(float_dat
+00012da0: 6129 0a0a 2020 2020 2020 2020 2020 2020  a)..            
+00012db0: 7063 615f 6461 7461 203d 2070 642e 4461  pca_data = pd.Da
+00012dc0: 7461 4672 616d 6528 7063 615f 7265 6475  taFrame(pca_redu
+00012dd0: 6365 645f 6461 7461 2c20 696e 6465 783d  ced_data, index=
+00012de0: 6665 6174 7572 6573 292e 540a 0a20 2020  features).T..   
+00012df0: 2020 2020 2020 2020 2074 736e 655f 6461           tsne_da
+00012e00: 7461 203d 2073 656c 662e 5f74 736e 6528  ta = self._tsne(
+00012e10: 6461 7461 3d70 6361 5f64 6174 612c 2070  data=pca_data, p
+00012e20: 6572 706c 6578 6974 793d 7065 7270 6c65  erplexity=perple
+00012e30: 7869 7479 2c20 6c65 6172 6e69 6e67 5f72  xity, learning_r
+00012e40: 6174 653d 6c65 6172 6e69 6e67 5f72 6174  ate=learning_rat
+00012e50: 652c 2065 6172 6c79 5f65 7861 6767 6572  e, early_exagger
+00012e60: 6174 696f 6e3d 6561 726c 795f 6578 6167  ation=early_exag
+00012e70: 6765 7261 7469 6f6e 290a 0a20 2020 2020  geration)..     
+00012e80: 2020 2020 2020 2073 6e73 2e73 6361 7474         sns.scatt
+00012e90: 6572 706c 6f74 2864 6174 613d 7473 6e65  erplot(data=tsne
+00012ea0: 5f64 6174 612c 2078 3d27 5453 4e45 2031  _data, x='TSNE 1
+00012eb0: 272c 2079 3d27 5453 4e45 2032 272c 2068  ', y='TSNE 2', h
+00012ec0: 7565 3d27 6665 6174 7572 6573 272c 2061  ue='features', a
+00012ed0: 783d 6178 290a 2020 2020 2020 2020 2020  x=ax).          
+00012ee0: 2020 6178 2e73 6574 5f74 6974 6c65 2874    ax.set_title(t
+00012ef0: 6974 6c65 290a 2020 2020 2020 2020 2020  itle).          
+00012f00: 2020 736e 732e 6465 7370 696e 6528 290a    sns.despine().
+00012f10: 0a20 2020 2020 2020 2069 6620 7361 7665  .        if save
+00012f20: 6669 6720 3d3d 2054 7275 653a 0a20 2020  fig == True:.   
+00012f30: 2020 2020 2020 2020 2066 6967 2e73 6176           fig.sav
+00012f40: 6566 6967 2827 7365 715f 7063 615f 745f  efig('seq_pca_t_
+00012f50: 534e 455f 706c 6f74 2e70 6466 272c 2062  SNE_plot.pdf', b
+00012f60: 626f 785f 696e 6368 6573 3d27 7469 6768  box_inches='tigh
+00012f70: 7427 2c20 7472 616e 7370 6172 656e 743d  t', transparent=
+00012f80: 5472 7565 290a 0000 0000 0000 0000 0000  True)...........
 00012f90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00012fa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00012fb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00012fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00012fd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00012fe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00012ff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00013000: 7072 6f74 656f 6d69 6373 5f64 6f77 6e73  proteomics_downs
-00013010: 7472 6561 6d5f 616e 616c 7973 6973 2d30  tream_analysis-0
-00013020: 2e31 2e32 2f70 726f 7465 6f6d 6963 735f  .1.2/proteomics_
-00013030: 646f 776e 7374 7265 616d 5f61 6e61 6c79  downstream_analy
-00013040: 7369 732f 656e 7269 6368 6d65 6e74 616e  sis/enrichmentan
-00013050: 616c 7973 6973 2e70 7900 0000 0000 0000  alysis.py.......
-00013060: 0000 0000 3030 3030 3634 3400 3030 3031  ....0000644.0001
-00013070: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
-00013080: 3030 3534 3034 3700 3134 3435 3130 3636  0054047.14451066
-00013090: 3233 3500 3033 3232 3731 0020 3000 0000  235.032271. 0...
+00013000: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+00013010: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013020: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013060: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+00013070: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00013080: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
+00013090: 3030 3000 3031 3032 3133 0020 7800 0000  000.010213. x...
 000130a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000130b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000130c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000130d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000130e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000130f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00013100: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
+00013100: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
 00013110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00013120: 0000 0000 0000 0000 0064 6f63 6b65 7200  .........docker.
+00013120: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00013130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00013140: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00013150: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00013160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00013170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00013180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00013190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000131a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000131b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000131c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000131d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000131e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000131f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00013200: 696d 706f 7274 2067 7365 6170 7920 6173  import gseapy as
-00013210: 2067 700a 6672 6f6d 2067 6f61 746f 6f6c   gp.from goatool
-00013220: 732e 6f62 6f5f 7061 7273 6572 2069 6d70  s.obo_parser imp
-00013230: 6f72 7420 474f 4461 670a 6672 6f6d 2067  ort GODag.from g
-00013240: 6f61 746f 6f6c 732e 6173 736f 6369 6174  oatools.associat
-00013250: 696f 6e73 2069 6d70 6f72 7420 7265 6164  ions import read
-00013260: 5f67 6166 0a66 726f 6d20 676f 6174 6f6f  _gaf.from goatoo
-00013270: 6c73 2e61 7373 6f63 6961 7469 6f6e 7320  ls.associations 
-00013280: 696d 706f 7274 2064 6e6c 645f 6173 7363  import dnld_assc
-00013290: 0a66 726f 6d20 676f 6174 6f6f 6c73 2e73  .from goatools.s
-000132a0: 656d 616e 7469 6320 696d 706f 7274 2073  emantic import s
-000132b0: 656d 616e 7469 635f 7369 6d69 6c61 7269  emantic_similari
-000132c0: 7479 2c20 5465 726d 436f 756e 7473 2c20  ty, TermCounts, 
-000132d0: 5c0a 2020 2020 6765 745f 696e 666f 5f63  \.    get_info_c
-000132e0: 6f6e 7465 6e74 2c20 7265 736e 696b 5f73  ontent, resnik_s
-000132f0: 696d 2c20 6c69 6e5f 7369 6d2c 2064 6565  im, lin_sim, dee
-00013300: 7065 7374 5f63 6f6d 6d6f 6e5f 616e 6365  pest_common_ance
-00013310: 7374 6f72 0a0a 696d 706f 7274 2073 7472  stor..import str
-00013320: 6561 6d6c 6974 2061 7320 7374 0a69 6d70  eamlit as st.imp
-00013330: 6f72 7420 7061 6e64 6173 2061 7320 7064  ort pandas as pd
-00013340: 0a69 6d70 6f72 7420 6e75 6d70 7920 6173  .import numpy as
-00013350: 206e 700a 696d 706f 7274 2073 6561 626f   np.import seabo
-00013360: 726e 2061 7320 736e 730a 696d 706f 7274  rn as sns.import
-00013370: 206d 6174 706c 6f74 6c69 622e 7079 706c   matplotlib.pypl
-00013380: 6f74 2061 7320 706c 740a 6672 6f6d 2061  ot as plt.from a
-00013390: 646a 7573 7454 6578 7420 696d 706f 7274  djustText import
-000133a0: 2061 646a 7573 745f 7465 7874 0a66 726f   adjust_text.fro
-000133b0: 6d20 636f 6c6c 6563 7469 6f6e 7320 696d  m collections im
-000133c0: 706f 7274 2043 6f75 6e74 6572 0a69 6d70  port Counter.imp
-000133d0: 6f72 7420 7465 7874 7772 6170 0a0a 696d  ort textwrap..im
-000133e0: 706f 7274 2070 6c6f 746c 792e 6772 6170  port plotly.grap
-000133f0: 685f 6f62 6a65 6374 7320 6173 2067 6f0a  h_objects as go.
-00013400: 6672 6f6d 2070 6c6f 746c 792e 7375 6270  from plotly.subp
-00013410: 6c6f 7473 2069 6d70 6f72 7420 6d61 6b65  lots import make
-00013420: 5f73 7562 706c 6f74 730a 0a66 726f 6d20  _subplots..from 
-00013430: 2e75 7469 6c73 2069 6d70 6f72 7420 6973  .utils import is
-00013440: 5f6a 7570 7974 6572 5f6e 6f74 6562 6f6f  _jupyter_noteboo
-00013450: 6b2c 2066 6f72 6d61 745f 7974 6963 6b5f  k, format_ytick_
-00013460: 6c61 6265 6c0a 0a63 6c61 7373 2045 6e72  label..class Enr
-00013470: 6963 686d 656e 7441 6e61 6c79 7369 733a  ichmentAnalysis:
-00013480: 0a20 2020 2022 2222 2054 6869 7320 636c  .    """ This cl
-00013490: 6173 7320 656e 6361 7073 756c 6174 6573  ass encapsulates
-000134a0: 2065 6e72 6963 686d 656e 7420 616e 616c   enrichment anal
-000134b0: 7973 6973 206d 6574 686f 6473 2022 2222  ysis methods """
-000134c0: 0a0a 2020 2020 6465 6620 5f5f 696e 6974  ..    def __init
-000134d0: 5f5f 2873 656c 662c 206f 626f 5f66 696c  __(self, obo_fil
-000134e0: 653d 4e6f 6e65 2c20 6761 665f 6669 6c65  e=None, gaf_file
-000134f0: 3d4e 6f6e 6529 3a0a 2020 2020 2020 2020  =None):.        
-00013500: 0a20 2020 2020 2020 2069 6620 6f62 6f5f  .        if obo_
-00013510: 6669 6c65 2069 7320 4e6f 6e65 2061 6e64  file is None and
-00013520: 2067 6166 5f66 696c 6520 6973 204e 6f6e   gaf_file is Non
-00013530: 653a 0a20 2020 2020 2020 2020 2020 2070  e:.            p
-00013540: 6173 730a 2020 2020 2020 2020 656c 7365  ass.        else
-00013550: 3a0a 2020 2020 2020 2020 2020 2020 676f  :.            go
-00013560: 6461 6720 3d20 474f 4461 6728 6f62 6f5f  dag = GODag(obo_
-00013570: 6669 6c65 290a 2020 2020 2020 2020 2020  file).          
-00013580: 2020 6173 736f 6369 6174 696f 6e73 203d    associations =
-00013590: 2072 6561 645f 6761 6628 6761 665f 6669   read_gaf(gaf_fi
-000135a0: 6c65 290a 2020 2020 2020 2020 2020 2020  le).            
-000135b0: 7465 726d 636f 756e 7473 203d 2054 6572  termcounts = Ter
-000135c0: 6d43 6f75 6e74 7328 676f 6461 672c 2061  mCounts(godag, a
-000135d0: 7373 6f63 6961 7469 6f6e 7329 0a0a 2020  ssociations)..  
-000135e0: 2020 2020 2020 2020 2020 7365 6c66 2e67            self.g
-000135f0: 6f64 6167 203d 2067 6f64 6167 0a20 2020  odag = godag.   
-00013600: 2020 2020 2020 2020 2073 656c 662e 7465           self.te
-00013610: 726d 636f 756e 7473 203d 2074 6572 6d63  rmcounts = termc
-00013620: 6f75 6e74 730a 0a20 2020 2064 6566 2061  ounts..    def a
-00013630: 7272 6179 5f65 6e72 6963 686d 656e 745f  rray_enrichment_
-00013640: 616e 616c 7973 6973 2873 656c 662c 2067  analysis(self, g
-00013650: 656e 655f 6c69 7374 2c20 6f72 6761 6e69  ene_list, organi
-00013660: 736d 2c20 7365 6d61 7469 635f 7369 6d5f  sm, sematic_sim_
-00013670: 6669 6c74 6572 3d54 7275 6529 3a0a 0a20  filter=True):.. 
-00013680: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00013690: 2020 2050 6572 666f 726d 2047 4f20 7465     Perform GO te
-000136a0: 726d 2065 6e72 6963 686d 656e 740a 0a20  rm enrichment.. 
-000136b0: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
-000136c0: 730a 2020 2020 2020 2020 2d2d 2d2d 2d2d  s.        ------
-000136d0: 2d2d 2d2d 0a20 2020 2020 2020 2067 656e  ----.        gen
-000136e0: 655f 6c69 7374 203a 206c 6973 740a 2020  e_list : list.  
-000136f0: 2020 2020 2020 2020 2020 4120 6c69 7374            A list
-00013700: 206f 6620 6765 6e65 7320 746f 2062 6520   of genes to be 
-00013710: 7573 6564 2066 6f72 2065 6e72 6963 686d  used for enrichm
-00013720: 656e 7420 616e 616c 7973 6973 0a0a 2020  ent analysis..  
-00013730: 2020 2020 2020 6f72 6761 6e69 736d 203a        organism :
-00013740: 2073 7472 0a20 2020 2020 2020 2020 2020   str.           
-00013750: 204f 7267 616e 6973 6d20 746f 2062 6520   Organism to be 
-00013760: 7573 6564 2074 6f20 646f 2065 6e72 6963  used to do enric
-00013770: 686d 656e 7420 616e 616c 7973 6973 2e20  hment analysis. 
-00013780: 652e 6720 2768 756d 616e 2720 6f72 2027  e.g 'human' or '
-00013790: 6d6f 7573 6527 0a20 2020 2020 2020 200a  mouse'.        .
-000137a0: 2020 2020 2020 2020 5265 7475 726e 730a          Returns.
-000137b0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d0a          -------.
-000137c0: 2020 2020 2020 2020 656e 725f 6461 7461          enr_data
-000137d0: 5f66 696c 7420 3a20 6c69 7374 0a20 2020  _filt : list.   
-000137e0: 2020 2020 2020 2020 204c 6973 7420 6f66           List of
-000137f0: 2064 6174 6166 7261 6d65 7320 7769 7468   dataframes with
-00013800: 2047 4f5f 4269 6f6c 6f67 6963 616c 5f50   GO_Biological_P
-00013810: 726f 6365 7373 5f32 3032 312c 2047 4f5f  rocess_2021, GO_
-00013820: 4d6f 6c65 6375 6c61 725f 4675 6e63 7469  Molecular_Functi
-00013830: 6f6e 5f32 3032 310a 2020 2020 2020 2020  on_2021.        
-00013840: 2020 2020 474f 5f43 656c 6c75 6c61 725f      GO_Cellular_
-00013850: 436f 6d70 6f6e 656e 745f 3230 3231 2065  Component_2021 e
-00013860: 6e72 6963 686d 656e 7420 6461 7461 2e0a  nrichment data..
-00013870: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00013880: 2020 2020 7465 726d 203d 205b 2747 4f5f      term = ['GO_
-00013890: 4269 6f6c 6f67 6963 616c 5f50 726f 6365  Biological_Proce
-000138a0: 7373 5f32 3032 3127 2c0a 2020 2020 2020  ss_2021',.      
-000138b0: 2020 2020 2020 2020 2020 2747 4f5f 4d6f            'GO_Mo
-000138c0: 6c65 6375 6c61 725f 4675 6e63 7469 6f6e  lecular_Function
-000138d0: 5f32 3032 3127 2c0a 2020 2020 2020 2020  _2021',.        
-000138e0: 2020 2020 2020 2020 2747 4f5f 4365 6c6c          'GO_Cell
-000138f0: 756c 6172 5f43 6f6d 706f 6e65 6e74 5f32  ular_Component_2
-00013900: 3032 3127 5d0a 2020 2020 2020 2020 0a20  021'].        . 
-00013910: 2020 2020 2020 2065 6e72 203d 2067 702e         enr = gp.
-00013920: 656e 7269 6368 7228 6765 6e65 5f6c 6973  enrichr(gene_lis
-00013930: 743d 6765 6e65 5f6c 6973 742c 0a20 2020  t=gene_list,.   
-00013940: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013950: 2020 2020 2020 6765 6e65 5f73 6574 733d        gene_sets=
-00013960: 7465 726d 2c0a 2020 2020 2020 2020 2020  term,.          
-00013970: 2020 2020 2020 2020 2020 2020 2020 206f                 o
-00013980: 7267 616e 6973 6d3d 6f72 6761 6e69 736d  rganism=organism
-00013990: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-000139a0: 2020 2020 2020 2020 2020 206f 7574 6469             outdi
-000139b0: 723d 4e6f 6e65 2c0a 2020 2020 2020 2020  r=None,.        
-000139c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000139d0: 2063 7574 6f66 663d 302e 3529 0a0a 2020   cutoff=0.5)..  
-000139e0: 2020 2020 2020 2320 6368 616e 6765 2064        # change d
-000139f0: 7479 7065 206f 6620 656e 720a 2020 2020  type of enr.    
-00013a00: 2020 2020 656e 7220 3d20 656e 722e 7265      enr = enr.re
-00013a10: 7375 6c74 732e 6173 7479 7065 287b 2754  sults.astype({'T
-00013a20: 6572 6d27 3a20 2773 7472 696e 6727 7d29  erm': 'string'})
-00013a30: 0a0a 2020 2020 2020 2020 2320 7472 616e  ..        # tran
-00013a40: 7366 6f72 6d20 7468 6520 7076 616c 7565  sform the pvalue
-00013a50: 0a20 2020 2020 2020 2065 6e72 5f64 6174  .        enr_dat
-00013a60: 6120 3d20 656e 722e 736f 7274 5f76 616c  a = enr.sort_val
-00013a70: 7565 7328 2741 646a 7573 7465 6420 502d  ues('Adjusted P-
-00013a80: 7661 6c75 6527 290a 2020 2020 2020 2020  value').        
-00013a90: 656e 725f 6461 7461 5b27 4164 6a75 7374  enr_data['Adjust
-00013aa0: 6564 2050 2d76 616c 7565 275d 203d 202d  ed P-value'] = -
-00013ab0: 206e 702e 6c6f 6731 3028 656e 725f 6461   np.log10(enr_da
-00013ac0: 7461 5b27 4164 6a75 7374 6564 2050 2d76  ta['Adjusted P-v
-00013ad0: 616c 7565 275d 290a 0a20 2020 2020 2020  alue'])..       
-00013ae0: 2023 2063 616c 6375 6c61 746f 7220 7468   # calculator th
-00013af0: 6520 6f76 6572 6c61 7020 696e 2025 0a20  e overlap in %. 
-00013b00: 2020 2020 2020 206e 756d 6572 6174 6f72         numerator
-00013b10: 203d 205b 666c 6f61 7428 695b 305d 2920   = [float(i[0]) 
-00013b20: 666f 7220 6920 696e 2065 6e72 5f64 6174  for i in enr_dat
-00013b30: 615b 274f 7665 726c 6170 275d 2e73 7472  a['Overlap'].str
-00013b40: 2e73 706c 6974 2827 2f27 295d 0a20 2020  .split('/')].   
-00013b50: 2020 2020 2064 656e 6f6d 696e 6174 6f72       denominator
-00013b60: 203d 205b 666c 6f61 7428 695b 315d 2920   = [float(i[1]) 
-00013b70: 666f 7220 6920 696e 2065 6e72 5f64 6174  for i in enr_dat
-00013b80: 615b 274f 7665 726c 6170 275d 2e73 7472  a['Overlap'].str
-00013b90: 2e73 706c 6974 2827 2f27 295d 0a20 2020  .split('/')].   
-00013ba0: 2020 2020 206f 7665 726c 6170 203d 206e       overlap = n
-00013bb0: 702e 726f 756e 6428 6e70 2e61 7272 6179  p.round(np.array
-00013bc0: 286e 756d 6572 6174 6f72 2920 2f20 6e70  (numerator) / np
-00013bd0: 2e61 7272 6179 2864 656e 6f6d 696e 6174  .array(denominat
-00013be0: 6f72 2920 2a20 3130 3029 0a20 2020 2020  or) * 100).     
-00013bf0: 2020 2065 6e72 5f64 6174 615b 274f 7665     enr_data['Ove
-00013c00: 726c 6170 2069 6e20 2527 5d20 3d20 6f76  rlap in %'] = ov
-00013c10: 6572 6c61 700a 0a20 2020 2020 2020 2023  erlap..        #
-00013c20: 2070 6172 7469 7469 6f6e 2074 6865 2074   partition the t
-00013c30: 6572 6d0a 2020 2020 2020 2020 656e 725f  erm.        enr_
-00013c40: 6461 7461 5b27 474f 2074 6572 6d20 4944  data['GO term ID
-00013c50: 275d 203d 205b 695b 315d 2e73 706c 6974  '] = [i[1].split
-00013c60: 2827 2927 295b 305d 0a20 2020 2020 2020  (')')[0].       
-00013c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013c80: 2020 2020 2020 2020 2020 2066 6f72 2069             for i
-00013c90: 2069 6e20 656e 725f 6461 7461 5b27 5465   in enr_data['Te
-00013ca0: 726d 275d 2e73 7472 2e73 706c 6974 2827  rm'].str.split('
-00013cb0: 2827 295d 0a20 2020 2020 2020 2065 6e72  (')].        enr
-00013cc0: 5f64 6174 615b 2747 4f20 7465 726d 2049  _data['GO term I
-00013cd0: 4427 5d20 3d20 656e 725f 6461 7461 5b27  D'] = enr_data['
-00013ce0: 474f 2074 6572 6d20 4944 275d 2e61 7374  GO term ID'].ast
-00013cf0: 7970 6528 2773 7472 696e 6727 290a 2020  ype('string').  
-00013d00: 2020 2020 2020 656e 725f 6461 7461 5b27        enr_data['
-00013d10: 5465 726d 275d 203d 2065 6e72 5f64 6174  Term'] = enr_dat
-00013d20: 615b 2754 6572 6d27 5d2e 7374 722e 7061  a['Term'].str.pa
-00013d30: 7274 6974 696f 6e28 2720 2827 295b 305d  rtition(' (')[0]
-00013d40: 0a0a 2020 2020 2020 2020 2320 6669 6c74  ..        # filt
-00013d50: 6572 2074 6865 2064 6174 6120 6279 2046  er the data by F
-00013d60: 4452 0a20 2020 2020 2020 2065 6e72 5f64  DR.        enr_d
-00013d70: 6174 6120 3d20 656e 725f 6461 7461 5b65  ata = enr_data[e
-00013d80: 6e72 5f64 6174 615b 2741 646a 7573 7465  nr_data['Adjuste
-00013d90: 6420 502d 7661 6c75 6527 5d20 3e20 312e  d P-value'] > 1.
-00013da0: 335d 0a20 2020 2020 2020 2065 6e72 5f64  3].        enr_d
-00013db0: 6174 6120 3d20 656e 725f 6461 7461 2e73  ata = enr_data.s
-00013dc0: 6f72 745f 7661 6c75 6573 2827 436f 6d62  ort_values('Comb
-00013dd0: 696e 6564 2053 636f 7265 272c 2061 7363  ined Score', asc
-00013de0: 656e 6469 6e67 3d46 616c 7365 2920 0a20  ending=False) . 
-00013df0: 2020 2020 2020 200a 2020 2020 2020 2020         .        
-00013e00: 6966 2073 656d 6174 6963 5f73 696d 5f66  if sematic_sim_f
-00013e10: 696c 7465 7220 6973 2054 7275 653a 0a20  ilter is True:. 
-00013e20: 2020 2020 2020 2020 2020 2065 6e72 5f64             enr_d
-00013e30: 6174 615f 6669 6c74 203d 2073 656c 662e  ata_filt = self.
-00013e40: 6669 6c74 6572 5f67 6f5f 6279 5f6c 696e  filter_go_by_lin
-00013e50: 5f73 696d 280a 2020 2020 2020 2020 2020  _sim(.          
-00013e60: 2020 2020 2020 5b65 6e72 5f64 6174 615b        [enr_data[
-00013e70: 656e 725f 6461 7461 5b27 4765 6e65 5f73  enr_data['Gene_s
-00013e80: 6574 275d 203d 3d20 695d 2066 6f72 2069  et'] == i] for i
-00013e90: 2069 6e20 7465 726d 5d29 0a20 2020 2020   in term]).     
-00013ea0: 2020 2020 2020 2065 6e72 5f64 6174 615f         enr_data_
-00013eb0: 6669 6c74 203d 205b 656e 725f 6461 7461  filt = [enr_data
-00013ec0: 5f66 696c 745b 656e 725f 6461 7461 5f66  _filt[enr_data_f
-00013ed0: 696c 745b 2747 656e 655f 7365 7427 5d20  ilt['Gene_set'] 
-00013ee0: 3d3d 2069 5d0a 2020 2020 2020 2020 2020  == i].          
-00013ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013f00: 2020 666f 7220 6920 696e 2074 6572 6d5d    for i in term]
-00013f10: 0a20 2020 2020 2020 2020 2020 200a 2020  .            .  
-00013f20: 2020 2020 2020 2020 2020 666f 7220 6461            for da
-00013f30: 7461 2069 6e20 656e 725f 6461 7461 5f66  ta in enr_data_f
-00013f40: 696c 743a 0a20 2020 2020 2020 2020 2020  ilt:.           
-00013f50: 2020 2020 2064 6174 615b 2769 6e66 6f20       data['info 
-00013f60: 636f 6e74 656e 7427 5d20 3d20 5b67 6574  content'] = [get
-00013f70: 5f69 6e66 6f5f 636f 6e74 656e 7428 676f  _info_content(go
-00013f80: 5f69 642c 2073 656c 662e 7465 726d 636f  _id, self.termco
-00013f90: 756e 7473 290a 2020 2020 2020 2020 2020  unts).          
-00013fa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013fb0: 2020 2020 2020 2020 2020 2020 2020 666f                fo
-00013fc0: 7220 676f 5f69 6420 696e 2064 6174 615b  r go_id in data[
-00013fd0: 2747 4f20 7465 726d 2049 4427 5d5d 0a20  'GO term ID']]. 
-00013fe0: 2020 2020 2020 2020 2020 2020 2020 2064                 d
-00013ff0: 6174 6120 3d20 6461 7461 2e73 6f72 745f  ata = data.sort_
-00014000: 7661 6c75 6573 2827 696e 666f 2063 6f6e  values('info con
-00014010: 7465 6e74 272c 2061 7363 656e 6469 6e67  tent', ascending
-00014020: 3d46 616c 7365 290a 2020 2020 2020 2020  =False).        
-00014030: 2020 2020 0a20 2020 2020 2020 2065 6c73      .        els
-00014040: 653a 0a20 2020 2020 2020 2020 2020 2065  e:.            e
-00014050: 6e72 5f64 6174 615f 6669 6c74 203d 205b  nr_data_filt = [
-00014060: 656e 725f 6461 7461 5b65 6e72 5f64 6174  enr_data[enr_dat
-00014070: 615b 2747 656e 655f 7365 7427 5d20 3d3d  a['Gene_set'] ==
-00014080: 2069 5d20 666f 7220 6920 696e 2074 6572   i] for i in ter
-00014090: 6d5d 0a20 2020 2020 2020 200a 2020 2020  m].        .    
-000140a0: 2020 2020 7365 6c66 2e67 6f5f 6461 7461      self.go_data
-000140b0: 203d 2065 6e72 5f64 6174 615f 6669 6c74   = enr_data_filt
-000140c0: 2e63 6f70 7928 290a 2020 2020 2020 2020  .copy().        
-000140d0: 7265 7475 726e 2065 6e72 5f64 6174 615f  return enr_data_
-000140e0: 6669 6c74 0a20 2020 200a 0a20 2020 2064  filt.    ..    d
-000140f0: 6566 2070 6c6f 745f 6172 7261 795f 656e  ef plot_array_en
-00014100: 7269 6368 6d65 6e74 2873 656c 662c 2067  richment(self, g
-00014110: 6f5f 6461 7461 2c20 6669 6773 697a 652c  o_data, figsize,
-00014120: 2074 6f70 2c0a 2020 2020 2020 2020 2020   top,.          
-00014130: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014140: 2020 2020 7361 7665 6669 673d 4661 6c73      savefig=Fals
-00014150: 6529 3a0a 2020 2020 2020 2020 2222 220a  e):.        """.
-00014160: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
-00014170: 6572 730a 2020 2020 2020 2020 2d2d 2d2d  ers.        ----
-00014180: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2067  ------.        g
-00014190: 6f5f 6461 7461 203a 206c 6973 740a 2020  o_data : list.  
-000141a0: 2020 2020 2020 2020 2020 4c69 7374 206f            List o
-000141b0: 6620 6461 7461 6672 616d 6573 2077 6974  f dataframes wit
-000141c0: 6820 474f 5f42 696f 6c6f 6769 6361 6c5f  h GO_Biological_
-000141d0: 5072 6f63 6573 735f 3230 3231 2c0a 2020  Process_2021,.  
-000141e0: 2020 2020 2020 2020 2020 474f 5f4d 6f6c            GO_Mol
-000141f0: 6563 756c 6172 5f46 756e 6374 696f 6e5f  ecular_Function_
-00014200: 3230 3231 2061 6e64 0a20 2020 2020 2020  2021 and.       
-00014210: 2020 2020 2047 4f5f 4365 6c6c 756c 6172       GO_Cellular
-00014220: 5f43 6f6d 706f 6e65 6e74 5f32 3032 3120  _Component_2021 
-00014230: 656e 7269 6368 6d65 6e74 2064 6174 612e  enrichment data.
-00014240: 0a0a 2020 2020 2020 2020 6669 6773 697a  ..        figsiz
-00014250: 6520 3a20 7475 706c 650a 2020 2020 2020  e : tuple.      
-00014260: 2020 2020 2020 5369 7a65 206f 6620 7468        Size of th
-00014270: 6520 6669 6775 7265 2065 2e67 2028 3130  e figure e.g (10
-00014280: 2c20 3130 290a 2020 2020 2020 2020 0a20  , 10).        . 
-00014290: 2020 2020 2020 2074 6f70 203a 2069 6e74         top : int
-000142a0: 0a20 2020 2020 2020 2020 2020 2074 6f70  .            top
-000142b0: 206e 2074 6572 6d73 2074 6f20 6265 2070   n terms to be p
-000142c0: 6c6f 7474 6564 2062 6173 6564 206f 6e20  lotted based on 
-000142d0: 7468 6520 636f 6d62 696e 6564 2073 636f  the combined sco
-000142e0: 7265 0a0a 2020 2020 2020 2020 7361 7665  re..        save
-000142f0: 6669 6720 3a20 626f 6f6c 6561 6e0a 2020  fig : boolean.  
-00014300: 2020 2020 2020 2020 2020 2049 6620 5472             If Tr
-00014310: 7565 2073 6176 6573 2074 6865 2066 6967  ue saves the fig
-00014320: 7572 6520 2844 6566 6175 6c74 2076 616c  ure (Default val
-00014330: 7565 203d 2046 616c 7365 292e 0a0a 2020  ue = False)...  
-00014340: 2020 2020 2020 5265 7475 726e 730a 2020        Returns.  
-00014350: 2020 2020 2020 2d2d 2d2d 2d2d 2d0a 2020        -------.  
-00014360: 2020 2020 2020 6d61 7470 6c6f 746c 6962        matplotlib
-00014370: 2e70 7970 6c6f 740a 2020 2020 2020 2020  .pyplot.        
-00014380: 2020 2020 506c 6f74 206f 6620 7468 6520      Plot of the 
-00014390: 656e 7269 6368 6d65 6e74 2061 6e61 6c79  enrichment analy
-000143a0: 7369 730a 2020 2020 2020 2020 2222 220a  sis.        """.
-000143b0: 0a20 2020 2020 2020 2074 6974 6c65 7320  .        titles 
-000143c0: 3d20 5b27 474f 5f42 696f 6c6f 6769 6361  = ['GO_Biologica
-000143d0: 6c5f 5072 6f63 6573 7327 2c0a 2020 2020  l_Process',.    
-000143e0: 2020 2020 2020 2020 2020 2020 2020 2747                'G
-000143f0: 4f5f 4d6f 6c65 6375 6c61 725f 4675 6e63  O_Molecular_Func
-00014400: 7469 6f6e 272c 0a20 2020 2020 2020 2020  tion',.         
-00014410: 2020 2020 2020 2020 2027 474f 5f43 656c           'GO_Cel
-00014420: 6c75 6c61 725f 436f 6d70 6f6e 656e 7427  lular_Component'
-00014430: 5d0a 2020 2020 2020 2020 0a20 2020 2020  ].        .     
-00014440: 2020 2066 6967 2c20 6178 203d 2070 6c74     fig, ax = plt
-00014450: 2e73 7562 706c 6f74 7328 312c 2033 2c20  .subplots(1, 3, 
-00014460: 6669 6773 697a 653d 6669 6773 697a 6529  figsize=figsize)
-00014470: 0a20 2020 2020 2020 200a 2020 2020 2020  .        .      
-00014480: 2020 666f 7220 6461 7461 2c20 6178 6573    for data, axes
-00014490: 2c20 7469 746c 6520 696e 207a 6970 2867  , title in zip(g
-000144a0: 6f5f 6461 7461 2c20 6178 2e66 6c61 742c  o_data, ax.flat,
-000144b0: 2074 6974 6c65 7329 3a0a 2020 2020 2020   titles):.      
-000144c0: 2020 2020 2020 6461 7461 5f63 6f70 7920        data_copy 
-000144d0: 3d20 6461 7461 2e63 6f70 7928 290a 2020  = data.copy().  
-000144e0: 2020 2020 2020 2020 2020 6461 7461 5f63            data_c
-000144f0: 6f70 795b 2754 6572 6d27 5d20 3d20 5b74  opy['Term'] = [t
-00014500: 6578 7477 7261 702e 6669 6c6c 2869 2c20  extwrap.fill(i, 
-00014510: 3330 290a 2020 2020 2020 2020 2020 2020  30).            
-00014520: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014530: 2020 2020 2066 6f72 2069 2069 6e20 6461       for i in da
-00014540: 7461 5f63 6f70 795b 2754 6572 6d27 5d5d  ta_copy['Term']]
-00014550: 0a20 2020 2020 2020 2020 2020 200a 2020  .            .  
-00014560: 2020 2020 2020 2020 2020 736e 732e 7363            sns.sc
-00014570: 6174 7465 7270 6c6f 7428 6461 7461 3d64  atterplot(data=d
-00014580: 6174 615f 636f 7079 2e68 6561 6428 746f  ata_copy.head(to
-00014590: 7029 2c0a 2020 2020 2020 2020 2020 2020  p),.            
-000145a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000145b0: 783d 2741 646a 7573 7465 6420 502d 7661  x='Adjusted P-va
-000145c0: 6c75 6527 2c0a 2020 2020 2020 2020 2020  lue',.          
-000145d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000145e0: 2020 793d 2754 6572 6d27 2c0a 2020 2020    y='Term',.    
-000145f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014600: 2020 2020 2020 2020 7369 7a65 3d27 4f76          size='Ov
-00014610: 6572 6c61 7020 696e 2025 272c 0a20 2020  erlap in %',.   
-00014620: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014630: 2020 2020 2020 2020 2068 7565 3d27 436f           hue='Co
-00014640: 6d62 696e 6564 2053 636f 7265 272c 200a  mbined Score', .
-00014650: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014660: 2020 2020 2020 2020 2020 2020 7369 7a65              size
-00014670: 733d 2832 302c 2032 3030 292c 0a20 2020  s=(20, 200),.   
-00014680: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014690: 2020 2020 2020 2020 2070 616c 6574 7465           palette
-000146a0: 3d27 7669 7269 6469 735f 7227 2c0a 2020  ='viridis_r',.  
-000146b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000146c0: 2020 2020 2020 2020 2020 6178 3d61 7865            ax=axe
-000146d0: 7329 0a20 2020 2020 2020 2020 2020 200a  s).            .
-000146e0: 2020 2020 2020 2020 2020 2020 6178 6573              axes
-000146f0: 2e74 6974 6c65 2e73 6574 5f74 6578 7428  .title.set_text(
-00014700: 7469 746c 6529 0a20 2020 2020 2020 2020  title).         
-00014710: 2020 2070 6c74 2e6c 6567 656e 6428 6c6f     plt.legend(lo
-00014720: 633d 2762 6573 7427 290a 2020 2020 2020  c='best').      
-00014730: 2020 2020 2020 736e 732e 6465 7370 696e        sns.despin
-00014740: 6528 290a 2020 2020 2020 2020 6669 672e  e().        fig.
-00014750: 7469 6768 745f 6c61 796f 7574 2829 0a20  tight_layout(). 
-00014760: 2020 2020 2020 2020 2020 200a 2020 2020             .    
-00014770: 2020 2020 6966 2073 6176 6566 6967 2069      if savefig i
-00014780: 7320 5472 7565 3a0a 2020 2020 2020 2020  s True:.        
-00014790: 2020 2020 6669 672e 7361 7665 6669 6728      fig.savefig(
-000147a0: 2770 6c6f 745f 6172 7261 795f 656e 7269  'plot_array_enri
-000147b0: 6368 6d65 6e74 2e70 6466 272c 2062 626f  chment.pdf', bbo
-000147c0: 785f 696e 6368 6573 3d27 7469 6768 7427  x_inches='tight'
-000147d0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-000147e0: 2020 2020 2020 2020 2020 7472 616e 7370            transp
-000147f0: 6172 656e 743d 5472 7565 290a 2020 2020  arent=True).    
-00014800: 2020 2020 2020 2020 0a20 2020 2064 6566          .    def
-00014810: 2069 6e74 5f70 6c6f 745f 6172 7261 795f   int_plot_array_
-00014820: 656e 7269 6368 6d65 6e74 2873 656c 662c  enrichment(self,
-00014830: 2067 6f5f 6461 7461 2c20 6865 6967 6874   go_data, height
-00014840: 3d37 3030 2c20 7769 6474 683d 3135 3030  =700, width=1500
-00014850: 2c20 746f 703d 3130 3029 3a0a 0a20 2020  , top=100):..   
-00014860: 2020 2020 206e 5f63 6f6c 7320 3d20 330a       n_cols = 3.
-00014870: 2020 2020 2020 2020 7469 746c 6573 203d          titles =
-00014880: 205b 2742 696f 6c6f 6769 6361 6c20 5072   ['Biological Pr
-00014890: 6f63 6573 7327 2c20 2743 656c 6c75 6c61  ocess', 'Cellula
-000148a0: 7220 436f 6d70 6f6e 656e 7427 2c20 274d  r Component', 'M
-000148b0: 6f6c 6563 756c 6172 2046 756e 6374 696f  olecular Functio
-000148c0: 6e27 5d0a 2020 2020 2020 2020 6669 6720  n'].        fig 
-000148d0: 3d20 6d61 6b65 5f73 7562 706c 6f74 7328  = make_subplots(
-000148e0: 312c 2033 2c20 686f 7269 7a6f 6e74 616c  1, 3, horizontal
-000148f0: 5f73 7061 6369 6e67 203d 2030 2e32 2c20  _spacing = 0.2, 
-00014900: 7375 6270 6c6f 745f 7469 746c 6573 3d74  subplot_titles=t
-00014910: 6974 6c65 7329 0a0a 2020 2020 2020 2020  itles)..        
-00014920: 636d 696e 203d 206e 702e 6d69 6e28 7064  cmin = np.min(pd
-00014930: 2e63 6f6e 6361 7428 676f 5f64 6174 6129  .concat(go_data)
-00014940: 5b27 436f 6d62 696e 6564 2053 636f 7265  ['Combined Score
-00014950: 275d 290a 2020 2020 2020 2020 636d 6178  ']).        cmax
-00014960: 203d 206e 702e 6d61 7828 7064 2e63 6f6e   = np.max(pd.con
-00014970: 6361 7428 676f 5f64 6174 6129 5b27 436f  cat(go_data)['Co
-00014980: 6d62 696e 6564 2053 636f 7265 275d 290a  mbined Score']).
-00014990: 0a20 2020 2020 2020 2066 6f72 2069 2c20  .        for i, 
-000149a0: 6461 7461 2069 6e20 656e 756d 6572 6174  data in enumerat
-000149b0: 6528 676f 5f64 6174 612c 2073 7461 7274  e(go_data, start
-000149c0: 3d31 293a 0a20 2020 2020 2020 2020 2020  =1):.           
-000149d0: 200a 2020 2020 2020 2020 2020 2020 6461   .            da
-000149e0: 7461 203d 2064 6174 612e 696c 6f63 5b3a  ta = data.iloc[:
-000149f0: 746f 705d 2e63 6f70 7928 290a 0a20 2020  top].copy()..   
-00014a00: 2020 2020 2020 2020 2023 2043 616c 6375           # Calcu
-00014a10: 6c61 7465 2072 6f77 2061 6e64 2063 6f6c  late row and col
-00014a20: 2076 616c 7565 7320 666f 7220 7468 6520   values for the 
-00014a30: 7375 6270 6c6f 7473 2062 6173 6564 206f  subplots based o
-00014a40: 6e20 690a 2020 2020 2020 2020 2020 2020  n i.            
-00014a50: 726f 7720 3d20 2869 202d 2031 2920 2f2f  row = (i - 1) //
-00014a60: 206e 5f63 6f6c 7320 2b20 310a 2020 2020   n_cols + 1.    
-00014a70: 2020 2020 2020 2020 636f 6c20 3d20 2869          col = (i
-00014a80: 202d 2031 2920 2520 6e5f 636f 6c73 202b   - 1) % n_cols +
-00014a90: 2031 0a0a 2020 2020 2020 2020 2020 2020   1..            
-00014aa0: 2320 4164 6420 7468 6520 7363 6174 7465  # Add the scatte
-00014ab0: 7220 706c 6f74 7320 746f 2074 6865 2073  r plots to the s
-00014ac0: 7562 706c 6f74 7320 6c61 796f 7574 0a20  ubplots layout. 
-00014ad0: 2020 2020 2020 2020 2020 2066 6967 2e61             fig.a
-00014ae0: 6464 5f74 7261 6365 2867 6f2e 5363 6174  dd_trace(go.Scat
-00014af0: 7465 7228 783d 6461 7461 5b27 4164 6a75  ter(x=data['Adju
-00014b00: 7374 6564 2050 2d76 616c 7565 275d 2c0a  sted P-value'],.
-00014b10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014b20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014b30: 2020 2020 793d 6461 7461 5b27 5465 726d      y=data['Term
-00014b40: 275d 2c0a 2020 2020 2020 2020 2020 2020  '],.            
-00014b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014b60: 2020 2020 2020 2020 6d6f 6465 3d27 6d61          mode='ma
-00014b70: 726b 6572 7327 2c0a 2020 2020 2020 2020  rkers',.        
-00014b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014b90: 2020 2020 2020 2020 2020 2020 6d61 726b              mark
-00014ba0: 6572 3d64 6963 7428 7369 7a65 3d64 6174  er=dict(size=dat
-00014bb0: 615b 274f 7665 726c 6170 2069 6e20 2527  a['Overlap in %'
-00014bc0: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
-00014bd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014be0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014bf0: 2020 2063 6f6c 6f72 3d64 6174 615b 2743     color=data['C
-00014c00: 6f6d 6269 6e65 6420 5363 6f72 6527 5d2c  ombined Score'],
-00014c10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00014c20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014c40: 2063 6f6c 6f72 7363 616c 653d 2756 6972   colorscale='Vir
-00014c50: 6964 6973 272c 200a 2020 2020 2020 2020  idis', .        
-00014c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014c80: 2020 2020 2020 2020 7368 6f77 7363 616c          showscal
-00014c90: 653d 5472 7565 2c20 200a 2020 2020 2020  e=True,  .      
-00014ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014cc0: 2020 2020 2020 2020 2020 636d 696e 3d63            cmin=c
-00014cd0: 6d69 6e2c 2020 0a20 2020 2020 2020 2020  min,  .         
-00014ce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014d00: 2020 2020 2020 2063 6d61 783d 636d 6178         cmax=cmax
-00014d10: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
-00014d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014d30: 2020 2020 2020 2074 6578 743d 6461 7461         text=data
-00014d40: 5b27 4765 6e65 7327 5d2c 0a20 2020 2020  ['Genes'],.     
-00014d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014d60: 2020 2020 2020 2020 2020 2020 2020 2068                 h
-00014d70: 6f76 6572 7465 6d70 6c61 7465 203d 2022  overtemplate = "
-00014d80: 4f76 6572 6c61 7020 696e 2025 3a20 257b  Overlap in %: %{
-00014d90: 6d61 726b 6572 2e73 697a 657d 3c62 723e  marker.size}<br>
-00014da0: 2220 2b0a 2020 2020 2020 2020 2020 2020  " +.            
-00014db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014dc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014dd0: 2020 2020 2020 2020 2247 656e 6573 3a20          "Genes: 
-00014de0: 257b 7465 7874 7d3c 6272 3e22 292c 0a20  %{text}<br>"),. 
-00014df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014e00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014e10: 2020 2020 2020 2072 6f77 3d72 6f77 2c0a         row=row,.
-00014e20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014e30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014e40: 2020 2020 2020 2020 636f 6c3d 636f 6c29          col=col)
-00014e50: 0a0a 2020 2020 2020 2020 2020 2020 6669  ..            fi
-00014e60: 672e 7570 6461 7465 5f78 6178 6573 2874  g.update_xaxes(t
-00014e70: 6974 6c65 5f74 6578 743d 2741 646a 7573  itle_text='Adjus
-00014e80: 7465 6420 502d 7661 6c75 6527 290a 2020  ted P-value').  
-00014e90: 2020 2020 2020 2020 2020 6669 672e 7570            fig.up
-00014ea0: 6461 7465 5f79 6178 6573 2874 6974 6c65  date_yaxes(title
-00014eb0: 5f74 6578 743d 2754 6572 6d27 2c20 0a20  _text='Term', . 
-00014ec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014ed0: 2020 2020 2020 2020 2020 2074 6963 6b6d             tickm
-00014ee0: 6f64 653d 2761 7272 6179 272c 0a20 2020  ode='array',.   
-00014ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014f00: 2020 2020 2020 2020 2074 6963 6b76 616c           tickval
-00014f10: 733d 6461 7461 5b27 5465 726d 275d 2c0a  s=data['Term'],.
+00013200: 3232 206d 7469 6d65 3d31 3638 3835 3732  22 mtime=1688572
+00013210: 3039 322e 300a 0000 0000 0000 0000 0000  092.0...........
+00013220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013260: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013270: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013280: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013290: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000132a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000132b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000132c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000132d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000132e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000132f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013300: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013320: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013340: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013350: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000133a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000133b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000133c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000133d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000133e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000133f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013400: 7072 6f74 656f 6d69 6373 5f64 6f77 6e73  proteomics_downs
+00013410: 7472 6561 6d5f 616e 616c 7973 6973 2d30  tream_analysis-0
+00013420: 2e31 2e33 2f70 726f 7465 6f6d 6963 735f  .1.3/proteomics_
+00013430: 646f 776e 7374 7265 616d 5f61 6e61 6c79  downstream_analy
+00013440: 7369 732f 656e 7269 6368 6d65 6e74 616e  sis/enrichmentan
+00013450: 616c 7973 6973 2e70 7900 0000 0000 0000  alysis.py.......
+00013460: 0000 0000 3030 3030 3634 3400 3030 3031  ....0000644.0001
+00013470: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
+00013480: 3030 3534 3034 3700 3134 3435 3133 3130  0054047.14451310
+00013490: 3237 3400 3033 3232 3635 0020 3000 0000  274.032265. 0...
+000134a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000134b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000134c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000134d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000134e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000134f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013500: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
+00013510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013520: 0000 0000 0000 0000 0064 6f63 6b65 7200  .........docker.
+00013530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013540: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013550: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000135a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000135b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000135c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000135d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000135e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000135f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013600: 696d 706f 7274 2067 7365 6170 7920 6173  import gseapy as
+00013610: 2067 700a 6672 6f6d 2067 6f61 746f 6f6c   gp.from goatool
+00013620: 732e 6f62 6f5f 7061 7273 6572 2069 6d70  s.obo_parser imp
+00013630: 6f72 7420 474f 4461 670a 6672 6f6d 2067  ort GODag.from g
+00013640: 6f61 746f 6f6c 732e 6173 736f 6369 6174  oatools.associat
+00013650: 696f 6e73 2069 6d70 6f72 7420 7265 6164  ions import read
+00013660: 5f67 6166 0a66 726f 6d20 676f 6174 6f6f  _gaf.from goatoo
+00013670: 6c73 2e61 7373 6f63 6961 7469 6f6e 7320  ls.associations 
+00013680: 696d 706f 7274 2064 6e6c 645f 6173 7363  import dnld_assc
+00013690: 0a66 726f 6d20 676f 6174 6f6f 6c73 2e73  .from goatools.s
+000136a0: 656d 616e 7469 6320 696d 706f 7274 2073  emantic import s
+000136b0: 656d 616e 7469 635f 7369 6d69 6c61 7269  emantic_similari
+000136c0: 7479 2c20 5465 726d 436f 756e 7473 2c20  ty, TermCounts, 
+000136d0: 5c0a 2020 2020 6765 745f 696e 666f 5f63  \.    get_info_c
+000136e0: 6f6e 7465 6e74 2c20 7265 736e 696b 5f73  ontent, resnik_s
+000136f0: 696d 2c20 6c69 6e5f 7369 6d2c 2064 6565  im, lin_sim, dee
+00013700: 7065 7374 5f63 6f6d 6d6f 6e5f 616e 6365  pest_common_ance
+00013710: 7374 6f72 0a0a 696d 706f 7274 2073 7472  stor..import str
+00013720: 6561 6d6c 6974 2061 7320 7374 0a69 6d70  eamlit as st.imp
+00013730: 6f72 7420 7061 6e64 6173 2061 7320 7064  ort pandas as pd
+00013740: 0a69 6d70 6f72 7420 6e75 6d70 7920 6173  .import numpy as
+00013750: 206e 700a 696d 706f 7274 2073 6561 626f   np.import seabo
+00013760: 726e 2061 7320 736e 730a 696d 706f 7274  rn as sns.import
+00013770: 206d 6174 706c 6f74 6c69 622e 7079 706c   matplotlib.pypl
+00013780: 6f74 2061 7320 706c 740a 6672 6f6d 2061  ot as plt.from a
+00013790: 646a 7573 7454 6578 7420 696d 706f 7274  djustText import
+000137a0: 2061 646a 7573 745f 7465 7874 0a66 726f   adjust_text.fro
+000137b0: 6d20 636f 6c6c 6563 7469 6f6e 7320 696d  m collections im
+000137c0: 706f 7274 2043 6f75 6e74 6572 0a69 6d70  port Counter.imp
+000137d0: 6f72 7420 7465 7874 7772 6170 0a0a 696d  ort textwrap..im
+000137e0: 706f 7274 2070 6c6f 746c 792e 6772 6170  port plotly.grap
+000137f0: 685f 6f62 6a65 6374 7320 6173 2067 6f0a  h_objects as go.
+00013800: 6672 6f6d 2070 6c6f 746c 792e 7375 6270  from plotly.subp
+00013810: 6c6f 7473 2069 6d70 6f72 7420 6d61 6b65  lots import make
+00013820: 5f73 7562 706c 6f74 730a 0a66 726f 6d20  _subplots..from 
+00013830: 2e75 7469 6c73 2069 6d70 6f72 7420 6973  .utils import is
+00013840: 5f6a 7570 7974 6572 5f6e 6f74 6562 6f6f  _jupyter_noteboo
+00013850: 6b2c 2066 6f72 6d61 745f 7974 6963 6b5f  k, format_ytick_
+00013860: 6c61 6265 6c0a 0a63 6c61 7373 2045 6e72  label..class Enr
+00013870: 6963 686d 656e 7441 6e61 6c79 7369 733a  ichmentAnalysis:
+00013880: 0a20 2020 2022 2222 2054 6869 7320 636c  .    """ This cl
+00013890: 6173 7320 656e 6361 7073 756c 6174 6573  ass encapsulates
+000138a0: 2065 6e72 6963 686d 656e 7420 616e 616c   enrichment anal
+000138b0: 7973 6973 206d 6574 686f 6473 2022 2222  ysis methods """
+000138c0: 0a0a 2020 2020 6465 6620 5f5f 696e 6974  ..    def __init
+000138d0: 5f5f 2873 656c 662c 206f 626f 5f66 696c  __(self, obo_fil
+000138e0: 653d 4e6f 6e65 2c20 6761 665f 6669 6c65  e=None, gaf_file
+000138f0: 3d4e 6f6e 6529 3a0a 2020 2020 2020 2020  =None):.        
+00013900: 0a20 2020 2020 2020 2069 6620 6f62 6f5f  .        if obo_
+00013910: 6669 6c65 2069 7320 4e6f 6e65 2061 6e64  file is None and
+00013920: 2067 6166 5f66 696c 6520 6973 204e 6f6e   gaf_file is Non
+00013930: 653a 0a20 2020 2020 2020 2020 2020 2070  e:.            p
+00013940: 6173 730a 2020 2020 2020 2020 656c 7365  ass.        else
+00013950: 3a0a 2020 2020 2020 2020 2020 2020 676f  :.            go
+00013960: 6461 6720 3d20 474f 4461 6728 6f62 6f5f  dag = GODag(obo_
+00013970: 6669 6c65 290a 2020 2020 2020 2020 2020  file).          
+00013980: 2020 6173 736f 6369 6174 696f 6e73 203d    associations =
+00013990: 2072 6561 645f 6761 6628 6761 665f 6669   read_gaf(gaf_fi
+000139a0: 6c65 290a 2020 2020 2020 2020 2020 2020  le).            
+000139b0: 7465 726d 636f 756e 7473 203d 2054 6572  termcounts = Ter
+000139c0: 6d43 6f75 6e74 7328 676f 6461 672c 2061  mCounts(godag, a
+000139d0: 7373 6f63 6961 7469 6f6e 7329 0a0a 2020  ssociations)..  
+000139e0: 2020 2020 2020 2020 2020 7365 6c66 2e67            self.g
+000139f0: 6f64 6167 203d 2067 6f64 6167 0a20 2020  odag = godag.   
+00013a00: 2020 2020 2020 2020 2073 656c 662e 7465           self.te
+00013a10: 726d 636f 756e 7473 203d 2074 6572 6d63  rmcounts = termc
+00013a20: 6f75 6e74 730a 0a20 2020 2064 6566 2061  ounts..    def a
+00013a30: 7272 6179 5f65 6e72 6963 686d 656e 745f  rray_enrichment_
+00013a40: 616e 616c 7973 6973 2873 656c 662c 2067  analysis(self, g
+00013a50: 656e 655f 6c69 7374 2c20 6f72 6761 6e69  ene_list, organi
+00013a60: 736d 2c20 7365 6d61 7469 635f 7369 6d5f  sm, sematic_sim_
+00013a70: 6669 6c74 6572 3d54 7275 6529 3a0a 0a20  filter=True):.. 
+00013a80: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+00013a90: 2020 2050 6572 666f 726d 2047 4f20 7465     Perform GO te
+00013aa0: 726d 2065 6e72 6963 686d 656e 740a 0a20  rm enrichment.. 
+00013ab0: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
+00013ac0: 730a 2020 2020 2020 2020 2d2d 2d2d 2d2d  s.        ------
+00013ad0: 2d2d 2d2d 0a20 2020 2020 2020 2067 656e  ----.        gen
+00013ae0: 655f 6c69 7374 203a 206c 6973 740a 2020  e_list : list.  
+00013af0: 2020 2020 2020 2020 2020 4120 6c69 7374            A list
+00013b00: 206f 6620 6765 6e65 7320 746f 2062 6520   of genes to be 
+00013b10: 7573 6564 2066 6f72 2065 6e72 6963 686d  used for enrichm
+00013b20: 656e 7420 616e 616c 7973 6973 0a0a 2020  ent analysis..  
+00013b30: 2020 2020 2020 6f72 6761 6e69 736d 203a        organism :
+00013b40: 2073 7472 0a20 2020 2020 2020 2020 2020   str.           
+00013b50: 204f 7267 616e 6973 6d20 746f 2062 6520   Organism to be 
+00013b60: 7573 6564 2074 6f20 646f 2065 6e72 6963  used to do enric
+00013b70: 686d 656e 7420 616e 616c 7973 6973 2e20  hment analysis. 
+00013b80: 652e 6720 2768 756d 616e 2720 6f72 2027  e.g 'human' or '
+00013b90: 6d6f 7573 6527 0a20 2020 2020 2020 200a  mouse'.        .
+00013ba0: 2020 2020 2020 2020 5265 7475 726e 730a          Returns.
+00013bb0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d0a          -------.
+00013bc0: 2020 2020 2020 2020 656e 725f 6461 7461          enr_data
+00013bd0: 5f66 696c 7420 3a20 6c69 7374 0a20 2020  _filt : list.   
+00013be0: 2020 2020 2020 2020 204c 6973 7420 6f66           List of
+00013bf0: 2064 6174 6166 7261 6d65 7320 7769 7468   dataframes with
+00013c00: 2047 4f5f 4269 6f6c 6f67 6963 616c 5f50   GO_Biological_P
+00013c10: 726f 6365 7373 5f32 3032 312c 2047 4f5f  rocess_2021, GO_
+00013c20: 4d6f 6c65 6375 6c61 725f 4675 6e63 7469  Molecular_Functi
+00013c30: 6f6e 5f32 3032 310a 2020 2020 2020 2020  on_2021.        
+00013c40: 2020 2020 474f 5f43 656c 6c75 6c61 725f      GO_Cellular_
+00013c50: 436f 6d70 6f6e 656e 745f 3230 3231 2065  Component_2021 e
+00013c60: 6e72 6963 686d 656e 7420 6461 7461 2e0a  nrichment data..
+00013c70: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00013c80: 2020 2020 7465 726d 203d 205b 2747 4f5f      term = ['GO_
+00013c90: 4269 6f6c 6f67 6963 616c 5f50 726f 6365  Biological_Proce
+00013ca0: 7373 5f32 3032 3127 2c0a 2020 2020 2020  ss_2021',.      
+00013cb0: 2020 2020 2020 2020 2020 2747 4f5f 4d6f            'GO_Mo
+00013cc0: 6c65 6375 6c61 725f 4675 6e63 7469 6f6e  lecular_Function
+00013cd0: 5f32 3032 3127 2c0a 2020 2020 2020 2020  _2021',.        
+00013ce0: 2020 2020 2020 2020 2747 4f5f 4365 6c6c          'GO_Cell
+00013cf0: 756c 6172 5f43 6f6d 706f 6e65 6e74 5f32  ular_Component_2
+00013d00: 3032 3127 5d0a 2020 2020 2020 2020 0a20  021'].        . 
+00013d10: 2020 2020 2020 2065 6e72 203d 2067 702e         enr = gp.
+00013d20: 656e 7269 6368 7228 6765 6e65 5f6c 6973  enrichr(gene_lis
+00013d30: 743d 6765 6e65 5f6c 6973 742c 0a20 2020  t=gene_list,.   
+00013d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013d50: 2020 2020 2020 6765 6e65 5f73 6574 733d        gene_sets=
+00013d60: 7465 726d 2c0a 2020 2020 2020 2020 2020  term,.          
+00013d70: 2020 2020 2020 2020 2020 2020 2020 206f                 o
+00013d80: 7267 616e 6973 6d3d 6f72 6761 6e69 736d  rganism=organism
+00013d90: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00013da0: 2020 2020 2020 2020 2020 206f 7574 6469             outdi
+00013db0: 723d 4e6f 6e65 2c0a 2020 2020 2020 2020  r=None,.        
+00013dc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013dd0: 2063 7574 6f66 663d 302e 3529 0a0a 2020   cutoff=0.5)..  
+00013de0: 2020 2020 2020 2320 6368 616e 6765 2064        # change d
+00013df0: 7479 7065 206f 6620 656e 720a 2020 2020  type of enr.    
+00013e00: 2020 2020 656e 7220 3d20 656e 722e 7265      enr = enr.re
+00013e10: 7375 6c74 732e 6173 7479 7065 287b 2754  sults.astype({'T
+00013e20: 6572 6d27 3a20 2773 7472 696e 6727 7d29  erm': 'string'})
+00013e30: 0a0a 2020 2020 2020 2020 2320 7472 616e  ..        # tran
+00013e40: 7366 6f72 6d20 7468 6520 7076 616c 7565  sform the pvalue
+00013e50: 0a20 2020 2020 2020 2065 6e72 5f64 6174  .        enr_dat
+00013e60: 6120 3d20 656e 722e 736f 7274 5f76 616c  a = enr.sort_val
+00013e70: 7565 7328 2741 646a 7573 7465 6420 502d  ues('Adjusted P-
+00013e80: 7661 6c75 6527 290a 2020 2020 2020 2020  value').        
+00013e90: 656e 725f 6461 7461 5b27 4164 6a75 7374  enr_data['Adjust
+00013ea0: 6564 2050 2d76 616c 7565 275d 203d 202d  ed P-value'] = -
+00013eb0: 206e 702e 6c6f 6731 3028 656e 725f 6461   np.log10(enr_da
+00013ec0: 7461 5b27 4164 6a75 7374 6564 2050 2d76  ta['Adjusted P-v
+00013ed0: 616c 7565 275d 290a 0a20 2020 2020 2020  alue'])..       
+00013ee0: 2023 2063 616c 6375 6c61 746f 7220 7468   # calculator th
+00013ef0: 6520 6f76 6572 6c61 7020 696e 2025 0a20  e overlap in %. 
+00013f00: 2020 2020 2020 206e 756d 6572 6174 6f72         numerator
+00013f10: 203d 205b 666c 6f61 7428 695b 305d 2920   = [float(i[0]) 
+00013f20: 666f 7220 6920 696e 2065 6e72 5f64 6174  for i in enr_dat
+00013f30: 615b 274f 7665 726c 6170 275d 2e73 7472  a['Overlap'].str
+00013f40: 2e73 706c 6974 2827 2f27 295d 0a20 2020  .split('/')].   
+00013f50: 2020 2020 2064 656e 6f6d 696e 6174 6f72       denominator
+00013f60: 203d 205b 666c 6f61 7428 695b 315d 2920   = [float(i[1]) 
+00013f70: 666f 7220 6920 696e 2065 6e72 5f64 6174  for i in enr_dat
+00013f80: 615b 274f 7665 726c 6170 275d 2e73 7472  a['Overlap'].str
+00013f90: 2e73 706c 6974 2827 2f27 295d 0a20 2020  .split('/')].   
+00013fa0: 2020 2020 206f 7665 726c 6170 203d 206e       overlap = n
+00013fb0: 702e 726f 756e 6428 6e70 2e61 7272 6179  p.round(np.array
+00013fc0: 286e 756d 6572 6174 6f72 2920 2f20 6e70  (numerator) / np
+00013fd0: 2e61 7272 6179 2864 656e 6f6d 696e 6174  .array(denominat
+00013fe0: 6f72 2920 2a20 3130 3029 0a20 2020 2020  or) * 100).     
+00013ff0: 2020 2065 6e72 5f64 6174 615b 274f 7665     enr_data['Ove
+00014000: 726c 6170 2069 6e20 2527 5d20 3d20 6f76  rlap in %'] = ov
+00014010: 6572 6c61 700a 0a20 2020 2020 2020 2023  erlap..        #
+00014020: 2070 6172 7469 7469 6f6e 2074 6865 2074   partition the t
+00014030: 6572 6d0a 2020 2020 2020 2020 656e 725f  erm.        enr_
+00014040: 6461 7461 5b27 474f 2074 6572 6d20 4944  data['GO term ID
+00014050: 275d 203d 205b 695b 315d 2e73 706c 6974  '] = [i[1].split
+00014060: 2827 2927 295b 305d 0a20 2020 2020 2020  (')')[0].       
+00014070: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014080: 2020 2020 2020 2020 2020 2066 6f72 2069             for i
+00014090: 2069 6e20 656e 725f 6461 7461 5b27 5465   in enr_data['Te
+000140a0: 726d 275d 2e73 7472 2e73 706c 6974 2827  rm'].str.split('
+000140b0: 2827 295d 0a20 2020 2020 2020 2065 6e72  (')].        enr
+000140c0: 5f64 6174 615b 2747 4f20 7465 726d 2049  _data['GO term I
+000140d0: 4427 5d20 3d20 656e 725f 6461 7461 5b27  D'] = enr_data['
+000140e0: 474f 2074 6572 6d20 4944 275d 2e61 7374  GO term ID'].ast
+000140f0: 7970 6528 2773 7472 696e 6727 290a 2020  ype('string').  
+00014100: 2020 2020 2020 656e 725f 6461 7461 5b27        enr_data['
+00014110: 5465 726d 275d 203d 2065 6e72 5f64 6174  Term'] = enr_dat
+00014120: 615b 2754 6572 6d27 5d2e 7374 722e 7061  a['Term'].str.pa
+00014130: 7274 6974 696f 6e28 2720 2827 295b 305d  rtition(' (')[0]
+00014140: 0a0a 2020 2020 2020 2020 2320 6669 6c74  ..        # filt
+00014150: 6572 2074 6865 2064 6174 6120 6279 2046  er the data by F
+00014160: 4452 0a20 2020 2020 2020 2065 6e72 5f64  DR.        enr_d
+00014170: 6174 6120 3d20 656e 725f 6461 7461 5b65  ata = enr_data[e
+00014180: 6e72 5f64 6174 615b 2741 646a 7573 7465  nr_data['Adjuste
+00014190: 6420 502d 7661 6c75 6527 5d20 3e20 312e  d P-value'] > 1.
+000141a0: 335d 0a20 2020 2020 2020 2065 6e72 5f64  3].        enr_d
+000141b0: 6174 6120 3d20 656e 725f 6461 7461 2e73  ata = enr_data.s
+000141c0: 6f72 745f 7661 6c75 6573 2827 436f 6d62  ort_values('Comb
+000141d0: 696e 6564 2053 636f 7265 272c 2061 7363  ined Score', asc
+000141e0: 656e 6469 6e67 3d46 616c 7365 2920 0a20  ending=False) . 
+000141f0: 2020 2020 2020 200a 2020 2020 2020 2020         .        
+00014200: 6966 2073 656d 6174 6963 5f73 696d 5f66  if sematic_sim_f
+00014210: 696c 7465 7220 6973 2054 7275 653a 0a20  ilter is True:. 
+00014220: 2020 2020 2020 2020 2020 2065 6e72 5f64             enr_d
+00014230: 6174 615f 6669 6c74 203d 2073 656c 662e  ata_filt = self.
+00014240: 6669 6c74 6572 5f67 6f5f 6279 5f6c 696e  filter_go_by_lin
+00014250: 5f73 696d 280a 2020 2020 2020 2020 2020  _sim(.          
+00014260: 2020 2020 2020 5b65 6e72 5f64 6174 615b        [enr_data[
+00014270: 656e 725f 6461 7461 5b27 4765 6e65 5f73  enr_data['Gene_s
+00014280: 6574 275d 203d 3d20 695d 2066 6f72 2069  et'] == i] for i
+00014290: 2069 6e20 7465 726d 5d29 0a20 2020 2020   in term]).     
+000142a0: 2020 2020 2020 2065 6e72 5f64 6174 615f         enr_data_
+000142b0: 6669 6c74 203d 205b 656e 725f 6461 7461  filt = [enr_data
+000142c0: 5f66 696c 745b 656e 725f 6461 7461 5f66  _filt[enr_data_f
+000142d0: 696c 745b 2747 656e 655f 7365 7427 5d20  ilt['Gene_set'] 
+000142e0: 3d3d 2069 5d0a 2020 2020 2020 2020 2020  == i].          
+000142f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014300: 2020 666f 7220 6920 696e 2074 6572 6d5d    for i in term]
+00014310: 0a20 2020 2020 2020 2020 2020 200a 2020  .            .  
+00014320: 2020 2020 2020 2020 2020 666f 7220 6461            for da
+00014330: 7461 2069 6e20 656e 725f 6461 7461 5f66  ta in enr_data_f
+00014340: 696c 743a 0a20 2020 2020 2020 2020 2020  ilt:.           
+00014350: 2020 2020 2064 6174 615b 2769 6e66 6f20       data['info 
+00014360: 636f 6e74 656e 7427 5d20 3d20 5b67 6574  content'] = [get
+00014370: 5f69 6e66 6f5f 636f 6e74 656e 7428 676f  _info_content(go
+00014380: 5f69 642c 2073 656c 662e 7465 726d 636f  _id, self.termco
+00014390: 756e 7473 290a 2020 2020 2020 2020 2020  unts).          
+000143a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000143b0: 2020 2020 2020 2020 2020 2020 2020 666f                fo
+000143c0: 7220 676f 5f69 6420 696e 2064 6174 615b  r go_id in data[
+000143d0: 2747 4f20 7465 726d 2049 4427 5d5d 0a20  'GO term ID']]. 
+000143e0: 2020 2020 2020 2020 2020 2020 2020 2064                 d
+000143f0: 6174 6120 3d20 6461 7461 2e73 6f72 745f  ata = data.sort_
+00014400: 7661 6c75 6573 2827 696e 666f 2063 6f6e  values('info con
+00014410: 7465 6e74 272c 2061 7363 656e 6469 6e67  tent', ascending
+00014420: 3d46 616c 7365 290a 2020 2020 2020 2020  =False).        
+00014430: 2020 2020 0a20 2020 2020 2020 2065 6c73      .        els
+00014440: 653a 0a20 2020 2020 2020 2020 2020 2065  e:.            e
+00014450: 6e72 5f64 6174 615f 6669 6c74 203d 205b  nr_data_filt = [
+00014460: 656e 725f 6461 7461 5b65 6e72 5f64 6174  enr_data[enr_dat
+00014470: 615b 2747 656e 655f 7365 7427 5d20 3d3d  a['Gene_set'] ==
+00014480: 2069 5d20 666f 7220 6920 696e 2074 6572   i] for i in ter
+00014490: 6d5d 0a20 2020 2020 2020 200a 2020 2020  m].        .    
+000144a0: 2020 2020 7365 6c66 2e67 6f5f 6461 7461      self.go_data
+000144b0: 203d 2065 6e72 5f64 6174 615f 6669 6c74   = enr_data_filt
+000144c0: 2e63 6f70 7928 290a 2020 2020 2020 2020  .copy().        
+000144d0: 7265 7475 726e 2065 6e72 5f64 6174 615f  return enr_data_
+000144e0: 6669 6c74 0a20 2020 200a 0a20 2020 2064  filt.    ..    d
+000144f0: 6566 2070 6c6f 745f 6172 7261 795f 656e  ef plot_array_en
+00014500: 7269 6368 6d65 6e74 2873 656c 662c 2067  richment(self, g
+00014510: 6f5f 6461 7461 2c20 6669 6773 697a 652c  o_data, figsize,
+00014520: 2074 6f70 2c0a 2020 2020 2020 2020 2020   top,.          
+00014530: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014540: 2020 2020 7361 7665 6669 673d 4661 6c73      savefig=Fals
+00014550: 6529 3a0a 2020 2020 2020 2020 2222 220a  e):.        """.
+00014560: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
+00014570: 6572 730a 2020 2020 2020 2020 2d2d 2d2d  ers.        ----
+00014580: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2067  ------.        g
+00014590: 6f5f 6461 7461 203a 206c 6973 740a 2020  o_data : list.  
+000145a0: 2020 2020 2020 2020 2020 4c69 7374 206f            List o
+000145b0: 6620 6461 7461 6672 616d 6573 2077 6974  f dataframes wit
+000145c0: 6820 474f 5f42 696f 6c6f 6769 6361 6c5f  h GO_Biological_
+000145d0: 5072 6f63 6573 735f 3230 3231 2c0a 2020  Process_2021,.  
+000145e0: 2020 2020 2020 2020 2020 474f 5f4d 6f6c            GO_Mol
+000145f0: 6563 756c 6172 5f46 756e 6374 696f 6e5f  ecular_Function_
+00014600: 3230 3231 2061 6e64 0a20 2020 2020 2020  2021 and.       
+00014610: 2020 2020 2047 4f5f 4365 6c6c 756c 6172       GO_Cellular
+00014620: 5f43 6f6d 706f 6e65 6e74 5f32 3032 3120  _Component_2021 
+00014630: 656e 7269 6368 6d65 6e74 2064 6174 612e  enrichment data.
+00014640: 0a0a 2020 2020 2020 2020 6669 6773 697a  ..        figsiz
+00014650: 6520 3a20 7475 706c 650a 2020 2020 2020  e : tuple.      
+00014660: 2020 2020 2020 5369 7a65 206f 6620 7468        Size of th
+00014670: 6520 6669 6775 7265 2065 2e67 2028 3130  e figure e.g (10
+00014680: 2c20 3130 290a 2020 2020 2020 2020 0a20  , 10).        . 
+00014690: 2020 2020 2020 2074 6f70 203a 2069 6e74         top : int
+000146a0: 0a20 2020 2020 2020 2020 2020 2074 6f70  .            top
+000146b0: 206e 2074 6572 6d73 2074 6f20 6265 2070   n terms to be p
+000146c0: 6c6f 7474 6564 2062 6173 6564 206f 6e20  lotted based on 
+000146d0: 7468 6520 636f 6d62 696e 6564 2073 636f  the combined sco
+000146e0: 7265 0a0a 2020 2020 2020 2020 7361 7665  re..        save
+000146f0: 6669 6720 3a20 626f 6f6c 6561 6e0a 2020  fig : boolean.  
+00014700: 2020 2020 2020 2020 2020 2049 6620 5472             If Tr
+00014710: 7565 2073 6176 6573 2074 6865 2066 6967  ue saves the fig
+00014720: 7572 6520 2844 6566 6175 6c74 2076 616c  ure (Default val
+00014730: 7565 203d 2046 616c 7365 292e 0a0a 2020  ue = False)...  
+00014740: 2020 2020 2020 5265 7475 726e 730a 2020        Returns.  
+00014750: 2020 2020 2020 2d2d 2d2d 2d2d 2d0a 2020        -------.  
+00014760: 2020 2020 2020 6d61 7470 6c6f 746c 6962        matplotlib
+00014770: 2e70 7970 6c6f 740a 2020 2020 2020 2020  .pyplot.        
+00014780: 2020 2020 506c 6f74 206f 6620 7468 6520      Plot of the 
+00014790: 656e 7269 6368 6d65 6e74 2061 6e61 6c79  enrichment analy
+000147a0: 7369 730a 2020 2020 2020 2020 2222 220a  sis.        """.
+000147b0: 0a20 2020 2020 2020 2074 6974 6c65 7320  .        titles 
+000147c0: 3d20 5b27 474f 5f42 696f 6c6f 6769 6361  = ['GO_Biologica
+000147d0: 6c5f 5072 6f63 6573 7327 2c0a 2020 2020  l_Process',.    
+000147e0: 2020 2020 2020 2020 2020 2020 2020 2747                'G
+000147f0: 4f5f 4d6f 6c65 6375 6c61 725f 4675 6e63  O_Molecular_Func
+00014800: 7469 6f6e 272c 0a20 2020 2020 2020 2020  tion',.         
+00014810: 2020 2020 2020 2020 2027 474f 5f43 656c           'GO_Cel
+00014820: 6c75 6c61 725f 436f 6d70 6f6e 656e 7427  lular_Component'
+00014830: 5d0a 2020 2020 2020 2020 0a20 2020 2020  ].        .     
+00014840: 2020 2066 6967 2c20 6178 203d 2070 6c74     fig, ax = plt
+00014850: 2e73 7562 706c 6f74 7328 312c 2033 2c20  .subplots(1, 3, 
+00014860: 6669 6773 697a 653d 6669 6773 697a 6529  figsize=figsize)
+00014870: 0a20 2020 2020 2020 200a 2020 2020 2020  .        .      
+00014880: 2020 666f 7220 6461 7461 2c20 6178 6573    for data, axes
+00014890: 2c20 7469 746c 6520 696e 207a 6970 2867  , title in zip(g
+000148a0: 6f5f 6461 7461 2c20 6178 2e66 6c61 742c  o_data, ax.flat,
+000148b0: 2074 6974 6c65 7329 3a0a 2020 2020 2020   titles):.      
+000148c0: 2020 2020 2020 6461 7461 5f63 6f70 7920        data_copy 
+000148d0: 3d20 6461 7461 2e63 6f70 7928 290a 2020  = data.copy().  
+000148e0: 2020 2020 2020 2020 2020 6461 7461 5f63            data_c
+000148f0: 6f70 795b 2754 6572 6d27 5d20 3d20 5b74  opy['Term'] = [t
+00014900: 6578 7477 7261 702e 6669 6c6c 2869 2c20  extwrap.fill(i, 
+00014910: 3330 290a 2020 2020 2020 2020 2020 2020  30).            
+00014920: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014930: 2020 2020 2066 6f72 2069 2069 6e20 6461       for i in da
+00014940: 7461 5f63 6f70 795b 2754 6572 6d27 5d5d  ta_copy['Term']]
+00014950: 0a20 2020 2020 2020 2020 2020 200a 2020  .            .  
+00014960: 2020 2020 2020 2020 2020 736e 732e 7363            sns.sc
+00014970: 6174 7465 7270 6c6f 7428 6461 7461 3d64  atterplot(data=d
+00014980: 6174 615f 636f 7079 2e68 6561 6428 746f  ata_copy.head(to
+00014990: 7029 2c0a 2020 2020 2020 2020 2020 2020  p),.            
+000149a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000149b0: 783d 2741 646a 7573 7465 6420 502d 7661  x='Adjusted P-va
+000149c0: 6c75 6527 2c0a 2020 2020 2020 2020 2020  lue',.          
+000149d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000149e0: 2020 793d 2754 6572 6d27 2c0a 2020 2020    y='Term',.    
+000149f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014a00: 2020 2020 2020 2020 7369 7a65 3d27 4f76          size='Ov
+00014a10: 6572 6c61 7020 696e 2025 272c 0a20 2020  erlap in %',.   
+00014a20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014a30: 2020 2020 2020 2020 2068 7565 3d27 436f           hue='Co
+00014a40: 6d62 696e 6564 2053 636f 7265 272c 200a  mbined Score', .
+00014a50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014a60: 2020 2020 2020 2020 2020 2020 7369 7a65              size
+00014a70: 733d 2832 302c 2032 3030 292c 0a20 2020  s=(20, 200),.   
+00014a80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014a90: 2020 2020 2020 2020 2070 616c 6574 7465           palette
+00014aa0: 3d27 7669 7269 6469 735f 7227 2c0a 2020  ='viridis_r',.  
+00014ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014ac0: 2020 2020 2020 2020 2020 6178 3d61 7865            ax=axe
+00014ad0: 7329 0a20 2020 2020 2020 2020 2020 200a  s).            .
+00014ae0: 2020 2020 2020 2020 2020 2020 6178 6573              axes
+00014af0: 2e74 6974 6c65 2e73 6574 5f74 6578 7428  .title.set_text(
+00014b00: 7469 746c 6529 0a20 2020 2020 2020 2020  title).         
+00014b10: 2020 2070 6c74 2e6c 6567 656e 6428 6c6f     plt.legend(lo
+00014b20: 633d 2762 6573 7427 290a 2020 2020 2020  c='best').      
+00014b30: 2020 2020 2020 736e 732e 6465 7370 696e        sns.despin
+00014b40: 6528 290a 2020 2020 2020 2020 6669 672e  e().        fig.
+00014b50: 7469 6768 745f 6c61 796f 7574 2829 0a20  tight_layout(). 
+00014b60: 2020 2020 2020 2020 2020 200a 2020 2020             .    
+00014b70: 2020 2020 6966 2073 6176 6566 6967 2069      if savefig i
+00014b80: 7320 5472 7565 3a0a 2020 2020 2020 2020  s True:.        
+00014b90: 2020 2020 6669 672e 7361 7665 6669 6728      fig.savefig(
+00014ba0: 2770 6c6f 745f 6172 7261 795f 656e 7269  'plot_array_enri
+00014bb0: 6368 6d65 6e74 2e70 6466 272c 2062 626f  chment.pdf', bbo
+00014bc0: 785f 696e 6368 6573 3d27 7469 6768 7427  x_inches='tight'
+00014bd0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00014be0: 2020 2020 2020 2020 2020 7472 616e 7370            transp
+00014bf0: 6172 656e 743d 5472 7565 290a 2020 2020  arent=True).    
+00014c00: 2020 2020 2020 2020 0a20 2020 2064 6566          .    def
+00014c10: 2069 6e74 5f70 6c6f 745f 6172 7261 795f   int_plot_array_
+00014c20: 656e 7269 6368 6d65 6e74 2873 656c 662c  enrichment(self,
+00014c30: 2067 6f5f 6461 7461 2c20 6865 6967 6874   go_data, height
+00014c40: 3d37 3030 2c20 7769 6474 683d 3135 3030  =700, width=1500
+00014c50: 2c20 746f 703d 3130 3029 3a0a 0a20 2020  , top=100):..   
+00014c60: 2020 2020 206e 5f63 6f6c 7320 3d20 330a       n_cols = 3.
+00014c70: 2020 2020 2020 2020 7469 746c 6573 203d          titles =
+00014c80: 205b 2742 696f 6c6f 6769 6361 6c20 5072   ['Biological Pr
+00014c90: 6f63 6573 7327 2c20 2743 656c 6c75 6c61  ocess', 'Cellula
+00014ca0: 7220 436f 6d70 6f6e 656e 7427 2c20 274d  r Component', 'M
+00014cb0: 6f6c 6563 756c 6172 2046 756e 6374 696f  olecular Functio
+00014cc0: 6e27 5d0a 2020 2020 2020 2020 6669 6720  n'].        fig 
+00014cd0: 3d20 6d61 6b65 5f73 7562 706c 6f74 7328  = make_subplots(
+00014ce0: 312c 2033 2c20 686f 7269 7a6f 6e74 616c  1, 3, horizontal
+00014cf0: 5f73 7061 6369 6e67 203d 2030 2e32 2c20  _spacing = 0.2, 
+00014d00: 7375 6270 6c6f 745f 7469 746c 6573 3d74  subplot_titles=t
+00014d10: 6974 6c65 7329 0a0a 2020 2020 2020 2020  itles)..        
+00014d20: 636d 696e 203d 206e 702e 6d69 6e28 7064  cmin = np.min(pd
+00014d30: 2e63 6f6e 6361 7428 676f 5f64 6174 6129  .concat(go_data)
+00014d40: 5b27 436f 6d62 696e 6564 2053 636f 7265  ['Combined Score
+00014d50: 275d 290a 2020 2020 2020 2020 636d 6178  ']).        cmax
+00014d60: 203d 206e 702e 6d61 7828 7064 2e63 6f6e   = np.max(pd.con
+00014d70: 6361 7428 676f 5f64 6174 6129 5b27 436f  cat(go_data)['Co
+00014d80: 6d62 696e 6564 2053 636f 7265 275d 290a  mbined Score']).
+00014d90: 0a20 2020 2020 2020 2066 6f72 2069 2c20  .        for i, 
+00014da0: 6461 7461 2069 6e20 656e 756d 6572 6174  data in enumerat
+00014db0: 6528 676f 5f64 6174 612c 2073 7461 7274  e(go_data, start
+00014dc0: 3d31 293a 0a20 2020 2020 2020 2020 2020  =1):.           
+00014dd0: 200a 2020 2020 2020 2020 2020 2020 6461   .            da
+00014de0: 7461 203d 2064 6174 612e 696c 6f63 5b3a  ta = data.iloc[:
+00014df0: 746f 705d 2e63 6f70 7928 290a 0a20 2020  top].copy()..   
+00014e00: 2020 2020 2020 2020 2023 2043 616c 6375           # Calcu
+00014e10: 6c61 7465 2072 6f77 2061 6e64 2063 6f6c  late row and col
+00014e20: 2076 616c 7565 7320 666f 7220 7468 6520   values for the 
+00014e30: 7375 6270 6c6f 7473 2062 6173 6564 206f  subplots based o
+00014e40: 6e20 690a 2020 2020 2020 2020 2020 2020  n i.            
+00014e50: 726f 7720 3d20 2869 202d 2031 2920 2f2f  row = (i - 1) //
+00014e60: 206e 5f63 6f6c 7320 2b20 310a 2020 2020   n_cols + 1.    
+00014e70: 2020 2020 2020 2020 636f 6c20 3d20 2869          col = (i
+00014e80: 202d 2031 2920 2520 6e5f 636f 6c73 202b   - 1) % n_cols +
+00014e90: 2031 0a0a 2020 2020 2020 2020 2020 2020   1..            
+00014ea0: 2320 4164 6420 7468 6520 7363 6174 7465  # Add the scatte
+00014eb0: 7220 706c 6f74 7320 746f 2074 6865 2073  r plots to the s
+00014ec0: 7562 706c 6f74 7320 6c61 796f 7574 0a20  ubplots layout. 
+00014ed0: 2020 2020 2020 2020 2020 2066 6967 2e61             fig.a
+00014ee0: 6464 5f74 7261 6365 2867 6f2e 5363 6174  dd_trace(go.Scat
+00014ef0: 7465 7228 783d 6461 7461 5b27 4164 6a75  ter(x=data['Adju
+00014f00: 7374 6564 2050 2d76 616c 7565 275d 2c0a  sted P-value'],.
+00014f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00014f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014f30: 2020 2020 2020 2020 2020 2020 7469 636b              tick
-00014f40: 7465 7874 3d5b 666f 726d 6174 5f79 7469  text=[format_yti
-00014f50: 636b 5f6c 6162 656c 2874 6963 6b29 2066  ck_label(tick) f
-00014f60: 6f72 2074 6963 6b20 696e 2064 6174 615b  or tick in data[
-00014f70: 2754 6572 6d27 5d5d 2c0a 2020 2020 2020  'Term']],.      
+00014f30: 2020 2020 793d 6461 7461 5b27 5465 726d      y=data['Term
+00014f40: 275d 2c0a 2020 2020 2020 2020 2020 2020  '],.            
+00014f50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014f60: 2020 2020 2020 2020 6d6f 6465 3d27 6d61          mode='ma
+00014f70: 726b 6572 7327 2c0a 2020 2020 2020 2020  rkers',.        
 00014f80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014f90: 2020 2020 2020 726f 773d 726f 772c 2063        row=row, c
-00014fa0: 6f6c 3d63 6f6c 290a 0a20 2020 2020 2020  ol=col)..       
-00014fb0: 2023 2055 7064 6174 6520 7468 6520 6c61   # Update the la
-00014fc0: 796f 7574 2061 6e64 2074 7261 6365 730a  yout and traces.
-00014fd0: 2020 2020 2020 2020 6669 672e 7570 6461          fig.upda
-00014fe0: 7465 5f6c 6179 6f75 7428 7465 6d70 6c61  te_layout(templa
-00014ff0: 7465 3d27 7369 6d70 6c65 5f77 6869 7465  te='simple_white
-00015000: 272c 0a20 2020 2020 2020 2020 2020 2020  ',.             
-00015010: 2020 2020 2020 2020 2020 2068 6569 6768             heigh
-00015020: 743d 6865 6967 6874 2c0a 2020 2020 2020  t=height,.      
+00014f90: 2020 2020 2020 2020 2020 2020 6d61 726b              mark
+00014fa0: 6572 3d64 6963 7428 7369 7a65 3d64 6174  er=dict(size=dat
+00014fb0: 615b 274f 7665 726c 6170 2069 6e20 2527  a['Overlap in %'
+00014fc0: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
+00014fd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014fe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014ff0: 2020 2063 6f6c 6f72 3d64 6174 615b 2743     color=data['C
+00015000: 6f6d 6269 6e65 6420 5363 6f72 6527 5d2c  ombined Score'],
+00015010: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00015020: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00015030: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015040: 2020 7769 6474 683d 7769 6474 682c 0a20    width=width,. 
-00015050: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015060: 2020 2020 2020 2068 6f76 6572 6c61 6265         hoverlabe
-00015070: 6c3d 6469 6374 2862 6763 6f6c 6f72 3d22  l=dict(bgcolor="
-00015080: 7768 6974 6522 2c0a 2020 2020 2020 2020  white",.        
-00015090: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015040: 2063 6f6c 6f72 7363 616c 653d 2756 6972   colorscale='Vir
+00015050: 6964 6973 272c 200a 2020 2020 2020 2020  idis', .        
+00015060: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015070: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015080: 2020 2020 2020 2020 7368 6f77 7363 616c          showscal
+00015090: 653d 5472 7565 2c20 200a 2020 2020 2020  e=True,  .      
 000150a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000150b0: 666f 6e74 5f73 697a 653d 3136 2929 0a20  font_size=16)). 
-000150c0: 2020 2020 2020 2023 2053 686f 7720 7468         # Show th
-000150d0: 6520 706c 6f74 0a20 2020 2020 2020 2069  e plot.        i
-000150e0: 6620 6973 5f6a 7570 7974 6572 5f6e 6f74  f is_jupyter_not
-000150f0: 6562 6f6f 6b28 293a 0a20 2020 2020 2020  ebook():.       
-00015100: 2020 2020 2066 6967 2e73 686f 7728 290a       fig.show().
-00015110: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-00015120: 2020 2020 2020 2020 2020 7374 2e70 6c6f            st.plo
-00015130: 746c 795f 6368 6172 7428 6669 672c 2075  tly_chart(fig, u
-00015140: 7365 5f63 6f6e 7461 696e 6572 5f77 6964  se_container_wid
-00015150: 7468 3d54 7275 6529 0a0a 2020 2020 6465  th=True)..    de
-00015160: 6620 6172 7261 795f 656e 7269 6368 6d65  f array_enrichme
-00015170: 6e74 5f61 6e61 6c79 7369 735f 706c 6f74  nt_analysis_plot
-00015180: 2873 656c 662c 2067 656e 655f 6c69 7374  (self, gene_list
-00015190: 2c20 6f72 6761 6e69 736d 2c20 6669 6773  , organism, figs
-000151a0: 697a 652c 2074 6f70 2c0a 2020 2020 2020  ize, top,.      
+000150b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000150c0: 2020 2020 2020 2020 2020 636d 696e 3d63            cmin=c
+000150d0: 6d69 6e2c 2020 0a20 2020 2020 2020 2020  min,  .         
+000150e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000150f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015100: 2020 2020 2020 2063 6d61 783d 636d 6178         cmax=cmax
+00015110: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
+00015120: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015130: 2020 2020 2020 2074 6578 743d 6461 7461         text=data
+00015140: 5b27 4765 6e65 7327 5d2c 0a20 2020 2020  ['Genes'],.     
+00015150: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015160: 2020 2020 2020 2020 2020 2020 2020 2068                 h
+00015170: 6f76 6572 7465 6d70 6c61 7465 203d 2022  overtemplate = "
+00015180: 4f76 6572 6c61 7020 696e 2025 3a20 257b  Overlap in %: %{
+00015190: 6d61 726b 6572 2e73 697a 657d 3c62 723e  marker.size}<br>
+000151a0: 2220 2b0a 2020 2020 2020 2020 2020 2020  " +.            
 000151b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000151c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000151d0: 2073 6176 6566 6967 3d46 616c 7365 293a   savefig=False):
-000151e0: 0a0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
-000151f0: 2020 2020 2020 5065 7266 6f72 6d20 656e        Perform en
-00015200: 7269 6368 6d65 6e74 2061 6e61 6c79 7369  richment analysi
-00015210: 7320 616e 6420 706c 6f74 0a20 2020 2020  s and plot.     
-00015220: 2020 2042 696f 6c6f 6769 6361 6c20 5072     Biological Pr
-00015230: 6f63 6573 732c 204d 6f6c 6563 756c 6172  ocess, Molecular
-00015240: 2046 756e 6374 696f 6e0a 2020 2020 2020   Function.      
-00015250: 2020 616e 6420 4365 6c6c 756c 6172 2063    and Cellular c
-00015260: 6f6d 7061 7274 6d65 6e74 0a0a 2020 2020  ompartment..    
-00015270: 2020 2020 5061 7261 6d65 7465 7273 0a20      Parameters. 
-00015280: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
-00015290: 2d0a 2020 2020 2020 2020 6765 6e65 5f6c  -.        gene_l
-000152a0: 6973 7420 3a20 6c69 7374 0a20 2020 2020  ist : list.     
-000152b0: 2020 2020 2020 2041 206c 6973 7420 6f66         A list of
-000152c0: 2067 656e 6573 2074 6f20 6265 2075 7365   genes to be use
-000152d0: 6420 666f 7220 656e 7269 6368 6d65 6e74  d for enrichment
-000152e0: 2061 6e61 6c79 7369 730a 2020 2020 2020   analysis.      
-000152f0: 2020 2020 2020 0a20 2020 2020 2020 206f        .        o
-00015300: 7267 616e 6973 6d20 3a20 7374 720a 2020  rganism : str.  
-00015310: 2020 2020 2020 2020 2020 4f72 6761 6e69            Organi
-00015320: 736d 2074 6f20 6265 2075 7365 6420 746f  sm to be used to
-00015330: 2064 6f20 656e 7269 6368 6d65 6e74 2061   do enrichment a
-00015340: 6e61 6c79 7369 732e 2065 2e67 2027 6875  nalysis. e.g 'hu
-00015350: 6d61 6e27 206f 7220 276d 6f75 7365 270a  man' or 'mouse'.
-00015360: 0a20 2020 2020 2020 2066 6967 7369 7a65  .        figsize
-00015370: 203a 2074 7570 6c65 0a20 2020 2020 2020   : tuple.       
-00015380: 2020 2020 2046 6967 7572 6520 7369 7a65       Figure size
-00015390: 2065 2e67 2028 3130 2c20 3130 290a 2020   e.g (10, 10).  
-000153a0: 2020 2020 2020 0a20 2020 2020 2020 2074        .        t
-000153b0: 6f70 203a 2069 6e74 0a20 2020 2020 2020  op : int.       
-000153c0: 2020 2020 2054 6f70 206e 2074 6572 6d73       Top n terms
-000153d0: 2074 6f20 6265 2070 6c6f 7474 6564 2062   to be plotted b
-000153e0: 6173 6564 206f 6e20 7468 6520 636f 6d62  ased on the comb
-000153f0: 696e 6564 2073 636f 7265 0a0a 2020 2020  ined score..    
-00015400: 2020 2020 7361 7665 6669 6720 3a20 626f      savefig : bo
-00015410: 6f6c 6561 6e0a 2020 2020 2020 2020 2020  olean.          
-00015420: 2020 2049 6620 5472 7565 2073 6176 6520     If True save 
-00015430: 6669 6775 7265 2028 4465 6661 756c 7420  figure (Default 
-00015440: 7661 6c75 6520 3d20 4661 6c73 6529 0a0a  value = False)..
-00015450: 2020 2020 2020 2020 5265 7475 726e 730a          Returns.
-00015460: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d0a          -------.
-00015470: 2020 2020 2020 2020 6d61 7470 6c6f 746c          matplotl
-00015480: 6962 2e70 7970 6c6f 740a 2020 2020 2020  ib.pyplot.      
-00015490: 2020 2222 220a 2020 2020 2020 2020 2320    """.        # 
-000154a0: 656e 7269 6368 6d65 6e74 0a20 2020 2020  enrichment.     
-000154b0: 2020 2067 6f5f 6461 7461 203d 2073 656c     go_data = sel
-000154c0: 662e 6172 7261 795f 656e 7269 6368 6d65  f.array_enrichme
-000154d0: 6e74 5f61 6e61 6c79 7369 7328 6765 6e65  nt_analysis(gene
-000154e0: 5f6c 6973 743d 6765 6e65 5f6c 6973 742c  _list=gene_list,
-000154f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00015500: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015510: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015520: 2020 6f72 6761 6e69 736d 3d6f 7267 616e    organism=organ
-00015530: 6973 6d29 0a20 2020 2020 2020 200a 2020  ism).        .  
-00015540: 2020 2020 2020 7365 6c66 2e70 6c6f 745f        self.plot_
-00015550: 6172 7261 795f 656e 7269 6368 6d65 6e74  array_enrichment
-00015560: 2867 6f5f 6461 7461 3d67 6f5f 6461 7461  (go_data=go_data
-00015570: 2c20 0a20 2020 2020 2020 2020 2020 2020  , .             
-00015580: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015590: 2020 2020 2020 6669 6773 697a 653d 6669        figsize=fi
-000155a0: 6773 697a 652c 2074 6f70 3d74 6f70 2c0a  gsize, top=top,.
+000151d0: 2020 2020 2020 2020 2247 656e 6573 3a20          "Genes: 
+000151e0: 257b 7465 7874 7d3c 6272 3e22 292c 0a20  %{text}<br>"),. 
+000151f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015200: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015210: 2020 2020 2020 2072 6f77 3d72 6f77 2c0a         row=row,.
+00015220: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015230: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015240: 2020 2020 2020 2020 636f 6c3d 636f 6c29          col=col)
+00015250: 0a0a 2020 2020 2020 2020 2020 2020 6669  ..            fi
+00015260: 672e 7570 6461 7465 5f78 6178 6573 2874  g.update_xaxes(t
+00015270: 6974 6c65 5f74 6578 743d 2741 646a 7573  itle_text='Adjus
+00015280: 7465 6420 502d 7661 6c75 6527 290a 2020  ted P-value').  
+00015290: 2020 2020 2020 2020 2020 6669 672e 7570            fig.up
+000152a0: 6461 7465 5f79 6178 6573 2874 6974 6c65  date_yaxes(title
+000152b0: 5f74 6578 743d 2754 6572 6d27 2c20 0a20  _text='Term', . 
+000152c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000152d0: 2020 2020 2020 2020 2020 2074 6963 6b6d             tickm
+000152e0: 6f64 653d 2761 7272 6179 272c 0a20 2020  ode='array',.   
+000152f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015300: 2020 2020 2020 2020 2074 6963 6b76 616c           tickval
+00015310: 733d 6461 7461 5b27 5465 726d 275d 2c0a  s=data['Term'],.
+00015320: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015330: 2020 2020 2020 2020 2020 2020 7469 636b              tick
+00015340: 7465 7874 3d5b 666f 726d 6174 5f79 7469  text=[format_yti
+00015350: 636b 5f6c 6162 656c 2874 6963 6b29 2066  ck_label(tick) f
+00015360: 6f72 2074 6963 6b20 696e 2064 6174 615b  or tick in data[
+00015370: 2754 6572 6d27 5d5d 2c0a 2020 2020 2020  'Term']],.      
+00015380: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015390: 2020 2020 2020 726f 773d 726f 772c 2063        row=row, c
+000153a0: 6f6c 3d63 6f6c 290a 0a20 2020 2020 2020  ol=col)..       
+000153b0: 2023 2055 7064 6174 6520 7468 6520 6c61   # Update the la
+000153c0: 796f 7574 2061 6e64 2074 7261 6365 730a  yout and traces.
+000153d0: 2020 2020 2020 2020 6669 672e 7570 6461          fig.upda
+000153e0: 7465 5f6c 6179 6f75 7428 7465 6d70 6c61  te_layout(templa
+000153f0: 7465 3d27 7369 6d70 6c65 5f77 6869 7465  te='simple_white
+00015400: 272c 0a20 2020 2020 2020 2020 2020 2020  ',.             
+00015410: 2020 2020 2020 2020 2020 2068 6569 6768             heigh
+00015420: 743d 6865 6967 6874 2c0a 2020 2020 2020  t=height,.      
+00015430: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015440: 2020 7769 6474 683d 7769 6474 682c 0a20    width=width,. 
+00015450: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015460: 2020 2020 2020 2068 6f76 6572 6c61 6265         hoverlabe
+00015470: 6c3d 6469 6374 2862 6763 6f6c 6f72 3d22  l=dict(bgcolor="
+00015480: 7768 6974 6522 2c0a 2020 2020 2020 2020  white",.        
+00015490: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000154a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000154b0: 666f 6e74 5f73 697a 653d 3136 2929 0a20  font_size=16)). 
+000154c0: 2020 2020 2020 2023 2053 686f 7720 7468         # Show th
+000154d0: 6520 706c 6f74 0a20 2020 2020 2020 2069  e plot.        i
+000154e0: 6620 6973 5f6a 7570 7974 6572 5f6e 6f74  f is_jupyter_not
+000154f0: 6562 6f6f 6b28 293a 0a20 2020 2020 2020  ebook():.       
+00015500: 2020 2020 2066 6967 2e73 686f 7728 290a       fig.show().
+00015510: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+00015520: 2020 2020 2020 2020 2020 7374 2e70 6c6f            st.plo
+00015530: 746c 795f 6368 6172 7428 6669 672c 2075  tly_chart(fig, u
+00015540: 7365 5f63 6f6e 7461 696e 6572 5f77 6964  se_container_wid
+00015550: 7468 3d54 7275 6529 0a0a 2020 2020 6465  th=True)..    de
+00015560: 6620 6172 7261 795f 656e 7269 6368 6d65  f array_enrichme
+00015570: 6e74 5f61 6e61 6c79 7369 735f 706c 6f74  nt_analysis_plot
+00015580: 2873 656c 662c 2067 656e 655f 6c69 7374  (self, gene_list
+00015590: 2c20 6f72 6761 6e69 736d 2c20 6669 6773  , organism, figs
+000155a0: 697a 652c 2074 6f70 2c0a 2020 2020 2020  ize, top,.      
 000155b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000155c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000155d0: 2020 2073 6176 6566 6967 3d73 6176 6566     savefig=savef
-000155e0: 6967 290a 2020 2020 2020 2020 7265 7475  ig).        retu
-000155f0: 726e 2067 6f5f 6461 7461 0a20 2020 200a  rn go_data.    .
-00015600: 2020 2020 6465 6620 6172 7261 795f 656e      def array_en
-00015610: 7269 6368 6d65 6e74 5f61 6e61 6c79 7369  richment_analysi
-00015620: 735f 696e 745f 706c 6f74 2873 656c 662c  s_int_plot(self,
-00015630: 2067 656e 655f 6c69 7374 2c20 6f72 6761   gene_list, orga
-00015640: 6e69 736d 2c20 6865 6967 6874 3d37 3030  nism, height=700
-00015650: 2c20 7769 6474 683d 3135 3030 2c20 746f  , width=1500, to
-00015660: 703d 3130 293a 0a0a 2020 2020 2020 2020  p=10):..        
-00015670: 2023 2065 6e72 6963 686d 656e 740a 2020   # enrichment.  
-00015680: 2020 2020 2020 676f 5f64 6174 6120 3d20        go_data = 
-00015690: 7365 6c66 2e61 7272 6179 5f65 6e72 6963  self.array_enric
-000156a0: 686d 656e 745f 616e 616c 7973 6973 2867  hment_analysis(g
-000156b0: 656e 655f 6c69 7374 3d67 656e 655f 6c69  ene_list=gene_li
-000156c0: 7374 2c0a 2020 2020 2020 2020 2020 2020  st,.            
-000156d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000156e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000156f0: 2020 2020 206f 7267 616e 6973 6d3d 6f72       organism=or
-00015700: 6761 6e69 736d 290a 2020 2020 2020 2020  ganism).        
-00015710: 0a20 2020 2020 2020 2073 656c 662e 696e  .        self.in
-00015720: 745f 706c 6f74 5f61 7272 6179 5f65 6e72  t_plot_array_enr
-00015730: 6963 686d 656e 7428 676f 5f64 6174 613d  ichment(go_data=
-00015740: 676f 5f64 6174 612c 2068 6569 6768 743d  go_data, height=
-00015750: 6865 6967 6874 2c20 7769 6474 683d 7769  height, width=wi
-00015760: 6474 682c 2074 6f70 3d74 6f70 290a 2020  dth, top=top).  
-00015770: 2020 2020 2020 0a20 2020 2020 2020 2072        .        r
-00015780: 6574 7572 6e20 676f 5f64 6174 610a 2020  eturn go_data.  
-00015790: 2020 0a20 2020 2064 6566 2067 6f5f 656e    .    def go_en
-000157a0: 7269 6368 6572 2873 656c 662c 2075 705f  richer(self, up_
-000157b0: 6765 6e65 5f6c 6973 742c 2064 6f77 6e5f  gene_list, down_
-000157c0: 6765 6e65 5f6c 6973 742c 206f 7267 616e  gene_list, organ
-000157d0: 6973 6d2c 2067 6f5f 7465 726d 3d30 293a  ism, go_term=0):
-000157e0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-000157f0: 2020 2020 2050 6572 666f 726d 2047 4f20       Perform GO 
-00015800: 7465 726d 2065 6e72 6963 686d 656e 7420  term enrichment 
-00015810: 616e 616c 7973 6973 0a0a 2020 2020 2020  analysis..      
-00015820: 2020 5061 7261 6d65 7465 7273 0a20 2020    Parameters.   
-00015830: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a       ----------.
-00015840: 2020 2020 2020 2020 7570 5f67 656e 655f          up_gene_
-00015850: 6c69 7374 203a 206c 6973 740a 2020 2020  list : list.    
-00015860: 2020 2020 2020 2020 4c69 7374 206f 6620          List of 
-00015870: 7570 7265 6775 6c61 7465 6420 6765 6e65  upregulated gene
-00015880: 730a 0a20 2020 2020 2020 2064 6f77 6e5f  s..        down_
-00015890: 6765 6e65 5f6c 6973 7420 3a20 6c69 7374  gene_list : list
-000158a0: 0a20 2020 2020 2020 2020 2020 204c 6973  .            Lis
-000158b0: 7420 6f66 2064 6f77 6e72 6567 756c 6174  t of downregulat
-000158c0: 6564 2067 656e 6573 0a20 2020 2020 2020  ed genes.       
-000158d0: 2020 2020 200a 2020 2020 2020 2020 6f72       .        or
-000158e0: 6761 6e69 736d 203a 2073 7472 0a20 2020  ganism : str.   
-000158f0: 2020 2020 2020 2020 204f 7267 616e 6973           Organis
-00015900: 6d20 746f 2062 6520 7573 6564 2074 6f20  m to be used to 
-00015910: 646f 2065 6e72 6963 686d 656e 7420 616e  do enrichment an
-00015920: 616c 7973 6973 2e20 652e 6720 2768 756d  alysis. e.g 'hum
-00015930: 616e 2720 6f72 2027 6d6f 7573 6527 0a0a  an' or 'mouse'..
-00015940: 2020 2020 2020 2020 676f 5f74 6572 6d20          go_term 
-00015950: 3a20 696e 740a 2020 2020 2020 2020 2020  : int.          
-00015960: 2020 2030 2072 6570 7265 7365 6e74 7320     0 represents 
-00015970: 4269 6f6c 6f67 6963 616c 2070 726f 6365  Biological proce
-00015980: 7373 2c0a 2020 2020 2020 2020 2020 2020  ss,.            
-00015990: 2031 2072 6570 7265 7365 6e74 7320 4d6f   1 represents Mo
-000159a0: 6c65 6375 6c61 7220 6675 6e63 7469 6f6e  lecular function
-000159b0: 2061 6e64 0a20 2020 2020 2020 2020 2020   and.           
-000159c0: 2020 3220 7265 7072 6573 656e 7473 2063    2 represents c
-000159d0: 656c 6c75 6c61 7220 636f 6d70 6f6e 656e  ellular componen
-000159e0: 740a 2020 2020 2020 2020 2020 2020 2028  t.             (
-000159f0: 4465 6661 756c 7420 7661 6c75 6520 3d20  Default value = 
-00015a00: 3029 0a0a 2020 2020 2020 2020 5265 7475  0)..        Retu
-00015a10: 726e 730a 2020 2020 2020 2020 2d2d 2d2d  rns.        ----
-00015a20: 2d2d 2d0a 2020 2020 2020 2020 676f 5f64  ---.        go_d
-00015a30: 6174 6173 6574 7320 3a20 6c69 7374 0a20  atasets : list. 
-00015a40: 2020 2020 2020 2020 2020 204c 6973 7420             List 
-00015a50: 6f66 2064 6174 6166 7261 6d65 7320 7769  of dataframes wi
-00015a60: 7468 2047 4f5f 4269 6f6c 6f67 6963 616c  th GO_Biological
-00015a70: 5f50 726f 6365 7373 5f32 3032 312c 0a20  _Process_2021,. 
-00015a80: 2020 2020 2020 2020 2020 2047 4f5f 4d6f             GO_Mo
-00015a90: 6c65 6375 6c61 725f 4675 6e63 7469 6f6e  lecular_Function
-00015aa0: 5f32 3032 3120 616e 640a 2020 2020 2020  _2021 and.      
-00015ab0: 2020 2020 2020 474f 5f43 656c 6c75 6c61        GO_Cellula
-00015ac0: 725f 436f 6d70 6f6e 656e 745f 3230 3231  r_Component_2021
-00015ad0: 2065 6e72 6963 686d 656e 7420 6461 7461   enrichment data
-00015ae0: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
-00015af0: 2020 0a20 2020 2020 2020 2067 6f5f 6461    .        go_da
-00015b00: 7461 7365 7473 203d 205b 5d0a 2020 2020  tasets = [].    
-00015b10: 2020 2020 0a20 2020 2020 2020 2066 6f72      .        for
-00015b20: 2067 656e 655f 6c69 7374 2069 6e20 5b75   gene_list in [u
-00015b30: 705f 6765 6e65 5f6c 6973 742c 2064 6f77  p_gene_list, dow
-00015b40: 6e5f 6765 6e65 5f6c 6973 745d 3a0a 2020  n_gene_list]:.  
-00015b50: 2020 2020 2020 0a20 2020 2020 2020 2020        .         
-00015b60: 2020 2022 2222 2050 6572 666f 726d 2047     """ Perform G
-00015b70: 4f20 7465 726d 2065 6e72 6963 686d 656e  O term enrichmen
-00015b80: 7420 2222 220a 2020 2020 2020 2020 2020  t """.          
-00015b90: 2020 7465 726d 203d 205b 2747 4f5f 4269    term = ['GO_Bi
-00015ba0: 6f6c 6f67 6963 616c 5f50 726f 6365 7373  ological_Process
-00015bb0: 5f32 3032 3127 2c0a 2020 2020 2020 2020  _2021',.        
-00015bc0: 2020 2020 2020 2020 2020 2020 2747 4f5f              'GO_
-00015bd0: 4d6f 6c65 6375 6c61 725f 4675 6e63 7469  Molecular_Functi
-00015be0: 6f6e 5f32 3032 3127 2c0a 2020 2020 2020  on_2021',.      
-00015bf0: 2020 2020 2020 2020 2020 2020 2020 2747                'G
-00015c00: 4f5f 4365 6c6c 756c 6172 5f43 6f6d 706f  O_Cellular_Compo
-00015c10: 6e65 6e74 5f32 3032 3127 5d5b 676f 5f74  nent_2021'][go_t
-00015c20: 6572 6d5d 0a20 2020 2020 2020 2020 2020  erm].           
-00015c30: 2065 6e72 203d 2067 702e 656e 7269 6368   enr = gp.enrich
-00015c40: 7228 6765 6e65 5f6c 6973 743d 6765 6e65  r(gene_list=gene
-00015c50: 5f6c 6973 742c 0a20 2020 2020 2020 2020  _list,.         
-00015c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015c70: 2020 2020 6765 6e65 5f73 6574 733d 7465      gene_sets=te
-00015c80: 726d 2c0a 2020 2020 2020 2020 2020 2020  rm,.            
-00015c90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015ca0: 206f 7267 616e 6973 6d3d 6f72 6761 6e69   organism=organi
-00015cb0: 736d 2c20 0a20 2020 2020 2020 2020 2020  sm, .           
-00015cc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015cd0: 2020 6f75 7464 6972 3d4e 6f6e 652c 0a20    outdir=None,. 
-00015ce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015cf0: 2020 2020 2020 2020 2020 2020 6375 746f              cuto
-00015d00: 6666 3d30 2e35 290a 0a20 2020 2020 2020  ff=0.5)..       
-00015d10: 2020 2020 2023 2063 6861 6e67 6520 6474       # change dt
-00015d20: 7970 6520 6f66 2065 6e72 0a20 2020 2020  ype of enr.     
-00015d30: 2020 2020 2020 2065 6e72 203d 2065 6e72         enr = enr
-00015d40: 2e72 6573 756c 7473 2e61 7374 7970 6528  .results.astype(
-00015d50: 7b27 5465 726d 273a 2027 7374 7269 6e67  {'Term': 'string
-00015d60: 277d 290a 0a20 2020 2020 2020 2020 2020  '})..           
-00015d70: 2023 2074 7261 6e73 666f 726d 2074 6865   # transform the
-00015d80: 2070 7661 6c75 650a 2020 2020 2020 2020   pvalue.        
-00015d90: 2020 2020 656e 725f 6461 7461 203d 2065      enr_data = e
-00015da0: 6e72 2e73 6f72 745f 7661 6c75 6573 2827  nr.sort_values('
-00015db0: 4164 6a75 7374 6564 2050 2d76 616c 7565  Adjusted P-value
-00015dc0: 2729 0a20 2020 2020 2020 2020 2020 2065  ').            e
-00015dd0: 6e72 5f64 6174 615b 2741 646a 7573 7465  nr_data['Adjuste
-00015de0: 6420 502d 7661 6c75 6527 5d20 3d20 2d20  d P-value'] = - 
-00015df0: 6e70 2e6c 6f67 3130 280a 2020 2020 2020  np.log10(.      
-00015e00: 2020 2020 2020 2020 2020 656e 725f 6461            enr_da
-00015e10: 7461 5b27 4164 6a75 7374 6564 2050 2d76  ta['Adjusted P-v
-00015e20: 616c 7565 275d 290a 0a20 2020 2020 2020  alue'])..       
-00015e30: 2020 2020 2023 2063 616c 6375 6c61 746f       # calculato
-00015e40: 7220 7468 6520 6f76 6572 6c61 7020 696e  r the overlap in
-00015e50: 2025 0a20 2020 2020 2020 2020 2020 206e   %.            n
-00015e60: 756d 6572 6174 6f72 203d 205b 666c 6f61  umerator = [floa
-00015e70: 7428 695b 305d 290a 2020 2020 2020 2020  t(i[0]).        
-00015e80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015e90: 2066 6f72 2069 2069 6e20 656e 725f 6461   for i in enr_da
-00015ea0: 7461 5b27 4f76 6572 6c61 7027 5d2e 7374  ta['Overlap'].st
-00015eb0: 722e 7370 6c69 7428 272f 2729 5d0a 2020  r.split('/')].  
-00015ec0: 2020 2020 2020 2020 2020 6465 6e6f 6d69            denomi
-00015ed0: 6e61 746f 7220 3d20 5b66 6c6f 6174 2869  nator = [float(i
-00015ee0: 5b31 5d29 0a20 2020 2020 2020 2020 2020  [1]).           
-00015ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015f00: 666f 7220 6920 696e 2065 6e72 5f64 6174  for i in enr_dat
-00015f10: 615b 274f 7665 726c 6170 275d 2e73 7472  a['Overlap'].str
-00015f20: 2e73 706c 6974 2827 2f27 295d 0a20 2020  .split('/')].   
-00015f30: 2020 2020 2020 2020 206f 7665 726c 6170           overlap
-00015f40: 203d 206e 702e 726f 756e 6428 6e70 2e61   = np.round(np.a
-00015f50: 7272 6179 286e 756d 6572 6174 6f72 2920  rray(numerator) 
-00015f60: 2f20 0a20 2020 2020 2020 2020 2020 2020  / .             
-00015f70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015f80: 2020 6e70 2e61 7272 6179 2864 656e 6f6d    np.array(denom
-00015f90: 696e 6174 6f72 2920 2a20 3130 3029 0a20  inator) * 100). 
-00015fa0: 2020 2020 2020 2020 2020 2065 6e72 5f64             enr_d
-00015fb0: 6174 615b 274f 7665 726c 6170 2069 6e20  ata['Overlap in 
-00015fc0: 2527 5d20 3d20 6f76 6572 6c61 700a 0a20  %'] = overlap.. 
-00015fd0: 2020 2020 2020 2020 2020 2023 2070 6172             # par
-00015fe0: 7469 7469 6f6e 2074 6865 2074 6572 6d20  tition the term 
-00015ff0: 0a20 2020 2020 2020 2020 2020 2065 6e72  .            enr
-00016000: 5f64 6174 615b 2747 4f20 7465 726d 2049  _data['GO term I
-00016010: 4427 5d20 3d20 5b69 5b31 5d2e 7370 6c69  D'] = [i[1].spli
-00016020: 7428 2729 2729 5b30 5d0a 2020 2020 2020  t(')')[0].      
-00016030: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016040: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016050: 666f 7220 6920 696e 2065 6e72 5f64 6174  for i in enr_dat
-00016060: 615b 2754 6572 6d27 5d2e 7374 722e 7370  a['Term'].str.sp
-00016070: 6c69 7428 2728 2729 5d0a 2020 2020 2020  lit('(')].      
-00016080: 2020 2020 2020 656e 725f 6461 7461 5b27        enr_data['
-00016090: 474f 2074 6572 6d20 4944 275d 203d 2065  GO term ID'] = e
-000160a0: 6e72 5f64 6174 615b 2747 4f20 7465 726d  nr_data['GO term
-000160b0: 2049 4427 5d2e 6173 7479 7065 2827 7374   ID'].astype('st
-000160c0: 7269 6e67 2729 0a20 2020 2020 2020 2020  ring').         
-000160d0: 2020 2065 6e72 5f64 6174 615b 2754 6572     enr_data['Ter
-000160e0: 6d27 5d20 3d20 656e 725f 6461 7461 5b27  m'] = enr_data['
-000160f0: 5465 726d 275d 2e73 7472 2e70 6172 7469  Term'].str.parti
-00016100: 7469 6f6e 2827 2028 2729 5b30 5d0a 0a20  tion(' (')[0].. 
-00016110: 2020 2020 2020 2020 2020 2023 2066 696c             # fil
-00016120: 7465 7220 7468 6520 6461 7461 2062 7920  ter the data by 
-00016130: 4644 520a 2020 2020 2020 2020 2020 2020  FDR.            
-00016140: 656e 725f 6461 7461 203d 2065 6e72 5f64  enr_data = enr_d
-00016150: 6174 615b 656e 725f 6461 7461 5b27 4164  ata[enr_data['Ad
-00016160: 6a75 7374 6564 2050 2d76 616c 7565 275d  justed P-value']
-00016170: 203e 2031 2e33 5d0a 2020 2020 2020 2020   > 1.3].        
-00016180: 2020 2020 656e 725f 6461 7461 203d 2065      enr_data = e
-00016190: 6e72 5f64 6174 612e 736f 7274 5f76 616c  nr_data.sort_val
-000161a0: 7565 7328 2743 6f6d 6269 6e65 6420 5363  ues('Combined Sc
-000161b0: 6f72 6527 2c20 6173 6365 6e64 696e 673d  ore', ascending=
-000161c0: 4661 6c73 6529 200a 2020 2020 2020 2020  False) .        
-000161d0: 2020 2020 0a20 2020 2020 2020 2020 2020      .           
-000161e0: 2067 6f5f 6461 7461 7365 7473 2e61 7070   go_datasets.app
-000161f0: 656e 6428 656e 725f 6461 7461 290a 2020  end(enr_data).  
-00016200: 2020 2020 2020 0a20 2020 2020 2020 2072        .        r
-00016210: 6574 7572 6e20 676f 5f64 6174 6173 6574  eturn go_dataset
-00016220: 730a 2020 2020 0a20 2020 2064 6566 2066  s.    .    def f
-00016230: 696c 7465 725f 676f 5f62 795f 6c69 6e5f  ilter_go_by_lin_
-00016240: 7369 6d28 7365 6c66 2c20 676f 5f64 6174  sim(self, go_dat
-00016250: 6173 6574 7329 3a0a 2020 2020 0a20 2020  asets):.    .   
-00016260: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00016270: 2046 696c 7465 7220 6461 7461 2062 6173   Filter data bas
-00016280: 6564 206f 6e20 6c69 6e20 7365 6d61 7469  ed on lin semati
-00016290: 6320 7369 6d69 6c61 7269 7479 0a0a 2020  c similarity..  
-000162a0: 2020 2020 2020 5061 7261 6d65 7465 7273        Parameters
-000162b0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-000162c0: 2d2d 2d0a 2020 2020 2020 2020 676f 5f64  ---.        go_d
-000162d0: 6174 6173 6574 7320 3a20 6c69 7374 0a20  atasets : list. 
-000162e0: 2020 2020 2020 2020 2020 204c 6973 7420             List 
-000162f0: 6f66 2064 6174 6166 7261 6d65 7320 7769  of dataframes wi
-00016300: 7468 2075 7072 6567 756c 6174 6564 2061  th upregulated a
-00016310: 6e64 0a20 2020 2020 2020 2020 2020 2064  nd.            d
-00016320: 6f77 6e72 6567 756c 6174 6564 2065 6e72  ownregulated enr
-00016330: 6963 6865 6420 474f 2074 6572 6d73 0a20  iched GO terms. 
-00016340: 2020 2020 2020 2020 2020 200a 2020 2020             .    
-00016350: 2020 2020 5265 7475 726e 730a 2020 2020      Returns.    
-00016360: 2020 2020 2d2d 2d2d 2d2d 2d0a 2020 2020      -------.    
-00016370: 2020 2020 676f 5f64 6174 6120 3a20 6c69      go_data : li
-00016380: 7374 0a20 2020 2020 2020 2020 2020 204c  st.            L
-00016390: 6973 7420 6f66 2064 6174 6166 7261 6d65  ist of dataframe
-000163a0: 7320 7769 7468 2075 7072 6567 756c 6174  s with upregulat
-000163b0: 6564 2061 6e64 0a20 2020 2020 2020 2020  ed and.         
-000163c0: 2020 2064 6f77 6e72 6567 756c 6174 6564     downregulated
-000163d0: 2065 6e72 6963 6865 6420 474f 2074 6572   enriched GO ter
-000163e0: 6d73 2066 696c 7465 7265 6420 6279 0a20  ms filtered by. 
-000163f0: 2020 2020 2020 2020 2020 206c 696e 2073             lin s
-00016400: 656d 6174 6963 2073 696d 696c 6172 6974  ematic similarit
-00016410: 790a 2020 2020 2020 2020 2222 220a 2020  y.        """.  
-00016420: 2020 2020 2020 2320 6465 6669 6e65 2061        # define a
-00016430: 2074 6872 6573 686f 6c64 2066 6f72 2073   threshold for s
-00016440: 696d 696c 6172 6974 790a 2020 2020 2020  imilarity.      
-00016450: 2020 7468 7265 7368 6f6c 6420 3d20 302e    threshold = 0.
-00016460: 370a 2020 2020 2020 2020 676f 5f64 6174  7.        go_dat
-00016470: 6120 3d20 5b5d 0a20 2020 2020 2020 200a  a = [].        .
-00016480: 2020 2020 2020 2020 666f 7220 6461 7461          for data
-00016490: 2069 6e20 676f 5f64 6174 6173 6574 733a   in go_datasets:
-000164a0: 0a20 2020 2020 2020 2020 2020 200a 2020  .            .  
-000164b0: 2020 2020 2020 2020 2020 6966 2064 6174            if dat
-000164c0: 612e 7368 6170 655b 305d 203e 2030 3a0a  a.shape[0] > 0:.
-000164d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000164e0: 2320 7265 6d6f 7665 2073 696d 696c 6172  # remove similar
-000164f0: 2065 6c65 6d65 6e74 730a 2020 2020 2020   elements.      
-00016500: 2020 2020 2020 2020 2020 756e 6971 7565            unique
-00016510: 5f76 616c 7565 7320 3d20 5b64 6174 615b  _values = [data[
-00016520: 2747 4f20 7465 726d 2049 4427 5d2e 696c  'GO term ID'].il
-00016530: 6f63 5b30 5d5d 0a0a 2020 2020 2020 2020  oc[0]]..        
-00016540: 2020 2020 2020 2020 666f 7220 7661 6c20          for val 
-00016550: 696e 2064 6174 615b 2747 4f20 7465 726d  in data['GO term
-00016560: 2049 4427 5d3a 0a20 2020 2020 2020 2020   ID']:.         
-00016570: 2020 2020 2020 2020 2020 2074 7279 3a0a             try:.
-00016580: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016590: 2020 2020 2020 2020 7369 6d73 203d 205b          sims = [
-000165a0: 6c69 6e5f 7369 6d28 0a20 2020 2020 2020  lin_sim(.       
-000165b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000165c0: 2020 2020 2076 616c 2c20 755f 7661 6c2c       val, u_val,
-000165d0: 2073 656c 662e 676f 6461 672c 2073 656c   self.godag, sel
-000165e0: 662e 7465 726d 636f 756e 7473 2920 3e3d  f.termcounts) >=
-000165f0: 2074 6872 6573 686f 6c64 0a20 2020 2020   threshold.     
-00016600: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016610: 2020 2020 2020 2066 6f72 2075 5f76 616c         for u_val
-00016620: 2069 6e20 756e 6971 7565 5f76 616c 7565   in unique_value
-00016630: 730a 2020 2020 2020 2020 2020 2020 2020  s.              
-00016640: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00016650: 206c 696e 5f73 696d 2876 616c 2c20 755f   lin_sim(val, u_
-00016660: 7661 6c2c 2073 656c 662e 676f 6461 672c  val, self.godag,
-00016670: 2073 656c 662e 7465 726d 636f 756e 7473   self.termcounts
-00016680: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00016690: 2020 2020 2020 2020 2020 2020 2020 6973                is
-000166a0: 206e 6f74 204e 6f6e 655d 0a0a 2020 2020   not None]..    
-000166b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000166c0: 2020 2020 6966 2061 6e79 2873 696d 7329      if any(sims)
-000166d0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-000166e0: 2020 2020 2020 2020 2020 2020 2020 7061                pa
-000166f0: 7373 0a0a 2020 2020 2020 2020 2020 2020  ss..            
-00016700: 2020 2020 2020 2020 2020 2020 656c 7365              else
-00016710: 3a20 0a20 2020 2020 2020 2020 2020 2020  : .             
-00016720: 2020 2020 2020 2020 2020 2020 2020 2075                 u
-00016730: 6e69 7175 655f 7661 6c75 6573 2e61 7070  nique_values.app
-00016740: 656e 6428 7661 6c29 0a0a 2020 2020 2020  end(val)..      
-00016750: 2020 2020 2020 2020 2020 2020 2020 6578                ex
-00016760: 6365 7074 204b 6579 4572 726f 723a 0a20  cept KeyError:. 
-00016770: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016780: 2020 2020 2020 2063 6f6e 7469 6e75 650a         continue.
-00016790: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000167a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000167b0: 2067 6f5f 6461 7461 2e61 7070 656e 6428   go_data.append(
-000167c0: 6461 7461 5b64 6174 615b 2747 4f20 7465  data[data['GO te
-000167d0: 726d 2049 4427 5d2e 6973 696e 2875 6e69  rm ID'].isin(uni
-000167e0: 7175 655f 7661 6c75 6573 295d 290a 2020  que_values)]).  
-000167f0: 2020 0a20 2020 2020 2020 2067 6f5f 6461    .        go_da
-00016800: 7461 203d 2070 642e 636f 6e63 6174 2867  ta = pd.concat(g
-00016810: 6f5f 6461 7461 2c20 6178 6973 3d30 292e  o_data, axis=0).
-00016820: 7265 7365 745f 696e 6465 7828 6472 6f70  reset_index(drop
-00016830: 3d54 7275 6529 0a20 2020 2020 2020 2020  =True).         
-00016840: 2020 200a 2020 2020 2020 2020 7265 7475     .        retu
-00016850: 726e 2067 6f5f 6461 7461 0a0a 2020 2020  rn go_data..    
-00016860: 6465 6620 6361 6c63 756c 6174 655f 6d65  def calculate_me
-00016870: 616e 5f66 6f6c 645f 656e 7269 6368 6d65  an_fold_enrichme
-00016880: 6e74 2873 656c 662c 2067 6f5f 6461 7461  nt(self, go_data
-00016890: 2c20 6663 5f64 6174 6129 3a0a 2020 2020  , fc_data):.    
-000168a0: 2020 2020 2222 220a 0a20 2020 2020 2020      """..       
-000168b0: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
-000168c0: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20      ----------. 
-000168d0: 2020 2020 2020 2067 6f5f 6461 7461 203a         go_data :
-000168e0: 206c 6973 740a 2020 2020 2020 2020 2020   list.          
-000168f0: 2020 4c69 7374 206f 6620 6461 7461 6672    List of datafr
-00016900: 616d 6573 2077 6974 6820 7570 7265 6775  ames with upregu
-00016910: 6c61 7465 6420 616e 640a 2020 2020 2020  lated and.      
-00016920: 2020 2020 2020 646f 776e 7265 6775 6c61        downregula
-00016930: 7465 6420 656e 7269 6368 6564 2047 4f20  ted enriched GO 
-00016940: 7465 726d 7320 6669 6c74 6572 6564 2062  terms filtered b
-00016950: 790a 2020 2020 2020 2020 2020 2020 6c69  y.            li
-00016960: 6e20 7365 6d61 7469 6320 7369 6d69 6c61  n sematic simila
-00016970: 7269 7479 0a20 2020 2020 2020 2020 2020  rity.           
-00016980: 200a 2020 2020 2020 2020 6663 5f64 6174   .        fc_dat
-00016990: 6120 3a20 7061 6e64 6173 2e44 6174 6146  a : pandas.DataF
-000169a0: 7261 6d65 0a20 2020 2020 2020 2020 2020  rame.           
-000169b0: 2044 6174 6166 7261 6d65 2077 6974 6820   Dataframe with 
-000169c0: 666f 6c64 2063 6861 6e67 6520 6461 7461  fold change data
-000169d0: 0a0a 2020 2020 2020 2020 5265 7475 726e  ..        Return
-000169e0: 730a 2020 2020 2020 2020 2d2d 2d2d 2d2d  s.        ------
-000169f0: 2d0a 2020 2020 2020 2020 6d65 616e 5f66  -.        mean_f
-00016a00: 6f6c 645f 676f 5f64 6174 6120 3a20 7061  old_go_data : pa
-00016a10: 6e64 6173 2e44 6174 6146 7261 6d65 0a20  ndas.DataFrame. 
-00016a20: 2020 2020 2020 2020 2020 2044 6174 6166             Dataf
-00016a30: 7261 6d65 2077 6974 6820 6d65 616e 2066  rame with mean f
-00016a40: 6f6c 6420 656e 7269 6368 6d65 6e74 2064  old enrichment d
-00016a50: 6174 610a 2020 2020 2020 2020 2222 220a  ata.        """.
-00016a60: 2020 2020 0a20 2020 2020 2020 206d 6561      .        mea
-00016a70: 6e5f 666f 6c64 5f67 6f5f 6461 7461 203d  n_fold_go_data =
-00016a80: 2067 6f5f 6461 7461 2e63 6f70 7928 290a   go_data.copy().
-00016a90: 2020 2020 2020 2020 0a20 2020 2020 2020          .       
-00016aa0: 206d 6561 6e5f 666f 6c64 5f67 6f5f 6461   mean_fold_go_da
-00016ab0: 7461 5b27 4765 6e65 7327 5d20 3d20 6d65  ta['Genes'] = me
-00016ac0: 616e 5f66 6f6c 645f 676f 5f64 6174 615b  an_fold_go_data[
-00016ad0: 2747 656e 6573 275d 2e73 7472 2e73 706c  'Genes'].str.spl
-00016ae0: 6974 2827 3b27 290a 0a20 2020 2020 2020  it(';')..       
-00016af0: 206d 6561 6e5f 666f 6c64 5f65 6e72 6963   mean_fold_enric
-00016b00: 686d 656e 7420 3d20 5b5d 0a20 2020 2020  hment = [].     
-00016b10: 2020 200a 2020 2020 2020 2020 666f 7220     .        for 
-00016b20: 6765 6e65 7320 696e 206d 6561 6e5f 666f  genes in mean_fo
-00016b30: 6c64 5f67 6f5f 6461 7461 5b27 4765 6e65  ld_go_data['Gene
-00016b40: 7327 5d3a 0a20 2020 2020 2020 2020 2020  s']:.           
-00016b50: 206d 6561 6e5f 6765 6e65 7320 3d20 6663   mean_genes = fc
-00016b60: 5f64 6174 615b 6663 5f64 6174 615b 2747  _data[fc_data['G
-00016b70: 656e 6573 275d 2e69 7369 6e28 6765 6e65  enes'].isin(gene
-00016b80: 7329 5d2e 6d65 616e 280a 2020 2020 2020  s)].mean(.      
-00016b90: 2020 2020 2020 2020 2020 6e75 6d65 7269            numeri
-00016ba0: 635f 6f6e 6c79 3d54 7275 6529 5b30 5d0a  c_only=True)[0].
-00016bb0: 2020 2020 2020 2020 2020 2020 6d65 616e              mean
-00016bc0: 5f66 6f6c 645f 656e 7269 6368 6d65 6e74  _fold_enrichment
-00016bd0: 2e61 7070 656e 6428 6d65 616e 5f67 656e  .append(mean_gen
-00016be0: 6573 290a 0a20 2020 2020 2020 206d 6561  es)..        mea
-00016bf0: 6e5f 666f 6c64 5f67 6f5f 6461 7461 5b27  n_fold_go_data['
-00016c00: 6d65 616e 5f66 6f6c 645f 656e 7269 6368  mean_fold_enrich
-00016c10: 6d65 6e74 275d 203d 206d 6561 6e5f 666f  ment'] = mean_fo
-00016c20: 6c64 5f65 6e72 6963 686d 656e 740a 2020  ld_enrichment.  
-00016c30: 2020 2020 2020 7365 6c66 2e67 6f5f 6461        self.go_da
-00016c40: 7461 203d 206d 6561 6e5f 666f 6c64 5f67  ta = mean_fold_g
-00016c50: 6f5f 6461 7461 2e63 6f70 7928 290a 2020  o_data.copy().  
-00016c60: 2020 2020 2020 7265 7475 726e 206d 6561        return mea
-00016c70: 6e5f 666f 6c64 5f67 6f5f 6461 7461 0a20  n_fold_go_data. 
-00016c80: 2020 200a 2020 2020 6465 6620 676f 5f74     .    def go_t
-00016c90: 6572 6d5f 7363 6174 7465 7270 6c6f 7428  erm_scatterplot(
-00016ca0: 7365 6c66 2c20 6d65 616e 5f66 6f6c 645f  self, mean_fold_
-00016cb0: 676f 5f64 6174 612c 206e 5f67 6f5f 7465  go_data, n_go_te
-00016cc0: 726d 732c 0a20 2020 2020 2020 2020 2020  rms,.           
-00016cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016ce0: 2073 6176 6566 6967 2c20 6164 6469 745f   savefig, addit_
-00016cf0: 616e 6e6f 743d 4e6f 6e65 293a 0a20 2020  annot=None):.   
-00016d00: 2020 2020 2022 2222 0a0a 2020 2020 2020       """..      
-00016d10: 2020 5061 7261 6d65 7465 7273 0a20 2020    Parameters.   
-00016d20: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a       ----------.
-00016d30: 2020 2020 2020 2020 6d65 616e 5f66 6f6c          mean_fol
-00016d40: 645f 676f 5f64 6174 6120 3a20 7061 6e64  d_go_data : pand
-00016d50: 6173 2e44 6174 6146 7261 6d65 0a20 2020  as.DataFrame.   
-00016d60: 2020 2020 2020 2020 2047 6f20 7465 726d           Go term
-00016d70: 2064 6174 6120 7769 7468 206d 6561 6e20   data with mean 
-00016d80: 666f 6c64 2065 6e72 6963 686d 656e 7420  fold enrichment 
-00016d90: 6461 7461 0a0a 2020 2020 2020 2020 6e5f  data..        n_
-00016da0: 676f 5f74 6572 6d73 203a 2069 6e74 0a20  go_terms : int. 
-00016db0: 2020 2020 2020 2020 2020 204e 756d 6265             Numbe
-00016dc0: 7220 6f66 2067 6f20 7465 726d 7320 746f  r of go terms to
-00016dd0: 2062 6520 706c 6f74 7465 6420 666f 7220   be plotted for 
-00016de0: 7570 2061 6e64 2064 6f77 6e72 6567 756c  up and downregul
-00016df0: 6174 6564 2067 656e 6573 0a20 2020 2020  ated genes.     
-00016e00: 2020 2020 2020 200a 2020 2020 2020 2020         .        
-00016e10: 7361 7665 6669 6720 3a20 626f 6f6c 200a  savefig : bool .
-00016e20: 2020 2020 2020 2020 2020 2020 4966 2054              If T
-00016e30: 7275 6520 7361 7665 2066 6967 7572 650a  rue save figure.
-00016e40: 0a20 2020 2020 2020 2061 6464 6974 5f61  .        addit_a
-00016e50: 6e6e 6f74 203a 206c 6973 740a 2020 2020  nnot : list.    
-00016e60: 2020 2020 2020 2020 2041 6464 6974 696f           Additio
-00016e70: 6e61 6c20 476f 2074 6572 6d73 2074 6f20  nal Go terms to 
-00016e80: 6265 2061 6e6e 6f74 6174 6564 2028 4465  be annotated (De
-00016e90: 6661 756c 7420 7661 6c75 6520 3d20 4e6f  fault value = No
-00016ea0: 6e65 290a 0a20 2020 2020 2020 2052 6574  ne)..        Ret
-00016eb0: 7572 6e73 0a20 2020 2020 2020 202d 2d2d  urns.        ---
-00016ec0: 2d2d 2d2d 0a20 2020 2020 2020 206d 6174  ----.        mat
-00016ed0: 706c 6f74 6c69 622e 7079 706c 6f74 2e66  plotlib.pyplot.f
-00016ee0: 6967 7572 650a 2020 2020 2020 2020 2020  igure.          
-00016ef0: 2020 5363 6174 7465 7270 6c6f 7420 6f66    Scatterplot of
-00016f00: 206d 6561 6e20 666f 6c64 2065 6e72 6963   mean fold enric
-00016f10: 686d 656e 7420 7673 2e20 6164 6a75 7374  hment vs. adjust
-00016f20: 6564 2070 2d76 616c 7565 0a20 2020 2020  ed p-value.     
-00016f30: 2020 2022 2222 0a20 2020 200a 2020 2020     """.    .    
-00016f40: 2020 2020 6d65 616e 5f66 6f6c 645f 676f      mean_fold_go
-00016f50: 5f64 6174 615b 2754 6572 6d27 5d20 3d20  _data['Term'] = 
-00016f60: 5b69 2e72 6570 6c61 6365 2827 2027 2c20  [i.replace(' ', 
-00016f70: 275c 6e27 290a 2020 2020 2020 2020 2020  '\n').          
-00016f80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016f90: 2020 2020 2020 2020 2020 2066 6f72 2069             for i
-00016fa0: 2069 6e20 6d65 616e 5f66 6f6c 645f 676f   in mean_fold_go
-00016fb0: 5f64 6174 615b 2754 6572 6d27 5d5d 0a20  _data['Term']]. 
-00016fc0: 2020 2020 2020 200a 2020 2020 2020 2020         .        
-00016fd0: 7769 7468 2073 6e73 2e70 6c6f 7474 696e  with sns.plottin
-00016fe0: 675f 636f 6e74 6578 7428 276e 6f74 6562  g_context('noteb
-00016ff0: 6f6f 6b27 293a 0a20 2020 2020 2020 2020  ook'):.         
-00017000: 2020 2066 6967 2c20 6178 203d 2070 6c74     fig, ax = plt
-00017010: 2e73 7562 706c 6f74 7328 6669 6773 697a  .subplots(figsiz
-00017020: 653d 2838 2c20 3629 290a 2020 2020 2020  e=(8, 6)).      
-00017030: 2020 2020 2020 6720 3d20 736e 732e 7363        g = sns.sc
-00017040: 6174 7465 7270 6c6f 7428 6461 7461 3d6d  atterplot(data=m
-00017050: 6561 6e5f 666f 6c64 5f67 6f5f 6461 7461  ean_fold_go_data
-00017060: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00017070: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017080: 2020 783d 276d 6561 6e5f 666f 6c64 5f65    x='mean_fold_e
-00017090: 6e72 6963 686d 656e 7427 2c0a 2020 2020  nrichment',.    
-000170a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000170b0: 2020 2020 2020 2020 2020 2020 793d 2741              y='A
-000170c0: 646a 7573 7465 6420 502d 7661 6c75 6527  djusted P-value'
-000170d0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-000170e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000170f0: 2020 7369 7a65 3d27 4f76 6572 6c61 7020    size='Overlap 
-00017100: 696e 2025 272c 0a20 2020 2020 2020 2020  in %',.         
-00017110: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017120: 2020 2020 2020 2068 7565 3d27 436f 6d62         hue='Comb
-00017130: 696e 6564 2053 636f 7265 272c 200a 2020  ined Score', .  
-00017140: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017150: 2020 2020 2020 2020 2020 2020 2020 7369                si
-00017160: 7a65 733d 2832 302c 2032 3030 292c 200a  zes=(20, 200), .
-00017170: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017180: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017190: 6178 3d61 782c 0a20 2020 2020 2020 2020  ax=ax,.         
-000171a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000171b0: 2020 2020 2020 2070 616c 6574 7465 3d27         palette='
-000171c0: 7669 7269 6469 735f 7227 290a 2020 2020  viridis_r').    
-000171d0: 2020 2020 2020 2020 0a20 2020 2020 2020          .       
-000171e0: 2020 2020 2075 705f 676f 5f64 6174 615f       up_go_data_
-000171f0: 6964 7820 3d20 6d65 616e 5f66 6f6c 645f  idx = mean_fold_
-00017200: 676f 5f64 6174 615b 6d65 616e 5f66 6f6c  go_data[mean_fol
-00017210: 645f 676f 5f64 6174 615b 276d 6561 6e5f  d_go_data['mean_
-00017220: 666f 6c64 5f65 6e72 6963 686d 656e 7427  fold_enrichment'
-00017230: 5d20 3e20 305d 2e73 6f72 745f 7661 6c75  ] > 0].sort_valu
-00017240: 6573 2827 436f 6d62 696e 6564 2053 636f  es('Combined Sco
-00017250: 7265 272c 2061 7363 656e 6469 6e67 3d46  re', ascending=F
-00017260: 616c 7365 292e 6865 6164 286e 5f67 6f5f  alse).head(n_go_
-00017270: 7465 726d 7329 2e69 6e64 6578 2e74 6f5f  terms).index.to_
-00017280: 6c69 7374 2829 0a20 2020 2020 2020 2020  list().         
-00017290: 2020 2064 6f77 6e5f 676f 5f64 6174 615f     down_go_data_
-000172a0: 6964 7820 3d20 6d65 616e 5f66 6f6c 645f  idx = mean_fold_
-000172b0: 676f 5f64 6174 615b 6d65 616e 5f66 6f6c  go_data[mean_fol
-000172c0: 645f 676f 5f64 6174 615b 276d 6561 6e5f  d_go_data['mean_
-000172d0: 666f 6c64 5f65 6e72 6963 686d 656e 7427  fold_enrichment'
-000172e0: 5d20 3c20 305d 2e73 6f72 745f 7661 6c75  ] < 0].sort_valu
-000172f0: 6573 2827 436f 6d62 696e 6564 2053 636f  es('Combined Sco
-00017300: 7265 272c 2061 7363 656e 6469 6e67 3d46  re', ascending=F
-00017310: 616c 7365 292e 6865 6164 286e 5f67 6f5f  alse).head(n_go_
-00017320: 7465 726d 7329 2e69 6e64 6578 2e74 6f5f  terms).index.to_
-00017330: 6c69 7374 2829 0a0a 2020 2020 2020 2020  list()..        
-00017340: 2020 2020 6966 2061 6464 6974 5f61 6e6e      if addit_ann
-00017350: 6f74 2069 7320 4e6f 6e65 3a0a 2020 2020  ot is None:.    
-00017360: 2020 2020 2020 2020 2020 2020 696e 6469              indi
-00017370: 6365 7320 3d20 7570 5f67 6f5f 6461 7461  ces = up_go_data
-00017380: 5f69 6478 202b 2064 6f77 6e5f 676f 5f64  _idx + down_go_d
-00017390: 6174 615f 6964 780a 2020 2020 2020 2020  ata_idx.        
-000173a0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-000173b0: 2020 2020 2020 2020 2020 6164 6469 745f            addit_
-000173c0: 616e 6e6f 745f 6964 7820 3d20 6d65 616e  annot_idx = mean
-000173d0: 5f66 6f6c 645f 676f 5f64 6174 615b 6d65  _fold_go_data[me
-000173e0: 616e 5f66 6f6c 645f 676f 5f64 6174 615b  an_fold_go_data[
-000173f0: 2754 6572 6d27 5d2e 7374 722e 636f 6e74  'Term'].str.cont
-00017400: 6169 6e73 2861 6464 6974 5f61 6e6e 6f74  ains(addit_annot
-00017410: 295d 2e69 6e64 6578 2e74 6f5f 6c69 7374  )].index.to_list
-00017420: 2829 0a20 2020 2020 2020 2020 2020 2020  ().             
-00017430: 2020 2069 6e64 6963 6573 203d 2075 705f     indices = up_
-00017440: 676f 5f64 6174 615f 6964 7820 2b20 646f  go_data_idx + do
-00017450: 776e 5f67 6f5f 6461 7461 5f69 6478 202b  wn_go_data_idx +
-00017460: 2061 6464 6974 5f61 6e6e 6f74 5f69 6478   addit_annot_idx
-00017470: 0a20 2020 2020 2020 2020 2020 2074 6578  .            tex
-00017480: 7473 203d 205b 706c 742e 7465 7874 286d  ts = [plt.text(m
-00017490: 6561 6e5f 666f 6c64 5f67 6f5f 6461 7461  ean_fold_go_data
-000174a0: 5b27 6d65 616e 5f66 6f6c 645f 656e 7269  ['mean_fold_enri
-000174b0: 6368 6d65 6e74 275d 5b69 6478 5d2c 0a20  chment'][idx],. 
-000174c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000174d0: 2020 2020 2020 2020 2020 2020 206d 6561               mea
-000174e0: 6e5f 666f 6c64 5f67 6f5f 6461 7461 5b27  n_fold_go_data['
-000174f0: 4164 6a75 7374 6564 2050 2d76 616c 7565  Adjusted P-value
-00017500: 275d 5b69 6478 5d2c 0a20 2020 2020 2020  '][idx],.       
+000155d0: 2073 6176 6566 6967 3d46 616c 7365 293a   savefig=False):
+000155e0: 0a0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
+000155f0: 2020 2020 2020 5065 7266 6f72 6d20 656e        Perform en
+00015600: 7269 6368 6d65 6e74 2061 6e61 6c79 7369  richment analysi
+00015610: 7320 616e 6420 706c 6f74 0a20 2020 2020  s and plot.     
+00015620: 2020 2042 696f 6c6f 6769 6361 6c20 5072     Biological Pr
+00015630: 6f63 6573 732c 204d 6f6c 6563 756c 6172  ocess, Molecular
+00015640: 2046 756e 6374 696f 6e0a 2020 2020 2020   Function.      
+00015650: 2020 616e 6420 4365 6c6c 756c 6172 2063    and Cellular c
+00015660: 6f6d 7061 7274 6d65 6e74 0a0a 2020 2020  ompartment..    
+00015670: 2020 2020 5061 7261 6d65 7465 7273 0a20      Parameters. 
+00015680: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
+00015690: 2d0a 2020 2020 2020 2020 6765 6e65 5f6c  -.        gene_l
+000156a0: 6973 7420 3a20 6c69 7374 0a20 2020 2020  ist : list.     
+000156b0: 2020 2020 2020 2041 206c 6973 7420 6f66         A list of
+000156c0: 2067 656e 6573 2074 6f20 6265 2075 7365   genes to be use
+000156d0: 6420 666f 7220 656e 7269 6368 6d65 6e74  d for enrichment
+000156e0: 2061 6e61 6c79 7369 730a 2020 2020 2020   analysis.      
+000156f0: 2020 2020 2020 0a20 2020 2020 2020 206f        .        o
+00015700: 7267 616e 6973 6d20 3a20 7374 720a 2020  rganism : str.  
+00015710: 2020 2020 2020 2020 2020 4f72 6761 6e69            Organi
+00015720: 736d 2074 6f20 6265 2075 7365 6420 746f  sm to be used to
+00015730: 2064 6f20 656e 7269 6368 6d65 6e74 2061   do enrichment a
+00015740: 6e61 6c79 7369 732e 2065 2e67 2027 6875  nalysis. e.g 'hu
+00015750: 6d61 6e27 206f 7220 276d 6f75 7365 270a  man' or 'mouse'.
+00015760: 0a20 2020 2020 2020 2066 6967 7369 7a65  .        figsize
+00015770: 203a 2074 7570 6c65 0a20 2020 2020 2020   : tuple.       
+00015780: 2020 2020 2046 6967 7572 6520 7369 7a65       Figure size
+00015790: 2065 2e67 2028 3130 2c20 3130 290a 2020   e.g (10, 10).  
+000157a0: 2020 2020 2020 0a20 2020 2020 2020 2074        .        t
+000157b0: 6f70 203a 2069 6e74 0a20 2020 2020 2020  op : int.       
+000157c0: 2020 2020 2054 6f70 206e 2074 6572 6d73       Top n terms
+000157d0: 2074 6f20 6265 2070 6c6f 7474 6564 2062   to be plotted b
+000157e0: 6173 6564 206f 6e20 7468 6520 636f 6d62  ased on the comb
+000157f0: 696e 6564 2073 636f 7265 0a0a 2020 2020  ined score..    
+00015800: 2020 2020 7361 7665 6669 6720 3a20 626f      savefig : bo
+00015810: 6f6c 6561 6e0a 2020 2020 2020 2020 2020  olean.          
+00015820: 2020 2049 6620 5472 7565 2073 6176 6520     If True save 
+00015830: 6669 6775 7265 2028 4465 6661 756c 7420  figure (Default 
+00015840: 7661 6c75 6520 3d20 4661 6c73 6529 0a0a  value = False)..
+00015850: 2020 2020 2020 2020 5265 7475 726e 730a          Returns.
+00015860: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d0a          -------.
+00015870: 2020 2020 2020 2020 6d61 7470 6c6f 746c          matplotl
+00015880: 6962 2e70 7970 6c6f 740a 2020 2020 2020  ib.pyplot.      
+00015890: 2020 2222 220a 2020 2020 2020 2020 2320    """.        # 
+000158a0: 656e 7269 6368 6d65 6e74 0a20 2020 2020  enrichment.     
+000158b0: 2020 2067 6f5f 6461 7461 203d 2073 656c     go_data = sel
+000158c0: 662e 6172 7261 795f 656e 7269 6368 6d65  f.array_enrichme
+000158d0: 6e74 5f61 6e61 6c79 7369 7328 6765 6e65  nt_analysis(gene
+000158e0: 5f6c 6973 743d 6765 6e65 5f6c 6973 742c  _list=gene_list,
+000158f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00015900: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015910: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015920: 2020 6f72 6761 6e69 736d 3d6f 7267 616e    organism=organ
+00015930: 6973 6d29 0a20 2020 2020 2020 200a 2020  ism).        .  
+00015940: 2020 2020 2020 7365 6c66 2e70 6c6f 745f        self.plot_
+00015950: 6172 7261 795f 656e 7269 6368 6d65 6e74  array_enrichment
+00015960: 2867 6f5f 6461 7461 3d67 6f5f 6461 7461  (go_data=go_data
+00015970: 2c20 0a20 2020 2020 2020 2020 2020 2020  , .             
+00015980: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015990: 2020 2020 2020 6669 6773 697a 653d 6669        figsize=fi
+000159a0: 6773 697a 652c 2074 6f70 3d74 6f70 2c0a  gsize, top=top,.
+000159b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000159c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000159d0: 2020 2073 6176 6566 6967 3d73 6176 6566     savefig=savef
+000159e0: 6967 290a 2020 2020 2020 2020 7265 7475  ig).        retu
+000159f0: 726e 2067 6f5f 6461 7461 0a20 2020 200a  rn go_data.    .
+00015a00: 2020 2020 6465 6620 6172 7261 795f 656e      def array_en
+00015a10: 7269 6368 6d65 6e74 5f61 6e61 6c79 7369  richment_analysi
+00015a20: 735f 696e 745f 706c 6f74 2873 656c 662c  s_int_plot(self,
+00015a30: 2067 656e 655f 6c69 7374 2c20 6f72 6761   gene_list, orga
+00015a40: 6e69 736d 2c20 6865 6967 6874 3d37 3030  nism, height=700
+00015a50: 2c20 7769 6474 683d 3135 3030 2c20 746f  , width=1500, to
+00015a60: 703d 3130 293a 0a0a 2020 2020 2020 2020  p=10):..        
+00015a70: 2023 2065 6e72 6963 686d 656e 740a 2020   # enrichment.  
+00015a80: 2020 2020 2020 676f 5f64 6174 6120 3d20        go_data = 
+00015a90: 7365 6c66 2e61 7272 6179 5f65 6e72 6963  self.array_enric
+00015aa0: 686d 656e 745f 616e 616c 7973 6973 2867  hment_analysis(g
+00015ab0: 656e 655f 6c69 7374 3d67 656e 655f 6c69  ene_list=gene_li
+00015ac0: 7374 2c0a 2020 2020 2020 2020 2020 2020  st,.            
+00015ad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015ae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015af0: 2020 2020 206f 7267 616e 6973 6d3d 6f72       organism=or
+00015b00: 6761 6e69 736d 290a 2020 2020 2020 2020  ganism).        
+00015b10: 0a20 2020 2020 2020 2073 656c 662e 696e  .        self.in
+00015b20: 745f 706c 6f74 5f61 7272 6179 5f65 6e72  t_plot_array_enr
+00015b30: 6963 686d 656e 7428 676f 5f64 6174 613d  ichment(go_data=
+00015b40: 676f 5f64 6174 612c 2068 6569 6768 743d  go_data, height=
+00015b50: 6865 6967 6874 2c20 7769 6474 683d 7769  height, width=wi
+00015b60: 6474 682c 2074 6f70 3d74 6f70 290a 2020  dth, top=top).  
+00015b70: 2020 2020 2020 0a20 2020 2020 2020 2072        .        r
+00015b80: 6574 7572 6e20 676f 5f64 6174 610a 2020  eturn go_data.  
+00015b90: 2020 0a20 2020 2064 6566 2067 6f5f 656e    .    def go_en
+00015ba0: 7269 6368 6572 2873 656c 662c 2075 705f  richer(self, up_
+00015bb0: 6765 6e65 5f6c 6973 742c 2064 6f77 6e5f  gene_list, down_
+00015bc0: 6765 6e65 5f6c 6973 742c 206f 7267 616e  gene_list, organ
+00015bd0: 6973 6d2c 2067 6f5f 7465 726d 3d30 293a  ism, go_term=0):
+00015be0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+00015bf0: 2020 2020 2050 6572 666f 726d 2047 4f20       Perform GO 
+00015c00: 7465 726d 2065 6e72 6963 686d 656e 7420  term enrichment 
+00015c10: 616e 616c 7973 6973 0a0a 2020 2020 2020  analysis..      
+00015c20: 2020 5061 7261 6d65 7465 7273 0a20 2020    Parameters.   
+00015c30: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a       ----------.
+00015c40: 2020 2020 2020 2020 7570 5f67 656e 655f          up_gene_
+00015c50: 6c69 7374 203a 206c 6973 740a 2020 2020  list : list.    
+00015c60: 2020 2020 2020 2020 4c69 7374 206f 6620          List of 
+00015c70: 7570 7265 6775 6c61 7465 6420 6765 6e65  upregulated gene
+00015c80: 730a 0a20 2020 2020 2020 2064 6f77 6e5f  s..        down_
+00015c90: 6765 6e65 5f6c 6973 7420 3a20 6c69 7374  gene_list : list
+00015ca0: 0a20 2020 2020 2020 2020 2020 204c 6973  .            Lis
+00015cb0: 7420 6f66 2064 6f77 6e72 6567 756c 6174  t of downregulat
+00015cc0: 6564 2067 656e 6573 0a20 2020 2020 2020  ed genes.       
+00015cd0: 2020 2020 200a 2020 2020 2020 2020 6f72       .        or
+00015ce0: 6761 6e69 736d 203a 2073 7472 0a20 2020  ganism : str.   
+00015cf0: 2020 2020 2020 2020 204f 7267 616e 6973           Organis
+00015d00: 6d20 746f 2062 6520 7573 6564 2074 6f20  m to be used to 
+00015d10: 646f 2065 6e72 6963 686d 656e 7420 616e  do enrichment an
+00015d20: 616c 7973 6973 2e20 652e 6720 2768 756d  alysis. e.g 'hum
+00015d30: 616e 2720 6f72 2027 6d6f 7573 6527 0a0a  an' or 'mouse'..
+00015d40: 2020 2020 2020 2020 676f 5f74 6572 6d20          go_term 
+00015d50: 3a20 696e 740a 2020 2020 2020 2020 2020  : int.          
+00015d60: 2020 2030 2072 6570 7265 7365 6e74 7320     0 represents 
+00015d70: 4269 6f6c 6f67 6963 616c 2070 726f 6365  Biological proce
+00015d80: 7373 2c0a 2020 2020 2020 2020 2020 2020  ss,.            
+00015d90: 2031 2072 6570 7265 7365 6e74 7320 4d6f   1 represents Mo
+00015da0: 6c65 6375 6c61 7220 6675 6e63 7469 6f6e  lecular function
+00015db0: 2061 6e64 0a20 2020 2020 2020 2020 2020   and.           
+00015dc0: 2020 3220 7265 7072 6573 656e 7473 2063    2 represents c
+00015dd0: 656c 6c75 6c61 7220 636f 6d70 6f6e 656e  ellular componen
+00015de0: 740a 2020 2020 2020 2020 2020 2020 2028  t.             (
+00015df0: 4465 6661 756c 7420 7661 6c75 6520 3d20  Default value = 
+00015e00: 3029 0a0a 2020 2020 2020 2020 5265 7475  0)..        Retu
+00015e10: 726e 730a 2020 2020 2020 2020 2d2d 2d2d  rns.        ----
+00015e20: 2d2d 2d0a 2020 2020 2020 2020 676f 5f64  ---.        go_d
+00015e30: 6174 6173 6574 7320 3a20 6c69 7374 0a20  atasets : list. 
+00015e40: 2020 2020 2020 2020 2020 204c 6973 7420             List 
+00015e50: 6f66 2064 6174 6166 7261 6d65 7320 7769  of dataframes wi
+00015e60: 7468 2047 4f5f 4269 6f6c 6f67 6963 616c  th GO_Biological
+00015e70: 5f50 726f 6365 7373 5f32 3032 312c 0a20  _Process_2021,. 
+00015e80: 2020 2020 2020 2020 2020 2047 4f5f 4d6f             GO_Mo
+00015e90: 6c65 6375 6c61 725f 4675 6e63 7469 6f6e  lecular_Function
+00015ea0: 5f32 3032 3120 616e 640a 2020 2020 2020  _2021 and.      
+00015eb0: 2020 2020 2020 474f 5f43 656c 6c75 6c61        GO_Cellula
+00015ec0: 725f 436f 6d70 6f6e 656e 745f 3230 3231  r_Component_2021
+00015ed0: 2065 6e72 6963 686d 656e 7420 6461 7461   enrichment data
+00015ee0: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
+00015ef0: 2020 0a20 2020 2020 2020 2067 6f5f 6461    .        go_da
+00015f00: 7461 7365 7473 203d 205b 5d0a 2020 2020  tasets = [].    
+00015f10: 2020 2020 0a20 2020 2020 2020 2066 6f72      .        for
+00015f20: 2067 656e 655f 6c69 7374 2069 6e20 5b75   gene_list in [u
+00015f30: 705f 6765 6e65 5f6c 6973 742c 2064 6f77  p_gene_list, dow
+00015f40: 6e5f 6765 6e65 5f6c 6973 745d 3a0a 2020  n_gene_list]:.  
+00015f50: 2020 2020 2020 0a20 2020 2020 2020 2020        .         
+00015f60: 2020 2022 2222 2050 6572 666f 726d 2047     """ Perform G
+00015f70: 4f20 7465 726d 2065 6e72 6963 686d 656e  O term enrichmen
+00015f80: 7420 2222 220a 2020 2020 2020 2020 2020  t """.          
+00015f90: 2020 7465 726d 203d 205b 2747 4f5f 4269    term = ['GO_Bi
+00015fa0: 6f6c 6f67 6963 616c 5f50 726f 6365 7373  ological_Process
+00015fb0: 5f32 3032 3127 2c0a 2020 2020 2020 2020  _2021',.        
+00015fc0: 2020 2020 2020 2020 2020 2020 2747 4f5f              'GO_
+00015fd0: 4d6f 6c65 6375 6c61 725f 4675 6e63 7469  Molecular_Functi
+00015fe0: 6f6e 5f32 3032 3127 2c0a 2020 2020 2020  on_2021',.      
+00015ff0: 2020 2020 2020 2020 2020 2020 2020 2747                'G
+00016000: 4f5f 4365 6c6c 756c 6172 5f43 6f6d 706f  O_Cellular_Compo
+00016010: 6e65 6e74 5f32 3032 3127 5d5b 676f 5f74  nent_2021'][go_t
+00016020: 6572 6d5d 0a20 2020 2020 2020 2020 2020  erm].           
+00016030: 2065 6e72 203d 2067 702e 656e 7269 6368   enr = gp.enrich
+00016040: 7228 6765 6e65 5f6c 6973 743d 6765 6e65  r(gene_list=gene
+00016050: 5f6c 6973 742c 0a20 2020 2020 2020 2020  _list,.         
+00016060: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016070: 2020 2020 6765 6e65 5f73 6574 733d 7465      gene_sets=te
+00016080: 726d 2c0a 2020 2020 2020 2020 2020 2020  rm,.            
+00016090: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000160a0: 206f 7267 616e 6973 6d3d 6f72 6761 6e69   organism=organi
+000160b0: 736d 2c20 0a20 2020 2020 2020 2020 2020  sm, .           
+000160c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000160d0: 2020 6f75 7464 6972 3d4e 6f6e 652c 0a20    outdir=None,. 
+000160e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000160f0: 2020 2020 2020 2020 2020 2020 6375 746f              cuto
+00016100: 6666 3d30 2e35 290a 0a20 2020 2020 2020  ff=0.5)..       
+00016110: 2020 2020 2023 2063 6861 6e67 6520 6474       # change dt
+00016120: 7970 6520 6f66 2065 6e72 0a20 2020 2020  ype of enr.     
+00016130: 2020 2020 2020 2065 6e72 203d 2065 6e72         enr = enr
+00016140: 2e72 6573 756c 7473 2e61 7374 7970 6528  .results.astype(
+00016150: 7b27 5465 726d 273a 2027 7374 7269 6e67  {'Term': 'string
+00016160: 277d 290a 0a20 2020 2020 2020 2020 2020  '})..           
+00016170: 2023 2074 7261 6e73 666f 726d 2074 6865   # transform the
+00016180: 2070 7661 6c75 650a 2020 2020 2020 2020   pvalue.        
+00016190: 2020 2020 656e 725f 6461 7461 203d 2065      enr_data = e
+000161a0: 6e72 2e73 6f72 745f 7661 6c75 6573 2827  nr.sort_values('
+000161b0: 4164 6a75 7374 6564 2050 2d76 616c 7565  Adjusted P-value
+000161c0: 2729 0a20 2020 2020 2020 2020 2020 2065  ').            e
+000161d0: 6e72 5f64 6174 615b 2741 646a 7573 7465  nr_data['Adjuste
+000161e0: 6420 502d 7661 6c75 6527 5d20 3d20 2d20  d P-value'] = - 
+000161f0: 6e70 2e6c 6f67 3130 280a 2020 2020 2020  np.log10(.      
+00016200: 2020 2020 2020 2020 2020 656e 725f 6461            enr_da
+00016210: 7461 5b27 4164 6a75 7374 6564 2050 2d76  ta['Adjusted P-v
+00016220: 616c 7565 275d 290a 0a20 2020 2020 2020  alue'])..       
+00016230: 2020 2020 2023 2063 616c 6375 6c61 746f       # calculato
+00016240: 7220 7468 6520 6f76 6572 6c61 7020 696e  r the overlap in
+00016250: 2025 0a20 2020 2020 2020 2020 2020 206e   %.            n
+00016260: 756d 6572 6174 6f72 203d 205b 666c 6f61  umerator = [floa
+00016270: 7428 695b 305d 290a 2020 2020 2020 2020  t(i[0]).        
+00016280: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016290: 2066 6f72 2069 2069 6e20 656e 725f 6461   for i in enr_da
+000162a0: 7461 5b27 4f76 6572 6c61 7027 5d2e 7374  ta['Overlap'].st
+000162b0: 722e 7370 6c69 7428 272f 2729 5d0a 2020  r.split('/')].  
+000162c0: 2020 2020 2020 2020 2020 6465 6e6f 6d69            denomi
+000162d0: 6e61 746f 7220 3d20 5b66 6c6f 6174 2869  nator = [float(i
+000162e0: 5b31 5d29 0a20 2020 2020 2020 2020 2020  [1]).           
+000162f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016300: 666f 7220 6920 696e 2065 6e72 5f64 6174  for i in enr_dat
+00016310: 615b 274f 7665 726c 6170 275d 2e73 7472  a['Overlap'].str
+00016320: 2e73 706c 6974 2827 2f27 295d 0a20 2020  .split('/')].   
+00016330: 2020 2020 2020 2020 206f 7665 726c 6170           overlap
+00016340: 203d 206e 702e 726f 756e 6428 6e70 2e61   = np.round(np.a
+00016350: 7272 6179 286e 756d 6572 6174 6f72 2920  rray(numerator) 
+00016360: 2f20 0a20 2020 2020 2020 2020 2020 2020  / .             
+00016370: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016380: 2020 6e70 2e61 7272 6179 2864 656e 6f6d    np.array(denom
+00016390: 696e 6174 6f72 2920 2a20 3130 3029 0a20  inator) * 100). 
+000163a0: 2020 2020 2020 2020 2020 2065 6e72 5f64             enr_d
+000163b0: 6174 615b 274f 7665 726c 6170 2069 6e20  ata['Overlap in 
+000163c0: 2527 5d20 3d20 6f76 6572 6c61 700a 0a20  %'] = overlap.. 
+000163d0: 2020 2020 2020 2020 2020 2023 2070 6172             # par
+000163e0: 7469 7469 6f6e 2074 6865 2074 6572 6d20  tition the term 
+000163f0: 0a20 2020 2020 2020 2020 2020 2065 6e72  .            enr
+00016400: 5f64 6174 615b 2747 4f20 7465 726d 2049  _data['GO term I
+00016410: 4427 5d20 3d20 5b69 5b31 5d2e 7370 6c69  D'] = [i[1].spli
+00016420: 7428 2729 2729 5b30 5d0a 2020 2020 2020  t(')')[0].      
+00016430: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016440: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016450: 666f 7220 6920 696e 2065 6e72 5f64 6174  for i in enr_dat
+00016460: 615b 2754 6572 6d27 5d2e 7374 722e 7370  a['Term'].str.sp
+00016470: 6c69 7428 2728 2729 5d0a 2020 2020 2020  lit('(')].      
+00016480: 2020 2020 2020 656e 725f 6461 7461 5b27        enr_data['
+00016490: 474f 2074 6572 6d20 4944 275d 203d 2065  GO term ID'] = e
+000164a0: 6e72 5f64 6174 615b 2747 4f20 7465 726d  nr_data['GO term
+000164b0: 2049 4427 5d2e 6173 7479 7065 2827 7374   ID'].astype('st
+000164c0: 7269 6e67 2729 0a20 2020 2020 2020 2020  ring').         
+000164d0: 2020 2065 6e72 5f64 6174 615b 2754 6572     enr_data['Ter
+000164e0: 6d27 5d20 3d20 656e 725f 6461 7461 5b27  m'] = enr_data['
+000164f0: 5465 726d 275d 2e73 7472 2e70 6172 7469  Term'].str.parti
+00016500: 7469 6f6e 2827 2028 2729 5b30 5d0a 0a20  tion(' (')[0].. 
+00016510: 2020 2020 2020 2020 2020 2023 2066 696c             # fil
+00016520: 7465 7220 7468 6520 6461 7461 2062 7920  ter the data by 
+00016530: 4644 520a 2020 2020 2020 2020 2020 2020  FDR.            
+00016540: 656e 725f 6461 7461 203d 2065 6e72 5f64  enr_data = enr_d
+00016550: 6174 615b 656e 725f 6461 7461 5b27 4164  ata[enr_data['Ad
+00016560: 6a75 7374 6564 2050 2d76 616c 7565 275d  justed P-value']
+00016570: 203e 2031 2e33 5d0a 2020 2020 2020 2020   > 1.3].        
+00016580: 2020 2020 656e 725f 6461 7461 203d 2065      enr_data = e
+00016590: 6e72 5f64 6174 612e 736f 7274 5f76 616c  nr_data.sort_val
+000165a0: 7565 7328 2743 6f6d 6269 6e65 6420 5363  ues('Combined Sc
+000165b0: 6f72 6527 2c20 6173 6365 6e64 696e 673d  ore', ascending=
+000165c0: 4661 6c73 6529 200a 2020 2020 2020 2020  False) .        
+000165d0: 2020 2020 0a20 2020 2020 2020 2020 2020      .           
+000165e0: 2067 6f5f 6461 7461 7365 7473 2e61 7070   go_datasets.app
+000165f0: 656e 6428 656e 725f 6461 7461 290a 2020  end(enr_data).  
+00016600: 2020 2020 2020 0a20 2020 2020 2020 2072        .        r
+00016610: 6574 7572 6e20 676f 5f64 6174 6173 6574  eturn go_dataset
+00016620: 730a 2020 2020 0a20 2020 2064 6566 2066  s.    .    def f
+00016630: 696c 7465 725f 676f 5f62 795f 6c69 6e5f  ilter_go_by_lin_
+00016640: 7369 6d28 7365 6c66 2c20 676f 5f64 6174  sim(self, go_dat
+00016650: 6173 6574 7329 3a0a 2020 2020 0a20 2020  asets):.    .   
+00016660: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+00016670: 2046 696c 7465 7220 6461 7461 2062 6173   Filter data bas
+00016680: 6564 206f 6e20 6c69 6e20 7365 6d61 7469  ed on lin semati
+00016690: 6320 7369 6d69 6c61 7269 7479 0a0a 2020  c similarity..  
+000166a0: 2020 2020 2020 5061 7261 6d65 7465 7273        Parameters
+000166b0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+000166c0: 2d2d 2d0a 2020 2020 2020 2020 676f 5f64  ---.        go_d
+000166d0: 6174 6173 6574 7320 3a20 6c69 7374 0a20  atasets : list. 
+000166e0: 2020 2020 2020 2020 2020 204c 6973 7420             List 
+000166f0: 6f66 2064 6174 6166 7261 6d65 7320 7769  of dataframes wi
+00016700: 7468 2075 7072 6567 756c 6174 6564 2061  th upregulated a
+00016710: 6e64 0a20 2020 2020 2020 2020 2020 2064  nd.            d
+00016720: 6f77 6e72 6567 756c 6174 6564 2065 6e72  ownregulated enr
+00016730: 6963 6865 6420 474f 2074 6572 6d73 0a20  iched GO terms. 
+00016740: 2020 2020 2020 2020 2020 200a 2020 2020             .    
+00016750: 2020 2020 5265 7475 726e 730a 2020 2020      Returns.    
+00016760: 2020 2020 2d2d 2d2d 2d2d 2d0a 2020 2020      -------.    
+00016770: 2020 2020 676f 5f64 6174 6120 3a20 6c69      go_data : li
+00016780: 7374 0a20 2020 2020 2020 2020 2020 204c  st.            L
+00016790: 6973 7420 6f66 2064 6174 6166 7261 6d65  ist of dataframe
+000167a0: 7320 7769 7468 2075 7072 6567 756c 6174  s with upregulat
+000167b0: 6564 2061 6e64 0a20 2020 2020 2020 2020  ed and.         
+000167c0: 2020 2064 6f77 6e72 6567 756c 6174 6564     downregulated
+000167d0: 2065 6e72 6963 6865 6420 474f 2074 6572   enriched GO ter
+000167e0: 6d73 2066 696c 7465 7265 6420 6279 0a20  ms filtered by. 
+000167f0: 2020 2020 2020 2020 2020 206c 696e 2073             lin s
+00016800: 656d 6174 6963 2073 696d 696c 6172 6974  ematic similarit
+00016810: 790a 2020 2020 2020 2020 2222 220a 2020  y.        """.  
+00016820: 2020 2020 2020 2320 6465 6669 6e65 2061        # define a
+00016830: 2074 6872 6573 686f 6c64 2066 6f72 2073   threshold for s
+00016840: 696d 696c 6172 6974 790a 2020 2020 2020  imilarity.      
+00016850: 2020 7468 7265 7368 6f6c 6420 3d20 302e    threshold = 0.
+00016860: 370a 2020 2020 2020 2020 676f 5f64 6174  7.        go_dat
+00016870: 6120 3d20 5b5d 0a20 2020 2020 2020 200a  a = [].        .
+00016880: 2020 2020 2020 2020 666f 7220 6461 7461          for data
+00016890: 2069 6e20 676f 5f64 6174 6173 6574 733a   in go_datasets:
+000168a0: 0a20 2020 2020 2020 2020 2020 200a 2020  .            .  
+000168b0: 2020 2020 2020 2020 2020 6966 2064 6174            if dat
+000168c0: 612e 7368 6170 655b 305d 203e 2030 3a0a  a.shape[0] > 0:.
+000168d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000168e0: 2320 7265 6d6f 7665 2073 696d 696c 6172  # remove similar
+000168f0: 2065 6c65 6d65 6e74 730a 2020 2020 2020   elements.      
+00016900: 2020 2020 2020 2020 2020 756e 6971 7565            unique
+00016910: 5f76 616c 7565 7320 3d20 5b64 6174 615b  _values = [data[
+00016920: 2747 4f20 7465 726d 2049 4427 5d2e 696c  'GO term ID'].il
+00016930: 6f63 5b30 5d5d 0a0a 2020 2020 2020 2020  oc[0]]..        
+00016940: 2020 2020 2020 2020 666f 7220 7661 6c20          for val 
+00016950: 696e 2064 6174 615b 2747 4f20 7465 726d  in data['GO term
+00016960: 2049 4427 5d3a 0a20 2020 2020 2020 2020   ID']:.         
+00016970: 2020 2020 2020 2020 2020 2074 7279 3a0a             try:.
+00016980: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016990: 2020 2020 2020 2020 7369 6d73 203d 205b          sims = [
+000169a0: 6c69 6e5f 7369 6d28 0a20 2020 2020 2020  lin_sim(.       
+000169b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000169c0: 2020 2020 2076 616c 2c20 755f 7661 6c2c       val, u_val,
+000169d0: 2073 656c 662e 676f 6461 672c 2073 656c   self.godag, sel
+000169e0: 662e 7465 726d 636f 756e 7473 2920 3e3d  f.termcounts) >=
+000169f0: 2074 6872 6573 686f 6c64 0a20 2020 2020   threshold.     
+00016a00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016a10: 2020 2020 2020 2066 6f72 2075 5f76 616c         for u_val
+00016a20: 2069 6e20 756e 6971 7565 5f76 616c 7565   in unique_value
+00016a30: 730a 2020 2020 2020 2020 2020 2020 2020  s.              
+00016a40: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00016a50: 206c 696e 5f73 696d 2876 616c 2c20 755f   lin_sim(val, u_
+00016a60: 7661 6c2c 2073 656c 662e 676f 6461 672c  val, self.godag,
+00016a70: 2073 656c 662e 7465 726d 636f 756e 7473   self.termcounts
+00016a80: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00016a90: 2020 2020 2020 2020 2020 2020 2020 6973                is
+00016aa0: 206e 6f74 204e 6f6e 655d 0a0a 2020 2020   not None]..    
+00016ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016ac0: 2020 2020 6966 2061 6e79 2873 696d 7329      if any(sims)
+00016ad0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00016ae0: 2020 2020 2020 2020 2020 2020 2020 7061                pa
+00016af0: 7373 0a0a 2020 2020 2020 2020 2020 2020  ss..            
+00016b00: 2020 2020 2020 2020 2020 2020 656c 7365              else
+00016b10: 3a20 0a20 2020 2020 2020 2020 2020 2020  : .             
+00016b20: 2020 2020 2020 2020 2020 2020 2020 2075                 u
+00016b30: 6e69 7175 655f 7661 6c75 6573 2e61 7070  nique_values.app
+00016b40: 656e 6428 7661 6c29 0a0a 2020 2020 2020  end(val)..      
+00016b50: 2020 2020 2020 2020 2020 2020 2020 6578                ex
+00016b60: 6365 7074 204b 6579 4572 726f 723a 0a20  cept KeyError:. 
+00016b70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016b80: 2020 2020 2020 2063 6f6e 7469 6e75 650a         continue.
+00016b90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016ba0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00016bb0: 2067 6f5f 6461 7461 2e61 7070 656e 6428   go_data.append(
+00016bc0: 6461 7461 5b64 6174 615b 2747 4f20 7465  data[data['GO te
+00016bd0: 726d 2049 4427 5d2e 6973 696e 2875 6e69  rm ID'].isin(uni
+00016be0: 7175 655f 7661 6c75 6573 295d 290a 2020  que_values)]).  
+00016bf0: 2020 0a20 2020 2020 2020 2067 6f5f 6461    .        go_da
+00016c00: 7461 203d 2070 642e 636f 6e63 6174 2867  ta = pd.concat(g
+00016c10: 6f5f 6461 7461 2c20 6178 6973 3d30 292e  o_data, axis=0).
+00016c20: 7265 7365 745f 696e 6465 7828 6472 6f70  reset_index(drop
+00016c30: 3d54 7275 6529 0a20 2020 2020 2020 2020  =True).         
+00016c40: 2020 200a 2020 2020 2020 2020 7265 7475     .        retu
+00016c50: 726e 2067 6f5f 6461 7461 0a0a 2020 2020  rn go_data..    
+00016c60: 6465 6620 6361 6c63 756c 6174 655f 6d65  def calculate_me
+00016c70: 616e 5f66 6f6c 645f 656e 7269 6368 6d65  an_fold_enrichme
+00016c80: 6e74 2873 656c 662c 2067 6f5f 6461 7461  nt(self, go_data
+00016c90: 2c20 6663 5f64 6174 6129 3a0a 2020 2020  , fc_data):.    
+00016ca0: 2020 2020 2222 220a 0a20 2020 2020 2020      """..       
+00016cb0: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
+00016cc0: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20      ----------. 
+00016cd0: 2020 2020 2020 2067 6f5f 6461 7461 203a         go_data :
+00016ce0: 206c 6973 740a 2020 2020 2020 2020 2020   list.          
+00016cf0: 2020 4c69 7374 206f 6620 6461 7461 6672    List of datafr
+00016d00: 616d 6573 2077 6974 6820 7570 7265 6775  ames with upregu
+00016d10: 6c61 7465 6420 616e 640a 2020 2020 2020  lated and.      
+00016d20: 2020 2020 2020 646f 776e 7265 6775 6c61        downregula
+00016d30: 7465 6420 656e 7269 6368 6564 2047 4f20  ted enriched GO 
+00016d40: 7465 726d 7320 6669 6c74 6572 6564 2062  terms filtered b
+00016d50: 790a 2020 2020 2020 2020 2020 2020 6c69  y.            li
+00016d60: 6e20 7365 6d61 7469 6320 7369 6d69 6c61  n sematic simila
+00016d70: 7269 7479 0a20 2020 2020 2020 2020 2020  rity.           
+00016d80: 200a 2020 2020 2020 2020 6663 5f64 6174   .        fc_dat
+00016d90: 6120 3a20 7061 6e64 6173 2e44 6174 6146  a : pandas.DataF
+00016da0: 7261 6d65 0a20 2020 2020 2020 2020 2020  rame.           
+00016db0: 2044 6174 6166 7261 6d65 2077 6974 6820   Dataframe with 
+00016dc0: 666f 6c64 2063 6861 6e67 6520 6461 7461  fold change data
+00016dd0: 0a0a 2020 2020 2020 2020 5265 7475 726e  ..        Return
+00016de0: 730a 2020 2020 2020 2020 2d2d 2d2d 2d2d  s.        ------
+00016df0: 2d0a 2020 2020 2020 2020 6d65 616e 5f66  -.        mean_f
+00016e00: 6f6c 645f 676f 5f64 6174 6120 3a20 7061  old_go_data : pa
+00016e10: 6e64 6173 2e44 6174 6146 7261 6d65 0a20  ndas.DataFrame. 
+00016e20: 2020 2020 2020 2020 2020 2044 6174 6166             Dataf
+00016e30: 7261 6d65 2077 6974 6820 6d65 616e 2066  rame with mean f
+00016e40: 6f6c 6420 656e 7269 6368 6d65 6e74 2064  old enrichment d
+00016e50: 6174 610a 2020 2020 2020 2020 2222 220a  ata.        """.
+00016e60: 2020 2020 0a20 2020 2020 2020 206d 6561      .        mea
+00016e70: 6e5f 666f 6c64 5f67 6f5f 6461 7461 203d  n_fold_go_data =
+00016e80: 2067 6f5f 6461 7461 2e63 6f70 7928 290a   go_data.copy().
+00016e90: 2020 2020 2020 2020 0a20 2020 2020 2020          .       
+00016ea0: 206d 6561 6e5f 666f 6c64 5f67 6f5f 6461   mean_fold_go_da
+00016eb0: 7461 5b27 4765 6e65 7327 5d20 3d20 6d65  ta['Genes'] = me
+00016ec0: 616e 5f66 6f6c 645f 676f 5f64 6174 615b  an_fold_go_data[
+00016ed0: 2747 656e 6573 275d 2e73 7472 2e73 706c  'Genes'].str.spl
+00016ee0: 6974 2827 3b27 290a 0a20 2020 2020 2020  it(';')..       
+00016ef0: 206d 6561 6e5f 666f 6c64 5f65 6e72 6963   mean_fold_enric
+00016f00: 686d 656e 7420 3d20 5b5d 0a20 2020 2020  hment = [].     
+00016f10: 2020 200a 2020 2020 2020 2020 666f 7220     .        for 
+00016f20: 6765 6e65 7320 696e 206d 6561 6e5f 666f  genes in mean_fo
+00016f30: 6c64 5f67 6f5f 6461 7461 5b27 4765 6e65  ld_go_data['Gene
+00016f40: 7327 5d3a 0a20 2020 2020 2020 2020 2020  s']:.           
+00016f50: 206d 6561 6e5f 6765 6e65 7320 3d20 6663   mean_genes = fc
+00016f60: 5f64 6174 615b 6663 5f64 6174 615b 2747  _data[fc_data['G
+00016f70: 656e 6573 275d 2e69 7369 6e28 6765 6e65  enes'].isin(gene
+00016f80: 7329 5d2e 6d65 616e 280a 2020 2020 2020  s)].mean(.      
+00016f90: 2020 2020 2020 2020 2020 6e75 6d65 7269            numeri
+00016fa0: 635f 6f6e 6c79 3d54 7275 6529 5b30 5d0a  c_only=True)[0].
+00016fb0: 2020 2020 2020 2020 2020 2020 6d65 616e              mean
+00016fc0: 5f66 6f6c 645f 656e 7269 6368 6d65 6e74  _fold_enrichment
+00016fd0: 2e61 7070 656e 6428 6d65 616e 5f67 656e  .append(mean_gen
+00016fe0: 6573 290a 0a20 2020 2020 2020 206d 6561  es)..        mea
+00016ff0: 6e5f 666f 6c64 5f67 6f5f 6461 7461 5b27  n_fold_go_data['
+00017000: 6d65 616e 5f66 6f6c 645f 656e 7269 6368  mean_fold_enrich
+00017010: 6d65 6e74 275d 203d 206d 6561 6e5f 666f  ment'] = mean_fo
+00017020: 6c64 5f65 6e72 6963 686d 656e 740a 2020  ld_enrichment.  
+00017030: 2020 2020 2020 7365 6c66 2e67 6f5f 6461        self.go_da
+00017040: 7461 203d 206d 6561 6e5f 666f 6c64 5f67  ta = mean_fold_g
+00017050: 6f5f 6461 7461 2e63 6f70 7928 290a 2020  o_data.copy().  
+00017060: 2020 2020 2020 7265 7475 726e 206d 6561        return mea
+00017070: 6e5f 666f 6c64 5f67 6f5f 6461 7461 0a20  n_fold_go_data. 
+00017080: 2020 200a 2020 2020 6465 6620 676f 5f74     .    def go_t
+00017090: 6572 6d5f 7363 6174 7465 7270 6c6f 7428  erm_scatterplot(
+000170a0: 7365 6c66 2c20 6d65 616e 5f66 6f6c 645f  self, mean_fold_
+000170b0: 676f 5f64 6174 612c 206e 5f67 6f5f 7465  go_data, n_go_te
+000170c0: 726d 732c 0a20 2020 2020 2020 2020 2020  rms,.           
+000170d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000170e0: 2073 6176 6566 6967 2c20 6164 6469 745f   savefig, addit_
+000170f0: 616e 6e6f 743d 4e6f 6e65 293a 0a20 2020  annot=None):.   
+00017100: 2020 2020 2022 2222 0a0a 2020 2020 2020       """..      
+00017110: 2020 5061 7261 6d65 7465 7273 0a20 2020    Parameters.   
+00017120: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a       ----------.
+00017130: 2020 2020 2020 2020 6d65 616e 5f66 6f6c          mean_fol
+00017140: 645f 676f 5f64 6174 6120 3a20 7061 6e64  d_go_data : pand
+00017150: 6173 2e44 6174 6146 7261 6d65 0a20 2020  as.DataFrame.   
+00017160: 2020 2020 2020 2020 2047 6f20 7465 726d           Go term
+00017170: 2064 6174 6120 7769 7468 206d 6561 6e20   data with mean 
+00017180: 666f 6c64 2065 6e72 6963 686d 656e 7420  fold enrichment 
+00017190: 6461 7461 0a0a 2020 2020 2020 2020 6e5f  data..        n_
+000171a0: 676f 5f74 6572 6d73 203a 2069 6e74 0a20  go_terms : int. 
+000171b0: 2020 2020 2020 2020 2020 204e 756d 6265             Numbe
+000171c0: 7220 6f66 2067 6f20 7465 726d 7320 746f  r of go terms to
+000171d0: 2062 6520 706c 6f74 7465 6420 666f 7220   be plotted for 
+000171e0: 7570 2061 6e64 2064 6f77 6e72 6567 756c  up and downregul
+000171f0: 6174 6564 2067 656e 6573 0a20 2020 2020  ated genes.     
+00017200: 2020 2020 2020 200a 2020 2020 2020 2020         .        
+00017210: 7361 7665 6669 6720 3a20 626f 6f6c 200a  savefig : bool .
+00017220: 2020 2020 2020 2020 2020 2020 4966 2054              If T
+00017230: 7275 6520 7361 7665 2066 6967 7572 650a  rue save figure.
+00017240: 0a20 2020 2020 2020 2061 6464 6974 5f61  .        addit_a
+00017250: 6e6e 6f74 203a 206c 6973 740a 2020 2020  nnot : list.    
+00017260: 2020 2020 2020 2020 2041 6464 6974 696f           Additio
+00017270: 6e61 6c20 476f 2074 6572 6d73 2074 6f20  nal Go terms to 
+00017280: 6265 2061 6e6e 6f74 6174 6564 2028 4465  be annotated (De
+00017290: 6661 756c 7420 7661 6c75 6520 3d20 4e6f  fault value = No
+000172a0: 6e65 290a 0a20 2020 2020 2020 2052 6574  ne)..        Ret
+000172b0: 7572 6e73 0a20 2020 2020 2020 202d 2d2d  urns.        ---
+000172c0: 2d2d 2d2d 0a20 2020 2020 2020 206d 6174  ----.        mat
+000172d0: 706c 6f74 6c69 622e 7079 706c 6f74 2e66  plotlib.pyplot.f
+000172e0: 6967 7572 650a 2020 2020 2020 2020 2020  igure.          
+000172f0: 2020 5363 6174 7465 7270 6c6f 7420 6f66    Scatterplot of
+00017300: 206d 6561 6e20 666f 6c64 2065 6e72 6963   mean fold enric
+00017310: 686d 656e 7420 7673 2e20 6164 6a75 7374  hment vs. adjust
+00017320: 6564 2070 2d76 616c 7565 0a20 2020 2020  ed p-value.     
+00017330: 2020 2022 2222 0a20 2020 200a 2020 2020     """.    .    
+00017340: 2020 2020 6d65 616e 5f66 6f6c 645f 676f      mean_fold_go
+00017350: 5f64 6174 615b 2754 6572 6d27 5d20 3d20  _data['Term'] = 
+00017360: 5b69 2e72 6570 6c61 6365 2827 2027 2c20  [i.replace(' ', 
+00017370: 275c 6e27 290a 2020 2020 2020 2020 2020  '\n').          
+00017380: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017390: 2020 2020 2020 2020 2020 2066 6f72 2069             for i
+000173a0: 2069 6e20 6d65 616e 5f66 6f6c 645f 676f   in mean_fold_go
+000173b0: 5f64 6174 615b 2754 6572 6d27 5d5d 0a20  _data['Term']]. 
+000173c0: 2020 2020 2020 200a 2020 2020 2020 2020         .        
+000173d0: 7769 7468 2073 6e73 2e70 6c6f 7474 696e  with sns.plottin
+000173e0: 675f 636f 6e74 6578 7428 276e 6f74 6562  g_context('noteb
+000173f0: 6f6f 6b27 293a 0a20 2020 2020 2020 2020  ook'):.         
+00017400: 2020 2066 6967 2c20 6178 203d 2070 6c74     fig, ax = plt
+00017410: 2e73 7562 706c 6f74 7328 6669 6773 697a  .subplots(figsiz
+00017420: 653d 2838 2c20 3629 290a 2020 2020 2020  e=(8, 6)).      
+00017430: 2020 2020 2020 6720 3d20 736e 732e 7363        g = sns.sc
+00017440: 6174 7465 7270 6c6f 7428 6461 7461 3d6d  atterplot(data=m
+00017450: 6561 6e5f 666f 6c64 5f67 6f5f 6461 7461  ean_fold_go_data
+00017460: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00017470: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017480: 2020 783d 276d 6561 6e5f 666f 6c64 5f65    x='mean_fold_e
+00017490: 6e72 6963 686d 656e 7427 2c0a 2020 2020  nrichment',.    
+000174a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000174b0: 2020 2020 2020 2020 2020 2020 793d 2741              y='A
+000174c0: 646a 7573 7465 6420 502d 7661 6c75 6527  djusted P-value'
+000174d0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+000174e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000174f0: 2020 7369 7a65 3d27 4f76 6572 6c61 7020    size='Overlap 
+00017500: 696e 2025 272c 0a20 2020 2020 2020 2020  in %',.         
 00017510: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017520: 2020 2020 2020 206d 6561 6e5f 666f 6c64         mean_fold
-00017530: 5f67 6f5f 6461 7461 5b27 5465 726d 275d  _go_data['Term']
-00017540: 5b69 6478 5d2c 0a20 2020 2020 2020 2020  [idx],.         
-00017550: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017560: 2020 2020 2068 613d 2763 656e 7465 7227       ha='center'
-00017570: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00017520: 2020 2020 2020 2068 7565 3d27 436f 6d62         hue='Comb
+00017530: 696e 6564 2053 636f 7265 272c 200a 2020  ined Score', .  
+00017540: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017550: 2020 2020 2020 2020 2020 2020 2020 7369                si
+00017560: 7a65 733d 2832 302c 2032 3030 292c 200a  zes=(20, 200), .
+00017570: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00017580: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017590: 7661 3d27 6365 6e74 6572 272c 0a20 2020  va='center',.   
+00017590: 6178 3d61 782c 0a20 2020 2020 2020 2020  ax=ax,.         
 000175a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000175b0: 2020 2020 2020 2020 2020 2077 7261 703d             wrap=
-000175c0: 5472 7565 2c0a 2020 2020 2020 2020 2020  True,.          
-000175d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000175e0: 2020 2020 666f 6e74 7369 7a65 3d38 2c0a      fontsize=8,.
-000175f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017600: 2020 2020 2020 2020 2020 2020 2020 6262                bb
-00017610: 6f78 3d64 6963 7428 626f 7873 7479 6c65  ox=dict(boxstyle
-00017620: 3d27 726f 756e 6427 2c20 6663 3d27 7727  ='round', fc='w'
-00017630: 2c20 6563 3d27 626c 6163 6b27 2c0a 2020  , ec='black',.  
-00017640: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017650: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017660: 2020 2020 2020 616c 7068 613d 302e 3329        alpha=0.3)
-00017670: 2920 666f 7220 6964 7820 696e 2069 6e64  ) for idx in ind
-00017680: 6963 6573 5d0a 2020 2020 2020 2020 2020  ices].          
-00017690: 2020 6164 6a75 7374 5f74 6578 7428 7465    adjust_text(te
-000176a0: 7874 732c 2061 7272 6f77 7072 6f70 733d  xts, arrowprops=
-000176b0: 6469 6374 2861 7272 6f77 7374 796c 653d  dict(arrowstyle=
-000176c0: 272d 272c 2063 6f6c 6f72 3d27 626c 6163  '-', color='blac
-000176d0: 6b27 2c0a 2020 2020 2020 2020 2020 2020  k',.            
-000176e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000176f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017700: 2020 2061 6c70 6861 3d30 2e33 2929 0a0a     alpha=0.3))..
-00017710: 2020 2020 2020 2020 2020 2020 672e 6c65              g.le
-00017720: 6765 6e64 286c 6f63 3d27 7570 7065 7220  gend(loc='upper 
-00017730: 7269 6768 7427 2c20 6262 6f78 5f74 6f5f  right', bbox_to_
-00017740: 616e 6368 6f72 3d28 312e 332c 2031 2e33  anchor=(1.3, 1.3
-00017750: 292c 206e 636f 6c3d 3129 0a0a 2020 2020  ), ncol=1)..    
-00017760: 2020 2020 2020 2020 6e6f 726d 203d 2070          norm = p
-00017770: 6c74 2e4e 6f72 6d61 6c69 7a65 286d 6561  lt.Normalize(mea
-00017780: 6e5f 666f 6c64 5f67 6f5f 6461 7461 5b27  n_fold_go_data['
-00017790: 436f 6d62 696e 6564 2053 636f 7265 275d  Combined Score']
-000177a0: 2e6d 696e 2829 2c0a 2020 2020 2020 2020  .min(),.        
-000177b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000177c0: 2020 2020 2020 2020 206d 6561 6e5f 666f           mean_fo
-000177d0: 6c64 5f67 6f5f 6461 7461 5b27 436f 6d62  ld_go_data['Comb
-000177e0: 696e 6564 2053 636f 7265 275d 2e6d 6178  ined Score'].max
-000177f0: 2829 290a 2020 2020 2020 2020 2020 2020  ()).            
-00017800: 636d 6170 203d 2073 6e73 2e63 6f6c 6f72  cmap = sns.color
-00017810: 5f70 616c 6574 7465 2822 7669 7269 6469  _palette("viridi
-00017820: 735f 7222 2c20 6173 5f63 6d61 703d 5472  s_r", as_cmap=Tr
-00017830: 7565 290a 2020 2020 2020 2020 2020 2020  ue).            
-00017840: 736d 203d 2070 6c74 2e63 6d2e 5363 616c  sm = plt.cm.Scal
-00017850: 6172 4d61 7070 6162 6c65 2863 6d61 703d  arMappable(cmap=
-00017860: 636d 6170 2c20 6e6f 726d 3d6e 6f72 6d2c  cmap, norm=norm,
-00017870: 290a 0a20 2020 2020 2020 2020 2020 2063  )..            c
-00017880: 6178 203d 2066 6967 2e61 6464 5f61 7865  ax = fig.add_axe
-00017890: 7328 5b61 782e 6765 745f 706f 7369 7469  s([ax.get_positi
-000178a0: 6f6e 2829 2e78 312b 302e 3035 2c0a 2020  on().x1+0.05,.  
-000178b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000178c0: 2020 2020 2020 2020 2020 2020 2020 6178                ax
-000178d0: 2e67 6574 5f70 6f73 6974 696f 6e28 292e  .get_position().
-000178e0: 7930 2c20 302e 3036 2c0a 2020 2020 2020  y0, 0.06,.      
-000178f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017900: 2020 2020 2020 2020 2020 6178 2e67 6574            ax.get
-00017910: 5f70 6f73 6974 696f 6e28 292e 6865 6967  _position().heig
-00017920: 6874 202f 2032 5d29 0a20 2020 2020 2020  ht / 2]).       
-00017930: 2020 2020 2061 782e 6669 6775 7265 2e63       ax.figure.c
-00017940: 6f6c 6f72 6261 7228 736d 2c20 6361 783d  olorbar(sm, cax=
-00017950: 6361 782c 206c 6162 656c 3d22 436f 626d  cax, label="Cobm
-00017960: 696e 6564 2053 636f 7265 2229 2020 2020  ined Score")    
-00017970: 0a0a 2020 2020 2020 2020 2020 2020 736e  ..            sn
-00017980: 732e 6465 7370 696e 6528 290a 2020 2020  s.despine().    
-00017990: 2020 2020 2020 2020 6966 2073 6176 6566          if savef
-000179a0: 6967 2069 7320 5472 7565 3a0a 2020 2020  ig is True:.    
-000179b0: 2020 2020 2020 2020 2020 2020 706c 742e              plt.
-000179c0: 7361 7665 6669 6728 2747 4f5f 7363 6174  savefig('GO_scat
-000179d0: 7465 722e 7064 6627 2c20 6262 6f78 5f69  ter.pdf', bbox_i
-000179e0: 6e63 6865 733d 2774 6967 6874 272c 0a20  nches='tight',. 
+000175b0: 2020 2020 2020 2070 616c 6574 7465 3d27         palette='
+000175c0: 7669 7269 6469 735f 7227 290a 2020 2020  viridis_r').    
+000175d0: 2020 2020 2020 2020 0a20 2020 2020 2020          .       
+000175e0: 2020 2020 2075 705f 676f 5f64 6174 615f       up_go_data_
+000175f0: 6964 7820 3d20 6d65 616e 5f66 6f6c 645f  idx = mean_fold_
+00017600: 676f 5f64 6174 615b 6d65 616e 5f66 6f6c  go_data[mean_fol
+00017610: 645f 676f 5f64 6174 615b 276d 6561 6e5f  d_go_data['mean_
+00017620: 666f 6c64 5f65 6e72 6963 686d 656e 7427  fold_enrichment'
+00017630: 5d20 3e20 305d 2e73 6f72 745f 7661 6c75  ] > 0].sort_valu
+00017640: 6573 2827 436f 6d62 696e 6564 2053 636f  es('Combined Sco
+00017650: 7265 272c 2061 7363 656e 6469 6e67 3d46  re', ascending=F
+00017660: 616c 7365 292e 6865 6164 286e 5f67 6f5f  alse).head(n_go_
+00017670: 7465 726d 7329 2e69 6e64 6578 2e74 6f5f  terms).index.to_
+00017680: 6c69 7374 2829 0a20 2020 2020 2020 2020  list().         
+00017690: 2020 2064 6f77 6e5f 676f 5f64 6174 615f     down_go_data_
+000176a0: 6964 7820 3d20 6d65 616e 5f66 6f6c 645f  idx = mean_fold_
+000176b0: 676f 5f64 6174 615b 6d65 616e 5f66 6f6c  go_data[mean_fol
+000176c0: 645f 676f 5f64 6174 615b 276d 6561 6e5f  d_go_data['mean_
+000176d0: 666f 6c64 5f65 6e72 6963 686d 656e 7427  fold_enrichment'
+000176e0: 5d20 3c20 305d 2e73 6f72 745f 7661 6c75  ] < 0].sort_valu
+000176f0: 6573 2827 436f 6d62 696e 6564 2053 636f  es('Combined Sco
+00017700: 7265 272c 2061 7363 656e 6469 6e67 3d46  re', ascending=F
+00017710: 616c 7365 292e 6865 6164 286e 5f67 6f5f  alse).head(n_go_
+00017720: 7465 726d 7329 2e69 6e64 6578 2e74 6f5f  terms).index.to_
+00017730: 6c69 7374 2829 0a0a 2020 2020 2020 2020  list()..        
+00017740: 2020 2020 6966 2061 6464 6974 5f61 6e6e      if addit_ann
+00017750: 6f74 2069 7320 4e6f 6e65 3a0a 2020 2020  ot is None:.    
+00017760: 2020 2020 2020 2020 2020 2020 696e 6469              indi
+00017770: 6365 7320 3d20 7570 5f67 6f5f 6461 7461  ces = up_go_data
+00017780: 5f69 6478 202b 2064 6f77 6e5f 676f 5f64  _idx + down_go_d
+00017790: 6174 615f 6964 780a 2020 2020 2020 2020  ata_idx.        
+000177a0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+000177b0: 2020 2020 2020 2020 2020 6164 6469 745f            addit_
+000177c0: 616e 6e6f 745f 6964 7820 3d20 6d65 616e  annot_idx = mean
+000177d0: 5f66 6f6c 645f 676f 5f64 6174 615b 6d65  _fold_go_data[me
+000177e0: 616e 5f66 6f6c 645f 676f 5f64 6174 615b  an_fold_go_data[
+000177f0: 2754 6572 6d27 5d2e 7374 722e 636f 6e74  'Term'].str.cont
+00017800: 6169 6e73 2861 6464 6974 5f61 6e6e 6f74  ains(addit_annot
+00017810: 295d 2e69 6e64 6578 2e74 6f5f 6c69 7374  )].index.to_list
+00017820: 2829 0a20 2020 2020 2020 2020 2020 2020  ().             
+00017830: 2020 2069 6e64 6963 6573 203d 2075 705f     indices = up_
+00017840: 676f 5f64 6174 615f 6964 7820 2b20 646f  go_data_idx + do
+00017850: 776e 5f67 6f5f 6461 7461 5f69 6478 202b  wn_go_data_idx +
+00017860: 2061 6464 6974 5f61 6e6e 6f74 5f69 6478   addit_annot_idx
+00017870: 0a20 2020 2020 2020 2020 2020 2074 6578  .            tex
+00017880: 7473 203d 205b 706c 742e 7465 7874 286d  ts = [plt.text(m
+00017890: 6561 6e5f 666f 6c64 5f67 6f5f 6461 7461  ean_fold_go_data
+000178a0: 5b27 6d65 616e 5f66 6f6c 645f 656e 7269  ['mean_fold_enri
+000178b0: 6368 6d65 6e74 275d 5b69 6478 5d2c 0a20  chment'][idx],. 
+000178c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000178d0: 2020 2020 2020 2020 2020 2020 206d 6561               mea
+000178e0: 6e5f 666f 6c64 5f67 6f5f 6461 7461 5b27  n_fold_go_data['
+000178f0: 4164 6a75 7374 6564 2050 2d76 616c 7565  Adjusted P-value
+00017900: 275d 5b69 6478 5d2c 0a20 2020 2020 2020  '][idx],.       
+00017910: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017920: 2020 2020 2020 206d 6561 6e5f 666f 6c64         mean_fold
+00017930: 5f67 6f5f 6461 7461 5b27 5465 726d 275d  _go_data['Term']
+00017940: 5b69 6478 5d2c 0a20 2020 2020 2020 2020  [idx],.         
+00017950: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017960: 2020 2020 2068 613d 2763 656e 7465 7227       ha='center'
+00017970: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00017980: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017990: 7661 3d27 6365 6e74 6572 272c 0a20 2020  va='center',.   
+000179a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000179b0: 2020 2020 2020 2020 2020 2077 7261 703d             wrap=
+000179c0: 5472 7565 2c0a 2020 2020 2020 2020 2020  True,.          
+000179d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000179e0: 2020 2020 666f 6e74 7369 7a65 3d38 2c0a      fontsize=8,.
 000179f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017a00: 2020 2020 2020 2020 2020 2074 7261 6e73             trans
-00017a10: 7061 7265 6e74 3d54 7275 6529 0a20 2020  parent=True).   
-00017a20: 2020 2020 2020 2020 2070 6c74 2e73 686f           plt.sho
-00017a30: 7728 290a 0a20 2020 2064 6566 2065 6e72  w()..    def enr
-00017a40: 6963 686d 656e 745f 616e 616c 7973 6973  ichment_analysis
-00017a50: 5f70 6c6f 7428 7365 6c66 2c20 7570 5f67  _plot(self, up_g
-00017a60: 656e 655f 6c69 7374 2c20 646f 776e 5f67  ene_list, down_g
-00017a70: 656e 655f 6c69 7374 2c20 6f72 6761 6e69  ene_list, organi
-00017a80: 736d 2c0a 2020 2020 2020 2020 2020 2020  sm,.            
-00017a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017aa0: 2020 2020 2067 6f5f 7465 726d 2c20 6663       go_term, fc
-00017ab0: 5f64 6174 612c 206e 5f67 6f5f 7465 726d  _data, n_go_term
-00017ac0: 733d 3135 2c0a 2020 2020 2020 2020 2020  s=15,.          
-00017ad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017ae0: 2020 2020 2020 2073 6176 6566 6967 3d46         savefig=F
-00017af0: 616c 7365 293a 0a20 2020 2020 2020 200a  alse):.        .
-00017b00: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00017b10: 2020 2020 506c 6f74 2065 6e72 6963 686d      Plot enrichm
-00017b20: 656e 7420 616e 616c 7969 7320 7769 7468  ent analyis with
-00017b30: 2066 6f6c 6420 6368 616e 6765 2064 6174   fold change dat
-00017b40: 610a 0a20 2020 2020 2020 2050 6172 616d  a..        Param
-00017b50: 6574 6572 730a 2020 2020 2020 2020 2d2d  eters.        --
-00017b60: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
-00017b70: 2075 705f 6765 6e65 5f6c 6973 7420 3a20   up_gene_list : 
-00017b80: 6c69 7374 0a20 2020 2020 2020 2020 2020  list.           
-00017b90: 204c 6973 7420 6f66 2075 7072 6567 756c   List of upregul
-00017ba0: 6174 6564 2067 656e 6573 0a0a 2020 2020  ated genes..    
-00017bb0: 2020 2020 646f 776e 5f67 656e 655f 6c69      down_gene_li
-00017bc0: 7374 203a 206c 6973 740a 2020 2020 2020  st : list.      
-00017bd0: 2020 2020 2020 4c69 7374 206f 6620 646f        List of do
-00017be0: 776e 7265 6775 6c61 7465 6420 6765 6e65  wnregulated gene
-00017bf0: 730a 0a20 2020 2020 2020 206f 7267 616e  s..        organ
-00017c00: 6973 6d20 3a20 7374 720a 2020 2020 2020  ism : str.      
-00017c10: 2020 2020 2020 4f72 6761 6e69 736d 2066        Organism f
-00017c20: 6f72 2065 6e72 6963 686d 656e 7420 616e  or enrichment an
-00017c30: 616c 7973 6973 0a0a 2020 2020 2020 2020  alysis..        
-00017c40: 676f 5f74 6572 6d20 3a20 696e 740a 2020  go_term : int.  
-00017c50: 2020 2020 2020 2020 2020 2030 2072 6570             0 rep
-00017c60: 7265 7365 6e74 7320 4269 6f6c 6f67 6963  resents Biologic
-00017c70: 616c 2070 726f 6365 7373 2c0a 2020 2020  al process,.    
-00017c80: 2020 2020 2020 2020 2031 2072 6570 7265           1 repre
-00017c90: 7365 6e74 7320 4d6f 6c65 6375 6c61 7220  sents Molecular 
-00017ca0: 6675 6e63 7469 6f6e 2061 6e64 0a20 2020  function and.   
-00017cb0: 2020 2020 2020 2020 2020 3220 7265 7072            2 repr
-00017cc0: 6573 656e 7473 2063 656c 6c75 6c61 7220  esents cellular 
-00017cd0: 636f 6d70 6f6e 656e 740a 2020 2020 2020  component.      
-00017ce0: 2020 2020 2020 2028 4465 6661 756c 7420         (Default 
-00017cf0: 7661 6c75 6520 3d20 3029 0a0a 2020 2020  value = 0)..    
-00017d00: 2020 2020 6663 5f64 6174 6120 3a20 7061      fc_data : pa
-00017d10: 6e64 6173 2e44 6174 6146 7261 6d65 0a20  ndas.DataFrame. 
-00017d20: 2020 2020 2020 2020 2020 2044 6174 6166             Dataf
-00017d30: 7261 6d65 2077 6974 6820 666f 6c64 2063  rame with fold c
-00017d40: 6861 6e67 6520 6461 7461 0a0a 2020 2020  hange data..    
-00017d50: 2020 2020 6e5f 676f 5f74 6572 6d73 203a      n_go_terms :
-00017d60: 2069 6e74 0a20 2020 2020 2020 2020 2020   int.           
-00017d70: 2020 4e75 6d62 6572 7320 6f66 2067 6f20    Numbers of go 
-00017d80: 7465 726d 7320 746f 2062 6520 706c 6f74  terms to be plot
-00017d90: 7465 6420 2844 6566 6175 6c74 2076 616c  ted (Default val
-00017da0: 7565 203d 2031 3529 0a20 2020 2020 2020  ue = 15).       
-00017db0: 2073 6176 6566 6967 203a 2062 6f6f 6c0a   savefig : bool.
-00017dc0: 2020 2020 2020 2020 2020 2020 2049 6620               If 
-00017dd0: 5472 7565 2073 6176 6520 6669 6775 7265  True save figure
-00017de0: 2028 4465 6661 756c 7420 7661 6c75 6520   (Default value 
-00017df0: 3d20 4661 6c73 6529 0a0a 2020 2020 2020  = False)..      
-00017e00: 2020 5265 7475 726e 730a 2020 2020 2020    Returns.      
-00017e10: 2020 2d2d 2d2d 2d2d 2d0a 2020 2020 2020    -------.      
-00017e20: 2020 6d61 7470 6c6f 746c 6962 2e70 7970    matplotlib.pyp
-00017e30: 6c6f 742e 6669 6775 7265 0a20 2020 2020  lot.figure.     
-00017e40: 2020 2022 2222 0a0a 2020 2020 2020 2020     """..        
-00017e50: 676f 5f64 6174 6173 6574 7320 3d20 7365  go_datasets = se
-00017e60: 6c66 2e67 6f5f 656e 7269 6368 6572 2875  lf.go_enricher(u
-00017e70: 705f 6765 6e65 5f6c 6973 743d 7570 5f67  p_gene_list=up_g
-00017e80: 656e 655f 6c69 7374 2c0a 2020 2020 2020  ene_list,.      
+00017a00: 2020 2020 2020 2020 2020 2020 2020 6262                bb
+00017a10: 6f78 3d64 6963 7428 626f 7873 7479 6c65  ox=dict(boxstyle
+00017a20: 3d27 726f 756e 6427 2c20 6663 3d27 7727  ='round', fc='w'
+00017a30: 2c20 6563 3d27 626c 6163 6b27 2c0a 2020  , ec='black',.  
+00017a40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017a50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017a60: 2020 2020 2020 616c 7068 613d 302e 3329        alpha=0.3)
+00017a70: 2920 666f 7220 6964 7820 696e 2069 6e64  ) for idx in ind
+00017a80: 6963 6573 5d0a 2020 2020 2020 2020 2020  ices].          
+00017a90: 2020 6164 6a75 7374 5f74 6578 7428 7465    adjust_text(te
+00017aa0: 7874 732c 2061 7272 6f77 7072 6f70 733d  xts, arrowprops=
+00017ab0: 6469 6374 2861 7272 6f77 7374 796c 653d  dict(arrowstyle=
+00017ac0: 272d 272c 2063 6f6c 6f72 3d27 626c 6163  '-', color='blac
+00017ad0: 6b27 2c0a 2020 2020 2020 2020 2020 2020  k',.            
+00017ae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017af0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017b00: 2020 2061 6c70 6861 3d30 2e33 2929 0a0a     alpha=0.3))..
+00017b10: 2020 2020 2020 2020 2020 2020 672e 6c65              g.le
+00017b20: 6765 6e64 286c 6f63 3d27 7570 7065 7220  gend(loc='upper 
+00017b30: 7269 6768 7427 2c20 6262 6f78 5f74 6f5f  right', bbox_to_
+00017b40: 616e 6368 6f72 3d28 312e 332c 2031 2e33  anchor=(1.3, 1.3
+00017b50: 292c 206e 636f 6c3d 3129 0a0a 2020 2020  ), ncol=1)..    
+00017b60: 2020 2020 2020 2020 6e6f 726d 203d 2070          norm = p
+00017b70: 6c74 2e4e 6f72 6d61 6c69 7a65 286d 6561  lt.Normalize(mea
+00017b80: 6e5f 666f 6c64 5f67 6f5f 6461 7461 5b27  n_fold_go_data['
+00017b90: 436f 6d62 696e 6564 2053 636f 7265 275d  Combined Score']
+00017ba0: 2e6d 696e 2829 2c0a 2020 2020 2020 2020  .min(),.        
+00017bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017bc0: 2020 2020 2020 2020 206d 6561 6e5f 666f           mean_fo
+00017bd0: 6c64 5f67 6f5f 6461 7461 5b27 436f 6d62  ld_go_data['Comb
+00017be0: 696e 6564 2053 636f 7265 275d 2e6d 6178  ined Score'].max
+00017bf0: 2829 290a 2020 2020 2020 2020 2020 2020  ()).            
+00017c00: 636d 6170 203d 2073 6e73 2e63 6f6c 6f72  cmap = sns.color
+00017c10: 5f70 616c 6574 7465 2822 7669 7269 6469  _palette("viridi
+00017c20: 735f 7222 2c20 6173 5f63 6d61 703d 5472  s_r", as_cmap=Tr
+00017c30: 7565 290a 2020 2020 2020 2020 2020 2020  ue).            
+00017c40: 736d 203d 2070 6c74 2e63 6d2e 5363 616c  sm = plt.cm.Scal
+00017c50: 6172 4d61 7070 6162 6c65 2863 6d61 703d  arMappable(cmap=
+00017c60: 636d 6170 2c20 6e6f 726d 3d6e 6f72 6d2c  cmap, norm=norm,
+00017c70: 290a 0a20 2020 2020 2020 2020 2020 2063  )..            c
+00017c80: 6178 203d 2066 6967 2e61 6464 5f61 7865  ax = fig.add_axe
+00017c90: 7328 5b61 782e 6765 745f 706f 7369 7469  s([ax.get_positi
+00017ca0: 6f6e 2829 2e78 312b 302e 3035 2c0a 2020  on().x1+0.05,.  
+00017cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017cc0: 2020 2020 2020 2020 2020 2020 2020 6178                ax
+00017cd0: 2e67 6574 5f70 6f73 6974 696f 6e28 292e  .get_position().
+00017ce0: 7930 2c20 302e 3036 2c0a 2020 2020 2020  y0, 0.06,.      
+00017cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017d00: 2020 2020 2020 2020 2020 6178 2e67 6574            ax.get
+00017d10: 5f70 6f73 6974 696f 6e28 292e 6865 6967  _position().heig
+00017d20: 6874 202f 2032 5d29 0a20 2020 2020 2020  ht / 2]).       
+00017d30: 2020 2020 2061 782e 6669 6775 7265 2e63       ax.figure.c
+00017d40: 6f6c 6f72 6261 7228 736d 2c20 6361 783d  olorbar(sm, cax=
+00017d50: 6361 782c 206c 6162 656c 3d22 436f 626d  cax, label="Cobm
+00017d60: 696e 6564 2053 636f 7265 2229 2020 2020  ined Score")    
+00017d70: 0a0a 2020 2020 2020 2020 2020 2020 736e  ..            sn
+00017d80: 732e 6465 7370 696e 6528 290a 2020 2020  s.despine().    
+00017d90: 2020 2020 2020 2020 6966 2073 6176 6566          if savef
+00017da0: 6967 2069 7320 5472 7565 3a0a 2020 2020  ig is True:.    
+00017db0: 2020 2020 2020 2020 2020 2020 706c 742e              plt.
+00017dc0: 7361 7665 6669 6728 2747 4f5f 7363 6174  savefig('GO_scat
+00017dd0: 7465 722e 7064 6627 2c20 6262 6f78 5f69  ter.pdf', bbox_i
+00017de0: 6e63 6865 733d 2774 6967 6874 272c 0a20  nches='tight',. 
+00017df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017e00: 2020 2020 2020 2020 2020 2074 7261 6e73             trans
+00017e10: 7061 7265 6e74 3d54 7275 6529 0a20 2020  parent=True).   
+00017e20: 2020 2020 2020 2020 2070 6c74 2e73 686f           plt.sho
+00017e30: 7728 290a 0a20 2020 2064 6566 2065 6e72  w()..    def enr
+00017e40: 6963 686d 656e 745f 616e 616c 7973 6973  ichment_analysis
+00017e50: 5f70 6c6f 7428 7365 6c66 2c20 7570 5f67  _plot(self, up_g
+00017e60: 656e 655f 6c69 7374 2c20 646f 776e 5f67  ene_list, down_g
+00017e70: 656e 655f 6c69 7374 2c20 6f72 6761 6e69  ene_list, organi
+00017e80: 736d 2c0a 2020 2020 2020 2020 2020 2020  sm,.            
 00017e90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017eb0: 2064 6f77 6e5f 6765 6e65 5f6c 6973 743d   down_gene_list=
-00017ec0: 646f 776e 5f67 656e 655f 6c69 7374 2c0a  down_gene_list,.
+00017ea0: 2020 2020 2067 6f5f 7465 726d 2c20 6663       go_term, fc
+00017eb0: 5f64 6174 612c 206e 5f67 6f5f 7465 726d  _data, n_go_term
+00017ec0: 733d 3135 2c0a 2020 2020 2020 2020 2020  s=15,.          
 00017ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017ef0: 2020 2020 2020 206f 7267 616e 6973 6d3d         organism=
-00017f00: 6f72 6761 6e69 736d 2c20 676f 5f74 6572  organism, go_ter
-00017f10: 6d3d 676f 5f74 6572 6d29 0a0a 2020 2020  m=go_term)..    
-00017f20: 2020 2020 676f 5f64 6174 6120 3d20 7365      go_data = se
-00017f30: 6c66 2e66 696c 7465 725f 676f 5f62 795f  lf.filter_go_by_
-00017f40: 6c69 6e5f 7369 6d28 676f 5f64 6174 6173  lin_sim(go_datas
-00017f50: 6574 733d 676f 5f64 6174 6173 6574 7329  ets=go_datasets)
-00017f60: 0a0a 2020 2020 2020 2020 6d65 616e 5f66  ..        mean_f
-00017f70: 6f6c 645f 676f 5f64 6174 6120 3d20 7365  old_go_data = se
-00017f80: 6c66 2e63 616c 6375 6c61 7465 5f6d 6561  lf.calculate_mea
-00017f90: 6e5f 666f 6c64 5f65 6e72 6963 686d 656e  n_fold_enrichmen
-00017fa0: 7428 0a20 2020 2020 2020 2020 2020 2067  t(.            g
-00017fb0: 6f5f 6461 7461 3d67 6f5f 6461 7461 2c20  o_data=go_data, 
-00017fc0: 6663 5f64 6174 613d 6663 5f64 6174 6129  fc_data=fc_data)
-00017fd0: 0a0a 2020 2020 2020 2020 7365 6c66 2e67  ..        self.g
-00017fe0: 6f5f 7465 726d 5f73 6361 7474 6572 706c  o_term_scatterpl
-00017ff0: 6f74 286d 6561 6e5f 666f 6c64 5f67 6f5f  ot(mean_fold_go_
-00018000: 6461 7461 3d6d 6561 6e5f 666f 6c64 5f67  data=mean_fold_g
-00018010: 6f5f 6461 7461 2c0a 2020 2020 2020 2020  o_data,.        
-00018020: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018030: 2020 2020 2020 2020 206e 5f67 6f5f 7465           n_go_te
-00018040: 726d 733d 6e5f 676f 5f74 6572 6d73 2c20  rms=n_go_terms, 
-00018050: 7361 7665 6669 673d 7361 7665 6669 6729  savefig=savefig)
-00018060: 0a0a 2020 2020 6465 6620 676f 5f63 6972  ..    def go_cir
-00018070: 636c 655f 706c 6f74 2873 656c 662c 206d  cle_plot(self, m
-00018080: 6561 6e5f 666f 6c64 5f67 6f5f 6461 7461  ean_fold_go_data
-00018090: 2c20 6e5f 676f 5f74 6572 6d73 3d31 302c  , n_go_terms=10,
-000180a0: 2073 6176 6566 6967 3d46 616c 7365 293a   savefig=False):
-000180b0: 0a20 2020 2020 2020 2022 2222 0a0a 2020  .        """..  
-000180c0: 2020 2020 2020 5061 7261 6d65 7465 7273        Parameters
-000180d0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-000180e0: 2d2d 2d0a 2020 2020 2020 2020 6d65 616e  ---.        mean
-000180f0: 5f66 6f6c 645f 676f 5f64 6174 6120 3a20  _fold_go_data : 
-00018100: 7061 6e64 6173 2e44 6174 6146 7261 6d65  pandas.DataFrame
-00018110: 0a20 2020 2020 2020 2020 2020 2047 6f20  .            Go 
-00018120: 7465 726d 2064 6174 6120 7769 7468 206d  term data with m
-00018130: 6561 6e20 666f 6c64 2065 6e72 6963 686d  ean fold enrichm
-00018140: 656e 7420 6461 7461 0a20 2020 2020 2020  ent data.       
-00018150: 2020 2020 200a 2020 2020 2020 2020 6e5f       .        n_
-00018160: 676f 5f74 6572 6d73 203a 2069 6e74 0a20  go_terms : int. 
-00018170: 2020 2020 2020 2020 2020 2020 4e75 6d62              Numb
-00018180: 6572 206f 6620 676f 2074 6572 6d73 2074  er of go terms t
-00018190: 6f20 706c 6f74 2028 4465 6661 756c 7420  o plot (Default 
-000181a0: 7661 6c75 6520 3d20 3130 290a 2020 2020  value = 10).    
-000181b0: 2020 2020 7361 7665 6669 6720 3a20 626f      savefig : bo
-000181c0: 6f6c 0a20 2020 2020 2020 2020 2020 2020  ol.             
-000181d0: 4966 2054 7275 6520 7361 7665 2066 6967  If True save fig
-000181e0: 7572 6520 2844 6566 6175 6c74 2076 616c  ure (Default val
-000181f0: 7565 203d 2046 616c 7365 290a 0a20 2020  ue = False)..   
-00018200: 2020 2020 2052 6574 7572 6e73 0a20 2020       Returns.   
-00018210: 2020 2020 202d 2d2d 2d2d 2d2d 0a20 2020       -------.   
-00018220: 2020 2020 2063 6972 636f 7320 706c 6f74       circos plot
-00018230: 0a20 2020 2020 2020 2022 2222 0a0a 2020  .        """..  
-00018240: 2020 2020 2020 6672 6f6d 2070 7963 6972        from pycir
-00018250: 636c 697a 6520 696d 706f 7274 2043 6972  clize import Cir
-00018260: 636f 730a 2020 2020 2020 2020 6672 6f6d  cos.        from
-00018270: 2070 7963 6972 636c 697a 652e 7061 7273   pycirclize.pars
-00018280: 6572 2069 6d70 6f72 7420 4d61 7472 6978  er import Matrix
-00018290: 0a20 2020 2020 2020 200a 2020 2020 2020  .        .      
-000182a0: 2020 6d65 616e 5f66 6f6c 645f 676f 5f64    mean_fold_go_d
-000182b0: 6174 615b 2754 6572 6d27 5d20 3d20 5b74  ata['Term'] = [t
-000182c0: 6578 7477 7261 702e 6669 6c6c 2869 2c20  extwrap.fill(i, 
-000182d0: 3330 290a 2020 2020 2020 2020 2020 2020  30).            
+00017ee0: 2020 2020 2020 2073 6176 6566 6967 3d46         savefig=F
+00017ef0: 616c 7365 293a 0a20 2020 2020 2020 200a  alse):.        .
+00017f00: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00017f10: 2020 2020 506c 6f74 2065 6e72 6963 686d      Plot enrichm
+00017f20: 656e 7420 616e 616c 7969 7320 7769 7468  ent analyis with
+00017f30: 2066 6f6c 6420 6368 616e 6765 2064 6174   fold change dat
+00017f40: 610a 0a20 2020 2020 2020 2050 6172 616d  a..        Param
+00017f50: 6574 6572 730a 2020 2020 2020 2020 2d2d  eters.        --
+00017f60: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+00017f70: 2075 705f 6765 6e65 5f6c 6973 7420 3a20   up_gene_list : 
+00017f80: 6c69 7374 0a20 2020 2020 2020 2020 2020  list.           
+00017f90: 204c 6973 7420 6f66 2075 7072 6567 756c   List of upregul
+00017fa0: 6174 6564 2067 656e 6573 0a0a 2020 2020  ated genes..    
+00017fb0: 2020 2020 646f 776e 5f67 656e 655f 6c69      down_gene_li
+00017fc0: 7374 203a 206c 6973 740a 2020 2020 2020  st : list.      
+00017fd0: 2020 2020 2020 4c69 7374 206f 6620 646f        List of do
+00017fe0: 776e 7265 6775 6c61 7465 6420 6765 6e65  wnregulated gene
+00017ff0: 730a 0a20 2020 2020 2020 206f 7267 616e  s..        organ
+00018000: 6973 6d20 3a20 7374 720a 2020 2020 2020  ism : str.      
+00018010: 2020 2020 2020 4f72 6761 6e69 736d 2066        Organism f
+00018020: 6f72 2065 6e72 6963 686d 656e 7420 616e  or enrichment an
+00018030: 616c 7973 6973 0a0a 2020 2020 2020 2020  alysis..        
+00018040: 676f 5f74 6572 6d20 3a20 696e 740a 2020  go_term : int.  
+00018050: 2020 2020 2020 2020 2020 2030 2072 6570             0 rep
+00018060: 7265 7365 6e74 7320 4269 6f6c 6f67 6963  resents Biologic
+00018070: 616c 2070 726f 6365 7373 2c0a 2020 2020  al process,.    
+00018080: 2020 2020 2020 2020 2031 2072 6570 7265           1 repre
+00018090: 7365 6e74 7320 4d6f 6c65 6375 6c61 7220  sents Molecular 
+000180a0: 6675 6e63 7469 6f6e 2061 6e64 0a20 2020  function and.   
+000180b0: 2020 2020 2020 2020 2020 3220 7265 7072            2 repr
+000180c0: 6573 656e 7473 2063 656c 6c75 6c61 7220  esents cellular 
+000180d0: 636f 6d70 6f6e 656e 740a 2020 2020 2020  component.      
+000180e0: 2020 2020 2020 2028 4465 6661 756c 7420         (Default 
+000180f0: 7661 6c75 6520 3d20 3029 0a0a 2020 2020  value = 0)..    
+00018100: 2020 2020 6663 5f64 6174 6120 3a20 7061      fc_data : pa
+00018110: 6e64 6173 2e44 6174 6146 7261 6d65 0a20  ndas.DataFrame. 
+00018120: 2020 2020 2020 2020 2020 2044 6174 6166             Dataf
+00018130: 7261 6d65 2077 6974 6820 666f 6c64 2063  rame with fold c
+00018140: 6861 6e67 6520 6461 7461 0a0a 2020 2020  hange data..    
+00018150: 2020 2020 6e5f 676f 5f74 6572 6d73 203a      n_go_terms :
+00018160: 2069 6e74 0a20 2020 2020 2020 2020 2020   int.           
+00018170: 2020 4e75 6d62 6572 7320 6f66 2067 6f20    Numbers of go 
+00018180: 7465 726d 7320 746f 2062 6520 706c 6f74  terms to be plot
+00018190: 7465 6420 2844 6566 6175 6c74 2076 616c  ted (Default val
+000181a0: 7565 203d 2031 3529 0a20 2020 2020 2020  ue = 15).       
+000181b0: 2073 6176 6566 6967 203a 2062 6f6f 6c0a   savefig : bool.
+000181c0: 2020 2020 2020 2020 2020 2020 2049 6620               If 
+000181d0: 5472 7565 2073 6176 6520 6669 6775 7265  True save figure
+000181e0: 2028 4465 6661 756c 7420 7661 6c75 6520   (Default value 
+000181f0: 3d20 4661 6c73 6529 0a0a 2020 2020 2020  = False)..      
+00018200: 2020 5265 7475 726e 730a 2020 2020 2020    Returns.      
+00018210: 2020 2d2d 2d2d 2d2d 2d0a 2020 2020 2020    -------.      
+00018220: 2020 6d61 7470 6c6f 746c 6962 2e70 7970    matplotlib.pyp
+00018230: 6c6f 742e 6669 6775 7265 0a20 2020 2020  lot.figure.     
+00018240: 2020 2022 2222 0a0a 2020 2020 2020 2020     """..        
+00018250: 676f 5f64 6174 6173 6574 7320 3d20 7365  go_datasets = se
+00018260: 6c66 2e67 6f5f 656e 7269 6368 6572 2875  lf.go_enricher(u
+00018270: 705f 6765 6e65 5f6c 6973 743d 7570 5f67  p_gene_list=up_g
+00018280: 656e 655f 6c69 7374 2c0a 2020 2020 2020  ene_list,.      
+00018290: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000182a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000182b0: 2064 6f77 6e5f 6765 6e65 5f6c 6973 743d   down_gene_list=
+000182c0: 646f 776e 5f67 656e 655f 6c69 7374 2c0a  down_gene_list,.
+000182d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000182e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000182f0: 2020 2020 2020 2020 2066 6f72 2069 2069           for i i
-00018300: 6e20 6d65 616e 5f66 6f6c 645f 676f 5f64  n mean_fold_go_d
-00018310: 6174 615b 2754 6572 6d27 5d5d 0a20 2020  ata['Term']].   
-00018320: 2020 2020 200a 2020 2020 2020 2020 7570       .        up
-00018330: 7265 675f 676f 5f64 6174 6120 3d20 6d65  reg_go_data = me
-00018340: 616e 5f66 6f6c 645f 676f 5f64 6174 615b  an_fold_go_data[
-00018350: 6d65 616e 5f66 6f6c 645f 676f 5f64 6174  mean_fold_go_dat
-00018360: 615b 276d 6561 6e5f 666f 6c64 5f65 6e72  a['mean_fold_enr
-00018370: 6963 686d 656e 7427 5d20 3e20 305d 0a20  ichment'] > 0]. 
-00018380: 2020 2020 2020 2064 6f77 6e72 6567 5f67         downreg_g
-00018390: 6f5f 6461 7461 203d 206d 6561 6e5f 666f  o_data = mean_fo
-000183a0: 6c64 5f67 6f5f 6461 7461 5b6d 6561 6e5f  ld_go_data[mean_
-000183b0: 666f 6c64 5f67 6f5f 6461 7461 5b27 6d65  fold_go_data['me
-000183c0: 616e 5f66 6f6c 645f 656e 7269 6368 6d65  an_fold_enrichme
-000183d0: 6e74 275d 203c 2030 5d0a 0a20 2020 2020  nt'] < 0]..     
-000183e0: 2020 2066 6f72 2069 6478 2c20 2072 6567     for idx,  reg
-000183f0: 5f67 6f5f 6461 7461 2069 6e20 656e 756d  _go_data in enum
-00018400: 6572 6174 6528 5b75 7072 6567 5f67 6f5f  erate([upreg_go_
-00018410: 6461 7461 2c20 646f 776e 7265 675f 676f  data, downreg_go
-00018420: 5f64 6174 615d 293a 0a0a 2020 2020 2020  _data]):..      
-00018430: 2020 2020 2020 7465 7374 5f64 6174 6120        test_data 
-00018440: 3d20 7265 675f 676f 5f64 6174 612e 736f  = reg_go_data.so
-00018450: 7274 5f76 616c 7565 7328 2743 6f6d 6269  rt_values('Combi
-00018460: 6e65 6420 5363 6f72 6527 2c0a 2020 2020  ned Score',.    
-00018470: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018480: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018490: 2020 2020 2020 2020 2020 2020 6173 6365              asce
-000184a0: 6e64 696e 673d 4661 6c73 6529 2e68 6561  nding=False).hea
-000184b0: 6428 6e5f 676f 5f74 6572 6d73 292e 636f  d(n_go_terms).co
-000184c0: 7079 2829 0a0a 2020 2020 2020 2020 2020  py()..          
-000184d0: 2020 756e 6971 7565 5f67 656e 6573 203d    unique_genes =
-000184e0: 2073 6574 285b 6765 6e65 2066 6f72 2067   set([gene for g
-000184f0: 656e 6573 2069 6e20 7465 7374 5f64 6174  enes in test_dat
-00018500: 615b 2747 656e 6573 275d 0a20 2020 2020  a['Genes'].     
-00018510: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018520: 2020 2020 2020 2020 2020 2066 6f72 2067             for g
-00018530: 656e 6520 696e 2067 656e 6573 5d29 0a0a  ene in genes])..
-00018540: 2020 2020 2020 2020 2020 2020 6d61 7472              matr
-00018550: 6978 203d 2070 642e 4461 7461 4672 616d  ix = pd.DataFram
-00018560: 6528 5b5b 6765 6e65 2c20 7465 7374 5f64  e([[gene, test_d
-00018570: 6174 615b 2754 6572 6d27 5d2e 696c 6f63  ata['Term'].iloc
-00018580: 5b69 6478 5d2c 2031 5d0a 2020 2020 2020  [idx], 1].      
-00018590: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000185a0: 2020 2020 2020 2020 2020 2020 2066 6f72               for
-000185b0: 2067 656e 6520 696e 2075 6e69 7175 655f   gene in unique_
-000185c0: 6765 6e65 730a 2020 2020 2020 2020 2020  genes.          
-000185d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000185e0: 2020 2020 2020 2020 2066 6f72 2069 6478           for idx
-000185f0: 2c20 6765 6e65 5f73 6574 2069 6e20 2065  , gene_set in  e
-00018600: 6e75 6d65 7261 7465 2874 6573 745f 6461  numerate(test_da
-00018610: 7461 5b27 4765 6e65 7327 5d29 0a20 2020  ta['Genes']).   
-00018620: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018630: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018640: 6966 2067 656e 6520 696e 2067 656e 655f  if gene in gene_
-00018650: 7365 745d 2c20 636f 6c75 6d6e 733d 5b22  set], columns=["
-00018660: 6672 6f6d 222c 2022 746f 222c 2022 7661  from", "to", "va
-00018670: 6c75 6522 5d29 0a20 2020 2020 2020 2020  lue"]).         
-00018680: 2020 2020 2020 2020 2020 200a 2020 2020             .    
-00018690: 2020 2020 2020 2020 6d61 7472 6978 5f64          matrix_d
-000186a0: 6620 3d20 4d61 7472 6978 2e70 6172 7365  f = Matrix.parse
-000186b0: 5f66 726f 6d74 6f5f 7461 626c 6528 6d61  _fromto_table(ma
-000186c0: 7472 6978 2e73 6f72 745f 7661 6c75 6573  trix.sort_values
-000186d0: 2827 746f 2729 290a 0a20 2020 2020 2020  ('to'))..       
-000186e0: 2020 2020 2067 6f5f 7465 726d 735f 736f       go_terms_so
-000186f0: 7274 6564 203d 206c 6973 7428 6d61 7472  rted = list(matr
-00018700: 6978 5b27 746f 275d 2e75 6e69 7175 6528  ix['to'].unique(
-00018710: 2929 0a20 2020 2020 2020 2020 2020 2073  )).            s
-00018720: 6f72 7465 645f 6765 6e65 7320 3d20 736f  orted_genes = so
-00018730: 7274 6564 2843 6f75 6e74 6572 286d 6174  rted(Counter(mat
-00018740: 7269 785b 2766 726f 6d27 5d29 2e69 7465  rix['from']).ite
-00018750: 6d73 2829 2c20 6b65 793d 6c61 6d62 6461  ms(), key=lambda
-00018760: 2078 3a20 785b 315d 2c20 7265 7665 7273   x: x[1], revers
-00018770: 653d 5472 7565 290a 2020 2020 2020 2020  e=True).        
-00018780: 2020 2020 736f 7274 6564 5f67 656e 6573      sorted_genes
-00018790: 203d 205b 695b 305d 2066 6f72 2069 2069   = [i[0] for i i
-000187a0: 6e20 736f 7274 6564 5f67 656e 6573 5d0a  n sorted_genes].
-000187b0: 0a20 2020 2020 2020 2020 2020 2063 6972  .            cir
-000187c0: 636f 7320 3d20 4369 7263 6f73 2e69 6e69  cos = Circos.ini
-000187d0: 7469 616c 697a 655f 6672 6f6d 5f6d 6174  tialize_from_mat
-000187e0: 7269 7828 0a20 2020 2020 2020 2020 2020  rix(.           
-000187f0: 2020 2020 206d 6174 7269 785f 6466 2c0a       matrix_df,.
-00018800: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018810: 7370 6163 653d 312c 0a20 2020 2020 2020  space=1,.       
-00018820: 2020 2020 2020 2020 2063 6d61 703d 2274           cmap="t
-00018830: 6162 3230 222c 0a20 2020 2020 2020 2020  ab20",.         
-00018840: 2020 2020 2020 206c 6162 656c 5f6b 7773         label_kws
-00018850: 3d64 6963 7428 7369 7a65 3d36 2c20 723d  =dict(size=6, r=
-00018860: 3130 322c 206f 7269 656e 7461 7469 6f6e  102, orientation
-00018870: 3d22 7665 7274 6963 616c 2229 2c0a 2020  ="vertical"),.  
-00018880: 2020 2020 2020 2020 2020 2020 2020 6c69                li
-00018890: 6e6b 5f6b 7773 3d64 6963 7428 6469 7265  nk_kws=dict(dire
-000188a0: 6374 696f 6e3d 312c 2065 633d 2262 6c61  ction=1, ec="bla
-000188b0: 636b 222c 206c 773d 3029 2c0a 2020 2020  ck", lw=0),.    
-000188c0: 2020 2020 2020 2020 2020 2020 6f72 6465              orde
-000188d0: 7220 3d20 676f 5f74 6572 6d73 5f73 6f72  r = go_terms_sor
-000188e0: 7465 6420 202b 2073 6f72 7465 645f 6765  ted  + sorted_ge
-000188f0: 6e65 730a 2020 2020 2020 2020 2020 2020  nes.            
-00018900: 290a 2020 2020 2020 2020 2020 2020 6669  ).            fi
-00018910: 6720 3d20 6369 7263 6f73 2e70 6c6f 7466  g = circos.plotf
-00018920: 6967 2829 0a0a 2020 2020 2020 2020 2020  ig()..          
-00018930: 2020 6966 2069 6478 203d 3d20 303a 0a20    if idx == 0:. 
-00018940: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-00018950: 6c74 2e74 6974 6c65 2827 5570 7265 6775  lt.title('Upregu
-00018960: 6c61 7465 6420 7072 6f74 6569 6e73 2729  lated proteins')
-00018970: 0a0a 2020 2020 2020 2020 2020 2020 656c  ..            el
-00018980: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-00018990: 2020 2020 706c 742e 7469 746c 6528 2744      plt.title('D
-000189a0: 6f77 6e72 6567 756c 6174 6564 2070 726f  ownregulated pro
-000189b0: 7465 696e 7327 290a 2020 2020 2020 2020  teins').        
-000189c0: 2020 2020 6966 2073 6176 6566 6967 203d      if savefig =
-000189d0: 3d20 5472 7565 3a0a 2020 2020 2020 2020  = True:.        
-000189e0: 2020 2020 2020 2020 706c 742e 7361 7665          plt.save
-000189f0: 6669 6728 6627 7b69 6478 7d5f 6369 7263  fig(f'{idx}_circ
-00018a00: 6c65 5f70 6c6f 742e 7064 6627 2c20 6262  le_plot.pdf', bb
-00018a10: 6f78 5f69 6e63 6865 733d 2774 6967 6874  ox_inches='tight
-00018a20: 2729 0a20 2020 2000 0000 0000 0000 0000  ').    .........
-00018a30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018a40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018a50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018a60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018a70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018a80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018a90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018aa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018ab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018ac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018ad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018ae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018af0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018b00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018b10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018b20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018b30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018b40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018b50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018b60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018b70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018b80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018b90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018ba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018bb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018bc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018bd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018be0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018bf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018c00: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-00018c10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018c20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018c30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018c40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018c50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018c60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-00018c70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00018c80: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
-00018c90: 3030 3000 3031 3032 3133 0020 7800 0000  000.010213. x...
-00018ca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018cb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018cc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018cd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018ce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018cf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018d00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-00018d10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018d20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018d30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018d40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018d50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018d60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018d70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018d80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018d90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018da0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018db0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018dc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018dd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018de0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018df0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018e00: 3232 206d 7469 6d65 3d31 3638 3834 3937  22 mtime=1688497
-00018e10: 3330 392e 300a 0000 0000 0000 0000 0000  309.0...........
-00018e20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000182f0: 2020 2020 2020 206f 7267 616e 6973 6d3d         organism=
+00018300: 6f72 6761 6e69 736d 2c20 676f 5f74 6572  organism, go_ter
+00018310: 6d3d 676f 5f74 6572 6d29 0a0a 2020 2020  m=go_term)..    
+00018320: 2020 2020 676f 5f64 6174 6120 3d20 7365      go_data = se
+00018330: 6c66 2e66 696c 7465 725f 676f 5f62 795f  lf.filter_go_by_
+00018340: 6c69 6e5f 7369 6d28 676f 5f64 6174 6173  lin_sim(go_datas
+00018350: 6574 733d 676f 5f64 6174 6173 6574 7329  ets=go_datasets)
+00018360: 0a0a 2020 2020 2020 2020 6d65 616e 5f66  ..        mean_f
+00018370: 6f6c 645f 676f 5f64 6174 6120 3d20 7365  old_go_data = se
+00018380: 6c66 2e63 616c 6375 6c61 7465 5f6d 6561  lf.calculate_mea
+00018390: 6e5f 666f 6c64 5f65 6e72 6963 686d 656e  n_fold_enrichmen
+000183a0: 7428 0a20 2020 2020 2020 2020 2020 2067  t(.            g
+000183b0: 6f5f 6461 7461 3d67 6f5f 6461 7461 2c20  o_data=go_data, 
+000183c0: 6663 5f64 6174 613d 6663 5f64 6174 6129  fc_data=fc_data)
+000183d0: 0a0a 2020 2020 2020 2020 7365 6c66 2e67  ..        self.g
+000183e0: 6f5f 7465 726d 5f73 6361 7474 6572 706c  o_term_scatterpl
+000183f0: 6f74 286d 6561 6e5f 666f 6c64 5f67 6f5f  ot(mean_fold_go_
+00018400: 6461 7461 3d6d 6561 6e5f 666f 6c64 5f67  data=mean_fold_g
+00018410: 6f5f 6461 7461 2c0a 2020 2020 2020 2020  o_data,.        
+00018420: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018430: 2020 2020 2020 2020 206e 5f67 6f5f 7465           n_go_te
+00018440: 726d 733d 6e5f 676f 5f74 6572 6d73 2c20  rms=n_go_terms, 
+00018450: 7361 7665 6669 673d 7361 7665 6669 6729  savefig=savefig)
+00018460: 0a0a 2020 2020 6465 6620 676f 5f63 6972  ..    def go_cir
+00018470: 636c 655f 706c 6f74 2873 656c 662c 206d  cle_plot(self, m
+00018480: 6561 6e5f 666f 6c64 5f67 6f5f 6461 7461  ean_fold_go_data
+00018490: 2c20 6e5f 676f 5f74 6572 6d73 3d31 302c  , n_go_terms=10,
+000184a0: 2073 6176 6566 6967 3d46 616c 7365 293a   savefig=False):
+000184b0: 0a20 2020 2020 2020 2022 2222 0a0a 2020  .        """..  
+000184c0: 2020 2020 2020 5061 7261 6d65 7465 7273        Parameters
+000184d0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+000184e0: 2d2d 2d0a 2020 2020 2020 2020 6d65 616e  ---.        mean
+000184f0: 5f66 6f6c 645f 676f 5f64 6174 6120 3a20  _fold_go_data : 
+00018500: 7061 6e64 6173 2e44 6174 6146 7261 6d65  pandas.DataFrame
+00018510: 0a20 2020 2020 2020 2020 2020 2047 6f20  .            Go 
+00018520: 7465 726d 2064 6174 6120 7769 7468 206d  term data with m
+00018530: 6561 6e20 666f 6c64 2065 6e72 6963 686d  ean fold enrichm
+00018540: 656e 7420 6461 7461 0a20 2020 2020 2020  ent data.       
+00018550: 2020 2020 200a 2020 2020 2020 2020 6e5f       .        n_
+00018560: 676f 5f74 6572 6d73 203a 2069 6e74 0a20  go_terms : int. 
+00018570: 2020 2020 2020 2020 2020 2020 4e75 6d62              Numb
+00018580: 6572 206f 6620 676f 2074 6572 6d73 2074  er of go terms t
+00018590: 6f20 706c 6f74 2028 4465 6661 756c 7420  o plot (Default 
+000185a0: 7661 6c75 6520 3d20 3130 290a 2020 2020  value = 10).    
+000185b0: 2020 2020 7361 7665 6669 6720 3a20 626f      savefig : bo
+000185c0: 6f6c 0a20 2020 2020 2020 2020 2020 2020  ol.             
+000185d0: 4966 2054 7275 6520 7361 7665 2066 6967  If True save fig
+000185e0: 7572 6520 2844 6566 6175 6c74 2076 616c  ure (Default val
+000185f0: 7565 203d 2046 616c 7365 290a 0a20 2020  ue = False)..   
+00018600: 2020 2020 2052 6574 7572 6e73 0a20 2020       Returns.   
+00018610: 2020 2020 202d 2d2d 2d2d 2d2d 0a20 2020       -------.   
+00018620: 2020 2020 2063 6972 636f 7320 706c 6f74       circos plot
+00018630: 0a20 2020 2020 2020 2022 2222 0a0a 2020  .        """..  
+00018640: 2020 2020 2020 6672 6f6d 2070 7963 6972        from pycir
+00018650: 636c 697a 6520 696d 706f 7274 2043 6972  clize import Cir
+00018660: 636f 730a 2020 2020 2020 2020 6672 6f6d  cos.        from
+00018670: 2070 7963 6972 636c 697a 652e 7061 7273   pycirclize.pars
+00018680: 6572 2069 6d70 6f72 7420 4d61 7472 6978  er import Matrix
+00018690: 0a20 2020 2020 2020 200a 2020 2020 2020  .        .      
+000186a0: 2020 6d65 616e 5f66 6f6c 645f 676f 5f64    mean_fold_go_d
+000186b0: 6174 615b 2754 6572 6d27 5d20 3d20 5b74  ata['Term'] = [t
+000186c0: 6578 7477 7261 702e 6669 6c6c 2869 2c20  extwrap.fill(i, 
+000186d0: 3330 290a 2020 2020 2020 2020 2020 2020  30).            
+000186e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000186f0: 2020 2020 2020 2020 2066 6f72 2069 2069           for i i
+00018700: 6e20 6d65 616e 5f66 6f6c 645f 676f 5f64  n mean_fold_go_d
+00018710: 6174 615b 2754 6572 6d27 5d5d 0a20 2020  ata['Term']].   
+00018720: 2020 2020 200a 2020 2020 2020 2020 7570       .        up
+00018730: 7265 675f 676f 5f64 6174 6120 3d20 6d65  reg_go_data = me
+00018740: 616e 5f66 6f6c 645f 676f 5f64 6174 615b  an_fold_go_data[
+00018750: 6d65 616e 5f66 6f6c 645f 676f 5f64 6174  mean_fold_go_dat
+00018760: 615b 276d 6561 6e5f 666f 6c64 5f65 6e72  a['mean_fold_enr
+00018770: 6963 686d 656e 7427 5d20 3e20 305d 0a20  ichment'] > 0]. 
+00018780: 2020 2020 2020 2064 6f77 6e72 6567 5f67         downreg_g
+00018790: 6f5f 6461 7461 203d 206d 6561 6e5f 666f  o_data = mean_fo
+000187a0: 6c64 5f67 6f5f 6461 7461 5b6d 6561 6e5f  ld_go_data[mean_
+000187b0: 666f 6c64 5f67 6f5f 6461 7461 5b27 6d65  fold_go_data['me
+000187c0: 616e 5f66 6f6c 645f 656e 7269 6368 6d65  an_fold_enrichme
+000187d0: 6e74 275d 203c 2030 5d0a 0a20 2020 2020  nt'] < 0]..     
+000187e0: 2020 2066 6f72 2069 6478 2c20 2072 6567     for idx,  reg
+000187f0: 5f67 6f5f 6461 7461 2069 6e20 656e 756d  _go_data in enum
+00018800: 6572 6174 6528 5b75 7072 6567 5f67 6f5f  erate([upreg_go_
+00018810: 6461 7461 2c20 646f 776e 7265 675f 676f  data, downreg_go
+00018820: 5f64 6174 615d 293a 0a0a 2020 2020 2020  _data]):..      
+00018830: 2020 2020 2020 7465 7374 5f64 6174 6120        test_data 
+00018840: 3d20 7265 675f 676f 5f64 6174 612e 736f  = reg_go_data.so
+00018850: 7274 5f76 616c 7565 7328 2743 6f6d 6269  rt_values('Combi
+00018860: 6e65 6420 5363 6f72 6527 2c0a 2020 2020  ned Score',.    
+00018870: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018880: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018890: 2020 2020 2020 2020 2020 2020 6173 6365              asce
+000188a0: 6e64 696e 673d 4661 6c73 6529 2e68 6561  nding=False).hea
+000188b0: 6428 6e5f 676f 5f74 6572 6d73 292e 636f  d(n_go_terms).co
+000188c0: 7079 2829 0a0a 2020 2020 2020 2020 2020  py()..          
+000188d0: 2020 756e 6971 7565 5f67 656e 6573 203d    unique_genes =
+000188e0: 2073 6574 285b 6765 6e65 2066 6f72 2067   set([gene for g
+000188f0: 656e 6573 2069 6e20 7465 7374 5f64 6174  enes in test_dat
+00018900: 615b 2747 656e 6573 275d 0a20 2020 2020  a['Genes'].     
+00018910: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018920: 2020 2020 2020 2020 2020 2066 6f72 2067             for g
+00018930: 656e 6520 696e 2067 656e 6573 5d29 0a0a  ene in genes])..
+00018940: 2020 2020 2020 2020 2020 2020 6d61 7472              matr
+00018950: 6978 203d 2070 642e 4461 7461 4672 616d  ix = pd.DataFram
+00018960: 6528 5b5b 6765 6e65 2c20 7465 7374 5f64  e([[gene, test_d
+00018970: 6174 615b 2754 6572 6d27 5d2e 696c 6f63  ata['Term'].iloc
+00018980: 5b69 6478 5d2c 2031 5d0a 2020 2020 2020  [idx], 1].      
+00018990: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000189a0: 2020 2020 2020 2020 2020 2020 2066 6f72               for
+000189b0: 2067 656e 6520 696e 2075 6e69 7175 655f   gene in unique_
+000189c0: 6765 6e65 730a 2020 2020 2020 2020 2020  genes.          
+000189d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000189e0: 2020 2020 2020 2020 2066 6f72 2069 6478           for idx
+000189f0: 2c20 6765 6e65 5f73 6574 2069 6e20 2065  , gene_set in  e
+00018a00: 6e75 6d65 7261 7465 2874 6573 745f 6461  numerate(test_da
+00018a10: 7461 5b27 4765 6e65 7327 5d29 0a20 2020  ta['Genes']).   
+00018a20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018a30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018a40: 6966 2067 656e 6520 696e 2067 656e 655f  if gene in gene_
+00018a50: 7365 745d 2c20 636f 6c75 6d6e 733d 5b22  set], columns=["
+00018a60: 6672 6f6d 222c 2022 746f 222c 2022 7661  from", "to", "va
+00018a70: 6c75 6522 5d29 0a20 2020 2020 2020 2020  lue"]).         
+00018a80: 2020 2020 2020 2020 2020 200a 2020 2020             .    
+00018a90: 2020 2020 2020 2020 6d61 7472 6978 5f64          matrix_d
+00018aa0: 6620 3d20 4d61 7472 6978 2e70 6172 7365  f = Matrix.parse
+00018ab0: 5f66 726f 6d74 6f5f 7461 626c 6528 6d61  _fromto_table(ma
+00018ac0: 7472 6978 2e73 6f72 745f 7661 6c75 6573  trix.sort_values
+00018ad0: 2827 746f 2729 290a 0a20 2020 2020 2020  ('to'))..       
+00018ae0: 2020 2020 2067 6f5f 7465 726d 735f 736f       go_terms_so
+00018af0: 7274 6564 203d 206c 6973 7428 6d61 7472  rted = list(matr
+00018b00: 6978 5b27 746f 275d 2e75 6e69 7175 6528  ix['to'].unique(
+00018b10: 2929 0a20 2020 2020 2020 2020 2020 2073  )).            s
+00018b20: 6f72 7465 645f 6765 6e65 7320 3d20 736f  orted_genes = so
+00018b30: 7274 6564 2843 6f75 6e74 6572 286d 6174  rted(Counter(mat
+00018b40: 7269 785b 2766 726f 6d27 5d29 2e69 7465  rix['from']).ite
+00018b50: 6d73 2829 2c20 6b65 793d 6c61 6d62 6461  ms(), key=lambda
+00018b60: 2078 3a20 785b 315d 2c20 7265 7665 7273   x: x[1], revers
+00018b70: 653d 5472 7565 290a 2020 2020 2020 2020  e=True).        
+00018b80: 2020 2020 736f 7274 6564 5f67 656e 6573      sorted_genes
+00018b90: 203d 205b 695b 305d 2066 6f72 2069 2069   = [i[0] for i i
+00018ba0: 6e20 736f 7274 6564 5f67 656e 6573 5d0a  n sorted_genes].
+00018bb0: 0a20 2020 2020 2020 2020 2020 2063 6972  .            cir
+00018bc0: 636f 7320 3d20 4369 7263 6f73 2e69 6e69  cos = Circos.ini
+00018bd0: 7469 616c 697a 655f 6672 6f6d 5f6d 6174  tialize_from_mat
+00018be0: 7269 7828 0a20 2020 2020 2020 2020 2020  rix(.           
+00018bf0: 2020 2020 206d 6174 7269 785f 6466 2c0a       matrix_df,.
+00018c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018c10: 7370 6163 653d 312c 0a20 2020 2020 2020  space=1,.       
+00018c20: 2020 2020 2020 2020 2063 6d61 703d 2274           cmap="t
+00018c30: 6162 3230 222c 0a20 2020 2020 2020 2020  ab20",.         
+00018c40: 2020 2020 2020 206c 6162 656c 5f6b 7773         label_kws
+00018c50: 3d64 6963 7428 7369 7a65 3d36 2c20 723d  =dict(size=6, r=
+00018c60: 3130 322c 206f 7269 656e 7461 7469 6f6e  102, orientation
+00018c70: 3d22 7665 7274 6963 616c 2229 2c0a 2020  ="vertical"),.  
+00018c80: 2020 2020 2020 2020 2020 2020 2020 6c69                li
+00018c90: 6e6b 5f6b 7773 3d64 6963 7428 6469 7265  nk_kws=dict(dire
+00018ca0: 6374 696f 6e3d 312c 2065 633d 2262 6c61  ction=1, ec="bla
+00018cb0: 636b 222c 206c 773d 3029 2c0a 2020 2020  ck", lw=0),.    
+00018cc0: 2020 2020 2020 2020 2020 2020 6f72 6465              orde
+00018cd0: 7220 3d20 676f 5f74 6572 6d73 5f73 6f72  r = go_terms_sor
+00018ce0: 7465 6420 202b 2073 6f72 7465 645f 6765  ted  + sorted_ge
+00018cf0: 6e65 730a 2020 2020 2020 2020 2020 2020  nes.            
+00018d00: 290a 2020 2020 2020 2020 2020 2020 6669  ).            fi
+00018d10: 6720 3d20 6369 7263 6f73 2e70 6c6f 7466  g = circos.plotf
+00018d20: 6967 2829 0a0a 2020 2020 2020 2020 2020  ig()..          
+00018d30: 2020 6966 2069 6478 203d 3d20 303a 0a20    if idx == 0:. 
+00018d40: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+00018d50: 6c74 2e74 6974 6c65 2827 5570 7265 6775  lt.title('Upregu
+00018d60: 6c61 7465 6420 7072 6f74 6569 6e73 2729  lated proteins')
+00018d70: 0a0a 2020 2020 2020 2020 2020 2020 656c  ..            el
+00018d80: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+00018d90: 2020 2020 706c 742e 7469 746c 6528 2744      plt.title('D
+00018da0: 6f77 6e72 6567 756c 6174 6564 2070 726f  ownregulated pro
+00018db0: 7465 696e 7327 290a 2020 2020 2020 2020  teins').        
+00018dc0: 2020 2020 6966 2073 6176 6566 6967 203d      if savefig =
+00018dd0: 3d20 5472 7565 3a0a 2020 2020 2020 2020  = True:.        
+00018de0: 2020 2020 2020 2020 706c 742e 7361 7665          plt.save
+00018df0: 6669 6728 6627 7b69 6478 7d5f 6369 7263  fig(f'{idx}_circ
+00018e00: 6c65 5f70 6c6f 742e 7064 6627 2c20 6262  le_plot.pdf', bb
+00018e10: 6f78 5f69 6e63 6865 733d 2774 6967 6874  ox_inches='tight
+00018e20: 2729 0a20 2020 2000 0000 0000 0000 0000  ').    .........
 00018e30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00018e40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00018e50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00018e60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00018e70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00018e80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00018e90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -6394,509 +6394,509 @@
 00018f90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00018fa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00018fb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00018fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00018fd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00018fe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00018ff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00019000: 7072 6f74 656f 6d69 6373 5f64 6f77 6e73  proteomics_downs
-00019010: 7472 6561 6d5f 616e 616c 7973 6973 2d30  tream_analysis-0
-00019020: 2e31 2e32 2f70 726f 7465 6f6d 6963 735f  .1.2/proteomics_
-00019030: 646f 776e 7374 7265 616d 5f61 6e61 6c79  downstream_analy
-00019040: 7369 732f 696d 7075 7465 722e 7079 0000  sis/imputer.py..
+00019000: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+00019010: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019020: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00019050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00019060: 0000 0000 3030 3030 3634 3400 3030 3031  ....0000644.0001
-00019070: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
-00019080: 3030 3032 3633 3100 3134 3435 3130 3636  0002631.14451066
-00019090: 3233 3500 3033 3030 3436 0020 3000 0000  235.030046. 0...
+00019060: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+00019070: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00019080: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
+00019090: 3030 3000 3031 3032 3133 0020 7800 0000  000.010213. x...
 000190a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000190b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000190c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000190d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000190e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000190f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00019100: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
+00019100: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
 00019110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00019120: 0000 0000 0000 0000 0064 6f63 6b65 7200  .........docker.
+00019120: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00019130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00019140: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00019150: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00019160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00019170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00019180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00019190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000191a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000191b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000191c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000191d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000191e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000191f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00019200: 6672 6f6d 206e 756d 7079 2e72 616e 646f  from numpy.rando
-00019210: 6d20 696d 706f 7274 2072 616e 640a 0a63  m import rand..c
-00019220: 6c61 7373 2049 6d70 7574 6572 3a0a 0a20  lass Imputer:.. 
-00019230: 2020 2064 6566 205f 5f69 6e69 745f 5f28     def __init__(
-00019240: 7365 6c66 293a 0a20 2020 2020 2020 2070  self):.        p
-00019250: 6173 730a 0a20 2020 2064 6566 2066 696c  ass..    def fil
-00019260: 6c5f 6475 6d6d 795f 7661 6c75 6573 2873  l_dummy_values(s
-00019270: 656c 662c 2073 6361 6c69 6e67 5f66 6163  elf, scaling_fac
-00019280: 746f 7229 3a0a 0a20 2020 2020 2020 2064  tor):..        d
-00019290: 756d 6d79 5f64 6174 6120 3d20 7365 6c66  ummy_data = self
-000192a0: 2e64 6174 612e 636f 7079 2829 0a0a 2020  .data.copy()..  
-000192b0: 2020 2020 2020 666f 7220 636f 6c20 696e        for col in
-000192c0: 2064 756d 6d79 5f64 6174 613a 0a0a 2020   dummy_data:..  
-000192d0: 2020 2020 2020 2020 2020 2320 4765 7420            # Get 
-000192e0: 636f 6c75 6d6e 2c20 636f 6c75 6d6e 206d  column, column m
-000192f0: 6973 7369 6e67 2076 616c 7565 7320 616e  issing values an
-00019300: 6420 7261 6e67 650a 2020 2020 2020 2020  d range.        
-00019310: 2020 2020 636f 6c20 3d20 6475 6d6d 795f      col = dummy_
-00019320: 6461 7461 5b63 6f6c 5d0a 2020 2020 2020  data[col].      
-00019330: 2020 2020 2020 636f 6c5f 6e75 6c6c 203d        col_null =
-00019340: 2063 6f6c 2e69 736e 756c 6c28 290a 2020   col.isnull().  
-00019350: 2020 2020 2020 2020 2020 6e75 6d5f 6e75            num_nu
-00019360: 6c6c 7320 3d20 636f 6c5f 6e75 6c6c 2e73  lls = col_null.s
-00019370: 756d 2829 0a20 2020 2020 2020 2020 2020  um().           
-00019380: 2063 6f6c 5f72 616e 6765 203d 2063 6f6c   col_range = col
-00019390: 2e6d 6178 2829 202d 2063 6f6c 2e6d 696e  .max() - col.min
-000193a0: 2829 0a0a 2020 2020 2020 2020 2020 2020  ()..            
-000193b0: 2320 5368 6966 7420 616e 6420 7363 616c  # Shift and scal
-000193c0: 6520 6475 6d6d 7920 7661 6c75 6573 0a20  e dummy values. 
-000193d0: 2020 2020 2020 2020 2020 2064 756d 6d79             dummy
-000193e0: 5f76 616c 7565 7320 3d20 2872 616e 6428  _values = (rand(
-000193f0: 6e75 6d5f 6e75 6c6c 7329 202d 2032 290a  num_nulls) - 2).
-00019400: 2020 2020 2020 2020 2020 2020 6475 6d6d              dumm
-00019410: 795f 7661 6c75 6573 203d 2064 756d 6d79  y_values = dummy
-00019420: 5f76 616c 7565 7320 2a20 7363 616c 696e  _values * scalin
-00019430: 675f 6661 6374 6f72 202a 2063 6f6c 5f72  g_factor * col_r
-00019440: 616e 6765 202b 2063 6f6c 2e6d 696e 2829  ange + col.min()
-00019450: 0a0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
-00019460: 5265 7475 726e 2064 756d 6d79 2076 616c  Return dummy val
-00019470: 7565 730a 2020 2020 2020 2020 2020 2020  ues.            
-00019480: 636f 6c5b 636f 6c5f 6e75 6c6c 5d20 3d20  col[col_null] = 
-00019490: 6475 6d6d 795f 7661 6c75 6573 0a0a 2020  dummy_values..  
-000194a0: 2020 2020 2020 7265 7475 726e 2064 756d        return dum
-000194b0: 6d79 5f64 6174 610a 0a20 2020 2064 6566  my_data..    def
-000194c0: 2073 696d 706c 655f 696d 7075 7465 2873   simple_impute(s
-000194d0: 656c 662c 2073 7472 6174 6567 792c 2064  elf, strategy, d
-000194e0: 6174 613d 4e6f 6e65 2c20 636f 6e73 7461  ata=None, consta
-000194f0: 6e74 3d30 293a 0a20 2020 2020 2020 200a  nt=0):.        .
-00019500: 2020 2020 2020 2020 6966 2064 6174 6120          if data 
-00019510: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
-00019520: 2020 2020 2069 6d70 7574 6564 5f64 6174       imputed_dat
-00019530: 6120 3d20 7365 6c66 2e64 6174 612e 636f  a = self.data.co
-00019540: 7079 2829 0a0a 2020 2020 2020 2020 656c  py()..        el
-00019550: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-00019560: 696d 7075 7465 645f 6461 7461 203d 2064  imputed_data = d
-00019570: 6174 612e 636f 7079 2829 0a0a 2020 2020  ata.copy()..    
-00019580: 2020 2020 666f 7220 636f 6c20 696e 2069      for col in i
-00019590: 6d70 7574 6564 5f64 6174 612e 636f 6c75  mputed_data.colu
-000195a0: 6d6e 732e 756e 6971 7565 2829 3a0a 0a20  mns.unique():.. 
-000195b0: 2020 2020 2020 2020 2020 2023 2047 6574             # Get
-000195c0: 2063 6f6c 756d 6e2c 2063 6f6c 756d 6e20   column, column 
-000195d0: 6d69 7373 696e 6720 7661 6c75 6573 2061  missing values a
-000195e0: 6e64 2072 616e 6765 0a20 2020 2020 2020  nd range.       
-000195f0: 2020 2020 2063 6f6c 203d 2069 6d70 7574       col = imput
-00019600: 6564 5f64 6174 615b 636f 6c5d 0a20 2020  ed_data[col].   
-00019610: 2020 2020 2020 2020 2063 6f6c 5f6e 756c           col_nul
-00019620: 6c20 3d20 636f 6c2e 6973 6e75 6c6c 2829  l = col.isnull()
-00019630: 0a0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
-00019640: 496d 7075 7465 2064 6174 610a 2020 2020  Impute data.    
-00019650: 2020 2020 2020 2020 6966 2073 7472 6174          if strat
-00019660: 6567 7920 3d3d 2027 6d65 616e 273a 0a20  egy == 'mean':. 
-00019670: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-00019680: 6f6c 5b63 6f6c 5f6e 756c 6c5d 203d 2063  ol[col_null] = c
-00019690: 6f6c 2e6d 6561 6e28 290a 2020 2020 2020  ol.mean().      
-000196a0: 2020 2020 2020 0a20 2020 2020 2020 2020        .         
-000196b0: 2020 2065 6c69 6620 7374 7261 7465 6779     elif strategy
-000196c0: 203d 3d20 276d 6564 6961 6e27 3a0a 2020   == 'median':.  
-000196d0: 2020 2020 2020 2020 2020 2020 2020 636f                co
-000196e0: 6c5b 636f 6c5f 6e75 6c6c 5d20 3d20 636f  l[col_null] = co
-000196f0: 6c2e 6d65 6469 616e 2829 0a0a 2020 2020  l.median()..    
-00019700: 2020 2020 2020 2020 656c 6966 2073 7472          elif str
-00019710: 6174 6567 7920 3d3d 2027 636f 6e73 7461  ategy == 'consta
-00019720: 6e74 273a 0a20 2020 2020 2020 2020 2020  nt':.           
-00019730: 2020 2020 2063 6f6c 5b63 6f6c 5f6e 756c       col[col_nul
-00019740: 6c5d 203d 2063 6f6e 7374 616e 740a 2020  l] = constant.  
-00019750: 2020 2020 2020 0a20 2020 2020 2020 2073        .        s
-00019760: 656c 662e 6461 7461 203d 2069 6d70 7574  elf.data = imput
-00019770: 6564 5f64 6174 610a 0a20 2020 2020 2020  ed_data..       
-00019780: 2072 6574 7572 6e20 7365 6c66 2e64 6174   return self.dat
-00019790: 610a 2020 2020 0a0a 0a00 0000 0000 0000  a.    ..........
-000197a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000197b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000197c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000197d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000197e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000197f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00019800: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-00019810: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00019820: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00019830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00019840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00019850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00019860: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-00019870: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00019880: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
-00019890: 3030 3000 3031 3032 3133 0020 7800 0000  000.010213. x...
-000198a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000198b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000198c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000198d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000198e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000198f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00019900: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-00019910: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00019920: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00019930: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00019940: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00019950: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00019960: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00019970: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00019980: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00019990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000199a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000199b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000199c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000199d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000199e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000199f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00019a00: 3232 206d 7469 6d65 3d31 3638 3834 3937  22 mtime=1688497
-00019a10: 3330 392e 300a 0000 0000 0000 0000 0000  309.0...........
-00019a20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00019a30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00019a40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00019a50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00019a60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00019a70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00019a80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00019a90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00019aa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00019ab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00019ac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00019ad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00019ae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00019af0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00019b00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00019b10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00019b20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00019b30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00019b40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00019b50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00019b60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00019b70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00019b80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00019b90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019200: 3232 206d 7469 6d65 3d31 3638 3835 3732  22 mtime=1688572
+00019210: 3039 322e 300a 0000 0000 0000 0000 0000  092.0...........
+00019220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019260: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019270: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019280: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019290: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000192a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000192b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000192c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000192d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000192e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000192f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019300: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019320: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019340: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019350: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000193a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000193b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000193c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000193d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000193e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000193f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019400: 7072 6f74 656f 6d69 6373 5f64 6f77 6e73  proteomics_downs
+00019410: 7472 6561 6d5f 616e 616c 7973 6973 2d30  tream_analysis-0
+00019420: 2e31 2e33 2f70 726f 7465 6f6d 6963 735f  .1.3/proteomics_
+00019430: 646f 776e 7374 7265 616d 5f61 6e61 6c79  downstream_analy
+00019440: 7369 732f 696d 7075 7465 722e 7079 0000  sis/imputer.py..
+00019450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019460: 0000 0000 3030 3030 3634 3400 3030 3031  ....0000644.0001
+00019470: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
+00019480: 3030 3032 3633 3100 3134 3435 3133 3130  0002631.14451310
+00019490: 3237 3400 3033 3030 3432 0020 3000 0000  274.030042. 0...
+000194a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000194b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000194c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000194d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000194e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000194f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019500: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
+00019510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019520: 0000 0000 0000 0000 0064 6f63 6b65 7200  .........docker.
+00019530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019540: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019550: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000195a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000195b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000195c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000195d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000195e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000195f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019600: 6672 6f6d 206e 756d 7079 2e72 616e 646f  from numpy.rando
+00019610: 6d20 696d 706f 7274 2072 616e 640a 0a63  m import rand..c
+00019620: 6c61 7373 2049 6d70 7574 6572 3a0a 0a20  lass Imputer:.. 
+00019630: 2020 2064 6566 205f 5f69 6e69 745f 5f28     def __init__(
+00019640: 7365 6c66 293a 0a20 2020 2020 2020 2070  self):.        p
+00019650: 6173 730a 0a20 2020 2064 6566 2066 696c  ass..    def fil
+00019660: 6c5f 6475 6d6d 795f 7661 6c75 6573 2873  l_dummy_values(s
+00019670: 656c 662c 2073 6361 6c69 6e67 5f66 6163  elf, scaling_fac
+00019680: 746f 7229 3a0a 0a20 2020 2020 2020 2064  tor):..        d
+00019690: 756d 6d79 5f64 6174 6120 3d20 7365 6c66  ummy_data = self
+000196a0: 2e64 6174 612e 636f 7079 2829 0a0a 2020  .data.copy()..  
+000196b0: 2020 2020 2020 666f 7220 636f 6c20 696e        for col in
+000196c0: 2064 756d 6d79 5f64 6174 613a 0a0a 2020   dummy_data:..  
+000196d0: 2020 2020 2020 2020 2020 2320 4765 7420            # Get 
+000196e0: 636f 6c75 6d6e 2c20 636f 6c75 6d6e 206d  column, column m
+000196f0: 6973 7369 6e67 2076 616c 7565 7320 616e  issing values an
+00019700: 6420 7261 6e67 650a 2020 2020 2020 2020  d range.        
+00019710: 2020 2020 636f 6c20 3d20 6475 6d6d 795f      col = dummy_
+00019720: 6461 7461 5b63 6f6c 5d0a 2020 2020 2020  data[col].      
+00019730: 2020 2020 2020 636f 6c5f 6e75 6c6c 203d        col_null =
+00019740: 2063 6f6c 2e69 736e 756c 6c28 290a 2020   col.isnull().  
+00019750: 2020 2020 2020 2020 2020 6e75 6d5f 6e75            num_nu
+00019760: 6c6c 7320 3d20 636f 6c5f 6e75 6c6c 2e73  lls = col_null.s
+00019770: 756d 2829 0a20 2020 2020 2020 2020 2020  um().           
+00019780: 2063 6f6c 5f72 616e 6765 203d 2063 6f6c   col_range = col
+00019790: 2e6d 6178 2829 202d 2063 6f6c 2e6d 696e  .max() - col.min
+000197a0: 2829 0a0a 2020 2020 2020 2020 2020 2020  ()..            
+000197b0: 2320 5368 6966 7420 616e 6420 7363 616c  # Shift and scal
+000197c0: 6520 6475 6d6d 7920 7661 6c75 6573 0a20  e dummy values. 
+000197d0: 2020 2020 2020 2020 2020 2064 756d 6d79             dummy
+000197e0: 5f76 616c 7565 7320 3d20 2872 616e 6428  _values = (rand(
+000197f0: 6e75 6d5f 6e75 6c6c 7329 202d 2032 290a  num_nulls) - 2).
+00019800: 2020 2020 2020 2020 2020 2020 6475 6d6d              dumm
+00019810: 795f 7661 6c75 6573 203d 2064 756d 6d79  y_values = dummy
+00019820: 5f76 616c 7565 7320 2a20 7363 616c 696e  _values * scalin
+00019830: 675f 6661 6374 6f72 202a 2063 6f6c 5f72  g_factor * col_r
+00019840: 616e 6765 202b 2063 6f6c 2e6d 696e 2829  ange + col.min()
+00019850: 0a0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
+00019860: 5265 7475 726e 2064 756d 6d79 2076 616c  Return dummy val
+00019870: 7565 730a 2020 2020 2020 2020 2020 2020  ues.            
+00019880: 636f 6c5b 636f 6c5f 6e75 6c6c 5d20 3d20  col[col_null] = 
+00019890: 6475 6d6d 795f 7661 6c75 6573 0a0a 2020  dummy_values..  
+000198a0: 2020 2020 2020 7265 7475 726e 2064 756d        return dum
+000198b0: 6d79 5f64 6174 610a 0a20 2020 2064 6566  my_data..    def
+000198c0: 2073 696d 706c 655f 696d 7075 7465 2873   simple_impute(s
+000198d0: 656c 662c 2073 7472 6174 6567 792c 2064  elf, strategy, d
+000198e0: 6174 613d 4e6f 6e65 2c20 636f 6e73 7461  ata=None, consta
+000198f0: 6e74 3d30 293a 0a20 2020 2020 2020 200a  nt=0):.        .
+00019900: 2020 2020 2020 2020 6966 2064 6174 6120          if data 
+00019910: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
+00019920: 2020 2020 2069 6d70 7574 6564 5f64 6174       imputed_dat
+00019930: 6120 3d20 7365 6c66 2e64 6174 612e 636f  a = self.data.co
+00019940: 7079 2829 0a0a 2020 2020 2020 2020 656c  py()..        el
+00019950: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+00019960: 696d 7075 7465 645f 6461 7461 203d 2064  imputed_data = d
+00019970: 6174 612e 636f 7079 2829 0a0a 2020 2020  ata.copy()..    
+00019980: 2020 2020 666f 7220 636f 6c20 696e 2069      for col in i
+00019990: 6d70 7574 6564 5f64 6174 612e 636f 6c75  mputed_data.colu
+000199a0: 6d6e 732e 756e 6971 7565 2829 3a0a 0a20  mns.unique():.. 
+000199b0: 2020 2020 2020 2020 2020 2023 2047 6574             # Get
+000199c0: 2063 6f6c 756d 6e2c 2063 6f6c 756d 6e20   column, column 
+000199d0: 6d69 7373 696e 6720 7661 6c75 6573 2061  missing values a
+000199e0: 6e64 2072 616e 6765 0a20 2020 2020 2020  nd range.       
+000199f0: 2020 2020 2063 6f6c 203d 2069 6d70 7574       col = imput
+00019a00: 6564 5f64 6174 615b 636f 6c5d 0a20 2020  ed_data[col].   
+00019a10: 2020 2020 2020 2020 2063 6f6c 5f6e 756c           col_nul
+00019a20: 6c20 3d20 636f 6c2e 6973 6e75 6c6c 2829  l = col.isnull()
+00019a30: 0a0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
+00019a40: 496d 7075 7465 2064 6174 610a 2020 2020  Impute data.    
+00019a50: 2020 2020 2020 2020 6966 2073 7472 6174          if strat
+00019a60: 6567 7920 3d3d 2027 6d65 616e 273a 0a20  egy == 'mean':. 
+00019a70: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+00019a80: 6f6c 5b63 6f6c 5f6e 756c 6c5d 203d 2063  ol[col_null] = c
+00019a90: 6f6c 2e6d 6561 6e28 290a 2020 2020 2020  ol.mean().      
+00019aa0: 2020 2020 2020 0a20 2020 2020 2020 2020        .         
+00019ab0: 2020 2065 6c69 6620 7374 7261 7465 6779     elif strategy
+00019ac0: 203d 3d20 276d 6564 6961 6e27 3a0a 2020   == 'median':.  
+00019ad0: 2020 2020 2020 2020 2020 2020 2020 636f                co
+00019ae0: 6c5b 636f 6c5f 6e75 6c6c 5d20 3d20 636f  l[col_null] = co
+00019af0: 6c2e 6d65 6469 616e 2829 0a0a 2020 2020  l.median()..    
+00019b00: 2020 2020 2020 2020 656c 6966 2073 7472          elif str
+00019b10: 6174 6567 7920 3d3d 2027 636f 6e73 7461  ategy == 'consta
+00019b20: 6e74 273a 0a20 2020 2020 2020 2020 2020  nt':.           
+00019b30: 2020 2020 2063 6f6c 5b63 6f6c 5f6e 756c       col[col_nul
+00019b40: 6c5d 203d 2063 6f6e 7374 616e 740a 2020  l] = constant.  
+00019b50: 2020 2020 2020 0a20 2020 2020 2020 2073        .        s
+00019b60: 656c 662e 6461 7461 203d 2069 6d70 7574  elf.data = imput
+00019b70: 6564 5f64 6174 610a 0a20 2020 2020 2020  ed_data..       
+00019b80: 2072 6574 7572 6e20 7365 6c66 2e64 6174   return self.dat
+00019b90: 610a 2020 2020 0a0a 0a00 0000 0000 0000  a.    ..........
 00019ba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00019bb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00019bc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00019bd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00019be0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00019bf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00019c00: 7072 6f74 656f 6d69 6373 5f64 6f77 6e73  proteomics_downs
-00019c10: 7472 6561 6d5f 616e 616c 7973 6973 2d30  tream_analysis-0
-00019c20: 2e31 2e32 2f70 726f 7465 6f6d 6963 735f  .1.2/proteomics_
-00019c30: 646f 776e 7374 7265 616d 5f61 6e61 6c79  downstream_analy
-00019c40: 7369 732f 6d75 6c74 696c 6576 656c 6461  sis/multilevelda
-00019c50: 7461 2e70 7900 0000 0000 0000 0000 0000  ta.py...........
-00019c60: 0000 0000 3030 3030 3634 3400 3030 3031  ....0000644.0001
-00019c70: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
-00019c80: 3030 3036 3335 3100 3134 3435 3130 3636  0006351.14451066
-00019c90: 3233 3500 3033 3134 3030 0020 3000 0000  235.031400. 0...
+00019c00: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+00019c10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019c20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019c30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019c40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019c50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019c60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+00019c70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00019c80: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
+00019c90: 3030 3000 3031 3032 3133 0020 7800 0000  000.010213. x...
 00019ca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00019cb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00019cc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00019cd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00019ce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00019cf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00019d00: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
+00019d00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
 00019d10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00019d20: 0000 0000 0000 0000 0064 6f63 6b65 7200  .........docker.
+00019d20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00019d30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00019d40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00019d50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00019d60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00019d70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00019d80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00019d90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00019da0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00019db0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00019dc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00019dd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00019de0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00019df0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00019e00: 696d 706f 7274 2070 616e 6461 7320 6173  import pandas as
-00019e10: 2070 640a 0a63 6c61 7373 204d 756c 7469   pd..class Multi
-00019e20: 4c65 7665 6c44 6174 6128 293a 0a20 2020  LevelData():.   
-00019e30: 2022 2222 2054 6869 7320 636c 6173 7320   """ This class 
-00019e40: 656e 6361 7073 756c 6174 6573 2064 6174  encapsulates dat
-00019e50: 6120 7772 616e 676c 696e 6720 6d65 7468  a wrangling meth
-00019e60: 6f64 7320 666f 7220 6d75 6c74 6920 6c65  ods for multi le
-00019e70: 7665 6c20 6461 7461 2022 2222 0a0a 2020  vel data """..  
-00019e80: 2020 6465 6620 5f5f 696e 6974 5f5f 2873    def __init__(s
-00019e90: 656c 662c 2066 696c 6570 6174 6829 3a0a  elf, filepath):.
-00019ea0: 2020 2020 2020 2020 7061 7373 0a20 2020          pass.   
-00019eb0: 200a 2020 2020 6465 6620 6d75 6c74 695f   .    def multi_
-00019ec0: 6c65 7665 6c5f 6461 7461 2873 656c 662c  level_data(self,
-00019ed0: 2061 6e6e 6f74 6174 696f 6e2c 206d 756c   annotation, mul
-00019ee0: 7469 6c65 7665 6c5f 636f 6c73 293a 0a20  tilevel_cols):. 
-00019ef0: 2020 2020 2020 200a 2020 2020 2020 2020         .        
-00019f00: 2222 220a 2020 2020 2020 2020 4765 7420  """.        Get 
-00019f10: 6d75 6c74 6920 6c65 7665 6c20 6461 7461  multi level data
-00019f20: 0a0a 2020 2020 2020 2020 5061 7261 6d65  ..        Parame
-00019f30: 7465 7273 0a20 2020 2020 2020 202d 2d2d  ters.        ---
-00019f40: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-00019f50: 616e 6e6f 7461 7469 6f6e 203a 2070 642e  annotation : pd.
-00019f60: 4461 7461 4672 616d 650a 2020 2020 2020  DataFrame.      
-00019f70: 2020 2020 2020 416e 6e6f 7461 7469 6f6e        Annotation
-00019f80: 2064 6174 6120 7468 6174 2063 6f6e 7461   data that conta
-00019f90: 696e 7320 7468 6520 6d75 6c74 696c 6576  ins the multilev
-00019fa0: 656c 2063 6f6c 756d 6e73 0a0a 2020 2020  el columns..    
-00019fb0: 2020 2020 6d75 6c74 696c 6576 656c 5f63      multilevel_c
-00019fc0: 6f6c 7320 3a20 6c69 7374 0a20 2020 2020  ols : list.     
-00019fd0: 2020 2020 2020 204c 6973 7420 6f66 2063         List of c
-00019fe0: 6f6c 756d 6e20 6e61 6d65 7320 746f 2062  olumn names to b
-00019ff0: 6520 7573 6564 2066 6f72 206d 756c 7469  e used for multi
-0001a000: 6c65 7665 6c20 6461 7461 0a0a 2020 2020  level data..    
-0001a010: 2020 2020 5265 7475 726e 730a 2020 2020      Returns.    
-0001a020: 2020 2020 2d2d 2d2d 2d2d 2d0a 2020 2020      -------.    
-0001a030: 2020 2020 6d75 6c74 696c 6576 656c 5f64      multilevel_d
-0001a040: 6174 6120 3a20 7064 2e44 6174 6146 7261  ata : pd.DataFra
-0001a050: 6d65 0a20 2020 2020 2020 2020 2020 2044  me.            D
-0001a060: 6174 6120 7769 7468 206d 756c 7469 6c65  ata with multile
-0001a070: 7665 6c20 636f 6c75 6d6e 730a 2020 2020  vel columns.    
-0001a080: 2020 2020 2222 220a 0a20 2020 2020 2020      """..       
-0001a090: 2064 6174 615f 636f 7079 203d 2073 656c   data_copy = sel
-0001a0a0: 662e 6461 7461 2e63 6f70 7928 290a 2020  f.data.copy().  
-0001a0b0: 2020 2020 2020 7374 7269 6e67 5f63 6f6c        string_col
-0001a0c0: 7320 3d20 6461 7461 5f63 6f70 792e 7365  s = data_copy.se
-0001a0d0: 6c65 6374 5f64 7479 7065 7328 2773 7472  lect_dtypes('str
-0001a0e0: 696e 6727 292e 636f 6c75 6d6e 732e 746f  ing').columns.to
-0001a0f0: 5f6c 6973 7428 290a 2020 2020 2020 2020  _list().        
-0001a100: 636f 6c73 203d 2061 6e6e 6f74 6174 696f  cols = annotatio
-0001a110: 6e5b 6d75 6c74 696c 6576 656c 5f63 6f6c  n[multilevel_col
-0001a120: 735d 0a20 2020 2020 2020 2063 6f6c 735f  s].        cols_
-0001a130: 6461 7461 203d 2070 642e 4461 7461 4672  data = pd.DataFr
-0001a140: 616d 6528 290a 0a20 2020 2020 2020 2066  ame()..        f
-0001a150: 6f72 2063 6f6c 735f 6e61 6d65 2069 6e20  or cols_name in 
-0001a160: 636f 6c73 2e63 6f6c 756d 6e73 2e75 6e69  cols.columns.uni
-0001a170: 7175 6528 293a 0a20 2020 2020 2020 2020  que():.         
-0001a180: 2020 2063 6f6c 735f 6461 7461 5b63 6f6c     cols_data[col
-0001a190: 735f 6e61 6d65 5d20 3d20 7374 7269 6e67  s_name] = string
-0001a1a0: 5f63 6f6c 7320 2b20 636f 6c73 5b63 6f6c  _cols + cols[col
-0001a1b0: 735f 6e61 6d65 5d2e 746f 5f6c 6973 7428  s_name].to_list(
-0001a1c0: 290a 0a20 2020 2020 2020 206d 756c 7469  )..        multi
-0001a1d0: 5f63 6f6c 7320 3d20 7064 2e4d 756c 7469  _cols = pd.Multi
-0001a1e0: 496e 6465 782e 6672 6f6d 5f66 7261 6d65  Index.from_frame
-0001a1f0: 2863 6f6c 735f 6461 7461 290a 2020 2020  (cols_data).    
-0001a200: 2020 2020 6461 7461 5f63 6f70 792e 636f      data_copy.co
-0001a210: 6c75 6d6e 7320 3d20 6d75 6c74 695f 636f  lumns = multi_co
-0001a220: 6c73 0a20 2020 2020 2020 2073 656c 662e  ls.        self.
-0001a230: 6d75 6c74 696c 6576 656c 5f64 6174 6120  multilevel_data 
-0001a240: 3d20 6461 7461 5f63 6f70 792e 636f 7079  = data_copy.copy
-0001a250: 2829 0a0a 2020 2020 2020 2020 7265 7475  ()..        retu
-0001a260: 726e 2073 656c 662e 6d75 6c74 696c 6576  rn self.multilev
-0001a270: 656c 5f64 6174 610a 0a20 2020 2064 6566  el_data..    def
-0001a280: 2073 696e 676c 655f 6c65 7665 6c5f 6461   single_level_da
-0001a290: 7461 2873 656c 662c 206c 6576 656c 2c20  ta(self, level, 
-0001a2a0: 6461 7461 3d4e 6f6e 6529 3a0a 0a20 2020  data=None):..   
-0001a2b0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-0001a2c0: 2047 6574 2061 2073 696e 676c 6520 6c65   Get a single le
-0001a2d0: 7665 6c20 636f 6c75 6d6e 2064 6174 6120  vel column data 
-0001a2e0: 6672 6f6d 206d 756c 7469 6c65 7665 6c20  from multilevel 
-0001a2f0: 6461 7461 0a0a 2020 2020 2020 2020 5061  data..        Pa
-0001a300: 7261 6d65 7465 7273 0a20 2020 2020 2020  rameters.       
-0001a310: 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020   ----------.    
-0001a320: 2020 2020 6c65 7665 6c20 3a20 696e 740a      level : int.
-0001a330: 2020 2020 2020 2020 2020 2020 4c65 7665              Leve
-0001a340: 6c20 6f66 2074 6865 2063 6f6c 756d 6e20  l of the column 
-0001a350: 746f 2062 6520 6578 7472 6163 7465 640a  to be extracted.
-0001a360: 0a20 2020 2020 2020 2064 6174 6120 3a20  .        data : 
-0001a370: 7064 2e44 6174 6146 7261 6d65 0a20 2020  pd.DataFrame.   
-0001a380: 2020 2020 2020 2020 2020 2844 6566 6175            (Defau
-0001a390: 6c74 2076 616c 7565 203d 204e 6f6e 6529  lt value = None)
-0001a3a0: 0a0a 2020 2020 2020 2020 5265 7475 726e  ..        Return
-0001a3b0: 730a 2020 2020 2020 2020 2d2d 2d2d 2d2d  s.        ------
-0001a3c0: 2d0a 2020 2020 2020 2020 6765 745f 6c65  -.        get_le
-0001a3d0: 7665 6c5f 6461 7461 203a 2070 642e 4461  vel_data : pd.Da
-0001a3e0: 7461 4672 616d 650a 2020 2020 2020 2020  taFrame.        
-0001a3f0: 2020 2020 4461 7461 2077 6974 6820 7369      Data with si
-0001a400: 6e67 6c65 206c 6576 656c 2063 6f6c 756d  ngle level colum
-0001a410: 6e73 0a20 2020 2020 2020 2022 2222 0a20  ns.        """. 
-0001a420: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
-0001a430: 616e 6365 2864 6174 612c 2070 642e 4461  ance(data, pd.Da
-0001a440: 7461 4672 616d 6529 3a0a 2020 2020 2020  taFrame):.      
-0001a450: 2020 2020 2020 6765 745f 6c65 7665 6c5f        get_level_
-0001a460: 6461 7461 203d 2064 6174 612e 636f 7079  data = data.copy
-0001a470: 2829 0a20 2020 2020 2020 2020 2020 2067  ().            g
-0001a480: 6574 5f6c 6576 656c 5f64 6174 612e 636f  et_level_data.co
-0001a490: 6c75 6d6e 7320 3d20 6765 745f 6c65 7665  lumns = get_leve
-0001a4a0: 6c5f 6461 7461 2e63 6f6c 756d 6e73 2e67  l_data.columns.g
-0001a4b0: 6574 5f6c 6576 656c 5f76 616c 7565 7328  et_level_values(
-0001a4c0: 6c65 7665 6c29 0a0a 2020 2020 2020 2020  level)..        
-0001a4d0: 2020 2020 7265 7475 726e 2067 6574 5f6c      return get_l
-0001a4e0: 6576 656c 5f64 6174 610a 0a20 2020 2020  evel_data..     
-0001a4f0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-0001a500: 2020 2020 2067 6574 5f6c 6576 656c 5f64       get_level_d
-0001a510: 6174 6120 3d20 7365 6c66 2e6d 756c 7469  ata = self.multi
-0001a520: 6c65 7665 6c5f 6461 7461 2e63 6f70 7928  level_data.copy(
-0001a530: 290a 2020 2020 2020 2020 2020 2020 6765  ).            ge
-0001a540: 745f 6c65 7665 6c5f 6461 7461 2e63 6f6c  t_level_data.col
-0001a550: 756d 6e73 203d 2067 6574 5f6c 6576 656c  umns = get_level
-0001a560: 5f64 6174 612e 636f 6c75 6d6e 732e 6765  _data.columns.ge
-0001a570: 745f 6c65 7665 6c5f 7661 6c75 6573 286c  t_level_values(l
-0001a580: 6576 656c 290a 2020 2020 2020 2020 2020  evel).          
-0001a590: 2020 7365 6c66 2e64 6174 6120 3d20 6765    self.data = ge
-0001a5a0: 745f 6c65 7665 6c5f 6461 7461 2e63 6f70  t_level_data.cop
-0001a5b0: 7928 290a 0a20 2020 2020 2020 2020 2020  y()..           
-0001a5c0: 2072 6574 7572 6e20 6765 745f 6c65 7665   return get_leve
-0001a5d0: 6c5f 6461 7461 0a0a 2020 2020 6465 6620  l_data..    def 
-0001a5e0: 6d75 6c74 696c 6576 656c 5f73 756d 6d61  multilevel_summa
-0001a5f0: 7279 5f73 7461 7428 7365 6c66 2c20 6c65  ry_stat(self, le
-0001a600: 7665 6c2c 206f 7574 7075 745f 6c65 7665  vel, output_leve
-0001a610: 6c2c 2073 756d 6d61 7279 5f73 7461 7469  l, summary_stati
-0001a620: 7374 6963 293a 0a0a 2020 2020 2020 2020  stic):..        
-0001a630: 2222 220a 2020 2020 2020 2020 4765 7420  """.        Get 
-0001a640: 7468 6520 6d65 616e 206f 6620 6120 7369  the mean of a si
-0001a650: 6e67 6c65 206c 6576 656c 2064 6174 610a  ngle level data.
-0001a660: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
-0001a670: 6572 730a 2020 2020 2020 2020 2d2d 2d2d  ers.        ----
-0001a680: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 206c  ------.        l
-0001a690: 6576 656c 203a 2069 6e74 0a20 2020 2020  evel : int.     
-0001a6a0: 2020 2020 2020 204c 6576 656c 206f 6620         Level of 
-0001a6b0: 7468 6520 636f 6c75 6d6e 2074 6f20 6361  the column to ca
-0001a6c0: 6c63 756c 6174 6520 7468 6520 7374 6174  lculate the stat
-0001a6d0: 6973 7469 6320 6672 6f6d 0a0a 2020 2020  istic from..    
-0001a6e0: 2020 2020 6f75 7470 7574 5f6c 6576 656c      output_level
-0001a6f0: 203a 2069 6e74 0a20 2020 2020 2020 2020   : int.         
-0001a700: 2020 204c 6576 656c 206f 6620 7468 6520     Level of the 
-0001a710: 636f 6c75 6d6e 2074 6f20 6265 2075 7365  column to be use
-0001a720: 6420 6173 2074 6865 206f 7574 7075 740a  d as the output.
-0001a730: 2020 2020 2020 2020 2020 2020 0a20 2020              .   
-0001a740: 2020 2020 2073 756d 6d61 7279 5f73 7461       summary_sta
-0001a750: 7469 7374 6963 203a 2073 7472 0a20 2020  tistic : str.   
-0001a760: 2020 2020 2020 2020 2053 756d 6d61 7279           Summary
-0001a770: 2073 7461 7469 7374 6963 2074 6f20 6265   statistic to be
-0001a780: 2063 616c 6375 6c61 7465 642e 2045 6974   calculated. Eit
-0001a790: 6865 7220 276d 6561 6e27 206f 7220 276d  her 'mean' or 'm
-0001a7a0: 6564 6961 6e27 0a0a 2020 2020 2020 2020  edian'..        
-0001a7b0: 5265 7475 726e 730a 2020 2020 2020 2020  Returns.        
-0001a7c0: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-0001a7d0: 7375 6d6d 6172 795f 6461 7461 203a 2070  summary_data : p
-0001a7e0: 642e 4461 7461 4672 616d 650a 2020 2020  d.DataFrame.    
-0001a7f0: 2020 2020 2020 2020 4461 7461 2077 6974          Data wit
-0001a800: 6820 7468 6520 7375 6d6d 6172 7920 7374  h the summary st
-0001a810: 6174 6973 7469 6320 616e 6420 7369 6e67  atistic and sing
-0001a820: 6c65 206c 6576 656c 2063 6f6c 756d 6e73  le level columns
-0001a830: 0a20 2020 2020 2020 2022 2222 0a0a 2020  .        """..  
-0001a840: 2020 2020 2020 6461 7461 5f63 6f70 7920        data_copy 
-0001a850: 3d20 7365 6c66 2e6d 756c 7469 6c65 7665  = self.multileve
-0001a860: 6c5f 6461 7461 2e73 656c 6563 745f 6474  l_data.select_dt
-0001a870: 7970 6573 2827 666c 6f61 7427 292e 636f  ypes('float').co
-0001a880: 7079 2829 0a0a 2020 2020 2020 2020 6966  py()..        if
-0001a890: 2073 756d 6d61 7279 5f73 7461 7469 7374   summary_statist
-0001a8a0: 6963 203d 3d20 276d 6561 6e27 3a0a 2020  ic == 'mean':.  
-0001a8b0: 2020 2020 2020 2020 2020 7375 6d6d 6172            summar
-0001a8c0: 795f 6461 7461 203d 2064 6174 615f 636f  y_data = data_co
-0001a8d0: 7079 2e67 726f 7570 6279 286c 6576 656c  py.groupby(level
-0001a8e0: 3d5b 6c65 7665 6c2c 206f 7574 7075 745f  =[level, output_
-0001a8f0: 6c65 7665 6c5d 2c20 6178 6973 3d31 292e  level], axis=1).
-0001a900: 6d65 616e 2829 0a0a 2020 2020 2020 2020  mean()..        
-0001a910: 656c 6966 2073 756d 6d61 7279 5f73 7461  elif summary_sta
-0001a920: 7469 7374 6963 203d 3d20 276d 6564 6961  tistic == 'media
-0001a930: 6e27 3a0a 2020 2020 2020 2020 2020 2020  n':.            
-0001a940: 7375 6d6d 6172 795f 6461 7461 203d 2064  summary_data = d
-0001a950: 6174 615f 636f 7079 2e67 726f 7570 6279  ata_copy.groupby
-0001a960: 286c 6576 656c 3d5b 6c65 7665 6c2c 206f  (level=[level, o
-0001a970: 7574 7075 745f 6c65 7665 6c5d 2c20 6178  utput_level], ax
-0001a980: 6973 3d31 292e 6d65 6469 616e 2829 0a0a  is=1).median()..
-0001a990: 2020 2020 2020 2020 7375 6d6d 6172 795f          summary_
-0001a9a0: 6461 7461 203d 2073 656c 662e 7369 6e67  data = self.sing
-0001a9b0: 6c65 5f6c 6576 656c 5f64 6174 6128 6f75  le_level_data(ou
-0001a9c0: 7470 7574 5f6c 6576 656c 2c20 7375 6d6d  tput_level, summ
-0001a9d0: 6172 795f 6461 7461 290a 2020 2020 2020  ary_data).      
-0001a9e0: 2020 7374 7269 6e67 5f64 6174 6120 3d20    string_data = 
-0001a9f0: 7365 6c66 2e73 696e 676c 655f 6c65 7665  self.single_leve
-0001aa00: 6c5f 6461 7461 286f 7574 7075 745f 6c65  l_data(output_le
-0001aa10: 7665 6c2c 2073 656c 662e 6d75 6c74 696c  vel, self.multil
-0001aa20: 6576 656c 5f64 6174 612e 7365 6c65 6374  evel_data.select
-0001aa30: 5f64 7479 7065 7328 2773 7472 696e 6727  _dtypes('string'
-0001aa40: 2929 0a20 2020 2020 2020 2073 756d 6d61  )).        summa
-0001aa50: 7279 5f64 6174 6120 3d20 7374 7269 6e67  ry_data = string
-0001aa60: 5f64 6174 612e 6d65 7267 6528 7375 6d6d  _data.merge(summ
-0001aa70: 6172 795f 6461 7461 2c20 6c65 6674 5f69  ary_data, left_i
-0001aa80: 6e64 6578 3d54 7275 652c 2072 6967 6874  ndex=True, right
-0001aa90: 5f69 6e64 6578 3d54 7275 6529 0a20 2020  _index=True).   
-0001aaa0: 2020 2020 2073 656c 662e 7375 6d6d 6172       self.summar
-0001aab0: 795f 6461 7461 203d 2073 756d 6d61 7279  y_data = summary
-0001aac0: 5f64 6174 612e 636f 7079 2829 0a0a 2020  _data.copy()..  
-0001aad0: 2020 2020 2020 7265 7475 726e 2073 756d        return sum
-0001aae0: 6d61 7279 5f64 6174 6100 0000 0000 0000  mary_data.......
-0001aaf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ab00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ab10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ab20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ab30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ab40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ab50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ab60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ab70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ab80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ab90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001aba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001abb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001abc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001abd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001abe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001abf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ac00: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-0001ac10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ac20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ac30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ac40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ac50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ac60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-0001ac70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-0001ac80: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
-0001ac90: 3030 3000 3031 3032 3133 0020 7800 0000  000.010213. x...
-0001aca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001acb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001acc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001acd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ace0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001acf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ad00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-0001ad10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ad20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ad30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ad40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ad50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ad60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ad70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ad80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ad90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ada0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001adb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001adc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001add0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ade0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001adf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ae00: 3232 206d 7469 6d65 3d31 3638 3834 3937  22 mtime=1688497
-0001ae10: 3330 392e 300a 0000 0000 0000 0000 0000  309.0...........
-0001ae20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ae30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ae40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ae50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ae60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ae70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ae80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ae90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001aea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001aeb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001aec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001aed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001aee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019e00: 3232 206d 7469 6d65 3d31 3638 3835 3732  22 mtime=1688572
+00019e10: 3039 322e 300a 0000 0000 0000 0000 0000  092.0...........
+00019e20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019e30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019e40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019e50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019e60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019e70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019e80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019e90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019ea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019eb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019ec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019ed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019ee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019ef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019f00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019f10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019f20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019f30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019f40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019f50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019f60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019f70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019f80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019f90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019fa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019fb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019fd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019fe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019ff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001a000: 7072 6f74 656f 6d69 6373 5f64 6f77 6e73  proteomics_downs
+0001a010: 7472 6561 6d5f 616e 616c 7973 6973 2d30  tream_analysis-0
+0001a020: 2e31 2e33 2f70 726f 7465 6f6d 6963 735f  .1.3/proteomics_
+0001a030: 646f 776e 7374 7265 616d 5f61 6e61 6c79  downstream_analy
+0001a040: 7369 732f 6d75 6c74 696c 6576 656c 6461  sis/multilevelda
+0001a050: 7461 2e70 7900 0000 0000 0000 0000 0000  ta.py...........
+0001a060: 0000 0000 3030 3030 3634 3400 3030 3031  ....0000644.0001
+0001a070: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
+0001a080: 3030 3036 3335 3100 3134 3435 3133 3130  0006351.14451310
+0001a090: 3237 3400 3033 3133 3734 0020 3000 0000  274.031374. 0...
+0001a0a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001a0b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001a0c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001a0d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001a0e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001a0f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001a100: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
+0001a110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001a120: 0000 0000 0000 0000 0064 6f63 6b65 7200  .........docker.
+0001a130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001a140: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001a150: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001a160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001a170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001a180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001a190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001a1a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001a1b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001a1c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001a1d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001a1e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001a1f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001a200: 696d 706f 7274 2070 616e 6461 7320 6173  import pandas as
+0001a210: 2070 640a 0a63 6c61 7373 204d 756c 7469   pd..class Multi
+0001a220: 4c65 7665 6c44 6174 6128 293a 0a20 2020  LevelData():.   
+0001a230: 2022 2222 2054 6869 7320 636c 6173 7320   """ This class 
+0001a240: 656e 6361 7073 756c 6174 6573 2064 6174  encapsulates dat
+0001a250: 6120 7772 616e 676c 696e 6720 6d65 7468  a wrangling meth
+0001a260: 6f64 7320 666f 7220 6d75 6c74 6920 6c65  ods for multi le
+0001a270: 7665 6c20 6461 7461 2022 2222 0a0a 2020  vel data """..  
+0001a280: 2020 6465 6620 5f5f 696e 6974 5f5f 2873    def __init__(s
+0001a290: 656c 662c 2066 696c 6570 6174 6829 3a0a  elf, filepath):.
+0001a2a0: 2020 2020 2020 2020 7061 7373 0a20 2020          pass.   
+0001a2b0: 200a 2020 2020 6465 6620 6d75 6c74 695f   .    def multi_
+0001a2c0: 6c65 7665 6c5f 6461 7461 2873 656c 662c  level_data(self,
+0001a2d0: 2061 6e6e 6f74 6174 696f 6e2c 206d 756c   annotation, mul
+0001a2e0: 7469 6c65 7665 6c5f 636f 6c73 293a 0a20  tilevel_cols):. 
+0001a2f0: 2020 2020 2020 200a 2020 2020 2020 2020         .        
+0001a300: 2222 220a 2020 2020 2020 2020 4765 7420  """.        Get 
+0001a310: 6d75 6c74 6920 6c65 7665 6c20 6461 7461  multi level data
+0001a320: 0a0a 2020 2020 2020 2020 5061 7261 6d65  ..        Parame
+0001a330: 7465 7273 0a20 2020 2020 2020 202d 2d2d  ters.        ---
+0001a340: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+0001a350: 616e 6e6f 7461 7469 6f6e 203a 2070 642e  annotation : pd.
+0001a360: 4461 7461 4672 616d 650a 2020 2020 2020  DataFrame.      
+0001a370: 2020 2020 2020 416e 6e6f 7461 7469 6f6e        Annotation
+0001a380: 2064 6174 6120 7468 6174 2063 6f6e 7461   data that conta
+0001a390: 696e 7320 7468 6520 6d75 6c74 696c 6576  ins the multilev
+0001a3a0: 656c 2063 6f6c 756d 6e73 0a0a 2020 2020  el columns..    
+0001a3b0: 2020 2020 6d75 6c74 696c 6576 656c 5f63      multilevel_c
+0001a3c0: 6f6c 7320 3a20 6c69 7374 0a20 2020 2020  ols : list.     
+0001a3d0: 2020 2020 2020 204c 6973 7420 6f66 2063         List of c
+0001a3e0: 6f6c 756d 6e20 6e61 6d65 7320 746f 2062  olumn names to b
+0001a3f0: 6520 7573 6564 2066 6f72 206d 756c 7469  e used for multi
+0001a400: 6c65 7665 6c20 6461 7461 0a0a 2020 2020  level data..    
+0001a410: 2020 2020 5265 7475 726e 730a 2020 2020      Returns.    
+0001a420: 2020 2020 2d2d 2d2d 2d2d 2d0a 2020 2020      -------.    
+0001a430: 2020 2020 6d75 6c74 696c 6576 656c 5f64      multilevel_d
+0001a440: 6174 6120 3a20 7064 2e44 6174 6146 7261  ata : pd.DataFra
+0001a450: 6d65 0a20 2020 2020 2020 2020 2020 2044  me.            D
+0001a460: 6174 6120 7769 7468 206d 756c 7469 6c65  ata with multile
+0001a470: 7665 6c20 636f 6c75 6d6e 730a 2020 2020  vel columns.    
+0001a480: 2020 2020 2222 220a 0a20 2020 2020 2020      """..       
+0001a490: 2064 6174 615f 636f 7079 203d 2073 656c   data_copy = sel
+0001a4a0: 662e 6461 7461 2e63 6f70 7928 290a 2020  f.data.copy().  
+0001a4b0: 2020 2020 2020 7374 7269 6e67 5f63 6f6c        string_col
+0001a4c0: 7320 3d20 6461 7461 5f63 6f70 792e 7365  s = data_copy.se
+0001a4d0: 6c65 6374 5f64 7479 7065 7328 2773 7472  lect_dtypes('str
+0001a4e0: 696e 6727 292e 636f 6c75 6d6e 732e 746f  ing').columns.to
+0001a4f0: 5f6c 6973 7428 290a 2020 2020 2020 2020  _list().        
+0001a500: 636f 6c73 203d 2061 6e6e 6f74 6174 696f  cols = annotatio
+0001a510: 6e5b 6d75 6c74 696c 6576 656c 5f63 6f6c  n[multilevel_col
+0001a520: 735d 0a20 2020 2020 2020 2063 6f6c 735f  s].        cols_
+0001a530: 6461 7461 203d 2070 642e 4461 7461 4672  data = pd.DataFr
+0001a540: 616d 6528 290a 0a20 2020 2020 2020 2066  ame()..        f
+0001a550: 6f72 2063 6f6c 735f 6e61 6d65 2069 6e20  or cols_name in 
+0001a560: 636f 6c73 2e63 6f6c 756d 6e73 2e75 6e69  cols.columns.uni
+0001a570: 7175 6528 293a 0a20 2020 2020 2020 2020  que():.         
+0001a580: 2020 2063 6f6c 735f 6461 7461 5b63 6f6c     cols_data[col
+0001a590: 735f 6e61 6d65 5d20 3d20 7374 7269 6e67  s_name] = string
+0001a5a0: 5f63 6f6c 7320 2b20 636f 6c73 5b63 6f6c  _cols + cols[col
+0001a5b0: 735f 6e61 6d65 5d2e 746f 5f6c 6973 7428  s_name].to_list(
+0001a5c0: 290a 0a20 2020 2020 2020 206d 756c 7469  )..        multi
+0001a5d0: 5f63 6f6c 7320 3d20 7064 2e4d 756c 7469  _cols = pd.Multi
+0001a5e0: 496e 6465 782e 6672 6f6d 5f66 7261 6d65  Index.from_frame
+0001a5f0: 2863 6f6c 735f 6461 7461 290a 2020 2020  (cols_data).    
+0001a600: 2020 2020 6461 7461 5f63 6f70 792e 636f      data_copy.co
+0001a610: 6c75 6d6e 7320 3d20 6d75 6c74 695f 636f  lumns = multi_co
+0001a620: 6c73 0a20 2020 2020 2020 2073 656c 662e  ls.        self.
+0001a630: 6d75 6c74 696c 6576 656c 5f64 6174 6120  multilevel_data 
+0001a640: 3d20 6461 7461 5f63 6f70 792e 636f 7079  = data_copy.copy
+0001a650: 2829 0a0a 2020 2020 2020 2020 7265 7475  ()..        retu
+0001a660: 726e 2073 656c 662e 6d75 6c74 696c 6576  rn self.multilev
+0001a670: 656c 5f64 6174 610a 0a20 2020 2064 6566  el_data..    def
+0001a680: 2073 696e 676c 655f 6c65 7665 6c5f 6461   single_level_da
+0001a690: 7461 2873 656c 662c 206c 6576 656c 2c20  ta(self, level, 
+0001a6a0: 6461 7461 3d4e 6f6e 6529 3a0a 0a20 2020  data=None):..   
+0001a6b0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+0001a6c0: 2047 6574 2061 2073 696e 676c 6520 6c65   Get a single le
+0001a6d0: 7665 6c20 636f 6c75 6d6e 2064 6174 6120  vel column data 
+0001a6e0: 6672 6f6d 206d 756c 7469 6c65 7665 6c20  from multilevel 
+0001a6f0: 6461 7461 0a0a 2020 2020 2020 2020 5061  data..        Pa
+0001a700: 7261 6d65 7465 7273 0a20 2020 2020 2020  rameters.       
+0001a710: 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020   ----------.    
+0001a720: 2020 2020 6c65 7665 6c20 3a20 696e 740a      level : int.
+0001a730: 2020 2020 2020 2020 2020 2020 4c65 7665              Leve
+0001a740: 6c20 6f66 2074 6865 2063 6f6c 756d 6e20  l of the column 
+0001a750: 746f 2062 6520 6578 7472 6163 7465 640a  to be extracted.
+0001a760: 0a20 2020 2020 2020 2064 6174 6120 3a20  .        data : 
+0001a770: 7064 2e44 6174 6146 7261 6d65 0a20 2020  pd.DataFrame.   
+0001a780: 2020 2020 2020 2020 2020 2844 6566 6175            (Defau
+0001a790: 6c74 2076 616c 7565 203d 204e 6f6e 6529  lt value = None)
+0001a7a0: 0a0a 2020 2020 2020 2020 5265 7475 726e  ..        Return
+0001a7b0: 730a 2020 2020 2020 2020 2d2d 2d2d 2d2d  s.        ------
+0001a7c0: 2d0a 2020 2020 2020 2020 6765 745f 6c65  -.        get_le
+0001a7d0: 7665 6c5f 6461 7461 203a 2070 642e 4461  vel_data : pd.Da
+0001a7e0: 7461 4672 616d 650a 2020 2020 2020 2020  taFrame.        
+0001a7f0: 2020 2020 4461 7461 2077 6974 6820 7369      Data with si
+0001a800: 6e67 6c65 206c 6576 656c 2063 6f6c 756d  ngle level colum
+0001a810: 6e73 0a20 2020 2020 2020 2022 2222 0a20  ns.        """. 
+0001a820: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
+0001a830: 616e 6365 2864 6174 612c 2070 642e 4461  ance(data, pd.Da
+0001a840: 7461 4672 616d 6529 3a0a 2020 2020 2020  taFrame):.      
+0001a850: 2020 2020 2020 6765 745f 6c65 7665 6c5f        get_level_
+0001a860: 6461 7461 203d 2064 6174 612e 636f 7079  data = data.copy
+0001a870: 2829 0a20 2020 2020 2020 2020 2020 2067  ().            g
+0001a880: 6574 5f6c 6576 656c 5f64 6174 612e 636f  et_level_data.co
+0001a890: 6c75 6d6e 7320 3d20 6765 745f 6c65 7665  lumns = get_leve
+0001a8a0: 6c5f 6461 7461 2e63 6f6c 756d 6e73 2e67  l_data.columns.g
+0001a8b0: 6574 5f6c 6576 656c 5f76 616c 7565 7328  et_level_values(
+0001a8c0: 6c65 7665 6c29 0a0a 2020 2020 2020 2020  level)..        
+0001a8d0: 2020 2020 7265 7475 726e 2067 6574 5f6c      return get_l
+0001a8e0: 6576 656c 5f64 6174 610a 0a20 2020 2020  evel_data..     
+0001a8f0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+0001a900: 2020 2020 2067 6574 5f6c 6576 656c 5f64       get_level_d
+0001a910: 6174 6120 3d20 7365 6c66 2e6d 756c 7469  ata = self.multi
+0001a920: 6c65 7665 6c5f 6461 7461 2e63 6f70 7928  level_data.copy(
+0001a930: 290a 2020 2020 2020 2020 2020 2020 6765  ).            ge
+0001a940: 745f 6c65 7665 6c5f 6461 7461 2e63 6f6c  t_level_data.col
+0001a950: 756d 6e73 203d 2067 6574 5f6c 6576 656c  umns = get_level
+0001a960: 5f64 6174 612e 636f 6c75 6d6e 732e 6765  _data.columns.ge
+0001a970: 745f 6c65 7665 6c5f 7661 6c75 6573 286c  t_level_values(l
+0001a980: 6576 656c 290a 2020 2020 2020 2020 2020  evel).          
+0001a990: 2020 7365 6c66 2e64 6174 6120 3d20 6765    self.data = ge
+0001a9a0: 745f 6c65 7665 6c5f 6461 7461 2e63 6f70  t_level_data.cop
+0001a9b0: 7928 290a 0a20 2020 2020 2020 2020 2020  y()..           
+0001a9c0: 2072 6574 7572 6e20 6765 745f 6c65 7665   return get_leve
+0001a9d0: 6c5f 6461 7461 0a0a 2020 2020 6465 6620  l_data..    def 
+0001a9e0: 6d75 6c74 696c 6576 656c 5f73 756d 6d61  multilevel_summa
+0001a9f0: 7279 5f73 7461 7428 7365 6c66 2c20 6c65  ry_stat(self, le
+0001aa00: 7665 6c2c 206f 7574 7075 745f 6c65 7665  vel, output_leve
+0001aa10: 6c2c 2073 756d 6d61 7279 5f73 7461 7469  l, summary_stati
+0001aa20: 7374 6963 293a 0a0a 2020 2020 2020 2020  stic):..        
+0001aa30: 2222 220a 2020 2020 2020 2020 4765 7420  """.        Get 
+0001aa40: 7468 6520 6d65 616e 206f 6620 6120 7369  the mean of a si
+0001aa50: 6e67 6c65 206c 6576 656c 2064 6174 610a  ngle level data.
+0001aa60: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
+0001aa70: 6572 730a 2020 2020 2020 2020 2d2d 2d2d  ers.        ----
+0001aa80: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 206c  ------.        l
+0001aa90: 6576 656c 203a 2069 6e74 0a20 2020 2020  evel : int.     
+0001aaa0: 2020 2020 2020 204c 6576 656c 206f 6620         Level of 
+0001aab0: 7468 6520 636f 6c75 6d6e 2074 6f20 6361  the column to ca
+0001aac0: 6c63 756c 6174 6520 7468 6520 7374 6174  lculate the stat
+0001aad0: 6973 7469 6320 6672 6f6d 0a0a 2020 2020  istic from..    
+0001aae0: 2020 2020 6f75 7470 7574 5f6c 6576 656c      output_level
+0001aaf0: 203a 2069 6e74 0a20 2020 2020 2020 2020   : int.         
+0001ab00: 2020 204c 6576 656c 206f 6620 7468 6520     Level of the 
+0001ab10: 636f 6c75 6d6e 2074 6f20 6265 2075 7365  column to be use
+0001ab20: 6420 6173 2074 6865 206f 7574 7075 740a  d as the output.
+0001ab30: 2020 2020 2020 2020 2020 2020 0a20 2020              .   
+0001ab40: 2020 2020 2073 756d 6d61 7279 5f73 7461       summary_sta
+0001ab50: 7469 7374 6963 203a 2073 7472 0a20 2020  tistic : str.   
+0001ab60: 2020 2020 2020 2020 2053 756d 6d61 7279           Summary
+0001ab70: 2073 7461 7469 7374 6963 2074 6f20 6265   statistic to be
+0001ab80: 2063 616c 6375 6c61 7465 642e 2045 6974   calculated. Eit
+0001ab90: 6865 7220 276d 6561 6e27 206f 7220 276d  her 'mean' or 'm
+0001aba0: 6564 6961 6e27 0a0a 2020 2020 2020 2020  edian'..        
+0001abb0: 5265 7475 726e 730a 2020 2020 2020 2020  Returns.        
+0001abc0: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+0001abd0: 7375 6d6d 6172 795f 6461 7461 203a 2070  summary_data : p
+0001abe0: 642e 4461 7461 4672 616d 650a 2020 2020  d.DataFrame.    
+0001abf0: 2020 2020 2020 2020 4461 7461 2077 6974          Data wit
+0001ac00: 6820 7468 6520 7375 6d6d 6172 7920 7374  h the summary st
+0001ac10: 6174 6973 7469 6320 616e 6420 7369 6e67  atistic and sing
+0001ac20: 6c65 206c 6576 656c 2063 6f6c 756d 6e73  le level columns
+0001ac30: 0a20 2020 2020 2020 2022 2222 0a0a 2020  .        """..  
+0001ac40: 2020 2020 2020 6461 7461 5f63 6f70 7920        data_copy 
+0001ac50: 3d20 7365 6c66 2e6d 756c 7469 6c65 7665  = self.multileve
+0001ac60: 6c5f 6461 7461 2e73 656c 6563 745f 6474  l_data.select_dt
+0001ac70: 7970 6573 2827 666c 6f61 7427 292e 636f  ypes('float').co
+0001ac80: 7079 2829 0a0a 2020 2020 2020 2020 6966  py()..        if
+0001ac90: 2073 756d 6d61 7279 5f73 7461 7469 7374   summary_statist
+0001aca0: 6963 203d 3d20 276d 6561 6e27 3a0a 2020  ic == 'mean':.  
+0001acb0: 2020 2020 2020 2020 2020 7375 6d6d 6172            summar
+0001acc0: 795f 6461 7461 203d 2064 6174 615f 636f  y_data = data_co
+0001acd0: 7079 2e67 726f 7570 6279 286c 6576 656c  py.groupby(level
+0001ace0: 3d5b 6c65 7665 6c2c 206f 7574 7075 745f  =[level, output_
+0001acf0: 6c65 7665 6c5d 2c20 6178 6973 3d31 292e  level], axis=1).
+0001ad00: 6d65 616e 2829 0a0a 2020 2020 2020 2020  mean()..        
+0001ad10: 656c 6966 2073 756d 6d61 7279 5f73 7461  elif summary_sta
+0001ad20: 7469 7374 6963 203d 3d20 276d 6564 6961  tistic == 'media
+0001ad30: 6e27 3a0a 2020 2020 2020 2020 2020 2020  n':.            
+0001ad40: 7375 6d6d 6172 795f 6461 7461 203d 2064  summary_data = d
+0001ad50: 6174 615f 636f 7079 2e67 726f 7570 6279  ata_copy.groupby
+0001ad60: 286c 6576 656c 3d5b 6c65 7665 6c2c 206f  (level=[level, o
+0001ad70: 7574 7075 745f 6c65 7665 6c5d 2c20 6178  utput_level], ax
+0001ad80: 6973 3d31 292e 6d65 6469 616e 2829 0a0a  is=1).median()..
+0001ad90: 2020 2020 2020 2020 7375 6d6d 6172 795f          summary_
+0001ada0: 6461 7461 203d 2073 656c 662e 7369 6e67  data = self.sing
+0001adb0: 6c65 5f6c 6576 656c 5f64 6174 6128 6f75  le_level_data(ou
+0001adc0: 7470 7574 5f6c 6576 656c 2c20 7375 6d6d  tput_level, summ
+0001add0: 6172 795f 6461 7461 290a 2020 2020 2020  ary_data).      
+0001ade0: 2020 7374 7269 6e67 5f64 6174 6120 3d20    string_data = 
+0001adf0: 7365 6c66 2e73 696e 676c 655f 6c65 7665  self.single_leve
+0001ae00: 6c5f 6461 7461 286f 7574 7075 745f 6c65  l_data(output_le
+0001ae10: 7665 6c2c 2073 656c 662e 6d75 6c74 696c  vel, self.multil
+0001ae20: 6576 656c 5f64 6174 612e 7365 6c65 6374  evel_data.select
+0001ae30: 5f64 7479 7065 7328 2773 7472 696e 6727  _dtypes('string'
+0001ae40: 2929 0a20 2020 2020 2020 2073 756d 6d61  )).        summa
+0001ae50: 7279 5f64 6174 6120 3d20 7374 7269 6e67  ry_data = string
+0001ae60: 5f64 6174 612e 6d65 7267 6528 7375 6d6d  _data.merge(summ
+0001ae70: 6172 795f 6461 7461 2c20 6c65 6674 5f69  ary_data, left_i
+0001ae80: 6e64 6578 3d54 7275 652c 2072 6967 6874  ndex=True, right
+0001ae90: 5f69 6e64 6578 3d54 7275 6529 0a20 2020  _index=True).   
+0001aea0: 2020 2020 2073 656c 662e 7375 6d6d 6172       self.summar
+0001aeb0: 795f 6461 7461 203d 2073 756d 6d61 7279  y_data = summary
+0001aec0: 5f64 6174 612e 636f 7079 2829 0a0a 2020  _data.copy()..  
+0001aed0: 2020 2020 2020 7265 7475 726e 2073 756d        return sum
+0001aee0: 6d61 7279 5f64 6174 6100 0000 0000 0000  mary_data.......
 0001aef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001af00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001af10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001af20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001af30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001af40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001af50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -6906,507 +6906,507 @@
 0001af90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001afa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001afb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001afc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001afd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001afe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001aff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001b000: 7072 6f74 656f 6d69 6373 5f64 6f77 6e73  proteomics_downs
-0001b010: 7472 6561 6d5f 616e 616c 7973 6973 2d30  tream_analysis-0
-0001b020: 2e31 2e32 2f70 726f 7465 6f6d 6963 735f  .1.2/proteomics_
-0001b030: 646f 776e 7374 7265 616d 5f61 6e61 6c79  downstream_analy
-0001b040: 7369 732f 7072 6570 726f 6365 7373 696e  sis/preprocessin
-0001b050: 672e 7079 0000 0000 0000 0000 0000 0000  g.py............
-0001b060: 0000 0000 3030 3030 3634 3400 3030 3031  ....0000644.0001
-0001b070: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
-0001b080: 3030 3134 3330 3600 3134 3435 3130 3636  0014306.14451066
-0001b090: 3233 3500 3033 3132 3436 0020 3000 0000  235.031246. 0...
+0001b000: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+0001b010: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001b020: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001b030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001b040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001b050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001b060: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+0001b070: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+0001b080: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
+0001b090: 3030 3000 3031 3032 3133 0020 7800 0000  000.010213. x...
 0001b0a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001b0b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001b0c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001b0d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001b0e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001b0f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001b100: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
+0001b100: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
 0001b110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001b120: 0000 0000 0000 0000 0064 6f63 6b65 7200  .........docker.
+0001b120: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001b130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001b140: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001b150: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001b160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001b170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001b180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001b190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001b1a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001b1b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001b1c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001b1d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001b1e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001b1f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001b200: 696d 706f 7274 206e 756d 7079 2061 7320  import numpy as 
-0001b210: 6e70 0a0a 636c 6173 7320 5072 6570 726f  np..class Prepro
-0001b220: 6365 7373 696e 673a 0a20 2020 200a 2020  cessing:.    .  
-0001b230: 2020 2222 2254 6869 7320 636c 6173 7320    """This class 
-0001b240: 656e 6361 7073 756c 6174 6573 2070 7265  encapsulates pre
-0001b250: 7072 6f63 6573 7369 6e67 2073 7465 7073  processing steps
-0001b260: 2222 220a 2020 2020 0a20 2020 2064 6566  """.    .    def
-0001b270: 205f 5f69 6e69 745f 5f28 7365 6c66 293a   __init__(self):
-0001b280: 0a20 2020 2020 2020 2070 6173 7320 0a20  .        pass . 
-0001b290: 2020 2020 2020 200a 2020 2020 6465 6620         .    def 
-0001b2a0: 5f63 6861 6e67 655f 6461 7461 7479 7065  _change_datatype
-0001b2b0: 7328 7365 6c66 2c20 6461 7461 293a 0a20  s(self, data):. 
-0001b2c0: 2020 2020 2020 200a 2020 2020 2020 2020         .        
-0001b2d0: 2222 220a 2020 2020 2020 2020 6368 616e  """.        chan
-0001b2e0: 6765 2064 6174 6174 7970 6573 0a0a 2020  ge datatypes..  
-0001b2f0: 2020 2020 2020 5061 7261 6d65 7465 7273        Parameters
-0001b300: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-0001b310: 2d2d 2d0a 2020 2020 2020 2020 6461 7461  ---.        data
-0001b320: 203a 2070 642e 4461 7461 4672 616d 650a   : pd.DataFrame.
-0001b330: 2020 2020 2020 2020 2020 2020 6461 7461              data
-0001b340: 2077 6974 6820 6f72 6967 696e 616c 2064   with original d
-0001b350: 6174 6174 7970 6573 0a20 2020 2020 2020  atatypes.       
-0001b360: 2052 6574 7572 6e73 0a20 2020 2020 2020   Returns.       
-0001b370: 202d 2d2d 2d2d 2d2d 0a20 2020 2020 2020   -------.       
-0001b380: 2064 6174 6120 3a20 7064 2e44 6174 6146   data : pd.DataF
-0001b390: 7261 6d65 0a20 2020 2020 2020 2020 2020  rame.           
-0001b3a0: 2064 6174 6120 7769 7468 2063 6861 6e67   data with chang
-0001b3b0: 6564 2064 6174 6174 7970 6573 0a20 2020  ed datatypes.   
-0001b3c0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-0001b3d0: 200a 2020 2020 2020 2020 666f 7220 6920   .        for i 
-0001b3e0: 696e 2064 6174 612e 636f 6c75 6d6e 732e  in data.columns.
-0001b3f0: 756e 6971 7565 2829 3a0a 2020 2020 2020  unique():.      
-0001b400: 2020 2020 2020 6966 2069 2069 6e20 5b27        if i in ['
-0001b410: 5072 6f74 6569 6e2e 4772 6f75 7027 2c20  Protein.Group', 
-0001b420: 2750 726f 7465 696e 2e49 6473 272c 2027  'Protein.Ids', '
-0001b430: 5072 6f74 6569 6e2e 4e61 6d65 7327 2c20  Protein.Names', 
-0001b440: 2747 656e 6573 272c 2746 6972 7374 2e50  'Genes','First.P
-0001b450: 726f 7465 696e 2e44 6573 6372 6970 7469  rotein.Descripti
-0001b460: 6f6e 275d 3a0a 2020 2020 2020 2020 2020  on']:.          
-0001b470: 2020 2020 2020 6461 7461 5b69 5d20 3d20        data[i] = 
-0001b480: 6461 7461 5b69 5d2e 6173 7479 7065 2827  data[i].astype('
-0001b490: 7374 7269 6e67 2729 0a20 2020 2020 2020  string').       
-0001b4a0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-0001b4b0: 2020 2020 2020 2020 2020 2064 6174 615b             data[
-0001b4c0: 695d 203d 2064 6174 615b 695d 2e61 7374  i] = data[i].ast
-0001b4d0: 7970 6528 2766 6c6f 6174 2729 200a 2020  ype('float') .  
-0001b4e0: 2020 2020 2020 7265 7475 726e 2064 6174        return dat
-0001b4f0: 610a 2020 2020 0a20 2020 2064 6566 205f  a.    .    def _
-0001b500: 6c6f 6732 5f74 7261 6e73 666f 726d 2873  log2_transform(s
-0001b510: 656c 662c 2064 6174 6129 3a0a 2020 2020  elf, data):.    
-0001b520: 2020 2020 0a20 2020 2020 2020 2022 2222      .        """
-0001b530: 0a20 2020 2020 2020 206c 6f67 3220 7472  .        log2 tr
-0001b540: 616e 7366 726f 6d20 666c 6f61 7420 6461  ansfrom float da
-0001b550: 7461 0a0a 2020 2020 2020 2020 5061 7261  ta..        Para
-0001b560: 6d65 7465 7273 0a20 2020 2020 2020 202d  meters.        -
-0001b570: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
-0001b580: 2020 6461 7461 203a 2070 642e 4461 7461    data : pd.Data
-0001b590: 4672 616d 650a 2020 2020 2020 2020 2020  Frame.          
-0001b5a0: 2020 6461 7461 2077 6974 6820 666c 6f61    data with floa
-0001b5b0: 7420 6461 7461 0a0a 2020 2020 2020 2020  t data..        
-0001b5c0: 5265 7475 726e 730a 2020 2020 2020 2020  Returns.        
-0001b5d0: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-0001b5e0: 6461 7461 203a 2070 642e 4461 7461 4672  data : pd.DataFr
-0001b5f0: 616d 650a 2020 2020 2020 2020 2020 2020  ame.            
-0001b600: 6461 7461 2077 6974 6820 6c6f 6732 2074  data with log2 t
-0001b610: 7261 6e73 666f 726d 6564 2066 6c6f 6174  ransformed float
-0001b620: 2064 6174 610a 2020 2020 2020 2020 2222   data.        ""
-0001b630: 220a 0a20 2020 2020 2020 2066 6f72 2069  "..        for i
-0001b640: 2069 6e20 6461 7461 2e73 656c 6563 745f   in data.select_
-0001b650: 6474 7970 6573 2827 666c 6f61 7427 292e  dtypes('float').
-0001b660: 636f 6c75 6d6e 732e 756e 6971 7565 2829  columns.unique()
-0001b670: 3a0a 2020 2020 2020 2020 2020 2020 6461  :.            da
-0001b680: 7461 5b69 5d20 3d20 6e70 2e6c 6f67 3228  ta[i] = np.log2(
-0001b690: 6461 7461 5b69 5d29 0a20 2020 2020 2020  data[i]).       
-0001b6a0: 2072 6574 7572 6e20 6461 7461 0a20 2020   return data.   
-0001b6b0: 2020 2020 200a 2020 2020 6465 6620 5f66       .    def _f
-0001b6c0: 696c 7465 725f 666f 725f 7661 6c69 645f  ilter_for_valid_
-0001b6d0: 7661 6c73 5f69 6e5f 6f6e 655f 6578 705f  vals_in_one_exp_
-0001b6e0: 6772 6f75 7028 7365 6c66 2c20 6461 7461  group(self, data
-0001b6f0: 293a 0a20 2020 2020 2020 200a 2020 2020  ):.        .    
-0001b700: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-0001b710: 4669 6c74 6572 2066 6f72 2076 616c 6964  Filter for valid
-0001b720: 2076 616c 7565 7320 696e 2061 7420 6c65   values in at le
-0001b730: 6173 7420 6f6e 6520 6578 7065 7269 6d65  ast one experime
-0001b740: 6e74 616c 2067 726f 7570 0a0a 2020 2020  ntal group..    
-0001b750: 2020 2020 5061 7261 6d65 7465 7273 0a20      Parameters. 
-0001b760: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
-0001b770: 2d0a 2020 2020 2020 2020 6461 7461 203a  -.        data :
-0001b780: 2070 642e 4461 7461 4672 616d 650a 2020   pd.DataFrame.  
-0001b790: 2020 2020 2020 2020 2020 6461 7461 2077            data w
-0001b7a0: 6974 6820 666c 6f61 7420 6461 7461 0a20  ith float data. 
-0001b7b0: 2020 2020 2020 200a 2020 2020 2020 2020         .        
-0001b7c0: 5265 7475 726e 730a 2020 2020 2020 2020  Returns.        
-0001b7d0: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-0001b7e0: 6461 7461 203a 2070 642e 4461 7461 4672  data : pd.DataFr
-0001b7f0: 616d 650a 2020 2020 2020 2020 2020 2020  ame.            
-0001b800: 6461 7461 2077 6974 6820 7661 6c69 6420  data with valid 
-0001b810: 7661 6c75 6573 2069 6e20 6174 206c 6561  values in at lea
-0001b820: 7374 206f 6e65 2065 7870 6572 696d 656e  st one experimen
-0001b830: 7461 6c20 6772 6f75 700a 2020 2020 2020  tal group.      
-0001b840: 2020 2222 220a 2020 2020 2020 2020 2020    """.          
-0001b850: 2020 0a20 2020 2020 2020 2063 6f6c 756d    .        colum
-0001b860: 6e73 5f6e 616d 6520 3d20 6461 7461 2e73  ns_name = data.s
-0001b870: 656c 6563 745f 6474 7970 6573 2827 666c  elect_dtypes('fl
-0001b880: 6f61 7427 292e 636f 6c75 6d6e 732e 756e  oat').columns.un
-0001b890: 6971 7565 2829 0a20 2020 2020 2020 2020  ique().         
-0001b8a0: 2020 200a 2020 2020 2020 2020 696e 6469     .        indi
-0001b8b0: 6365 7320 3d20 5b5d 0a20 2020 2020 2020  ces = [].       
-0001b8c0: 2020 2020 200a 2020 2020 2020 2020 666f       .        fo
-0001b8d0: 7220 636f 6c20 696e 2063 6f6c 756d 6e73  r col in columns
-0001b8e0: 5f6e 616d 653a 0a20 2020 2020 2020 2020  _name:.         
-0001b8f0: 2020 206e 6f6e 5f6e 615f 696e 6469 6365     non_na_indice
-0001b900: 7320 3d20 6461 7461 5b64 6174 615b 636f  s = data[data[co
-0001b910: 6c5d 2e69 736e 6128 292e 7375 6d28 6178  l].isna().sum(ax
-0001b920: 6973 3d31 293d 3d30 5d2e 696e 6465 782e  is=1)==0].index.
-0001b930: 746f 5f6c 6973 7428 290a 2020 2020 2020  to_list().      
-0001b940: 2020 2020 2020 696e 6469 6365 7320 2b3d        indices +=
-0001b950: 206e 6f6e 5f6e 615f 696e 6469 6365 730a   non_na_indices.
-0001b960: 2020 2020 2020 2020 696e 6469 6365 7320          indices 
-0001b970: 3d20 6c69 7374 2873 6574 2869 6e64 6963  = list(set(indic
-0001b980: 6573 2929 0a20 2020 2020 2020 2064 6174  es)).        dat
-0001b990: 6120 3d20 6461 7461 5b64 6174 612e 696e  a = data[data.in
-0001b9a0: 6465 782e 6973 696e 2869 6e64 6963 6573  dex.isin(indices
-0001b9b0: 295d 2e72 6573 6574 5f69 6e64 6578 2864  )].reset_index(d
-0001b9c0: 726f 7020 3d20 5472 7565 290a 2020 2020  rop = True).    
-0001b9d0: 2020 2020 0a20 2020 2020 2020 2072 6574      .        ret
-0001b9e0: 7572 6e20 6461 7461 0a20 2020 200a 2020  urn data.    .  
-0001b9f0: 2020 6465 6620 5f69 6d70 7574 655f 6765    def _impute_ge
-0001ba00: 6e65 735f 7769 7468 5f70 726f 7465 696e  nes_with_protein
-0001ba10: 5f69 6473 2873 656c 662c 2064 6174 6129  _ids(self, data)
-0001ba20: 3a0a 2020 2020 2020 2020 0a20 2020 2020  :.        .     
-0001ba30: 2020 2022 2222 0a20 2020 2020 2020 2049     """.        I
-0001ba40: 6d70 7574 696e 6720 6d69 7373 696e 6720  mputing missing 
-0001ba50: 7661 6c75 6573 2069 6e20 4765 6e65 7320  values in Genes 
-0001ba60: 636f 6c75 6d6e 2077 6974 6820 7468 6520  column with the 
-0001ba70: 7072 6f74 6569 6e20 4944 730a 0a20 2020  protein IDs..   
-0001ba80: 2020 2020 2050 6172 616d 6574 6572 730a       Parameters.
-0001ba90: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-0001baa0: 2d2d 0a20 2020 2020 2020 2064 6174 6120  --.        data 
-0001bab0: 3a20 7064 2e44 6174 6146 7261 6d65 0a20  : pd.DataFrame. 
-0001bac0: 2020 2020 2020 2020 2020 2064 6174 6120             data 
-0001bad0: 746f 2062 6520 696d 7075 7465 640a 0a20  to be imputed.. 
-0001bae0: 2020 2020 2020 2052 6574 7572 6e73 0a20         Returns. 
-0001baf0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 0a20         -------. 
-0001bb00: 2020 2020 2020 2064 6174 6120 3a20 7064         data : pd
-0001bb10: 2e44 6174 6146 7261 6d65 0a20 2020 2020  .DataFrame.     
-0001bb20: 2020 2020 2020 2064 6174 6120 7769 7468         data with
-0001bb30: 2069 6d70 7574 6564 2067 656e 6520 7661   imputed gene va
-0001bb40: 6c75 6573 0a20 2020 2020 2020 2022 2222  lues.        """
-0001bb50: 0a20 2020 2020 2020 2069 6d70 7574 6174  .        imputat
-0001bb60: 696f 6e5f 7661 6c75 6573 203d 205b 692e  ion_values = [i.
-0001bb70: 7370 6c69 7428 273b 2729 5b30 5d20 666f  split(';')[0] fo
-0001bb80: 7220 6920 696e 2064 6174 615b 6461 7461  r i in data[data
-0001bb90: 5b27 4765 6e65 7327 5d2e 6973 6e61 2829  ['Genes'].isna()
-0001bba0: 5d5b 2750 726f 7465 696e 2e49 6473 275d  ]['Protein.Ids']
-0001bbb0: 2e76 616c 7565 735d 0a20 2020 2020 2020  .values].       
-0001bbc0: 200a 2020 2020 2020 2020 666f 7220 6964   .        for id
-0001bbd0: 782c 2076 616c 7565 2069 6e20 7a69 7028  x, value in zip(
-0001bbe0: 6461 7461 5b64 6174 615b 2747 656e 6573  data[data['Genes
-0001bbf0: 275d 2e69 736e 6128 295d 5b27 5072 6f74  '].isna()]['Prot
-0001bc00: 6569 6e2e 4964 7327 5d2e 696e 6465 782c  ein.Ids'].index,
-0001bc10: 2069 6d70 7574 6174 696f 6e5f 7661 6c75   imputation_valu
-0001bc20: 6573 293a 0a20 2020 2020 2020 2020 2020  es):.           
-0001bc30: 2064 6174 612e 6c6f 635b 6964 782c 205b   data.loc[idx, [
-0001bc40: 2747 656e 6573 275d 5d20 3d20 7661 6c75  'Genes']] = valu
-0001bc50: 650a 0a20 2020 2020 2020 2072 6574 7572  e..        retur
-0001bc60: 6e20 6461 7461 0a20 2020 200a 2020 2020  n data.    .    
-0001bc70: 6465 6620 5f69 6d70 7574 655f 6261 7365  def _impute_base
-0001bc80: 645f 6f6e 5f67 6175 7373 6961 6e28 7365  d_on_gaussian(se
-0001bc90: 6c66 2c20 6461 7461 293a 0a20 2020 2020  lf, data):.     
-0001bca0: 2020 2020 0a20 2020 2020 2020 2022 2222      .        """
-0001bcb0: 0a20 2020 2020 2020 2054 6869 7320 6675  .        This fu
-0001bcc0: 6e63 7469 6f6e 2069 6d70 7574 6573 206d  nction imputes m
-0001bcd0: 6973 7369 6e67 2076 616c 7565 7320 696e  issing values in
-0001bce0: 2061 2064 6174 6173 6574 2075 7369 6e67   a dataset using
-0001bcf0: 2061 2047 6175 7373 6961 6e20 6469 7374   a Gaussian dist
-0001bd00: 7269 6275 7469 6f6e 2e0a 2020 2020 2020  ribution..      
-0001bd10: 2020 5468 6520 6d69 7373 696e 6720 7661    The missing va
-0001bd20: 6c75 6573 2061 7265 2069 6d70 7574 6564  lues are imputed
-0001bd30: 2062 7920 7261 6e64 6f6d 2073 616d 706c   by random sampl
-0001bd40: 696e 6720 7661 6c75 6573 2066 726f 6d20  ing values from 
-0001bd50: 6120 4761 7573 7369 616e 2064 6973 7472  a Gaussian distr
-0001bd60: 6962 7574 696f 6e20 7769 7468 2061 206d  ibution with a m
-0001bd70: 6561 6e0a 2020 2020 2020 2020 6f66 2033  ean.        of 3
-0001bd80: 2073 7461 6e64 6172 6420 6465 7669 6174   standard deviat
-0001bd90: 696f 6e73 2062 656c 6f77 2074 6865 2063  ions below the c
-0001bda0: 6f6d 7075 7465 6420 6d65 616e 2061 6e64  omputed mean and
-0001bdb0: 2061 2077 6964 7468 206f 6620 302e 3320   a width of 0.3 
-0001bdc0: 7469 6d65 7320 7468 6520 636f 6d70 7574  times the comput
-0001bdd0: 6564 2073 7461 6e64 6172 6420 6465 7669  ed standard devi
-0001bde0: 6174 696f 6e2e 0a20 2020 2020 2020 2054  ation..        T
-0001bdf0: 6865 2066 756e 6374 696f 6e20 7265 7475  he function retu
-0001be00: 726e 7320 6120 636f 7079 206f 6620 7468  rns a copy of th
-0001be10: 6520 696d 7075 7465 6420 6461 7461 7365  e imputed datase
-0001be20: 7420 7769 7468 2074 6865 206d 6973 7369  t with the missi
-0001be30: 6e67 2076 616c 7565 7320 7265 706c 6163  ng values replac
-0001be40: 6564 2e0a 0a20 2020 2020 2020 2050 6172  ed...        Par
-0001be50: 616d 6574 6572 730a 2020 2020 2020 2020  ameters.        
-0001be60: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
-0001be70: 2020 2064 6174 6120 3a20 7064 2e44 6174     data : pd.Dat
-0001be80: 6146 7261 6d65 0a20 2020 2020 2020 2020  aFrame.         
-0001be90: 2020 2064 6174 6120 746f 2062 6520 696d     data to be im
-0001bea0: 7075 7465 640a 0a20 2020 2020 2020 2052  puted..        R
-0001beb0: 6574 7572 6e73 0a20 2020 2020 2020 202d  eturns.        -
-0001bec0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2064  ------.        d
-0001bed0: 6174 6120 3a20 7064 2e44 6174 6146 7261  ata : pd.DataFra
-0001bee0: 6d65 0a20 2020 2020 2020 2020 2020 2064  me.            d
-0001bef0: 6174 6120 7769 7468 2069 6d70 7574 6564  ata with imputed
-0001bf00: 2076 616c 7565 730a 2020 2020 2020 2020   values.        
-0001bf10: 2222 220a 2020 2020 2020 2020 2320 7365  """.        # se
-0001bf20: 6c65 6374 206f 6e6c 7920 666c 6f61 7420  lect only float 
-0001bf30: 6461 7461 0a20 2020 2020 2020 2066 6c6f  data.        flo
-0001bf40: 6174 5f64 6174 6120 3d20 6461 7461 2e73  at_data = data.s
-0001bf50: 656c 6563 745f 6474 7970 6573 2827 666c  elect_dtypes('fl
-0001bf60: 6f61 7427 290a 2020 2020 2020 2020 6e61  oat').        na
-0001bf70: 5f64 6174 6120 3d20 666c 6f61 745f 6461  _data = float_da
-0001bf80: 7461 5b66 6c6f 6174 5f64 6174 612e 6973  ta[float_data.is
-0001bf90: 6e61 2829 2e61 6e79 2861 7869 733d 3129  na().any(axis=1)
-0001bfa0: 5d0a 0a20 2020 2020 2020 2023 206c 6f6f  ]..        # loo
-0001bfb0: 7020 7468 726f 7567 6820 6e61 5f64 6174  p through na_dat
-0001bfc0: 6120 726f 7773 2061 6e64 2067 656e 6572  a rows and gener
-0001bfd0: 6174 6520 696d 7075 7465 6420 6461 7461  ate imputed data
-0001bfe0: 0a20 2020 2020 2020 2069 6d70 5f61 7272  .        imp_arr
-0001bff0: 6179 203d 205b 5d0a 0a20 2020 2020 2020  ay = []..       
-0001c000: 2066 6f72 2069 2069 6e20 6e61 5f64 6174   for i in na_dat
-0001c010: 612e 696e 6465 783a 200a 2020 2020 2020  a.index: .      
-0001c020: 2020 2020 2020 6e61 5f63 6f75 6e74 203d        na_count =
-0001c030: 206e 615f 6461 7461 2e6c 6f63 5b69 5d2e   na_data.loc[i].
-0001c040: 6973 6e61 2829 2e73 756d 2829 0a0a 2020  isna().sum()..  
-0001c050: 2020 2020 2020 2020 2020 6d65 616e 203d            mean =
-0001c060: 206e 615f 6461 7461 2e6c 6f63 5b69 5d2e   na_data.loc[i].
-0001c070: 6d65 616e 2873 6b69 706e 613d 5472 7565  mean(skipna=True
-0001c080: 290a 2020 2020 2020 2020 2020 2020 7374  ).            st
-0001c090: 6420 3d20 6e61 5f64 6174 612e 6c6f 635b  d = na_data.loc[
-0001c0a0: 695d 2e73 7464 2873 6b69 706e 613d 5472  i].std(skipna=Tr
-0001c0b0: 7565 290a 0a20 2020 2020 2020 2020 2020  ue)..           
-0001c0c0: 206e 702e 7261 6e64 6f6d 2e73 6565 6428   np.random.seed(
-0001c0d0: 6929 0a20 2020 2020 2020 2020 2020 2069  i).            i
-0001c0e0: 6d70 5f61 7272 6179 2e61 7070 656e 6428  mp_array.append(
-0001c0f0: 6c69 7374 286e 702e 7261 6e64 6f6d 2e6e  list(np.random.n
-0001c100: 6f72 6d61 6c28 6c6f 633d 6d65 616e 2d33  ormal(loc=mean-3
-0001c110: 2a73 7464 2c20 7363 616c 653d 302e 332a  *std, scale=0.3*
-0001c120: 7374 642c 2073 697a 653d 6e61 5f63 6f75  std, size=na_cou
-0001c130: 6e74 2929 290a 0a20 2020 2020 2020 2069  nt)))..        i
-0001c140: 6d70 5f76 616c 7565 735f 6c69 7374 203d  mp_values_list =
-0001c150: 206e 702e 6172 7261 7928 5b69 6d70 5f76   np.array([imp_v
-0001c160: 616c 7565 2066 6f72 2069 6e6e 6572 6c69  alue for innerli
-0001c170: 7374 2069 6e20 696d 705f 6172 7261 7920  st in imp_array 
-0001c180: 666f 7220 696d 705f 7661 6c75 6520 696e  for imp_value in
-0001c190: 2069 6e6e 6572 6c69 7374 5d29 0a0a 2020   innerlist])..  
-0001c1a0: 2020 2020 2020 636f 7069 6564 5f64 6174        copied_dat
-0001c1b0: 6120 3d20 666c 6f61 745f 6461 7461 2e63  a = float_data.c
-0001c1c0: 6f70 7928 290a 2020 2020 2020 2020 636f  opy().        co
-0001c1d0: 6c75 6d6e 7320 3d20 666c 6f61 745f 6461  lumns = float_da
-0001c1e0: 7461 2e63 6f6c 756d 6e73 0a20 2020 2020  ta.columns.     
-0001c1f0: 2020 2063 6f70 6965 645f 6461 7461 2e63     copied_data.c
-0001c200: 6f6c 756d 6e73 203d 206e 702e 6172 616e  olumns = np.aran
-0001c210: 6765 2863 6f70 6965 645f 6461 7461 2e73  ge(copied_data.s
-0001c220: 6861 7065 5b31 5d29 0a20 2020 2020 2020  hape[1]).       
-0001c230: 200a 2020 2020 2020 2020 2320 696d 7075   .        # impu
-0001c240: 7465 2074 6865 2064 6174 610a 2020 2020  te the data.    
-0001c250: 2020 2020 7374 6163 6b65 645f 6e61 5f64      stacked_na_d
-0001c260: 6174 6120 3d20 636f 7069 6564 5f64 6174  ata = copied_dat
-0001c270: 612e 7374 6163 6b28 6472 6f70 6e61 3d46  a.stack(dropna=F
-0001c280: 616c 7365 290a 2020 2020 2020 2020 6e61  alse).        na
-0001c290: 5f69 6e64 6578 203d 2073 7461 636b 6564  _index = stacked
-0001c2a0: 5f6e 615f 6461 7461 5b73 7461 636b 6564  _na_data[stacked
-0001c2b0: 5f6e 615f 6461 7461 2e69 736e 6128 295d  _na_data.isna()]
-0001c2c0: 2e69 6e64 6578 0a20 2020 2020 2020 2073  .index.        s
-0001c2d0: 7461 636b 6564 5f6e 615f 6461 7461 2e6c  tacked_na_data.l
-0001c2e0: 6f63 5b6e 615f 696e 6465 785d 203d 2069  oc[na_index] = i
-0001c2f0: 6d70 5f76 616c 7565 735f 6c69 7374 0a20  mp_values_list. 
-0001c300: 2020 2020 2020 2069 6d70 5f64 6174 6120         imp_data 
-0001c310: 3d20 7374 6163 6b65 645f 6e61 5f64 6174  = stacked_na_dat
-0001c320: 612e 756e 7374 6163 6b28 290a 2020 2020  a.unstack().    
-0001c330: 2020 2020 696d 705f 6461 7461 2e63 6f6c      imp_data.col
-0001c340: 756d 6e73 203d 2063 6f6c 756d 6e73 0a20  umns = columns. 
-0001c350: 2020 2020 2020 2069 6d70 5f64 6174 6120         imp_data 
-0001c360: 3d20 6461 7461 2e73 656c 6563 745f 6474  = data.select_dt
-0001c370: 7970 6573 2827 7374 7269 6e67 2729 2e6d  ypes('string').m
-0001c380: 6572 6765 2869 6d70 5f64 6174 612c 206c  erge(imp_data, l
-0001c390: 6566 745f 696e 6465 783d 5472 7565 2c20  eft_index=True, 
-0001c3a0: 7269 6768 745f 696e 6465 783d 5472 7565  right_index=True
-0001c3b0: 290a 2020 2020 2020 2020 6461 7461 203d  ).        data =
-0001c3c0: 2069 6d70 5f64 6174 612e 636f 7079 2829   imp_data.copy()
-0001c3d0: 0a20 2020 2020 2020 200a 2020 2020 2020  .        .      
-0001c3e0: 2020 7265 7475 726e 2064 6174 610a 0a20    return data.. 
-0001c3f0: 2020 2064 6566 205f 6669 6c74 6572 5f66     def _filter_f
-0001c400: 6f72 5f76 616c 6964 5f76 616c 735f 7065  or_valid_vals_pe
-0001c410: 7263 2873 656c 662c 2064 6174 612c 2070  rc(self, data, p
-0001c420: 6572 6365 6e74 6167 6529 3a0a 2020 2020  ercentage):.    
-0001c430: 0a20 2020 2020 2020 2022 2222 4669 6c74  .        """Filt
-0001c440: 6572 2066 6f72 2076 616c 6964 2076 616c  er for valid val
-0001c450: 7565 7320 7573 696e 6720 6174 206c 6561  ues using at lea
-0001c460: 7374 2078 2025 2064 6174 6120 636f 6d70  st x % data comp
-0001c470: 6c65 7465 6e65 7373 0a0a 2020 2020 2020  leteness..      
-0001c480: 2020 5061 7261 6d65 7465 7273 0a20 2020    Parameters.   
-0001c490: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a       ----------.
-0001c4a0: 2020 2020 2020 2020 6461 7461 203a 2070          data : p
-0001c4b0: 642e 4461 7461 4672 616d 650a 2020 2020  d.DataFrame.    
-0001c4c0: 2020 2020 2020 2020 6461 7461 2074 6f20          data to 
-0001c4d0: 6265 2066 696c 7465 7265 640a 2020 2020  be filtered.    
-0001c4e0: 2020 2020 2020 2020 0a20 2020 2020 2020          .       
-0001c4f0: 2070 6572 6365 6e74 6167 6520 3a20 666c   percentage : fl
-0001c500: 6f61 740a 2020 2020 2020 2020 2020 2020  oat.            
-0001c510: 7065 7263 656e 7461 6765 206f 6620 6465  percentage of de
-0001c520: 7369 7265 6420 6461 7461 2063 6f6d 706c  sired data compl
-0001c530: 6574 656e 6573 730a 0a20 2020 2020 2020  eteness..       
-0001c540: 2052 6574 7572 6e73 0a20 2020 2020 2020   Returns.       
-0001c550: 202d 2d2d 2d2d 2d2d 0a20 2020 2020 2020   -------.       
-0001c560: 2064 6174 6120 3a20 7064 2e44 6174 6146   data : pd.DataF
-0001c570: 7261 6d65 0a20 2020 2020 2020 2020 2020  rame.           
-0001c580: 2064 6174 6120 7769 7468 2076 616c 6964   data with valid
-0001c590: 2076 616c 7565 7320 7573 696e 6720 6174   values using at
-0001c5a0: 206c 6561 7374 2078 2025 2064 6174 6120   least x % data 
-0001c5b0: 636f 6d70 6c65 7465 6e65 7373 0a20 2020  completeness.   
-0001c5c0: 2020 2020 2022 2222 0a20 2020 200a 2020       """.    .  
-0001c5d0: 2020 2020 2020 636f 6c5f 6c65 6e20 3d20        col_len = 
-0001c5e0: 6c65 6e28 6461 7461 2e73 656c 6563 745f  len(data.select_
-0001c5f0: 6474 7970 6573 2827 666c 6f61 7427 292e  dtypes('float').
-0001c600: 636f 6c75 6d6e 7329 0a20 2020 2020 2020  columns).       
-0001c610: 206d 696e 5f73 756d 203d 206e 702e 6365   min_sum = np.ce
-0001c620: 696c 2863 6f6c 5f6c 656e 202a 2070 6572  il(col_len * per
-0001c630: 6365 6e74 6167 6529 0a20 2020 2020 2020  centage).       
-0001c640: 2062 6f6f 6c5f 6172 7261 7920 3d20 6461   bool_array = da
-0001c650: 7461 2e73 656c 6563 745f 6474 7970 6573  ta.select_dtypes
-0001c660: 2827 666c 6f61 7427 292e 6e6f 746e 6128  ('float').notna(
-0001c670: 292e 7375 6d28 6178 6973 3d31 2920 3e3d  ).sum(axis=1) >=
-0001c680: 206d 696e 5f73 756d 0a0a 2020 2020 2020   min_sum..      
-0001c690: 2020 7265 7475 726e 2064 6174 615b 626f    return data[bo
-0001c6a0: 6f6c 5f61 7272 6179 5d0a 0a20 2020 2064  ol_array]..    d
-0001c6b0: 6566 205f 6669 6c74 6572 5f66 6f72 5f76  ef _filter_for_v
-0001c6c0: 616c 6964 5f76 616c 735f 696e 5f6f 6e65  alid_vals_in_one
-0001c6d0: 5f65 7870 5f67 726f 7570 5f70 6572 6328  _exp_group_perc(
-0001c6e0: 7365 6c66 2c20 6461 7461 2c20 7065 7263  self, data, perc
-0001c6f0: 656e 7461 6765 293a 0a0a 0a20 2020 2020  entage):...     
-0001c700: 2020 2022 2222 0a20 2020 2020 2020 2046     """.        F
-0001c710: 696c 7465 7220 666f 7220 7661 6c69 6420  ilter for valid 
-0001c720: 7661 6c75 6573 2075 7369 6e67 2061 7420  values using at 
-0001c730: 6c65 6173 7420 7820 2520 6461 7461 2063  least x % data c
-0001c740: 6f6d 706c 6574 656e 6573 2069 6e20 6561  ompletenes in ea
-0001c750: 6368 2065 7870 6572 696d 656e 7461 6c20  ch experimental 
-0001c760: 6772 6f75 700a 0a20 2020 2020 2020 2050  group..        P
-0001c770: 6172 616d 6574 6572 730a 2020 2020 2020  arameters.      
-0001c780: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020    ----------.   
-0001c790: 2020 2020 2064 6174 6120 3a20 7064 2e44       data : pd.D
-0001c7a0: 6174 6146 7261 6d65 0a20 2020 2020 2020  ataFrame.       
-0001c7b0: 2020 2020 2064 6174 6120 746f 2062 6520       data to be 
-0001c7c0: 6669 6c74 6572 6564 0a20 2020 2020 2020  filtered.       
-0001c7d0: 2020 2020 200a 2020 2020 2020 2020 7065       .        pe
-0001c7e0: 7263 656e 7461 6765 203a 2066 6c6f 6174  rcentage : float
-0001c7f0: 0a20 2020 2020 2020 2020 2020 2070 6572  .            per
-0001c800: 6365 6e74 6167 6520 6f66 2064 6573 6972  centage of desir
-0001c810: 6564 2064 6174 6120 636f 6d70 6c65 7465  ed data complete
-0001c820: 6e65 7373 0a0a 2020 2020 2020 2020 5265  ness..        Re
-0001c830: 7475 726e 730a 2020 2020 2020 2020 2d2d  turns.        --
-0001c840: 2d2d 2d2d 2d0a 2020 2020 2020 2020 6461  -----.        da
-0001c850: 7461 203a 2070 642e 4461 7461 4672 616d  ta : pd.DataFram
-0001c860: 650a 2020 2020 2020 2020 2020 2020 6461  e.            da
-0001c870: 7461 2077 6974 6820 7661 6c69 6420 7661  ta with valid va
-0001c880: 6c75 6573 2075 7369 6e67 2061 7420 6c65  lues using at le
-0001c890: 6173 7420 7820 2520 6461 7461 2063 6f6d  ast x % data com
-0001c8a0: 706c 6574 656e 6573 7320 696e 2065 6163  pleteness in eac
-0001c8b0: 6820 6578 7065 7269 6d65 6e74 616c 2067  h experimental g
-0001c8c0: 726f 7570 0a20 2020 2020 2020 2022 2222  roup.        """
-0001c8d0: 0a0a 2020 2020 2020 2020 636f 6c75 6d6e  ..        column
-0001c8e0: 735f 6e61 6d65 203d 2064 6174 612e 7365  s_name = data.se
-0001c8f0: 6c65 6374 5f64 7479 7065 7328 2766 6c6f  lect_dtypes('flo
-0001c900: 6174 2729 2e63 6f6c 756d 6e73 2e75 6e69  at').columns.uni
-0001c910: 7175 6528 290a 2020 2020 2020 2020 0a20  que().        . 
-0001c920: 2020 2020 2020 2069 6e64 6963 6573 203d         indices =
-0001c930: 205b 5d0a 2020 2020 2020 2020 0a20 2020   [].        .   
-0001c940: 2020 2020 2066 6f72 2063 6f6c 2069 6e20       for col in 
-0001c950: 636f 6c75 6d6e 735f 6e61 6d65 3a0a 2020  columns_name:.  
-0001c960: 2020 2020 2020 2020 2020 6e75 6d65 7261            numera
-0001c970: 746f 7220 3d20 6461 7461 5b63 6f6c 5d2e  tor = data[col].
-0001c980: 6e6f 746e 6128 292e 7375 6d28 6178 6973  notna().sum(axis
-0001c990: 3d31 290a 2020 2020 2020 2020 2020 2020  =1).            
-0001c9a0: 6465 6e6f 6d69 6e61 746f 7220 3d20 6461  denominator = da
-0001c9b0: 7461 5b63 6f6c 5d2e 7368 6170 655b 315d  ta[col].shape[1]
-0001c9c0: 0a20 2020 2020 2020 2020 2020 206e 6f6e  .            non
-0001c9d0: 5f6e 615f 696e 6469 6365 7320 3d20 6461  _na_indices = da
-0001c9e0: 7461 5b6e 756d 6572 6174 6f72 2f64 656e  ta[numerator/den
-0001c9f0: 6f6d 696e 6174 6f72 203e 3d20 7065 7263  ominator >= perc
-0001ca00: 656e 7461 6765 5d2e 696e 6465 782e 746f  entage].index.to
-0001ca10: 6c69 7374 2829 0a20 2020 2020 2020 2020  list().         
-0001ca20: 2020 2069 6e64 6963 6573 202b 3d20 6e6f     indices += no
-0001ca30: 6e5f 6e61 5f69 6e64 6963 6573 0a0a 2020  n_na_indices..  
-0001ca40: 2020 2020 2020 696e 6469 6365 7320 3d20        indices = 
-0001ca50: 6c69 7374 2873 6574 2869 6e64 6963 6573  list(set(indices
-0001ca60: 2929 0a20 2020 2020 2020 2064 6174 6120  )).        data 
-0001ca70: 3d20 6461 7461 5b64 6174 612e 696e 6465  = data[data.inde
-0001ca80: 782e 6973 696e 2869 6e64 6963 6573 295d  x.isin(indices)]
-0001ca90: 2e72 6573 6574 5f69 6e64 6578 2864 726f  .reset_index(dro
-0001caa0: 7020 3d20 5472 7565 290a 2020 2020 2020  p = True).      
-0001cab0: 2020 0a20 2020 2020 2020 2072 6574 7572    .        retur
-0001cac0: 6e20 6461 7461 0000 0000 0000 0000 0000  n data..........
-0001cad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001cae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001caf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001cb00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001cb10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001cb20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001cb30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001cb40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001cb50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001cb60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001cb70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001cb80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001cb90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001cba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001cbb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001cbc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001cbd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001cbe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001cbf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001cc00: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-0001cc10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001cc20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001cc30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001cc40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001cc50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001cc60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-0001cc70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-0001cc80: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
-0001cc90: 3030 3000 3031 3032 3133 0020 7800 0000  000.010213. x...
-0001cca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ccb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ccc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ccd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001cce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ccf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001cd00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-0001cd10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001cd20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001cd30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001cd40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001cd50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001cd60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001cd70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001cd80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001cd90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001cda0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001cdb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001cdc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001cdd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001cde0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001cdf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ce00: 3232 206d 7469 6d65 3d31 3638 3834 3937  22 mtime=1688497
-0001ce10: 3330 392e 300a 0000 0000 0000 0000 0000  309.0...........
-0001ce20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ce30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ce40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ce50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ce60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ce70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ce80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ce90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001cea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ceb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001cec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001b200: 3232 206d 7469 6d65 3d31 3638 3835 3732  22 mtime=1688572
+0001b210: 3039 322e 300a 0000 0000 0000 0000 0000  092.0...........
+0001b220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001b230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001b240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001b250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001b260: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001b270: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001b280: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001b290: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001b2a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001b2b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001b2c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001b2d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001b2e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001b2f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001b300: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001b310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001b320: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001b330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001b340: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001b350: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001b360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001b370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001b380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001b390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001b3a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001b3b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001b3c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001b3d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001b3e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001b3f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001b400: 7072 6f74 656f 6d69 6373 5f64 6f77 6e73  proteomics_downs
+0001b410: 7472 6561 6d5f 616e 616c 7973 6973 2d30  tream_analysis-0
+0001b420: 2e31 2e33 2f70 726f 7465 6f6d 6963 735f  .1.3/proteomics_
+0001b430: 646f 776e 7374 7265 616d 5f61 6e61 6c79  downstream_analy
+0001b440: 7369 732f 7072 6570 726f 6365 7373 696e  sis/preprocessin
+0001b450: 672e 7079 0000 0000 0000 0000 0000 0000  g.py............
+0001b460: 0000 0000 3030 3030 3634 3400 3030 3031  ....0000644.0001
+0001b470: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
+0001b480: 3030 3134 3330 3600 3134 3435 3133 3130  0014306.14451310
+0001b490: 3237 3400 3033 3132 3432 0020 3000 0000  274.031242. 0...
+0001b4a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001b4b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001b4c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001b4d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001b4e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001b4f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001b500: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
+0001b510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001b520: 0000 0000 0000 0000 0064 6f63 6b65 7200  .........docker.
+0001b530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001b540: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001b550: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001b560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001b570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001b580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001b590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001b5a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001b5b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001b5c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001b5d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001b5e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001b5f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001b600: 696d 706f 7274 206e 756d 7079 2061 7320  import numpy as 
+0001b610: 6e70 0a0a 636c 6173 7320 5072 6570 726f  np..class Prepro
+0001b620: 6365 7373 696e 673a 0a20 2020 200a 2020  cessing:.    .  
+0001b630: 2020 2222 2254 6869 7320 636c 6173 7320    """This class 
+0001b640: 656e 6361 7073 756c 6174 6573 2070 7265  encapsulates pre
+0001b650: 7072 6f63 6573 7369 6e67 2073 7465 7073  processing steps
+0001b660: 2222 220a 2020 2020 0a20 2020 2064 6566  """.    .    def
+0001b670: 205f 5f69 6e69 745f 5f28 7365 6c66 293a   __init__(self):
+0001b680: 0a20 2020 2020 2020 2070 6173 7320 0a20  .        pass . 
+0001b690: 2020 2020 2020 200a 2020 2020 6465 6620         .    def 
+0001b6a0: 5f63 6861 6e67 655f 6461 7461 7479 7065  _change_datatype
+0001b6b0: 7328 7365 6c66 2c20 6461 7461 293a 0a20  s(self, data):. 
+0001b6c0: 2020 2020 2020 200a 2020 2020 2020 2020         .        
+0001b6d0: 2222 220a 2020 2020 2020 2020 6368 616e  """.        chan
+0001b6e0: 6765 2064 6174 6174 7970 6573 0a0a 2020  ge datatypes..  
+0001b6f0: 2020 2020 2020 5061 7261 6d65 7465 7273        Parameters
+0001b700: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+0001b710: 2d2d 2d0a 2020 2020 2020 2020 6461 7461  ---.        data
+0001b720: 203a 2070 642e 4461 7461 4672 616d 650a   : pd.DataFrame.
+0001b730: 2020 2020 2020 2020 2020 2020 6461 7461              data
+0001b740: 2077 6974 6820 6f72 6967 696e 616c 2064   with original d
+0001b750: 6174 6174 7970 6573 0a20 2020 2020 2020  atatypes.       
+0001b760: 2052 6574 7572 6e73 0a20 2020 2020 2020   Returns.       
+0001b770: 202d 2d2d 2d2d 2d2d 0a20 2020 2020 2020   -------.       
+0001b780: 2064 6174 6120 3a20 7064 2e44 6174 6146   data : pd.DataF
+0001b790: 7261 6d65 0a20 2020 2020 2020 2020 2020  rame.           
+0001b7a0: 2064 6174 6120 7769 7468 2063 6861 6e67   data with chang
+0001b7b0: 6564 2064 6174 6174 7970 6573 0a20 2020  ed datatypes.   
+0001b7c0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+0001b7d0: 200a 2020 2020 2020 2020 666f 7220 6920   .        for i 
+0001b7e0: 696e 2064 6174 612e 636f 6c75 6d6e 732e  in data.columns.
+0001b7f0: 756e 6971 7565 2829 3a0a 2020 2020 2020  unique():.      
+0001b800: 2020 2020 2020 6966 2069 2069 6e20 5b27        if i in ['
+0001b810: 5072 6f74 6569 6e2e 4772 6f75 7027 2c20  Protein.Group', 
+0001b820: 2750 726f 7465 696e 2e49 6473 272c 2027  'Protein.Ids', '
+0001b830: 5072 6f74 6569 6e2e 4e61 6d65 7327 2c20  Protein.Names', 
+0001b840: 2747 656e 6573 272c 2746 6972 7374 2e50  'Genes','First.P
+0001b850: 726f 7465 696e 2e44 6573 6372 6970 7469  rotein.Descripti
+0001b860: 6f6e 275d 3a0a 2020 2020 2020 2020 2020  on']:.          
+0001b870: 2020 2020 2020 6461 7461 5b69 5d20 3d20        data[i] = 
+0001b880: 6461 7461 5b69 5d2e 6173 7479 7065 2827  data[i].astype('
+0001b890: 7374 7269 6e67 2729 0a20 2020 2020 2020  string').       
+0001b8a0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+0001b8b0: 2020 2020 2020 2020 2020 2064 6174 615b             data[
+0001b8c0: 695d 203d 2064 6174 615b 695d 2e61 7374  i] = data[i].ast
+0001b8d0: 7970 6528 2766 6c6f 6174 2729 200a 2020  ype('float') .  
+0001b8e0: 2020 2020 2020 7265 7475 726e 2064 6174        return dat
+0001b8f0: 610a 2020 2020 0a20 2020 2064 6566 205f  a.    .    def _
+0001b900: 6c6f 6732 5f74 7261 6e73 666f 726d 2873  log2_transform(s
+0001b910: 656c 662c 2064 6174 6129 3a0a 2020 2020  elf, data):.    
+0001b920: 2020 2020 0a20 2020 2020 2020 2022 2222      .        """
+0001b930: 0a20 2020 2020 2020 206c 6f67 3220 7472  .        log2 tr
+0001b940: 616e 7366 726f 6d20 666c 6f61 7420 6461  ansfrom float da
+0001b950: 7461 0a0a 2020 2020 2020 2020 5061 7261  ta..        Para
+0001b960: 6d65 7465 7273 0a20 2020 2020 2020 202d  meters.        -
+0001b970: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
+0001b980: 2020 6461 7461 203a 2070 642e 4461 7461    data : pd.Data
+0001b990: 4672 616d 650a 2020 2020 2020 2020 2020  Frame.          
+0001b9a0: 2020 6461 7461 2077 6974 6820 666c 6f61    data with floa
+0001b9b0: 7420 6461 7461 0a0a 2020 2020 2020 2020  t data..        
+0001b9c0: 5265 7475 726e 730a 2020 2020 2020 2020  Returns.        
+0001b9d0: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+0001b9e0: 6461 7461 203a 2070 642e 4461 7461 4672  data : pd.DataFr
+0001b9f0: 616d 650a 2020 2020 2020 2020 2020 2020  ame.            
+0001ba00: 6461 7461 2077 6974 6820 6c6f 6732 2074  data with log2 t
+0001ba10: 7261 6e73 666f 726d 6564 2066 6c6f 6174  ransformed float
+0001ba20: 2064 6174 610a 2020 2020 2020 2020 2222   data.        ""
+0001ba30: 220a 0a20 2020 2020 2020 2066 6f72 2069  "..        for i
+0001ba40: 2069 6e20 6461 7461 2e73 656c 6563 745f   in data.select_
+0001ba50: 6474 7970 6573 2827 666c 6f61 7427 292e  dtypes('float').
+0001ba60: 636f 6c75 6d6e 732e 756e 6971 7565 2829  columns.unique()
+0001ba70: 3a0a 2020 2020 2020 2020 2020 2020 6461  :.            da
+0001ba80: 7461 5b69 5d20 3d20 6e70 2e6c 6f67 3228  ta[i] = np.log2(
+0001ba90: 6461 7461 5b69 5d29 0a20 2020 2020 2020  data[i]).       
+0001baa0: 2072 6574 7572 6e20 6461 7461 0a20 2020   return data.   
+0001bab0: 2020 2020 200a 2020 2020 6465 6620 5f66       .    def _f
+0001bac0: 696c 7465 725f 666f 725f 7661 6c69 645f  ilter_for_valid_
+0001bad0: 7661 6c73 5f69 6e5f 6f6e 655f 6578 705f  vals_in_one_exp_
+0001bae0: 6772 6f75 7028 7365 6c66 2c20 6461 7461  group(self, data
+0001baf0: 293a 0a20 2020 2020 2020 200a 2020 2020  ):.        .    
+0001bb00: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+0001bb10: 4669 6c74 6572 2066 6f72 2076 616c 6964  Filter for valid
+0001bb20: 2076 616c 7565 7320 696e 2061 7420 6c65   values in at le
+0001bb30: 6173 7420 6f6e 6520 6578 7065 7269 6d65  ast one experime
+0001bb40: 6e74 616c 2067 726f 7570 0a0a 2020 2020  ntal group..    
+0001bb50: 2020 2020 5061 7261 6d65 7465 7273 0a20      Parameters. 
+0001bb60: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
+0001bb70: 2d0a 2020 2020 2020 2020 6461 7461 203a  -.        data :
+0001bb80: 2070 642e 4461 7461 4672 616d 650a 2020   pd.DataFrame.  
+0001bb90: 2020 2020 2020 2020 2020 6461 7461 2077            data w
+0001bba0: 6974 6820 666c 6f61 7420 6461 7461 0a20  ith float data. 
+0001bbb0: 2020 2020 2020 200a 2020 2020 2020 2020         .        
+0001bbc0: 5265 7475 726e 730a 2020 2020 2020 2020  Returns.        
+0001bbd0: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+0001bbe0: 6461 7461 203a 2070 642e 4461 7461 4672  data : pd.DataFr
+0001bbf0: 616d 650a 2020 2020 2020 2020 2020 2020  ame.            
+0001bc00: 6461 7461 2077 6974 6820 7661 6c69 6420  data with valid 
+0001bc10: 7661 6c75 6573 2069 6e20 6174 206c 6561  values in at lea
+0001bc20: 7374 206f 6e65 2065 7870 6572 696d 656e  st one experimen
+0001bc30: 7461 6c20 6772 6f75 700a 2020 2020 2020  tal group.      
+0001bc40: 2020 2222 220a 2020 2020 2020 2020 2020    """.          
+0001bc50: 2020 0a20 2020 2020 2020 2063 6f6c 756d    .        colum
+0001bc60: 6e73 5f6e 616d 6520 3d20 6461 7461 2e73  ns_name = data.s
+0001bc70: 656c 6563 745f 6474 7970 6573 2827 666c  elect_dtypes('fl
+0001bc80: 6f61 7427 292e 636f 6c75 6d6e 732e 756e  oat').columns.un
+0001bc90: 6971 7565 2829 0a20 2020 2020 2020 2020  ique().         
+0001bca0: 2020 200a 2020 2020 2020 2020 696e 6469     .        indi
+0001bcb0: 6365 7320 3d20 5b5d 0a20 2020 2020 2020  ces = [].       
+0001bcc0: 2020 2020 200a 2020 2020 2020 2020 666f       .        fo
+0001bcd0: 7220 636f 6c20 696e 2063 6f6c 756d 6e73  r col in columns
+0001bce0: 5f6e 616d 653a 0a20 2020 2020 2020 2020  _name:.         
+0001bcf0: 2020 206e 6f6e 5f6e 615f 696e 6469 6365     non_na_indice
+0001bd00: 7320 3d20 6461 7461 5b64 6174 615b 636f  s = data[data[co
+0001bd10: 6c5d 2e69 736e 6128 292e 7375 6d28 6178  l].isna().sum(ax
+0001bd20: 6973 3d31 293d 3d30 5d2e 696e 6465 782e  is=1)==0].index.
+0001bd30: 746f 5f6c 6973 7428 290a 2020 2020 2020  to_list().      
+0001bd40: 2020 2020 2020 696e 6469 6365 7320 2b3d        indices +=
+0001bd50: 206e 6f6e 5f6e 615f 696e 6469 6365 730a   non_na_indices.
+0001bd60: 2020 2020 2020 2020 696e 6469 6365 7320          indices 
+0001bd70: 3d20 6c69 7374 2873 6574 2869 6e64 6963  = list(set(indic
+0001bd80: 6573 2929 0a20 2020 2020 2020 2064 6174  es)).        dat
+0001bd90: 6120 3d20 6461 7461 5b64 6174 612e 696e  a = data[data.in
+0001bda0: 6465 782e 6973 696e 2869 6e64 6963 6573  dex.isin(indices
+0001bdb0: 295d 2e72 6573 6574 5f69 6e64 6578 2864  )].reset_index(d
+0001bdc0: 726f 7020 3d20 5472 7565 290a 2020 2020  rop = True).    
+0001bdd0: 2020 2020 0a20 2020 2020 2020 2072 6574      .        ret
+0001bde0: 7572 6e20 6461 7461 0a20 2020 200a 2020  urn data.    .  
+0001bdf0: 2020 6465 6620 5f69 6d70 7574 655f 6765    def _impute_ge
+0001be00: 6e65 735f 7769 7468 5f70 726f 7465 696e  nes_with_protein
+0001be10: 5f69 6473 2873 656c 662c 2064 6174 6129  _ids(self, data)
+0001be20: 3a0a 2020 2020 2020 2020 0a20 2020 2020  :.        .     
+0001be30: 2020 2022 2222 0a20 2020 2020 2020 2049     """.        I
+0001be40: 6d70 7574 696e 6720 6d69 7373 696e 6720  mputing missing 
+0001be50: 7661 6c75 6573 2069 6e20 4765 6e65 7320  values in Genes 
+0001be60: 636f 6c75 6d6e 2077 6974 6820 7468 6520  column with the 
+0001be70: 7072 6f74 6569 6e20 4944 730a 0a20 2020  protein IDs..   
+0001be80: 2020 2020 2050 6172 616d 6574 6572 730a       Parameters.
+0001be90: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+0001bea0: 2d2d 0a20 2020 2020 2020 2064 6174 6120  --.        data 
+0001beb0: 3a20 7064 2e44 6174 6146 7261 6d65 0a20  : pd.DataFrame. 
+0001bec0: 2020 2020 2020 2020 2020 2064 6174 6120             data 
+0001bed0: 746f 2062 6520 696d 7075 7465 640a 0a20  to be imputed.. 
+0001bee0: 2020 2020 2020 2052 6574 7572 6e73 0a20         Returns. 
+0001bef0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 0a20         -------. 
+0001bf00: 2020 2020 2020 2064 6174 6120 3a20 7064         data : pd
+0001bf10: 2e44 6174 6146 7261 6d65 0a20 2020 2020  .DataFrame.     
+0001bf20: 2020 2020 2020 2064 6174 6120 7769 7468         data with
+0001bf30: 2069 6d70 7574 6564 2067 656e 6520 7661   imputed gene va
+0001bf40: 6c75 6573 0a20 2020 2020 2020 2022 2222  lues.        """
+0001bf50: 0a20 2020 2020 2020 2069 6d70 7574 6174  .        imputat
+0001bf60: 696f 6e5f 7661 6c75 6573 203d 205b 692e  ion_values = [i.
+0001bf70: 7370 6c69 7428 273b 2729 5b30 5d20 666f  split(';')[0] fo
+0001bf80: 7220 6920 696e 2064 6174 615b 6461 7461  r i in data[data
+0001bf90: 5b27 4765 6e65 7327 5d2e 6973 6e61 2829  ['Genes'].isna()
+0001bfa0: 5d5b 2750 726f 7465 696e 2e49 6473 275d  ]['Protein.Ids']
+0001bfb0: 2e76 616c 7565 735d 0a20 2020 2020 2020  .values].       
+0001bfc0: 200a 2020 2020 2020 2020 666f 7220 6964   .        for id
+0001bfd0: 782c 2076 616c 7565 2069 6e20 7a69 7028  x, value in zip(
+0001bfe0: 6461 7461 5b64 6174 615b 2747 656e 6573  data[data['Genes
+0001bff0: 275d 2e69 736e 6128 295d 5b27 5072 6f74  '].isna()]['Prot
+0001c000: 6569 6e2e 4964 7327 5d2e 696e 6465 782c  ein.Ids'].index,
+0001c010: 2069 6d70 7574 6174 696f 6e5f 7661 6c75   imputation_valu
+0001c020: 6573 293a 0a20 2020 2020 2020 2020 2020  es):.           
+0001c030: 2064 6174 612e 6c6f 635b 6964 782c 205b   data.loc[idx, [
+0001c040: 2747 656e 6573 275d 5d20 3d20 7661 6c75  'Genes']] = valu
+0001c050: 650a 0a20 2020 2020 2020 2072 6574 7572  e..        retur
+0001c060: 6e20 6461 7461 0a20 2020 200a 2020 2020  n data.    .    
+0001c070: 6465 6620 5f69 6d70 7574 655f 6261 7365  def _impute_base
+0001c080: 645f 6f6e 5f67 6175 7373 6961 6e28 7365  d_on_gaussian(se
+0001c090: 6c66 2c20 6461 7461 293a 0a20 2020 2020  lf, data):.     
+0001c0a0: 2020 2020 0a20 2020 2020 2020 2022 2222      .        """
+0001c0b0: 0a20 2020 2020 2020 2054 6869 7320 6675  .        This fu
+0001c0c0: 6e63 7469 6f6e 2069 6d70 7574 6573 206d  nction imputes m
+0001c0d0: 6973 7369 6e67 2076 616c 7565 7320 696e  issing values in
+0001c0e0: 2061 2064 6174 6173 6574 2075 7369 6e67   a dataset using
+0001c0f0: 2061 2047 6175 7373 6961 6e20 6469 7374   a Gaussian dist
+0001c100: 7269 6275 7469 6f6e 2e0a 2020 2020 2020  ribution..      
+0001c110: 2020 5468 6520 6d69 7373 696e 6720 7661    The missing va
+0001c120: 6c75 6573 2061 7265 2069 6d70 7574 6564  lues are imputed
+0001c130: 2062 7920 7261 6e64 6f6d 2073 616d 706c   by random sampl
+0001c140: 696e 6720 7661 6c75 6573 2066 726f 6d20  ing values from 
+0001c150: 6120 4761 7573 7369 616e 2064 6973 7472  a Gaussian distr
+0001c160: 6962 7574 696f 6e20 7769 7468 2061 206d  ibution with a m
+0001c170: 6561 6e0a 2020 2020 2020 2020 6f66 2033  ean.        of 3
+0001c180: 2073 7461 6e64 6172 6420 6465 7669 6174   standard deviat
+0001c190: 696f 6e73 2062 656c 6f77 2074 6865 2063  ions below the c
+0001c1a0: 6f6d 7075 7465 6420 6d65 616e 2061 6e64  omputed mean and
+0001c1b0: 2061 2077 6964 7468 206f 6620 302e 3320   a width of 0.3 
+0001c1c0: 7469 6d65 7320 7468 6520 636f 6d70 7574  times the comput
+0001c1d0: 6564 2073 7461 6e64 6172 6420 6465 7669  ed standard devi
+0001c1e0: 6174 696f 6e2e 0a20 2020 2020 2020 2054  ation..        T
+0001c1f0: 6865 2066 756e 6374 696f 6e20 7265 7475  he function retu
+0001c200: 726e 7320 6120 636f 7079 206f 6620 7468  rns a copy of th
+0001c210: 6520 696d 7075 7465 6420 6461 7461 7365  e imputed datase
+0001c220: 7420 7769 7468 2074 6865 206d 6973 7369  t with the missi
+0001c230: 6e67 2076 616c 7565 7320 7265 706c 6163  ng values replac
+0001c240: 6564 2e0a 0a20 2020 2020 2020 2050 6172  ed...        Par
+0001c250: 616d 6574 6572 730a 2020 2020 2020 2020  ameters.        
+0001c260: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
+0001c270: 2020 2064 6174 6120 3a20 7064 2e44 6174     data : pd.Dat
+0001c280: 6146 7261 6d65 0a20 2020 2020 2020 2020  aFrame.         
+0001c290: 2020 2064 6174 6120 746f 2062 6520 696d     data to be im
+0001c2a0: 7075 7465 640a 0a20 2020 2020 2020 2052  puted..        R
+0001c2b0: 6574 7572 6e73 0a20 2020 2020 2020 202d  eturns.        -
+0001c2c0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2064  ------.        d
+0001c2d0: 6174 6120 3a20 7064 2e44 6174 6146 7261  ata : pd.DataFra
+0001c2e0: 6d65 0a20 2020 2020 2020 2020 2020 2064  me.            d
+0001c2f0: 6174 6120 7769 7468 2069 6d70 7574 6564  ata with imputed
+0001c300: 2076 616c 7565 730a 2020 2020 2020 2020   values.        
+0001c310: 2222 220a 2020 2020 2020 2020 2320 7365  """.        # se
+0001c320: 6c65 6374 206f 6e6c 7920 666c 6f61 7420  lect only float 
+0001c330: 6461 7461 0a20 2020 2020 2020 2066 6c6f  data.        flo
+0001c340: 6174 5f64 6174 6120 3d20 6461 7461 2e73  at_data = data.s
+0001c350: 656c 6563 745f 6474 7970 6573 2827 666c  elect_dtypes('fl
+0001c360: 6f61 7427 290a 2020 2020 2020 2020 6e61  oat').        na
+0001c370: 5f64 6174 6120 3d20 666c 6f61 745f 6461  _data = float_da
+0001c380: 7461 5b66 6c6f 6174 5f64 6174 612e 6973  ta[float_data.is
+0001c390: 6e61 2829 2e61 6e79 2861 7869 733d 3129  na().any(axis=1)
+0001c3a0: 5d0a 0a20 2020 2020 2020 2023 206c 6f6f  ]..        # loo
+0001c3b0: 7020 7468 726f 7567 6820 6e61 5f64 6174  p through na_dat
+0001c3c0: 6120 726f 7773 2061 6e64 2067 656e 6572  a rows and gener
+0001c3d0: 6174 6520 696d 7075 7465 6420 6461 7461  ate imputed data
+0001c3e0: 0a20 2020 2020 2020 2069 6d70 5f61 7272  .        imp_arr
+0001c3f0: 6179 203d 205b 5d0a 0a20 2020 2020 2020  ay = []..       
+0001c400: 2066 6f72 2069 2069 6e20 6e61 5f64 6174   for i in na_dat
+0001c410: 612e 696e 6465 783a 200a 2020 2020 2020  a.index: .      
+0001c420: 2020 2020 2020 6e61 5f63 6f75 6e74 203d        na_count =
+0001c430: 206e 615f 6461 7461 2e6c 6f63 5b69 5d2e   na_data.loc[i].
+0001c440: 6973 6e61 2829 2e73 756d 2829 0a0a 2020  isna().sum()..  
+0001c450: 2020 2020 2020 2020 2020 6d65 616e 203d            mean =
+0001c460: 206e 615f 6461 7461 2e6c 6f63 5b69 5d2e   na_data.loc[i].
+0001c470: 6d65 616e 2873 6b69 706e 613d 5472 7565  mean(skipna=True
+0001c480: 290a 2020 2020 2020 2020 2020 2020 7374  ).            st
+0001c490: 6420 3d20 6e61 5f64 6174 612e 6c6f 635b  d = na_data.loc[
+0001c4a0: 695d 2e73 7464 2873 6b69 706e 613d 5472  i].std(skipna=Tr
+0001c4b0: 7565 290a 0a20 2020 2020 2020 2020 2020  ue)..           
+0001c4c0: 206e 702e 7261 6e64 6f6d 2e73 6565 6428   np.random.seed(
+0001c4d0: 6929 0a20 2020 2020 2020 2020 2020 2069  i).            i
+0001c4e0: 6d70 5f61 7272 6179 2e61 7070 656e 6428  mp_array.append(
+0001c4f0: 6c69 7374 286e 702e 7261 6e64 6f6d 2e6e  list(np.random.n
+0001c500: 6f72 6d61 6c28 6c6f 633d 6d65 616e 2d33  ormal(loc=mean-3
+0001c510: 2a73 7464 2c20 7363 616c 653d 302e 332a  *std, scale=0.3*
+0001c520: 7374 642c 2073 697a 653d 6e61 5f63 6f75  std, size=na_cou
+0001c530: 6e74 2929 290a 0a20 2020 2020 2020 2069  nt)))..        i
+0001c540: 6d70 5f76 616c 7565 735f 6c69 7374 203d  mp_values_list =
+0001c550: 206e 702e 6172 7261 7928 5b69 6d70 5f76   np.array([imp_v
+0001c560: 616c 7565 2066 6f72 2069 6e6e 6572 6c69  alue for innerli
+0001c570: 7374 2069 6e20 696d 705f 6172 7261 7920  st in imp_array 
+0001c580: 666f 7220 696d 705f 7661 6c75 6520 696e  for imp_value in
+0001c590: 2069 6e6e 6572 6c69 7374 5d29 0a0a 2020   innerlist])..  
+0001c5a0: 2020 2020 2020 636f 7069 6564 5f64 6174        copied_dat
+0001c5b0: 6120 3d20 666c 6f61 745f 6461 7461 2e63  a = float_data.c
+0001c5c0: 6f70 7928 290a 2020 2020 2020 2020 636f  opy().        co
+0001c5d0: 6c75 6d6e 7320 3d20 666c 6f61 745f 6461  lumns = float_da
+0001c5e0: 7461 2e63 6f6c 756d 6e73 0a20 2020 2020  ta.columns.     
+0001c5f0: 2020 2063 6f70 6965 645f 6461 7461 2e63     copied_data.c
+0001c600: 6f6c 756d 6e73 203d 206e 702e 6172 616e  olumns = np.aran
+0001c610: 6765 2863 6f70 6965 645f 6461 7461 2e73  ge(copied_data.s
+0001c620: 6861 7065 5b31 5d29 0a20 2020 2020 2020  hape[1]).       
+0001c630: 200a 2020 2020 2020 2020 2320 696d 7075   .        # impu
+0001c640: 7465 2074 6865 2064 6174 610a 2020 2020  te the data.    
+0001c650: 2020 2020 7374 6163 6b65 645f 6e61 5f64      stacked_na_d
+0001c660: 6174 6120 3d20 636f 7069 6564 5f64 6174  ata = copied_dat
+0001c670: 612e 7374 6163 6b28 6472 6f70 6e61 3d46  a.stack(dropna=F
+0001c680: 616c 7365 290a 2020 2020 2020 2020 6e61  alse).        na
+0001c690: 5f69 6e64 6578 203d 2073 7461 636b 6564  _index = stacked
+0001c6a0: 5f6e 615f 6461 7461 5b73 7461 636b 6564  _na_data[stacked
+0001c6b0: 5f6e 615f 6461 7461 2e69 736e 6128 295d  _na_data.isna()]
+0001c6c0: 2e69 6e64 6578 0a20 2020 2020 2020 2073  .index.        s
+0001c6d0: 7461 636b 6564 5f6e 615f 6461 7461 2e6c  tacked_na_data.l
+0001c6e0: 6f63 5b6e 615f 696e 6465 785d 203d 2069  oc[na_index] = i
+0001c6f0: 6d70 5f76 616c 7565 735f 6c69 7374 0a20  mp_values_list. 
+0001c700: 2020 2020 2020 2069 6d70 5f64 6174 6120         imp_data 
+0001c710: 3d20 7374 6163 6b65 645f 6e61 5f64 6174  = stacked_na_dat
+0001c720: 612e 756e 7374 6163 6b28 290a 2020 2020  a.unstack().    
+0001c730: 2020 2020 696d 705f 6461 7461 2e63 6f6c      imp_data.col
+0001c740: 756d 6e73 203d 2063 6f6c 756d 6e73 0a20  umns = columns. 
+0001c750: 2020 2020 2020 2069 6d70 5f64 6174 6120         imp_data 
+0001c760: 3d20 6461 7461 2e73 656c 6563 745f 6474  = data.select_dt
+0001c770: 7970 6573 2827 7374 7269 6e67 2729 2e6d  ypes('string').m
+0001c780: 6572 6765 2869 6d70 5f64 6174 612c 206c  erge(imp_data, l
+0001c790: 6566 745f 696e 6465 783d 5472 7565 2c20  eft_index=True, 
+0001c7a0: 7269 6768 745f 696e 6465 783d 5472 7565  right_index=True
+0001c7b0: 290a 2020 2020 2020 2020 6461 7461 203d  ).        data =
+0001c7c0: 2069 6d70 5f64 6174 612e 636f 7079 2829   imp_data.copy()
+0001c7d0: 0a20 2020 2020 2020 200a 2020 2020 2020  .        .      
+0001c7e0: 2020 7265 7475 726e 2064 6174 610a 0a20    return data.. 
+0001c7f0: 2020 2064 6566 205f 6669 6c74 6572 5f66     def _filter_f
+0001c800: 6f72 5f76 616c 6964 5f76 616c 735f 7065  or_valid_vals_pe
+0001c810: 7263 2873 656c 662c 2064 6174 612c 2070  rc(self, data, p
+0001c820: 6572 6365 6e74 6167 6529 3a0a 2020 2020  ercentage):.    
+0001c830: 0a20 2020 2020 2020 2022 2222 4669 6c74  .        """Filt
+0001c840: 6572 2066 6f72 2076 616c 6964 2076 616c  er for valid val
+0001c850: 7565 7320 7573 696e 6720 6174 206c 6561  ues using at lea
+0001c860: 7374 2078 2025 2064 6174 6120 636f 6d70  st x % data comp
+0001c870: 6c65 7465 6e65 7373 0a0a 2020 2020 2020  leteness..      
+0001c880: 2020 5061 7261 6d65 7465 7273 0a20 2020    Parameters.   
+0001c890: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a       ----------.
+0001c8a0: 2020 2020 2020 2020 6461 7461 203a 2070          data : p
+0001c8b0: 642e 4461 7461 4672 616d 650a 2020 2020  d.DataFrame.    
+0001c8c0: 2020 2020 2020 2020 6461 7461 2074 6f20          data to 
+0001c8d0: 6265 2066 696c 7465 7265 640a 2020 2020  be filtered.    
+0001c8e0: 2020 2020 2020 2020 0a20 2020 2020 2020          .       
+0001c8f0: 2070 6572 6365 6e74 6167 6520 3a20 666c   percentage : fl
+0001c900: 6f61 740a 2020 2020 2020 2020 2020 2020  oat.            
+0001c910: 7065 7263 656e 7461 6765 206f 6620 6465  percentage of de
+0001c920: 7369 7265 6420 6461 7461 2063 6f6d 706c  sired data compl
+0001c930: 6574 656e 6573 730a 0a20 2020 2020 2020  eteness..       
+0001c940: 2052 6574 7572 6e73 0a20 2020 2020 2020   Returns.       
+0001c950: 202d 2d2d 2d2d 2d2d 0a20 2020 2020 2020   -------.       
+0001c960: 2064 6174 6120 3a20 7064 2e44 6174 6146   data : pd.DataF
+0001c970: 7261 6d65 0a20 2020 2020 2020 2020 2020  rame.           
+0001c980: 2064 6174 6120 7769 7468 2076 616c 6964   data with valid
+0001c990: 2076 616c 7565 7320 7573 696e 6720 6174   values using at
+0001c9a0: 206c 6561 7374 2078 2025 2064 6174 6120   least x % data 
+0001c9b0: 636f 6d70 6c65 7465 6e65 7373 0a20 2020  completeness.   
+0001c9c0: 2020 2020 2022 2222 0a20 2020 200a 2020       """.    .  
+0001c9d0: 2020 2020 2020 636f 6c5f 6c65 6e20 3d20        col_len = 
+0001c9e0: 6c65 6e28 6461 7461 2e73 656c 6563 745f  len(data.select_
+0001c9f0: 6474 7970 6573 2827 666c 6f61 7427 292e  dtypes('float').
+0001ca00: 636f 6c75 6d6e 7329 0a20 2020 2020 2020  columns).       
+0001ca10: 206d 696e 5f73 756d 203d 206e 702e 6365   min_sum = np.ce
+0001ca20: 696c 2863 6f6c 5f6c 656e 202a 2070 6572  il(col_len * per
+0001ca30: 6365 6e74 6167 6529 0a20 2020 2020 2020  centage).       
+0001ca40: 2062 6f6f 6c5f 6172 7261 7920 3d20 6461   bool_array = da
+0001ca50: 7461 2e73 656c 6563 745f 6474 7970 6573  ta.select_dtypes
+0001ca60: 2827 666c 6f61 7427 292e 6e6f 746e 6128  ('float').notna(
+0001ca70: 292e 7375 6d28 6178 6973 3d31 2920 3e3d  ).sum(axis=1) >=
+0001ca80: 206d 696e 5f73 756d 0a0a 2020 2020 2020   min_sum..      
+0001ca90: 2020 7265 7475 726e 2064 6174 615b 626f    return data[bo
+0001caa0: 6f6c 5f61 7272 6179 5d0a 0a20 2020 2064  ol_array]..    d
+0001cab0: 6566 205f 6669 6c74 6572 5f66 6f72 5f76  ef _filter_for_v
+0001cac0: 616c 6964 5f76 616c 735f 696e 5f6f 6e65  alid_vals_in_one
+0001cad0: 5f65 7870 5f67 726f 7570 5f70 6572 6328  _exp_group_perc(
+0001cae0: 7365 6c66 2c20 6461 7461 2c20 7065 7263  self, data, perc
+0001caf0: 656e 7461 6765 293a 0a0a 0a20 2020 2020  entage):...     
+0001cb00: 2020 2022 2222 0a20 2020 2020 2020 2046     """.        F
+0001cb10: 696c 7465 7220 666f 7220 7661 6c69 6420  ilter for valid 
+0001cb20: 7661 6c75 6573 2075 7369 6e67 2061 7420  values using at 
+0001cb30: 6c65 6173 7420 7820 2520 6461 7461 2063  least x % data c
+0001cb40: 6f6d 706c 6574 656e 6573 2069 6e20 6561  ompletenes in ea
+0001cb50: 6368 2065 7870 6572 696d 656e 7461 6c20  ch experimental 
+0001cb60: 6772 6f75 700a 0a20 2020 2020 2020 2050  group..        P
+0001cb70: 6172 616d 6574 6572 730a 2020 2020 2020  arameters.      
+0001cb80: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020    ----------.   
+0001cb90: 2020 2020 2064 6174 6120 3a20 7064 2e44       data : pd.D
+0001cba0: 6174 6146 7261 6d65 0a20 2020 2020 2020  ataFrame.       
+0001cbb0: 2020 2020 2064 6174 6120 746f 2062 6520       data to be 
+0001cbc0: 6669 6c74 6572 6564 0a20 2020 2020 2020  filtered.       
+0001cbd0: 2020 2020 200a 2020 2020 2020 2020 7065       .        pe
+0001cbe0: 7263 656e 7461 6765 203a 2066 6c6f 6174  rcentage : float
+0001cbf0: 0a20 2020 2020 2020 2020 2020 2070 6572  .            per
+0001cc00: 6365 6e74 6167 6520 6f66 2064 6573 6972  centage of desir
+0001cc10: 6564 2064 6174 6120 636f 6d70 6c65 7465  ed data complete
+0001cc20: 6e65 7373 0a0a 2020 2020 2020 2020 5265  ness..        Re
+0001cc30: 7475 726e 730a 2020 2020 2020 2020 2d2d  turns.        --
+0001cc40: 2d2d 2d2d 2d0a 2020 2020 2020 2020 6461  -----.        da
+0001cc50: 7461 203a 2070 642e 4461 7461 4672 616d  ta : pd.DataFram
+0001cc60: 650a 2020 2020 2020 2020 2020 2020 6461  e.            da
+0001cc70: 7461 2077 6974 6820 7661 6c69 6420 7661  ta with valid va
+0001cc80: 6c75 6573 2075 7369 6e67 2061 7420 6c65  lues using at le
+0001cc90: 6173 7420 7820 2520 6461 7461 2063 6f6d  ast x % data com
+0001cca0: 706c 6574 656e 6573 7320 696e 2065 6163  pleteness in eac
+0001ccb0: 6820 6578 7065 7269 6d65 6e74 616c 2067  h experimental g
+0001ccc0: 726f 7570 0a20 2020 2020 2020 2022 2222  roup.        """
+0001ccd0: 0a0a 2020 2020 2020 2020 636f 6c75 6d6e  ..        column
+0001cce0: 735f 6e61 6d65 203d 2064 6174 612e 7365  s_name = data.se
+0001ccf0: 6c65 6374 5f64 7479 7065 7328 2766 6c6f  lect_dtypes('flo
+0001cd00: 6174 2729 2e63 6f6c 756d 6e73 2e75 6e69  at').columns.uni
+0001cd10: 7175 6528 290a 2020 2020 2020 2020 0a20  que().        . 
+0001cd20: 2020 2020 2020 2069 6e64 6963 6573 203d         indices =
+0001cd30: 205b 5d0a 2020 2020 2020 2020 0a20 2020   [].        .   
+0001cd40: 2020 2020 2066 6f72 2063 6f6c 2069 6e20       for col in 
+0001cd50: 636f 6c75 6d6e 735f 6e61 6d65 3a0a 2020  columns_name:.  
+0001cd60: 2020 2020 2020 2020 2020 6e75 6d65 7261            numera
+0001cd70: 746f 7220 3d20 6461 7461 5b63 6f6c 5d2e  tor = data[col].
+0001cd80: 6e6f 746e 6128 292e 7375 6d28 6178 6973  notna().sum(axis
+0001cd90: 3d31 290a 2020 2020 2020 2020 2020 2020  =1).            
+0001cda0: 6465 6e6f 6d69 6e61 746f 7220 3d20 6461  denominator = da
+0001cdb0: 7461 5b63 6f6c 5d2e 7368 6170 655b 315d  ta[col].shape[1]
+0001cdc0: 0a20 2020 2020 2020 2020 2020 206e 6f6e  .            non
+0001cdd0: 5f6e 615f 696e 6469 6365 7320 3d20 6461  _na_indices = da
+0001cde0: 7461 5b6e 756d 6572 6174 6f72 2f64 656e  ta[numerator/den
+0001cdf0: 6f6d 696e 6174 6f72 203e 3d20 7065 7263  ominator >= perc
+0001ce00: 656e 7461 6765 5d2e 696e 6465 782e 746f  entage].index.to
+0001ce10: 6c69 7374 2829 0a20 2020 2020 2020 2020  list().         
+0001ce20: 2020 2069 6e64 6963 6573 202b 3d20 6e6f     indices += no
+0001ce30: 6e5f 6e61 5f69 6e64 6963 6573 0a0a 2020  n_na_indices..  
+0001ce40: 2020 2020 2020 696e 6469 6365 7320 3d20        indices = 
+0001ce50: 6c69 7374 2873 6574 2869 6e64 6963 6573  list(set(indices
+0001ce60: 2929 0a20 2020 2020 2020 2064 6174 6120  )).        data 
+0001ce70: 3d20 6461 7461 5b64 6174 612e 696e 6465  = data[data.inde
+0001ce80: 782e 6973 696e 2869 6e64 6963 6573 295d  x.isin(indices)]
+0001ce90: 2e72 6573 6574 5f69 6e64 6578 2864 726f  .reset_index(dro
+0001cea0: 7020 3d20 5472 7565 290a 2020 2020 2020  p = True).      
+0001ceb0: 2020 0a20 2020 2020 2020 2072 6574 7572    .        retur
+0001cec0: 6e20 6461 7461 0000 0000 0000 0000 0000  n data..........
 0001ced0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001cee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001cef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001cf00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001cf10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001cf20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001cf30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -7418,628 +7418,628 @@
 0001cf90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001cfa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001cfb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001cfc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001cfd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001cfe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001cff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d000: 7072 6f74 656f 6d69 6373 5f64 6f77 6e73  proteomics_downs
-0001d010: 7472 6561 6d5f 616e 616c 7973 6973 2d30  tream_analysis-0
-0001d020: 2e31 2e32 2f70 726f 7465 6f6d 6963 735f  .1.2/proteomics_
-0001d030: 646f 776e 7374 7265 616d 5f61 6e61 6c79  downstream_analy
-0001d040: 7369 732f 7072 6570 726f 6365 7373 696e  sis/preprocessin
-0001d050: 675f 7072 6570 726f 6365 7373 6f72 2e70  g_preprocessor.p
-0001d060: 7900 0000 3030 3030 3634 3400 3030 3031  y...0000644.0001
-0001d070: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
-0001d080: 3030 3132 3734 3300 3134 3435 3130 3636  0012743.14451066
-0001d090: 3233 3500 3033 3430 3537 0020 3000 0000  235.034057. 0...
+0001d000: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+0001d010: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001d020: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001d030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001d040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001d050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001d060: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+0001d070: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+0001d080: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
+0001d090: 3030 3000 3031 3032 3133 0020 7800 0000  000.010213. x...
 0001d0a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001d0b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001d0c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001d0d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001d0e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001d0f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d100: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
+0001d100: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
 0001d110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d120: 0000 0000 0000 0000 0064 6f63 6b65 7200  .........docker.
+0001d120: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001d130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001d140: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001d150: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001d160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001d170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001d180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001d190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001d1a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001d1b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001d1c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001d1d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001d1e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001d1f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d200: 696d 706f 7274 206e 756d 7079 2061 7320  import numpy as 
-0001d210: 6e70 0a0a 636c 6173 7320 5072 6570 726f  np..class Prepro
-0001d220: 6365 7373 696e 673a 0a20 2020 200a 2020  cessing:.    .  
-0001d230: 2020 2222 220a 2020 2020 5468 6973 2063    """.    This c
-0001d240: 6c61 7373 2065 6e63 6170 7375 6c61 7465  lass encapsulate
-0001d250: 7320 7072 6570 726f 6365 7373 696e 6720  s preprocessing 
-0001d260: 7374 6570 730a 2020 2020 2222 220a 2020  steps.    """.  
-0001d270: 2020 0a20 2020 2064 6566 205f 5f69 6e69    .    def __ini
-0001d280: 745f 5f28 7365 6c66 293a 0a20 2020 2020  t__(self):.     
-0001d290: 2020 2070 6173 7320 0a20 2020 2020 2020     pass .       
-0001d2a0: 200a 2020 2020 6465 6620 6368 616e 6765   .    def change
-0001d2b0: 5f64 6174 6174 7970 6573 2873 656c 662c  _datatypes(self,
-0001d2c0: 2064 6174 6129 3a0a 2020 2020 2020 2020   data):.        
-0001d2d0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-0001d2e0: 2020 2020 2063 6861 6e67 6520 6461 7461       change data
-0001d2f0: 7479 7065 730a 2020 2020 2020 2020 2222  types.        ""
-0001d300: 220a 2020 2020 2020 2020 0a20 2020 2020  ".        .     
-0001d310: 2020 2073 656c 662e 6461 7461 203d 2064     self.data = d
-0001d320: 6174 612e 636f 7079 2829 0a0a 2020 2020  ata.copy()..    
-0001d330: 2020 2020 666f 7220 6920 696e 2073 656c      for i in sel
-0001d340: 662e 6461 7461 2e63 6f6c 756d 6e73 2e75  f.data.columns.u
-0001d350: 6e69 7175 6528 293a 0a20 2020 2020 2020  nique():.       
-0001d360: 2020 2020 2069 6620 6920 696e 205b 2750       if i in ['P
-0001d370: 726f 7465 696e 2e47 726f 7570 272c 2027  rotein.Group', '
-0001d380: 5072 6f74 6569 6e2e 4964 7327 2c20 2750  Protein.Ids', 'P
-0001d390: 726f 7465 696e 2e4e 616d 6573 272c 2027  rotein.Names', '
-0001d3a0: 4765 6e65 7327 2c27 4669 7273 742e 5072  Genes','First.Pr
-0001d3b0: 6f74 6569 6e2e 4465 7363 7269 7074 696f  otein.Descriptio
-0001d3c0: 6e27 5d3a 0a20 2020 2020 2020 2020 2020  n']:.           
-0001d3d0: 2020 2020 2073 656c 662e 6461 7461 5b69       self.data[i
-0001d3e0: 5d20 3d20 7365 6c66 2e64 6174 615b 695d  ] = self.data[i]
-0001d3f0: 2e61 7374 7970 6528 2773 7472 696e 6727  .astype('string'
-0001d400: 290a 2020 2020 2020 2020 2020 2020 656c  ).            el
-0001d410: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-0001d420: 2020 2020 7365 6c66 2e64 6174 615b 695d      self.data[i]
-0001d430: 203d 2073 656c 662e 6461 7461 5b69 5d2e   = self.data[i].
-0001d440: 6173 7479 7065 2827 666c 6f61 7427 2920  astype('float') 
-0001d450: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0001d460: 7365 6c66 2e64 6174 610a 2020 2020 0a20  self.data.    . 
-0001d470: 2020 2064 6566 206c 6f67 325f 7472 616e     def log2_tran
-0001d480: 7366 6f72 6d28 7365 6c66 293a 0a20 2020  sform(self):.   
-0001d490: 2020 2020 200a 2020 2020 2020 2020 2222       .        ""
-0001d4a0: 220a 2020 2020 2020 2020 6c6f 6732 2074  ".        log2 t
-0001d4b0: 7261 6e73 6672 6f6d 2066 6c6f 6174 2064  ransfrom float d
-0001d4c0: 6174 610a 2020 2020 2020 2020 2222 220a  ata.        """.
-0001d4d0: 0a20 2020 2020 2020 2066 6f72 2069 2069  .        for i i
-0001d4e0: 6e20 7365 6c66 2e64 6174 612e 7365 6c65  n self.data.sele
-0001d4f0: 6374 5f64 7479 7065 7328 2766 6c6f 6174  ct_dtypes('float
-0001d500: 2729 2e63 6f6c 756d 6e73 2e75 6e69 7175  ').columns.uniqu
-0001d510: 6528 293a 0a20 2020 2020 2020 2020 2020  e():.           
-0001d520: 2073 656c 662e 6461 7461 5b69 5d20 3d20   self.data[i] = 
-0001d530: 6e70 2e6c 6f67 3228 7365 6c66 2e64 6174  np.log2(self.dat
-0001d540: 615b 695d 290a 2020 2020 2020 2020 7265  a[i]).        re
-0001d550: 7475 726e 2073 656c 662e 6461 7461 0a20  turn self.data. 
-0001d560: 2020 2020 2020 200a 2020 2020 6465 6620         .    def 
-0001d570: 6669 6c74 6572 5f66 6f72 5f76 616c 6964  filter_for_valid
-0001d580: 5f76 616c 735f 696e 5f6f 6e65 5f65 7870  _vals_in_one_exp
-0001d590: 5f67 726f 7570 2873 656c 6629 3a0a 2020  _group(self):.  
-0001d5a0: 2020 2020 2020 0a20 2020 2020 2020 2022        .        "
-0001d5b0: 2222 0a20 2020 2020 2020 2046 696c 7465  "".        Filte
-0001d5c0: 7220 666f 7220 7661 6c69 6420 7661 6c75  r for valid valu
-0001d5d0: 6573 2069 6e20 6174 206c 6561 7374 206f  es in at least o
-0001d5e0: 6e65 2065 7870 6572 696d 656e 7461 6c20  ne experimental 
-0001d5f0: 6772 6f75 700a 2020 2020 2020 2020 7061  group.        pa
-0001d600: 7261 6d20 6461 7461 3a20 6469 616e 6e20  ram data: diann 
-0001d610: 6f75 7470 7574 2074 6162 6c65 0a20 2020  output table.   
-0001d620: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-0001d630: 2020 2020 200a 2020 2020 2020 2020 636f       .        co
-0001d640: 6c75 6d6e 735f 6e61 6d65 203d 2073 656c  lumns_name = sel
-0001d650: 662e 6461 7461 2e73 656c 6563 745f 6474  f.data.select_dt
-0001d660: 7970 6573 2827 666c 6f61 7427 292e 636f  ypes('float').co
-0001d670: 6c75 6d6e 732e 756e 6971 7565 2829 0a20  lumns.unique(). 
-0001d680: 2020 2020 2020 2020 2020 200a 2020 2020             .    
-0001d690: 2020 2020 696e 6469 6365 7320 3d20 5b5d      indices = []
-0001d6a0: 0a20 2020 2020 2020 2020 2020 200a 2020  .            .  
-0001d6b0: 2020 2020 2020 666f 7220 636f 6c20 696e        for col in
-0001d6c0: 2063 6f6c 756d 6e73 5f6e 616d 653a 0a20   columns_name:. 
-0001d6d0: 2020 2020 2020 2020 2020 206e 6f6e 5f6e             non_n
-0001d6e0: 615f 696e 6469 6365 7320 3d20 7365 6c66  a_indices = self
-0001d6f0: 2e64 6174 615b 7365 6c66 2e64 6174 615b  .data[self.data[
-0001d700: 636f 6c5d 2e69 736e 6128 292e 7375 6d28  col].isna().sum(
-0001d710: 6178 6973 3d31 293d 3d30 5d2e 696e 6465  axis=1)==0].inde
-0001d720: 782e 746f 5f6c 6973 7428 290a 2020 2020  x.to_list().    
-0001d730: 2020 2020 2020 2020 696e 6469 6365 7320          indices 
-0001d740: 2b3d 206e 6f6e 5f6e 615f 696e 6469 6365  += non_na_indice
-0001d750: 730a 2020 2020 2020 2020 696e 6469 6365  s.        indice
-0001d760: 7320 3d20 6c69 7374 2873 6574 2869 6e64  s = list(set(ind
-0001d770: 6963 6573 2929 0a20 2020 2020 2020 2073  ices)).        s
-0001d780: 656c 662e 6461 7461 203d 2073 656c 662e  elf.data = self.
-0001d790: 6461 7461 5b73 656c 662e 6461 7461 2e69  data[self.data.i
-0001d7a0: 6e64 6578 2e69 7369 6e28 696e 6469 6365  ndex.isin(indice
-0001d7b0: 7329 5d2e 7265 7365 745f 696e 6465 7828  s)].reset_index(
-0001d7c0: 6472 6f70 203d 2054 7275 6529 0a20 2020  drop = True).   
-0001d7d0: 2020 2020 200a 2020 2020 2020 2020 7265       .        re
-0001d7e0: 7475 726e 2073 656c 662e 6461 7461 0a20  turn self.data. 
-0001d7f0: 2020 200a 2020 2020 6465 6620 696d 7075     .    def impu
-0001d800: 7465 5f67 656e 6573 5f77 6974 685f 7072  te_genes_with_pr
-0001d810: 6f74 6569 6e5f 6964 7328 7365 6c66 293a  otein_ids(self):
-0001d820: 0a20 2020 2020 2020 200a 2020 2020 2020  .        .      
-0001d830: 2020 2222 220a 2020 2020 2020 2020 496d    """.        Im
-0001d840: 7075 7469 6e67 206d 6973 7369 6e67 2076  puting missing v
-0001d850: 616c 7565 7320 696e 2047 656e 6573 2063  alues in Genes c
-0001d860: 6f6c 756d 6e20 7769 7468 2074 6865 2070  olumn with the p
-0001d870: 726f 7465 696e 2049 4473 0a20 2020 2020  rotein IDs.     
-0001d880: 2020 2022 2222 0a20 2020 2020 2020 2069     """.        i
-0001d890: 6d70 7574 6174 696f 6e5f 7661 6c75 6573  mputation_values
-0001d8a0: 203d 205b 692e 7370 6c69 7428 273b 2729   = [i.split(';')
-0001d8b0: 5b30 5d20 666f 7220 6920 696e 2073 656c  [0] for i in sel
-0001d8c0: 662e 6461 7461 5b73 656c 662e 6461 7461  f.data[self.data
-0001d8d0: 5b27 4765 6e65 7327 5d2e 6973 6e61 2829  ['Genes'].isna()
-0001d8e0: 5d5b 2750 726f 7465 696e 2e49 6473 275d  ]['Protein.Ids']
-0001d8f0: 2e76 616c 7565 735d 0a20 2020 2020 2020  .values].       
-0001d900: 200a 2020 2020 2020 2020 666f 7220 6964   .        for id
-0001d910: 782c 2076 616c 7565 2069 6e20 7a69 7028  x, value in zip(
-0001d920: 7365 6c66 2e64 6174 615b 7365 6c66 2e64  self.data[self.d
-0001d930: 6174 615b 2747 656e 6573 275d 2e69 736e  ata['Genes'].isn
-0001d940: 6128 295d 5b27 5072 6f74 6569 6e2e 4964  a()]['Protein.Id
-0001d950: 7327 5d2e 696e 6465 782c 2069 6d70 7574  s'].index, imput
-0001d960: 6174 696f 6e5f 7661 6c75 6573 293a 0a20  ation_values):. 
-0001d970: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0001d980: 6461 7461 2e6c 6f63 5b69 6478 2c20 5b27  data.loc[idx, ['
-0001d990: 4765 6e65 7327 5d5d 203d 2076 616c 7565  Genes']] = value
-0001d9a0: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-0001d9b0: 2073 656c 662e 6461 7461 0a20 2020 200a   self.data.    .
-0001d9c0: 2020 2020 6465 6620 696d 7075 7465 5f62      def impute_b
-0001d9d0: 6173 6564 5f6f 6e5f 6761 7573 7369 616e  ased_on_gaussian
-0001d9e0: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-0001d9f0: 200a 2020 2020 2020 2020 2222 220a 2020   .        """.  
-0001da00: 2020 2020 2020 5468 6973 2066 756e 6374        This funct
-0001da10: 696f 6e20 696d 7075 7465 7320 6d69 7373  ion imputes miss
-0001da20: 696e 6720 7661 6c75 6573 2069 6e20 6120  ing values in a 
-0001da30: 6461 7461 7365 7420 7573 696e 6720 6120  dataset using a 
-0001da40: 4761 7573 7369 616e 2064 6973 7472 6962  Gaussian distrib
-0001da50: 7574 696f 6e2e 0a20 2020 2020 2020 2054  ution..        T
-0001da60: 6865 206d 6973 7369 6e67 2076 616c 7565  he missing value
-0001da70: 7320 6172 6520 696d 7075 7465 6420 6279  s are imputed by
-0001da80: 2072 616e 646f 6d20 7361 6d70 6c69 6e67   random sampling
-0001da90: 2076 616c 7565 7320 6672 6f6d 2061 2047   values from a G
-0001daa0: 6175 7373 6961 6e20 6469 7374 7269 6275  aussian distribu
-0001dab0: 7469 6f6e 2077 6974 6820 6120 6d65 616e  tion with a mean
-0001dac0: 0a20 2020 2020 2020 206f 6620 3320 7374  .        of 3 st
-0001dad0: 616e 6461 7264 2064 6576 6961 7469 6f6e  andard deviation
-0001dae0: 7320 6265 6c6f 7720 7468 6520 636f 6d70  s below the comp
-0001daf0: 7574 6564 206d 6561 6e20 616e 6420 6120  uted mean and a 
-0001db00: 7769 6474 6820 6f66 2030 2e33 2074 696d  width of 0.3 tim
-0001db10: 6573 2074 6865 2063 6f6d 7075 7465 6420  es the computed 
-0001db20: 7374 616e 6461 7264 2064 6576 6961 7469  standard deviati
-0001db30: 6f6e 2e0a 2020 2020 2020 2020 5468 6520  on..        The 
-0001db40: 6675 6e63 7469 6f6e 2072 6574 7572 6e73  function returns
-0001db50: 2061 2063 6f70 7920 6f66 2074 6865 2069   a copy of the i
-0001db60: 6d70 7574 6564 2064 6174 6173 6574 2077  mputed dataset w
-0001db70: 6974 6820 7468 6520 6d69 7373 696e 6720  ith the missing 
-0001db80: 7661 6c75 6573 2072 6570 6c61 6365 642e  values replaced.
-0001db90: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-0001dba0: 2020 2020 2023 2073 656c 6563 7420 6f6e       # select on
-0001dbb0: 6c79 2066 6c6f 6174 2064 6174 610a 2020  ly float data.  
-0001dbc0: 2020 2020 2020 666c 6f61 745f 6461 7461        float_data
-0001dbd0: 203d 2073 656c 662e 6461 7461 2e73 656c   = self.data.sel
-0001dbe0: 6563 745f 6474 7970 6573 2827 666c 6f61  ect_dtypes('floa
-0001dbf0: 7427 290a 2020 2020 2020 2020 6e61 5f64  t').        na_d
-0001dc00: 6174 6120 3d20 666c 6f61 745f 6461 7461  ata = float_data
-0001dc10: 5b66 6c6f 6174 5f64 6174 612e 6973 6e61  [float_data.isna
-0001dc20: 2829 2e61 6e79 2861 7869 733d 3129 5d0a  ().any(axis=1)].
-0001dc30: 0a20 2020 2020 2020 2023 206c 6f6f 7020  .        # loop 
-0001dc40: 7468 726f 7567 6820 6e61 5f64 6174 6120  through na_data 
-0001dc50: 726f 7773 2061 6e64 2067 656e 6572 6174  rows and generat
-0001dc60: 6520 696d 7075 7465 6420 6461 7461 0a20  e imputed data. 
-0001dc70: 2020 2020 2020 2069 6d70 5f61 7272 6179         imp_array
-0001dc80: 203d 205b 5d0a 0a20 2020 2020 2020 2066   = []..        f
-0001dc90: 6f72 2069 2069 6e20 6e61 5f64 6174 612e  or i in na_data.
-0001dca0: 696e 6465 783a 200a 2020 2020 2020 2020  index: .        
-0001dcb0: 2020 2020 6e61 5f63 6f75 6e74 203d 206e      na_count = n
-0001dcc0: 615f 6461 7461 2e6c 6f63 5b69 5d2e 6973  a_data.loc[i].is
-0001dcd0: 6e61 2829 2e73 756d 2829 0a0a 2020 2020  na().sum()..    
-0001dce0: 2020 2020 2020 2020 6d65 616e 203d 206e          mean = n
-0001dcf0: 615f 6461 7461 2e6c 6f63 5b69 5d2e 6d65  a_data.loc[i].me
-0001dd00: 616e 2873 6b69 706e 613d 5472 7565 290a  an(skipna=True).
-0001dd10: 2020 2020 2020 2020 2020 2020 7374 6420              std 
-0001dd20: 3d20 6e61 5f64 6174 612e 6c6f 635b 695d  = na_data.loc[i]
-0001dd30: 2e73 7464 2873 6b69 706e 613d 5472 7565  .std(skipna=True
-0001dd40: 290a 0a20 2020 2020 2020 2020 2020 206e  )..            n
-0001dd50: 702e 7261 6e64 6f6d 2e73 6565 6428 6929  p.random.seed(i)
-0001dd60: 0a20 2020 2020 2020 2020 2020 2069 6d70  .            imp
-0001dd70: 5f61 7272 6179 2e61 7070 656e 6428 6c69  _array.append(li
-0001dd80: 7374 286e 702e 7261 6e64 6f6d 2e6e 6f72  st(np.random.nor
-0001dd90: 6d61 6c28 6c6f 633d 6d65 616e 2d33 2a73  mal(loc=mean-3*s
-0001dda0: 7464 2c20 7363 616c 653d 302e 332a 7374  td, scale=0.3*st
-0001ddb0: 642c 2073 697a 653d 6e61 5f63 6f75 6e74  d, size=na_count
-0001ddc0: 2929 290a 0a20 2020 2020 2020 2069 6d70  )))..        imp
-0001ddd0: 5f76 616c 7565 735f 6c69 7374 203d 206e  _values_list = n
-0001dde0: 702e 6172 7261 7928 5b69 6d70 5f76 616c  p.array([imp_val
-0001ddf0: 7565 2066 6f72 2069 6e6e 6572 6c69 7374  ue for innerlist
-0001de00: 2069 6e20 696d 705f 6172 7261 7920 666f   in imp_array fo
-0001de10: 7220 696d 705f 7661 6c75 6520 696e 2069  r imp_value in i
-0001de20: 6e6e 6572 6c69 7374 5d29 0a0a 2020 2020  nnerlist])..    
-0001de30: 2020 2020 636f 7069 6564 5f64 6174 6120      copied_data 
-0001de40: 3d20 666c 6f61 745f 6461 7461 2e63 6f70  = float_data.cop
-0001de50: 7928 290a 2020 2020 2020 2020 636f 6c75  y().        colu
-0001de60: 6d6e 7320 3d20 666c 6f61 745f 6461 7461  mns = float_data
-0001de70: 2e63 6f6c 756d 6e73 0a20 2020 2020 2020  .columns.       
-0001de80: 2063 6f70 6965 645f 6461 7461 2e63 6f6c   copied_data.col
-0001de90: 756d 6e73 203d 206e 702e 6172 616e 6765  umns = np.arange
-0001dea0: 2863 6f70 6965 645f 6461 7461 2e73 6861  (copied_data.sha
-0001deb0: 7065 5b31 5d29 0a20 2020 2020 2020 200a  pe[1]).        .
-0001dec0: 2020 2020 2020 2020 2320 696d 7075 7465          # impute
-0001ded0: 2074 6865 2064 6174 610a 2020 2020 2020   the data.      
-0001dee0: 2020 7374 6163 6b65 645f 6e61 5f64 6174    stacked_na_dat
-0001def0: 6120 3d20 636f 7069 6564 5f64 6174 612e  a = copied_data.
-0001df00: 7374 6163 6b28 6472 6f70 6e61 3d46 616c  stack(dropna=Fal
-0001df10: 7365 290a 2020 2020 2020 2020 6e61 5f69  se).        na_i
-0001df20: 6e64 6578 203d 2073 7461 636b 6564 5f6e  ndex = stacked_n
-0001df30: 615f 6461 7461 5b73 7461 636b 6564 5f6e  a_data[stacked_n
-0001df40: 615f 6461 7461 2e69 736e 6128 295d 2e69  a_data.isna()].i
-0001df50: 6e64 6578 0a20 2020 2020 2020 2073 7461  ndex.        sta
-0001df60: 636b 6564 5f6e 615f 6461 7461 2e6c 6f63  cked_na_data.loc
-0001df70: 5b6e 615f 696e 6465 785d 203d 2069 6d70  [na_index] = imp
-0001df80: 5f76 616c 7565 735f 6c69 7374 0a20 2020  _values_list.   
-0001df90: 2020 2020 2069 6d70 5f64 6174 6120 3d20       imp_data = 
-0001dfa0: 7374 6163 6b65 645f 6e61 5f64 6174 612e  stacked_na_data.
-0001dfb0: 756e 7374 6163 6b28 290a 2020 2020 2020  unstack().      
-0001dfc0: 2020 696d 705f 6461 7461 2e63 6f6c 756d    imp_data.colum
-0001dfd0: 6e73 203d 2063 6f6c 756d 6e73 0a20 2020  ns = columns.   
-0001dfe0: 2020 2020 2069 6d70 5f64 6174 6120 3d20       imp_data = 
-0001dff0: 7365 6c66 2e64 6174 612e 7365 6c65 6374  self.data.select
-0001e000: 5f64 7479 7065 7328 2773 7472 696e 6727  _dtypes('string'
-0001e010: 292e 6d65 7267 6528 696d 705f 6461 7461  ).merge(imp_data
-0001e020: 2c20 6c65 6674 5f69 6e64 6578 3d54 7275  , left_index=Tru
-0001e030: 652c 2072 6967 6874 5f69 6e64 6578 3d54  e, right_index=T
-0001e040: 7275 6529 0a20 2020 2020 2020 2073 656c  rue).        sel
-0001e050: 662e 6461 7461 203d 2069 6d70 5f64 6174  f.data = imp_dat
-0001e060: 612e 636f 7079 2829 0a20 2020 2020 2020  a.copy().       
-0001e070: 200a 2020 2020 2020 2020 7265 7475 726e   .        return
-0001e080: 2073 656c 662e 6461 7461 0a0a 2020 2020   self.data..    
-0001e090: 6465 6620 6669 6c74 6572 5f66 6f72 5f76  def filter_for_v
-0001e0a0: 616c 6964 5f76 616c 735f 7065 7263 2873  alid_vals_perc(s
-0001e0b0: 656c 662c 2070 6572 6365 6e74 6167 6529  elf, percentage)
-0001e0c0: 3a0a 2020 2020 0a20 2020 2020 2020 2027  :.    .        '
-0001e0d0: 2727 4669 6c74 6572 2066 6f72 2076 616c  ''Filter for val
-0001e0e0: 6964 2076 616c 7565 7320 7573 696e 6720  id values using 
-0001e0f0: 6174 206c 6561 7374 2078 2025 2064 6174  at least x % dat
-0001e100: 6120 636f 6d70 6c65 7465 6e65 7373 2727  a completeness''
-0001e110: 270a 2020 2020 0a20 2020 2020 2020 2063  '.    .        c
-0001e120: 6f6c 5f6c 656e 203d 206c 656e 2873 656c  ol_len = len(sel
-0001e130: 662e 6461 7461 2e73 656c 6563 745f 6474  f.data.select_dt
-0001e140: 7970 6573 2827 666c 6f61 7427 292e 636f  ypes('float').co
-0001e150: 6c75 6d6e 7329 0a20 2020 2020 2020 206d  lumns).        m
-0001e160: 696e 5f73 756d 203d 206e 702e 6365 696c  in_sum = np.ceil
-0001e170: 2863 6f6c 5f6c 656e 202a 2070 6572 6365  (col_len * perce
-0001e180: 6e74 6167 6529 0a20 2020 2020 2020 2062  ntage).        b
-0001e190: 6f6f 6c5f 6172 7261 7920 3d20 7365 6c66  ool_array = self
-0001e1a0: 2e64 6174 612e 7365 6c65 6374 5f64 7479  .data.select_dty
-0001e1b0: 7065 7328 2766 6c6f 6174 2729 2e6e 6f74  pes('float').not
-0001e1c0: 6e61 2829 2e73 756d 2861 7869 733d 3129  na().sum(axis=1)
-0001e1d0: 203e 3d20 6d69 6e5f 7375 6d0a 0a20 2020   >= min_sum..   
-0001e1e0: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-0001e1f0: 2e64 6174 615b 626f 6f6c 5f61 7272 6179  .data[bool_array
-0001e200: 5d0a 0a20 2020 2064 6566 2066 696c 7465  ]..    def filte
-0001e210: 725f 666f 725f 7661 6c69 645f 7661 6c73  r_for_valid_vals
-0001e220: 5f69 6e5f 6f6e 655f 6578 705f 6772 6f75  _in_one_exp_grou
-0001e230: 705f 7065 7263 2873 656c 662c 2070 6572  p_perc(self, per
-0001e240: 6365 6e74 6167 6529 3a0a 0a0a 2020 2020  centage):...    
-0001e250: 2020 2020 2727 2746 696c 7465 7220 666f      '''Filter fo
-0001e260: 7220 7661 6c69 6420 7661 6c75 6573 2075  r valid values u
-0001e270: 7369 6e67 2061 7420 6c65 6173 7420 7820  sing at least x 
-0001e280: 2520 6461 7461 2063 6f6d 706c 6574 656e  % data completen
-0001e290: 6573 2069 6e20 6561 6368 2065 7870 6572  es in each exper
-0001e2a0: 696d 656e 7461 6c20 6772 6f75 7027 2727  imental group'''
-0001e2b0: 0a0a 2020 2020 2020 2020 636f 6c75 6d6e  ..        column
-0001e2c0: 735f 6e61 6d65 203d 2073 656c 662e 6461  s_name = self.da
-0001e2d0: 7461 2e73 656c 6563 745f 6474 7970 6573  ta.select_dtypes
-0001e2e0: 2827 666c 6f61 7427 292e 636f 6c75 6d6e  ('float').column
-0001e2f0: 732e 756e 6971 7565 2829 0a20 2020 2020  s.unique().     
-0001e300: 2020 200a 2020 2020 2020 2020 696e 6469     .        indi
-0001e310: 6365 7320 3d20 5b5d 0a20 2020 2020 2020  ces = [].       
-0001e320: 200a 2020 2020 2020 2020 666f 7220 636f   .        for co
-0001e330: 6c20 696e 2063 6f6c 756d 6e73 5f6e 616d  l in columns_nam
-0001e340: 653a 0a20 2020 2020 2020 2020 2020 206e  e:.            n
-0001e350: 6f6e 5f6e 615f 696e 6469 6365 7320 3d20  on_na_indices = 
-0001e360: 7365 6c66 2e64 6174 615b 7365 6c66 2e64  self.data[self.d
-0001e370: 6174 615b 636f 6c5d 2e69 736e 6128 292e  ata[col].isna().
-0001e380: 7375 6d28 6178 6973 3d31 292f 6c65 6e28  sum(axis=1)/len(
-0001e390: 7365 6c66 2e64 6174 615b 636f 6c5d 2e63  self.data[col].c
-0001e3a0: 6f6c 756d 6e73 2920 3e3d 2070 6572 6365  olumns) >= perce
-0001e3b0: 6e74 6167 655d 2e69 6e64 6578 0a20 2020  ntage].index.   
-0001e3c0: 2020 2020 2020 2020 2069 6e64 6963 6573           indices
-0001e3d0: 2e61 7070 656e 6428 6e6f 6e5f 6e61 5f69  .append(non_na_i
-0001e3e0: 6e64 6963 6573 290a 2020 2020 2020 2020  ndices).        
-0001e3f0: 696e 6469 6365 7320 3d20 6c69 7374 2873  indices = list(s
-0001e400: 6574 2869 6e64 6963 6573 2929 0a20 2020  et(indices)).   
-0001e410: 2020 2020 2073 656c 662e 6461 7461 203d       self.data =
-0001e420: 2073 656c 662e 6461 7461 5b73 656c 662e   self.data[self.
-0001e430: 6461 7461 2e69 6e64 6578 2e69 7369 6e28  data.index.isin(
-0001e440: 696e 6469 6365 7329 5d2e 7265 7365 745f  indices)].reset_
-0001e450: 696e 6465 7828 6472 6f70 203d 2054 7275  index(drop = Tru
-0001e460: 6529 0a20 2020 2020 2020 200a 2020 2020  e).        .    
-0001e470: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-0001e480: 6461 7461 0a0a 0a63 6c61 7373 2050 7265  data...class Pre
-0001e490: 7072 6f63 6573 736f 723a 0a20 2020 200a  processor:.    .
-0001e4a0: 2020 2020 2222 220a 2020 2020 5468 6973      """.    This
-0001e4b0: 2063 6c61 7373 2061 7070 6c69 6573 2070   class applies p
-0001e4c0: 7265 7072 6f63 6573 7369 6e67 2073 7465  reprocessing ste
-0001e4d0: 7073 2074 6f20 4449 414e 4e20 6461 7461  ps to DIANN data
-0001e4e0: 0a20 2020 2022 2222 0a20 2020 200a 2020  .    """.    .  
-0001e4f0: 2020 6465 6620 5f5f 696e 6974 5f5f 2873    def __init__(s
-0001e500: 656c 6629 3a0a 2020 2020 2020 2020 7365  elf):.        se
-0001e510: 6c66 2e64 6174 6120 3d20 4e6f 6e65 0a20  lf.data = None. 
-0001e520: 2020 2020 2020 2073 656c 662e 5f70 7265         self._pre
-0001e530: 7072 6f63 6573 7369 6e67 203d 2050 7265  processing = Pre
-0001e540: 7072 6f63 6573 7369 6e67 2829 0a20 2020  processing().   
-0001e550: 200a 2020 2020 6465 6620 5f70 726f 6365   .    def _proce
-0001e560: 7373 2873 656c 662c 2064 6174 6129 3a0a  ss(self, data):.
-0001e570: 2020 2020 2020 2020 0a20 2020 2020 2020          .       
-0001e580: 2023 2063 6861 6e67 6520 7468 6520 6461   # change the da
-0001e590: 7461 7479 7065 730a 2020 2020 2020 2020  tatypes.        
-0001e5a0: 7365 6c66 2e64 6174 6120 3d20 7365 6c66  self.data = self
-0001e5b0: 2e5f 7072 6570 726f 6365 7373 696e 672e  ._preprocessing.
-0001e5c0: 6368 616e 6765 5f64 6174 6174 7970 6573  change_datatypes
-0001e5d0: 2864 6174 6129 0a20 2020 2020 2020 200a  (data).        .
-0001e5e0: 2020 2020 2020 2020 2320 6c6f 6732 2074          # log2 t
-0001e5f0: 7261 6e73 666f 726d 2064 6174 610a 2020  ransform data.  
-0001e600: 2020 2020 2020 7365 6c66 2e64 6174 6120        self.data 
-0001e610: 3d20 7365 6c66 2e5f 7072 6570 726f 6365  = self._preproce
-0001e620: 7373 696e 672e 6c6f 6732 5f74 7261 6e73  ssing.log2_trans
-0001e630: 666f 726d 2829 0a20 2020 2020 2020 200a  form().        .
-0001e640: 2020 2020 2020 2020 2320 6669 6c74 6572          # filter
-0001e650: 2066 6f72 2076 616c 6964 2076 616c 7565   for valid value
-0001e660: 7320 696e 2061 7420 6c65 6173 7420 6f6e  s in at least on
-0001e670: 6520 6578 7065 7269 6d65 6e74 616c 2067  e experimental g
-0001e680: 726f 7570 0a20 2020 2020 2020 2073 656c  roup.        sel
-0001e690: 662e 6461 7461 203d 2073 656c 662e 5f70  f.data = self._p
-0001e6a0: 7265 7072 6f63 6573 7369 6e67 2e66 696c  reprocessing.fil
-0001e6b0: 7465 725f 666f 725f 7661 6c69 645f 7661  ter_for_valid_va
-0001e6c0: 6c73 5f69 6e5f 6f6e 655f 6578 705f 6772  ls_in_one_exp_gr
-0001e6d0: 6f75 7028 290a 2020 2020 2020 2020 0a20  oup().        . 
-0001e6e0: 2020 2020 2020 2023 2069 6d70 7574 6520         # impute 
-0001e6f0: 6765 6e65 7320 6461 7461 0a20 2020 2020  genes data.     
-0001e700: 2020 2073 656c 662e 6461 7461 203d 2073     self.data = s
-0001e710: 656c 662e 5f70 7265 7072 6f63 6573 7369  elf._preprocessi
-0001e720: 6e67 2e69 6d70 7574 655f 6765 6e65 735f  ng.impute_genes_
-0001e730: 7769 7468 5f70 726f 7465 696e 5f69 6473  with_protein_ids
-0001e740: 2829 0a20 2020 2020 2020 200a 2020 2020  ().        .    
-0001e750: 2020 2020 2320 696d 7075 7465 2064 6174      # impute dat
-0001e760: 6120 6261 7365 6420 6f6e 206e 6f72 6d61  a based on norma
-0001e770: 6c20 6469 7374 7269 6275 7469 6f6e 0a20  l distribution. 
-0001e780: 2020 2020 2020 2073 656c 662e 6461 7461         self.data
-0001e790: 203d 2073 656c 662e 5f70 7265 7072 6f63   = self._preproc
-0001e7a0: 6573 7369 6e67 2e69 6d70 7574 655f 6261  essing.impute_ba
-0001e7b0: 7365 645f 6f6e 5f67 6175 7373 6961 6e28  sed_on_gaussian(
-0001e7c0: 290a 2020 2020 2020 2020 0a20 2020 2020  ).        .     
-0001e7d0: 2020 2072 6574 7572 6e20 7365 6c66 2e64     return self.d
-0001e7e0: 6174 6100 0000 0000 0000 0000 0000 0000  ata.............
-0001e7f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001e800: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-0001e810: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001e820: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001e830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001e840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001e850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001e860: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-0001e870: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-0001e880: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
-0001e890: 3030 3000 3031 3032 3133 0020 7800 0000  000.010213. x...
-0001e8a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001e8b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001e8c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001e8d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001e8e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001e8f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001e900: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-0001e910: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001e920: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001e930: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001e940: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001e950: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001e960: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001e970: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001e980: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001e990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001e9a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001e9b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001e9c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001e9d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001e9e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001e9f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ea00: 3232 206d 7469 6d65 3d31 3638 3834 3937  22 mtime=1688497
-0001ea10: 3330 392e 300a 0000 0000 0000 0000 0000  309.0...........
-0001ea20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ea30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ea40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ea50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ea60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ea70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ea80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ea90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001eaa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001eab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001eac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ead0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001eae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001eaf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001eb00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001eb10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001eb20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001eb30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001eb40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001eb50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001eb60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001eb70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001eb80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001eb90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001eba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ebb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ebc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ebd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ebe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001d200: 3232 206d 7469 6d65 3d31 3638 3835 3732  22 mtime=1688572
+0001d210: 3039 322e 300a 0000 0000 0000 0000 0000  092.0...........
+0001d220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001d230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001d240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001d250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001d260: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001d270: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001d280: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001d290: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001d2a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001d2b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001d2c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001d2d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001d2e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001d2f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001d300: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001d310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001d320: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001d330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001d340: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001d350: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001d360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001d370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001d380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001d390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001d3a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001d3b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001d3c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001d3d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001d3e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001d3f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001d400: 7072 6f74 656f 6d69 6373 5f64 6f77 6e73  proteomics_downs
+0001d410: 7472 6561 6d5f 616e 616c 7973 6973 2d30  tream_analysis-0
+0001d420: 2e31 2e33 2f70 726f 7465 6f6d 6963 735f  .1.3/proteomics_
+0001d430: 646f 776e 7374 7265 616d 5f61 6e61 6c79  downstream_analy
+0001d440: 7369 732f 7072 6570 726f 6365 7373 696e  sis/preprocessin
+0001d450: 675f 7072 6570 726f 6365 7373 6f72 2e70  g_preprocessor.p
+0001d460: 7900 0000 3030 3030 3634 3400 3030 3031  y...0000644.0001
+0001d470: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
+0001d480: 3030 3132 3734 3300 3134 3435 3133 3130  0012743.14451310
+0001d490: 3237 3400 3033 3430 3533 0020 3000 0000  274.034053. 0...
+0001d4a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001d4b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001d4c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001d4d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001d4e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001d4f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001d500: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
+0001d510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001d520: 0000 0000 0000 0000 0064 6f63 6b65 7200  .........docker.
+0001d530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001d540: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001d550: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001d560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001d570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001d580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001d590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001d5a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001d5b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001d5c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001d5d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001d5e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001d5f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001d600: 696d 706f 7274 206e 756d 7079 2061 7320  import numpy as 
+0001d610: 6e70 0a0a 636c 6173 7320 5072 6570 726f  np..class Prepro
+0001d620: 6365 7373 696e 673a 0a20 2020 200a 2020  cessing:.    .  
+0001d630: 2020 2222 220a 2020 2020 5468 6973 2063    """.    This c
+0001d640: 6c61 7373 2065 6e63 6170 7375 6c61 7465  lass encapsulate
+0001d650: 7320 7072 6570 726f 6365 7373 696e 6720  s preprocessing 
+0001d660: 7374 6570 730a 2020 2020 2222 220a 2020  steps.    """.  
+0001d670: 2020 0a20 2020 2064 6566 205f 5f69 6e69    .    def __ini
+0001d680: 745f 5f28 7365 6c66 293a 0a20 2020 2020  t__(self):.     
+0001d690: 2020 2070 6173 7320 0a20 2020 2020 2020     pass .       
+0001d6a0: 200a 2020 2020 6465 6620 6368 616e 6765   .    def change
+0001d6b0: 5f64 6174 6174 7970 6573 2873 656c 662c  _datatypes(self,
+0001d6c0: 2064 6174 6129 3a0a 2020 2020 2020 2020   data):.        
+0001d6d0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+0001d6e0: 2020 2020 2063 6861 6e67 6520 6461 7461       change data
+0001d6f0: 7479 7065 730a 2020 2020 2020 2020 2222  types.        ""
+0001d700: 220a 2020 2020 2020 2020 0a20 2020 2020  ".        .     
+0001d710: 2020 2073 656c 662e 6461 7461 203d 2064     self.data = d
+0001d720: 6174 612e 636f 7079 2829 0a0a 2020 2020  ata.copy()..    
+0001d730: 2020 2020 666f 7220 6920 696e 2073 656c      for i in sel
+0001d740: 662e 6461 7461 2e63 6f6c 756d 6e73 2e75  f.data.columns.u
+0001d750: 6e69 7175 6528 293a 0a20 2020 2020 2020  nique():.       
+0001d760: 2020 2020 2069 6620 6920 696e 205b 2750       if i in ['P
+0001d770: 726f 7465 696e 2e47 726f 7570 272c 2027  rotein.Group', '
+0001d780: 5072 6f74 6569 6e2e 4964 7327 2c20 2750  Protein.Ids', 'P
+0001d790: 726f 7465 696e 2e4e 616d 6573 272c 2027  rotein.Names', '
+0001d7a0: 4765 6e65 7327 2c27 4669 7273 742e 5072  Genes','First.Pr
+0001d7b0: 6f74 6569 6e2e 4465 7363 7269 7074 696f  otein.Descriptio
+0001d7c0: 6e27 5d3a 0a20 2020 2020 2020 2020 2020  n']:.           
+0001d7d0: 2020 2020 2073 656c 662e 6461 7461 5b69       self.data[i
+0001d7e0: 5d20 3d20 7365 6c66 2e64 6174 615b 695d  ] = self.data[i]
+0001d7f0: 2e61 7374 7970 6528 2773 7472 696e 6727  .astype('string'
+0001d800: 290a 2020 2020 2020 2020 2020 2020 656c  ).            el
+0001d810: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+0001d820: 2020 2020 7365 6c66 2e64 6174 615b 695d      self.data[i]
+0001d830: 203d 2073 656c 662e 6461 7461 5b69 5d2e   = self.data[i].
+0001d840: 6173 7479 7065 2827 666c 6f61 7427 2920  astype('float') 
+0001d850: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0001d860: 7365 6c66 2e64 6174 610a 2020 2020 0a20  self.data.    . 
+0001d870: 2020 2064 6566 206c 6f67 325f 7472 616e     def log2_tran
+0001d880: 7366 6f72 6d28 7365 6c66 293a 0a20 2020  sform(self):.   
+0001d890: 2020 2020 200a 2020 2020 2020 2020 2222       .        ""
+0001d8a0: 220a 2020 2020 2020 2020 6c6f 6732 2074  ".        log2 t
+0001d8b0: 7261 6e73 6672 6f6d 2066 6c6f 6174 2064  ransfrom float d
+0001d8c0: 6174 610a 2020 2020 2020 2020 2222 220a  ata.        """.
+0001d8d0: 0a20 2020 2020 2020 2066 6f72 2069 2069  .        for i i
+0001d8e0: 6e20 7365 6c66 2e64 6174 612e 7365 6c65  n self.data.sele
+0001d8f0: 6374 5f64 7479 7065 7328 2766 6c6f 6174  ct_dtypes('float
+0001d900: 2729 2e63 6f6c 756d 6e73 2e75 6e69 7175  ').columns.uniqu
+0001d910: 6528 293a 0a20 2020 2020 2020 2020 2020  e():.           
+0001d920: 2073 656c 662e 6461 7461 5b69 5d20 3d20   self.data[i] = 
+0001d930: 6e70 2e6c 6f67 3228 7365 6c66 2e64 6174  np.log2(self.dat
+0001d940: 615b 695d 290a 2020 2020 2020 2020 7265  a[i]).        re
+0001d950: 7475 726e 2073 656c 662e 6461 7461 0a20  turn self.data. 
+0001d960: 2020 2020 2020 200a 2020 2020 6465 6620         .    def 
+0001d970: 6669 6c74 6572 5f66 6f72 5f76 616c 6964  filter_for_valid
+0001d980: 5f76 616c 735f 696e 5f6f 6e65 5f65 7870  _vals_in_one_exp
+0001d990: 5f67 726f 7570 2873 656c 6629 3a0a 2020  _group(self):.  
+0001d9a0: 2020 2020 2020 0a20 2020 2020 2020 2022        .        "
+0001d9b0: 2222 0a20 2020 2020 2020 2046 696c 7465  "".        Filte
+0001d9c0: 7220 666f 7220 7661 6c69 6420 7661 6c75  r for valid valu
+0001d9d0: 6573 2069 6e20 6174 206c 6561 7374 206f  es in at least o
+0001d9e0: 6e65 2065 7870 6572 696d 656e 7461 6c20  ne experimental 
+0001d9f0: 6772 6f75 700a 2020 2020 2020 2020 7061  group.        pa
+0001da00: 7261 6d20 6461 7461 3a20 6469 616e 6e20  ram data: diann 
+0001da10: 6f75 7470 7574 2074 6162 6c65 0a20 2020  output table.   
+0001da20: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+0001da30: 2020 2020 200a 2020 2020 2020 2020 636f       .        co
+0001da40: 6c75 6d6e 735f 6e61 6d65 203d 2073 656c  lumns_name = sel
+0001da50: 662e 6461 7461 2e73 656c 6563 745f 6474  f.data.select_dt
+0001da60: 7970 6573 2827 666c 6f61 7427 292e 636f  ypes('float').co
+0001da70: 6c75 6d6e 732e 756e 6971 7565 2829 0a20  lumns.unique(). 
+0001da80: 2020 2020 2020 2020 2020 200a 2020 2020             .    
+0001da90: 2020 2020 696e 6469 6365 7320 3d20 5b5d      indices = []
+0001daa0: 0a20 2020 2020 2020 2020 2020 200a 2020  .            .  
+0001dab0: 2020 2020 2020 666f 7220 636f 6c20 696e        for col in
+0001dac0: 2063 6f6c 756d 6e73 5f6e 616d 653a 0a20   columns_name:. 
+0001dad0: 2020 2020 2020 2020 2020 206e 6f6e 5f6e             non_n
+0001dae0: 615f 696e 6469 6365 7320 3d20 7365 6c66  a_indices = self
+0001daf0: 2e64 6174 615b 7365 6c66 2e64 6174 615b  .data[self.data[
+0001db00: 636f 6c5d 2e69 736e 6128 292e 7375 6d28  col].isna().sum(
+0001db10: 6178 6973 3d31 293d 3d30 5d2e 696e 6465  axis=1)==0].inde
+0001db20: 782e 746f 5f6c 6973 7428 290a 2020 2020  x.to_list().    
+0001db30: 2020 2020 2020 2020 696e 6469 6365 7320          indices 
+0001db40: 2b3d 206e 6f6e 5f6e 615f 696e 6469 6365  += non_na_indice
+0001db50: 730a 2020 2020 2020 2020 696e 6469 6365  s.        indice
+0001db60: 7320 3d20 6c69 7374 2873 6574 2869 6e64  s = list(set(ind
+0001db70: 6963 6573 2929 0a20 2020 2020 2020 2073  ices)).        s
+0001db80: 656c 662e 6461 7461 203d 2073 656c 662e  elf.data = self.
+0001db90: 6461 7461 5b73 656c 662e 6461 7461 2e69  data[self.data.i
+0001dba0: 6e64 6578 2e69 7369 6e28 696e 6469 6365  ndex.isin(indice
+0001dbb0: 7329 5d2e 7265 7365 745f 696e 6465 7828  s)].reset_index(
+0001dbc0: 6472 6f70 203d 2054 7275 6529 0a20 2020  drop = True).   
+0001dbd0: 2020 2020 200a 2020 2020 2020 2020 7265       .        re
+0001dbe0: 7475 726e 2073 656c 662e 6461 7461 0a20  turn self.data. 
+0001dbf0: 2020 200a 2020 2020 6465 6620 696d 7075     .    def impu
+0001dc00: 7465 5f67 656e 6573 5f77 6974 685f 7072  te_genes_with_pr
+0001dc10: 6f74 6569 6e5f 6964 7328 7365 6c66 293a  otein_ids(self):
+0001dc20: 0a20 2020 2020 2020 200a 2020 2020 2020  .        .      
+0001dc30: 2020 2222 220a 2020 2020 2020 2020 496d    """.        Im
+0001dc40: 7075 7469 6e67 206d 6973 7369 6e67 2076  puting missing v
+0001dc50: 616c 7565 7320 696e 2047 656e 6573 2063  alues in Genes c
+0001dc60: 6f6c 756d 6e20 7769 7468 2074 6865 2070  olumn with the p
+0001dc70: 726f 7465 696e 2049 4473 0a20 2020 2020  rotein IDs.     
+0001dc80: 2020 2022 2222 0a20 2020 2020 2020 2069     """.        i
+0001dc90: 6d70 7574 6174 696f 6e5f 7661 6c75 6573  mputation_values
+0001dca0: 203d 205b 692e 7370 6c69 7428 273b 2729   = [i.split(';')
+0001dcb0: 5b30 5d20 666f 7220 6920 696e 2073 656c  [0] for i in sel
+0001dcc0: 662e 6461 7461 5b73 656c 662e 6461 7461  f.data[self.data
+0001dcd0: 5b27 4765 6e65 7327 5d2e 6973 6e61 2829  ['Genes'].isna()
+0001dce0: 5d5b 2750 726f 7465 696e 2e49 6473 275d  ]['Protein.Ids']
+0001dcf0: 2e76 616c 7565 735d 0a20 2020 2020 2020  .values].       
+0001dd00: 200a 2020 2020 2020 2020 666f 7220 6964   .        for id
+0001dd10: 782c 2076 616c 7565 2069 6e20 7a69 7028  x, value in zip(
+0001dd20: 7365 6c66 2e64 6174 615b 7365 6c66 2e64  self.data[self.d
+0001dd30: 6174 615b 2747 656e 6573 275d 2e69 736e  ata['Genes'].isn
+0001dd40: 6128 295d 5b27 5072 6f74 6569 6e2e 4964  a()]['Protein.Id
+0001dd50: 7327 5d2e 696e 6465 782c 2069 6d70 7574  s'].index, imput
+0001dd60: 6174 696f 6e5f 7661 6c75 6573 293a 0a20  ation_values):. 
+0001dd70: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0001dd80: 6461 7461 2e6c 6f63 5b69 6478 2c20 5b27  data.loc[idx, ['
+0001dd90: 4765 6e65 7327 5d5d 203d 2076 616c 7565  Genes']] = value
+0001dda0: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+0001ddb0: 2073 656c 662e 6461 7461 0a20 2020 200a   self.data.    .
+0001ddc0: 2020 2020 6465 6620 696d 7075 7465 5f62      def impute_b
+0001ddd0: 6173 6564 5f6f 6e5f 6761 7573 7369 616e  ased_on_gaussian
+0001dde0: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+0001ddf0: 200a 2020 2020 2020 2020 2222 220a 2020   .        """.  
+0001de00: 2020 2020 2020 5468 6973 2066 756e 6374        This funct
+0001de10: 696f 6e20 696d 7075 7465 7320 6d69 7373  ion imputes miss
+0001de20: 696e 6720 7661 6c75 6573 2069 6e20 6120  ing values in a 
+0001de30: 6461 7461 7365 7420 7573 696e 6720 6120  dataset using a 
+0001de40: 4761 7573 7369 616e 2064 6973 7472 6962  Gaussian distrib
+0001de50: 7574 696f 6e2e 0a20 2020 2020 2020 2054  ution..        T
+0001de60: 6865 206d 6973 7369 6e67 2076 616c 7565  he missing value
+0001de70: 7320 6172 6520 696d 7075 7465 6420 6279  s are imputed by
+0001de80: 2072 616e 646f 6d20 7361 6d70 6c69 6e67   random sampling
+0001de90: 2076 616c 7565 7320 6672 6f6d 2061 2047   values from a G
+0001dea0: 6175 7373 6961 6e20 6469 7374 7269 6275  aussian distribu
+0001deb0: 7469 6f6e 2077 6974 6820 6120 6d65 616e  tion with a mean
+0001dec0: 0a20 2020 2020 2020 206f 6620 3320 7374  .        of 3 st
+0001ded0: 616e 6461 7264 2064 6576 6961 7469 6f6e  andard deviation
+0001dee0: 7320 6265 6c6f 7720 7468 6520 636f 6d70  s below the comp
+0001def0: 7574 6564 206d 6561 6e20 616e 6420 6120  uted mean and a 
+0001df00: 7769 6474 6820 6f66 2030 2e33 2074 696d  width of 0.3 tim
+0001df10: 6573 2074 6865 2063 6f6d 7075 7465 6420  es the computed 
+0001df20: 7374 616e 6461 7264 2064 6576 6961 7469  standard deviati
+0001df30: 6f6e 2e0a 2020 2020 2020 2020 5468 6520  on..        The 
+0001df40: 6675 6e63 7469 6f6e 2072 6574 7572 6e73  function returns
+0001df50: 2061 2063 6f70 7920 6f66 2074 6865 2069   a copy of the i
+0001df60: 6d70 7574 6564 2064 6174 6173 6574 2077  mputed dataset w
+0001df70: 6974 6820 7468 6520 6d69 7373 696e 6720  ith the missing 
+0001df80: 7661 6c75 6573 2072 6570 6c61 6365 642e  values replaced.
+0001df90: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+0001dfa0: 2020 2020 2023 2073 656c 6563 7420 6f6e       # select on
+0001dfb0: 6c79 2066 6c6f 6174 2064 6174 610a 2020  ly float data.  
+0001dfc0: 2020 2020 2020 666c 6f61 745f 6461 7461        float_data
+0001dfd0: 203d 2073 656c 662e 6461 7461 2e73 656c   = self.data.sel
+0001dfe0: 6563 745f 6474 7970 6573 2827 666c 6f61  ect_dtypes('floa
+0001dff0: 7427 290a 2020 2020 2020 2020 6e61 5f64  t').        na_d
+0001e000: 6174 6120 3d20 666c 6f61 745f 6461 7461  ata = float_data
+0001e010: 5b66 6c6f 6174 5f64 6174 612e 6973 6e61  [float_data.isna
+0001e020: 2829 2e61 6e79 2861 7869 733d 3129 5d0a  ().any(axis=1)].
+0001e030: 0a20 2020 2020 2020 2023 206c 6f6f 7020  .        # loop 
+0001e040: 7468 726f 7567 6820 6e61 5f64 6174 6120  through na_data 
+0001e050: 726f 7773 2061 6e64 2067 656e 6572 6174  rows and generat
+0001e060: 6520 696d 7075 7465 6420 6461 7461 0a20  e imputed data. 
+0001e070: 2020 2020 2020 2069 6d70 5f61 7272 6179         imp_array
+0001e080: 203d 205b 5d0a 0a20 2020 2020 2020 2066   = []..        f
+0001e090: 6f72 2069 2069 6e20 6e61 5f64 6174 612e  or i in na_data.
+0001e0a0: 696e 6465 783a 200a 2020 2020 2020 2020  index: .        
+0001e0b0: 2020 2020 6e61 5f63 6f75 6e74 203d 206e      na_count = n
+0001e0c0: 615f 6461 7461 2e6c 6f63 5b69 5d2e 6973  a_data.loc[i].is
+0001e0d0: 6e61 2829 2e73 756d 2829 0a0a 2020 2020  na().sum()..    
+0001e0e0: 2020 2020 2020 2020 6d65 616e 203d 206e          mean = n
+0001e0f0: 615f 6461 7461 2e6c 6f63 5b69 5d2e 6d65  a_data.loc[i].me
+0001e100: 616e 2873 6b69 706e 613d 5472 7565 290a  an(skipna=True).
+0001e110: 2020 2020 2020 2020 2020 2020 7374 6420              std 
+0001e120: 3d20 6e61 5f64 6174 612e 6c6f 635b 695d  = na_data.loc[i]
+0001e130: 2e73 7464 2873 6b69 706e 613d 5472 7565  .std(skipna=True
+0001e140: 290a 0a20 2020 2020 2020 2020 2020 206e  )..            n
+0001e150: 702e 7261 6e64 6f6d 2e73 6565 6428 6929  p.random.seed(i)
+0001e160: 0a20 2020 2020 2020 2020 2020 2069 6d70  .            imp
+0001e170: 5f61 7272 6179 2e61 7070 656e 6428 6c69  _array.append(li
+0001e180: 7374 286e 702e 7261 6e64 6f6d 2e6e 6f72  st(np.random.nor
+0001e190: 6d61 6c28 6c6f 633d 6d65 616e 2d33 2a73  mal(loc=mean-3*s
+0001e1a0: 7464 2c20 7363 616c 653d 302e 332a 7374  td, scale=0.3*st
+0001e1b0: 642c 2073 697a 653d 6e61 5f63 6f75 6e74  d, size=na_count
+0001e1c0: 2929 290a 0a20 2020 2020 2020 2069 6d70  )))..        imp
+0001e1d0: 5f76 616c 7565 735f 6c69 7374 203d 206e  _values_list = n
+0001e1e0: 702e 6172 7261 7928 5b69 6d70 5f76 616c  p.array([imp_val
+0001e1f0: 7565 2066 6f72 2069 6e6e 6572 6c69 7374  ue for innerlist
+0001e200: 2069 6e20 696d 705f 6172 7261 7920 666f   in imp_array fo
+0001e210: 7220 696d 705f 7661 6c75 6520 696e 2069  r imp_value in i
+0001e220: 6e6e 6572 6c69 7374 5d29 0a0a 2020 2020  nnerlist])..    
+0001e230: 2020 2020 636f 7069 6564 5f64 6174 6120      copied_data 
+0001e240: 3d20 666c 6f61 745f 6461 7461 2e63 6f70  = float_data.cop
+0001e250: 7928 290a 2020 2020 2020 2020 636f 6c75  y().        colu
+0001e260: 6d6e 7320 3d20 666c 6f61 745f 6461 7461  mns = float_data
+0001e270: 2e63 6f6c 756d 6e73 0a20 2020 2020 2020  .columns.       
+0001e280: 2063 6f70 6965 645f 6461 7461 2e63 6f6c   copied_data.col
+0001e290: 756d 6e73 203d 206e 702e 6172 616e 6765  umns = np.arange
+0001e2a0: 2863 6f70 6965 645f 6461 7461 2e73 6861  (copied_data.sha
+0001e2b0: 7065 5b31 5d29 0a20 2020 2020 2020 200a  pe[1]).        .
+0001e2c0: 2020 2020 2020 2020 2320 696d 7075 7465          # impute
+0001e2d0: 2074 6865 2064 6174 610a 2020 2020 2020   the data.      
+0001e2e0: 2020 7374 6163 6b65 645f 6e61 5f64 6174    stacked_na_dat
+0001e2f0: 6120 3d20 636f 7069 6564 5f64 6174 612e  a = copied_data.
+0001e300: 7374 6163 6b28 6472 6f70 6e61 3d46 616c  stack(dropna=Fal
+0001e310: 7365 290a 2020 2020 2020 2020 6e61 5f69  se).        na_i
+0001e320: 6e64 6578 203d 2073 7461 636b 6564 5f6e  ndex = stacked_n
+0001e330: 615f 6461 7461 5b73 7461 636b 6564 5f6e  a_data[stacked_n
+0001e340: 615f 6461 7461 2e69 736e 6128 295d 2e69  a_data.isna()].i
+0001e350: 6e64 6578 0a20 2020 2020 2020 2073 7461  ndex.        sta
+0001e360: 636b 6564 5f6e 615f 6461 7461 2e6c 6f63  cked_na_data.loc
+0001e370: 5b6e 615f 696e 6465 785d 203d 2069 6d70  [na_index] = imp
+0001e380: 5f76 616c 7565 735f 6c69 7374 0a20 2020  _values_list.   
+0001e390: 2020 2020 2069 6d70 5f64 6174 6120 3d20       imp_data = 
+0001e3a0: 7374 6163 6b65 645f 6e61 5f64 6174 612e  stacked_na_data.
+0001e3b0: 756e 7374 6163 6b28 290a 2020 2020 2020  unstack().      
+0001e3c0: 2020 696d 705f 6461 7461 2e63 6f6c 756d    imp_data.colum
+0001e3d0: 6e73 203d 2063 6f6c 756d 6e73 0a20 2020  ns = columns.   
+0001e3e0: 2020 2020 2069 6d70 5f64 6174 6120 3d20       imp_data = 
+0001e3f0: 7365 6c66 2e64 6174 612e 7365 6c65 6374  self.data.select
+0001e400: 5f64 7479 7065 7328 2773 7472 696e 6727  _dtypes('string'
+0001e410: 292e 6d65 7267 6528 696d 705f 6461 7461  ).merge(imp_data
+0001e420: 2c20 6c65 6674 5f69 6e64 6578 3d54 7275  , left_index=Tru
+0001e430: 652c 2072 6967 6874 5f69 6e64 6578 3d54  e, right_index=T
+0001e440: 7275 6529 0a20 2020 2020 2020 2073 656c  rue).        sel
+0001e450: 662e 6461 7461 203d 2069 6d70 5f64 6174  f.data = imp_dat
+0001e460: 612e 636f 7079 2829 0a20 2020 2020 2020  a.copy().       
+0001e470: 200a 2020 2020 2020 2020 7265 7475 726e   .        return
+0001e480: 2073 656c 662e 6461 7461 0a0a 2020 2020   self.data..    
+0001e490: 6465 6620 6669 6c74 6572 5f66 6f72 5f76  def filter_for_v
+0001e4a0: 616c 6964 5f76 616c 735f 7065 7263 2873  alid_vals_perc(s
+0001e4b0: 656c 662c 2070 6572 6365 6e74 6167 6529  elf, percentage)
+0001e4c0: 3a0a 2020 2020 0a20 2020 2020 2020 2027  :.    .        '
+0001e4d0: 2727 4669 6c74 6572 2066 6f72 2076 616c  ''Filter for val
+0001e4e0: 6964 2076 616c 7565 7320 7573 696e 6720  id values using 
+0001e4f0: 6174 206c 6561 7374 2078 2025 2064 6174  at least x % dat
+0001e500: 6120 636f 6d70 6c65 7465 6e65 7373 2727  a completeness''
+0001e510: 270a 2020 2020 0a20 2020 2020 2020 2063  '.    .        c
+0001e520: 6f6c 5f6c 656e 203d 206c 656e 2873 656c  ol_len = len(sel
+0001e530: 662e 6461 7461 2e73 656c 6563 745f 6474  f.data.select_dt
+0001e540: 7970 6573 2827 666c 6f61 7427 292e 636f  ypes('float').co
+0001e550: 6c75 6d6e 7329 0a20 2020 2020 2020 206d  lumns).        m
+0001e560: 696e 5f73 756d 203d 206e 702e 6365 696c  in_sum = np.ceil
+0001e570: 2863 6f6c 5f6c 656e 202a 2070 6572 6365  (col_len * perce
+0001e580: 6e74 6167 6529 0a20 2020 2020 2020 2062  ntage).        b
+0001e590: 6f6f 6c5f 6172 7261 7920 3d20 7365 6c66  ool_array = self
+0001e5a0: 2e64 6174 612e 7365 6c65 6374 5f64 7479  .data.select_dty
+0001e5b0: 7065 7328 2766 6c6f 6174 2729 2e6e 6f74  pes('float').not
+0001e5c0: 6e61 2829 2e73 756d 2861 7869 733d 3129  na().sum(axis=1)
+0001e5d0: 203e 3d20 6d69 6e5f 7375 6d0a 0a20 2020   >= min_sum..   
+0001e5e0: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+0001e5f0: 2e64 6174 615b 626f 6f6c 5f61 7272 6179  .data[bool_array
+0001e600: 5d0a 0a20 2020 2064 6566 2066 696c 7465  ]..    def filte
+0001e610: 725f 666f 725f 7661 6c69 645f 7661 6c73  r_for_valid_vals
+0001e620: 5f69 6e5f 6f6e 655f 6578 705f 6772 6f75  _in_one_exp_grou
+0001e630: 705f 7065 7263 2873 656c 662c 2070 6572  p_perc(self, per
+0001e640: 6365 6e74 6167 6529 3a0a 0a0a 2020 2020  centage):...    
+0001e650: 2020 2020 2727 2746 696c 7465 7220 666f      '''Filter fo
+0001e660: 7220 7661 6c69 6420 7661 6c75 6573 2075  r valid values u
+0001e670: 7369 6e67 2061 7420 6c65 6173 7420 7820  sing at least x 
+0001e680: 2520 6461 7461 2063 6f6d 706c 6574 656e  % data completen
+0001e690: 6573 2069 6e20 6561 6368 2065 7870 6572  es in each exper
+0001e6a0: 696d 656e 7461 6c20 6772 6f75 7027 2727  imental group'''
+0001e6b0: 0a0a 2020 2020 2020 2020 636f 6c75 6d6e  ..        column
+0001e6c0: 735f 6e61 6d65 203d 2073 656c 662e 6461  s_name = self.da
+0001e6d0: 7461 2e73 656c 6563 745f 6474 7970 6573  ta.select_dtypes
+0001e6e0: 2827 666c 6f61 7427 292e 636f 6c75 6d6e  ('float').column
+0001e6f0: 732e 756e 6971 7565 2829 0a20 2020 2020  s.unique().     
+0001e700: 2020 200a 2020 2020 2020 2020 696e 6469     .        indi
+0001e710: 6365 7320 3d20 5b5d 0a20 2020 2020 2020  ces = [].       
+0001e720: 200a 2020 2020 2020 2020 666f 7220 636f   .        for co
+0001e730: 6c20 696e 2063 6f6c 756d 6e73 5f6e 616d  l in columns_nam
+0001e740: 653a 0a20 2020 2020 2020 2020 2020 206e  e:.            n
+0001e750: 6f6e 5f6e 615f 696e 6469 6365 7320 3d20  on_na_indices = 
+0001e760: 7365 6c66 2e64 6174 615b 7365 6c66 2e64  self.data[self.d
+0001e770: 6174 615b 636f 6c5d 2e69 736e 6128 292e  ata[col].isna().
+0001e780: 7375 6d28 6178 6973 3d31 292f 6c65 6e28  sum(axis=1)/len(
+0001e790: 7365 6c66 2e64 6174 615b 636f 6c5d 2e63  self.data[col].c
+0001e7a0: 6f6c 756d 6e73 2920 3e3d 2070 6572 6365  olumns) >= perce
+0001e7b0: 6e74 6167 655d 2e69 6e64 6578 0a20 2020  ntage].index.   
+0001e7c0: 2020 2020 2020 2020 2069 6e64 6963 6573           indices
+0001e7d0: 2e61 7070 656e 6428 6e6f 6e5f 6e61 5f69  .append(non_na_i
+0001e7e0: 6e64 6963 6573 290a 2020 2020 2020 2020  ndices).        
+0001e7f0: 696e 6469 6365 7320 3d20 6c69 7374 2873  indices = list(s
+0001e800: 6574 2869 6e64 6963 6573 2929 0a20 2020  et(indices)).   
+0001e810: 2020 2020 2073 656c 662e 6461 7461 203d       self.data =
+0001e820: 2073 656c 662e 6461 7461 5b73 656c 662e   self.data[self.
+0001e830: 6461 7461 2e69 6e64 6578 2e69 7369 6e28  data.index.isin(
+0001e840: 696e 6469 6365 7329 5d2e 7265 7365 745f  indices)].reset_
+0001e850: 696e 6465 7828 6472 6f70 203d 2054 7275  index(drop = Tru
+0001e860: 6529 0a20 2020 2020 2020 200a 2020 2020  e).        .    
+0001e870: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+0001e880: 6461 7461 0a0a 0a63 6c61 7373 2050 7265  data...class Pre
+0001e890: 7072 6f63 6573 736f 723a 0a20 2020 200a  processor:.    .
+0001e8a0: 2020 2020 2222 220a 2020 2020 5468 6973      """.    This
+0001e8b0: 2063 6c61 7373 2061 7070 6c69 6573 2070   class applies p
+0001e8c0: 7265 7072 6f63 6573 7369 6e67 2073 7465  reprocessing ste
+0001e8d0: 7073 2074 6f20 4449 414e 4e20 6461 7461  ps to DIANN data
+0001e8e0: 0a20 2020 2022 2222 0a20 2020 200a 2020  .    """.    .  
+0001e8f0: 2020 6465 6620 5f5f 696e 6974 5f5f 2873    def __init__(s
+0001e900: 656c 6629 3a0a 2020 2020 2020 2020 7365  elf):.        se
+0001e910: 6c66 2e64 6174 6120 3d20 4e6f 6e65 0a20  lf.data = None. 
+0001e920: 2020 2020 2020 2073 656c 662e 5f70 7265         self._pre
+0001e930: 7072 6f63 6573 7369 6e67 203d 2050 7265  processing = Pre
+0001e940: 7072 6f63 6573 7369 6e67 2829 0a20 2020  processing().   
+0001e950: 200a 2020 2020 6465 6620 5f70 726f 6365   .    def _proce
+0001e960: 7373 2873 656c 662c 2064 6174 6129 3a0a  ss(self, data):.
+0001e970: 2020 2020 2020 2020 0a20 2020 2020 2020          .       
+0001e980: 2023 2063 6861 6e67 6520 7468 6520 6461   # change the da
+0001e990: 7461 7479 7065 730a 2020 2020 2020 2020  tatypes.        
+0001e9a0: 7365 6c66 2e64 6174 6120 3d20 7365 6c66  self.data = self
+0001e9b0: 2e5f 7072 6570 726f 6365 7373 696e 672e  ._preprocessing.
+0001e9c0: 6368 616e 6765 5f64 6174 6174 7970 6573  change_datatypes
+0001e9d0: 2864 6174 6129 0a20 2020 2020 2020 200a  (data).        .
+0001e9e0: 2020 2020 2020 2020 2320 6c6f 6732 2074          # log2 t
+0001e9f0: 7261 6e73 666f 726d 2064 6174 610a 2020  ransform data.  
+0001ea00: 2020 2020 2020 7365 6c66 2e64 6174 6120        self.data 
+0001ea10: 3d20 7365 6c66 2e5f 7072 6570 726f 6365  = self._preproce
+0001ea20: 7373 696e 672e 6c6f 6732 5f74 7261 6e73  ssing.log2_trans
+0001ea30: 666f 726d 2829 0a20 2020 2020 2020 200a  form().        .
+0001ea40: 2020 2020 2020 2020 2320 6669 6c74 6572          # filter
+0001ea50: 2066 6f72 2076 616c 6964 2076 616c 7565   for valid value
+0001ea60: 7320 696e 2061 7420 6c65 6173 7420 6f6e  s in at least on
+0001ea70: 6520 6578 7065 7269 6d65 6e74 616c 2067  e experimental g
+0001ea80: 726f 7570 0a20 2020 2020 2020 2073 656c  roup.        sel
+0001ea90: 662e 6461 7461 203d 2073 656c 662e 5f70  f.data = self._p
+0001eaa0: 7265 7072 6f63 6573 7369 6e67 2e66 696c  reprocessing.fil
+0001eab0: 7465 725f 666f 725f 7661 6c69 645f 7661  ter_for_valid_va
+0001eac0: 6c73 5f69 6e5f 6f6e 655f 6578 705f 6772  ls_in_one_exp_gr
+0001ead0: 6f75 7028 290a 2020 2020 2020 2020 0a20  oup().        . 
+0001eae0: 2020 2020 2020 2023 2069 6d70 7574 6520         # impute 
+0001eaf0: 6765 6e65 7320 6461 7461 0a20 2020 2020  genes data.     
+0001eb00: 2020 2073 656c 662e 6461 7461 203d 2073     self.data = s
+0001eb10: 656c 662e 5f70 7265 7072 6f63 6573 7369  elf._preprocessi
+0001eb20: 6e67 2e69 6d70 7574 655f 6765 6e65 735f  ng.impute_genes_
+0001eb30: 7769 7468 5f70 726f 7465 696e 5f69 6473  with_protein_ids
+0001eb40: 2829 0a20 2020 2020 2020 200a 2020 2020  ().        .    
+0001eb50: 2020 2020 2320 696d 7075 7465 2064 6174      # impute dat
+0001eb60: 6120 6261 7365 6420 6f6e 206e 6f72 6d61  a based on norma
+0001eb70: 6c20 6469 7374 7269 6275 7469 6f6e 0a20  l distribution. 
+0001eb80: 2020 2020 2020 2073 656c 662e 6461 7461         self.data
+0001eb90: 203d 2073 656c 662e 5f70 7265 7072 6f63   = self._preproc
+0001eba0: 6573 7369 6e67 2e69 6d70 7574 655f 6261  essing.impute_ba
+0001ebb0: 7365 645f 6f6e 5f67 6175 7373 6961 6e28  sed_on_gaussian(
+0001ebc0: 290a 2020 2020 2020 2020 0a20 2020 2020  ).        .     
+0001ebd0: 2020 2072 6574 7572 6e20 7365 6c66 2e64     return self.d
+0001ebe0: 6174 6100 0000 0000 0000 0000 0000 0000  ata.............
 0001ebf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ec00: 7072 6f74 656f 6d69 6373 5f64 6f77 6e73  proteomics_downs
-0001ec10: 7472 6561 6d5f 616e 616c 7973 6973 2d30  tream_analysis-0
-0001ec20: 2e31 2e32 2f70 726f 7465 6f6d 6963 735f  .1.2/proteomics_
-0001ec30: 646f 776e 7374 7265 616d 5f61 6e61 6c79  downstream_analy
-0001ec40: 7369 732f 7072 6570 726f 6365 7373 6f72  sis/preprocessor
-0001ec50: 2e70 7900 0000 0000 0000 0000 0000 0000  .py.............
-0001ec60: 0000 0000 3030 3030 3634 3400 3030 3031  ....0000644.0001
-0001ec70: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
-0001ec80: 3030 3032 3133 3400 3134 3435 3130 3636  0002134.14451066
-0001ec90: 3233 3500 3033 3131 3035 0020 3000 0000  235.031105. 0...
+0001ec00: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+0001ec10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001ec20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001ec30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001ec40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001ec50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001ec60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+0001ec70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+0001ec80: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
+0001ec90: 3030 3000 3031 3032 3133 0020 7800 0000  000.010213. x...
 0001eca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001ecb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001ecc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001ecd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001ece0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001ecf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ed00: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
+0001ed00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
 0001ed10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ed20: 0000 0000 0000 0000 0064 6f63 6b65 7200  .........docker.
+0001ed20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001ed30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001ed40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001ed50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001ed60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001ed70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001ed80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001ed90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001eda0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001edb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001edc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001edd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001ede0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001edf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ee00: 6672 6f6d 2070 726f 7465 6f6d 6963 735f  from proteomics_
-0001ee10: 646f 776e 7374 7265 616d 5f61 6e61 6c79  downstream_analy
-0001ee20: 7369 732e 7072 6570 726f 6365 7373 696e  sis.preprocessin
-0001ee30: 6720 696d 706f 7274 2050 7265 7072 6f63  g import Preproc
-0001ee40: 6573 7369 6e67 0a0a 636c 6173 7320 5072  essing..class Pr
-0001ee50: 6570 726f 6365 7373 6f72 3a0a 2020 2020  eprocessor:.    
-0001ee60: 0a20 2020 2022 2222 0a20 2020 2054 6869  .    """.    Thi
-0001ee70: 7320 636c 6173 7320 6170 706c 6965 7320  s class applies 
-0001ee80: 7072 6570 726f 6365 7373 696e 6720 7374  preprocessing st
-0001ee90: 6570 7320 746f 2044 4941 4e4e 2064 6174  eps to DIANN dat
-0001eea0: 610a 2020 2020 2222 220a 2020 2020 0a20  a.    """.    . 
-0001eeb0: 2020 2064 6566 205f 5f69 6e69 745f 5f28     def __init__(
-0001eec0: 7365 6c66 293a 0a20 2020 2020 2020 2073  self):.        s
-0001eed0: 656c 662e 6461 7461 203d 204e 6f6e 650a  elf.data = None.
-0001eee0: 2020 2020 2020 2020 7365 6c66 2e5f 7072          self._pr
-0001eef0: 6570 726f 6365 7373 696e 6720 3d20 5072  eprocessing = Pr
-0001ef00: 6570 726f 6365 7373 696e 6728 290a 2020  eprocessing().  
-0001ef10: 2020 0a20 2020 2064 6566 205f 7072 6f63    .    def _proc
-0001ef20: 6573 7328 7365 6c66 2c20 6461 7461 293a  ess(self, data):
-0001ef30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001ef40: 200a 2020 2020 2020 2020 2320 6368 616e   .        # chan
-0001ef50: 6765 2074 6865 2064 6174 6174 7970 6573  ge the datatypes
-0001ef60: 0a20 2020 2020 2020 2064 6174 6120 3d20  .        data = 
-0001ef70: 7365 6c66 2e5f 7072 6570 726f 6365 7373  self._preprocess
-0001ef80: 696e 672e 5f63 6861 6e67 655f 6461 7461  ing._change_data
-0001ef90: 7479 7065 7328 6461 7461 290a 2020 2020  types(data).    
-0001efa0: 2020 2020 0a20 2020 2020 2020 2023 206c      .        # l
-0001efb0: 6f67 3220 7472 616e 7366 6f72 6d20 6461  og2 transform da
-0001efc0: 7461 0a20 2020 2020 2020 2064 6174 6120  ta.        data 
-0001efd0: 3d20 7365 6c66 2e5f 7072 6570 726f 6365  = self._preproce
-0001efe0: 7373 696e 672e 5f6c 6f67 325f 7472 616e  ssing._log2_tran
-0001eff0: 7366 6f72 6d28 6461 7461 290a 2020 2020  sform(data).    
-0001f000: 2020 2020 0a20 2020 2020 2020 2023 2066      .        # f
-0001f010: 696c 7465 7220 666f 7220 7661 6c69 6420  ilter for valid 
-0001f020: 7661 6c75 6573 2069 6e20 6174 206c 6561  values in at lea
-0001f030: 7374 206f 6e65 2065 7870 6572 696d 656e  st one experimen
-0001f040: 7461 6c20 6772 6f75 700a 2020 2020 2020  tal group.      
-0001f050: 2020 6461 7461 203d 2073 656c 662e 5f70    data = self._p
-0001f060: 7265 7072 6f63 6573 7369 6e67 2e5f 6669  reprocessing._fi
-0001f070: 6c74 6572 5f66 6f72 5f76 616c 6964 5f76  lter_for_valid_v
-0001f080: 616c 735f 696e 5f6f 6e65 5f65 7870 5f67  als_in_one_exp_g
-0001f090: 726f 7570 2864 6174 6129 0a20 2020 2020  roup(data).     
-0001f0a0: 2020 200a 2020 2020 2020 2020 2320 696d     .        # im
-0001f0b0: 7075 7465 2067 656e 6573 2064 6174 610a  pute genes data.
-0001f0c0: 2020 2020 2020 2020 6461 7461 203d 2073          data = s
-0001f0d0: 656c 662e 5f70 7265 7072 6f63 6573 7369  elf._preprocessi
-0001f0e0: 6e67 2e5f 696d 7075 7465 5f67 656e 6573  ng._impute_genes
-0001f0f0: 5f77 6974 685f 7072 6f74 6569 6e5f 6964  _with_protein_id
-0001f100: 7328 6461 7461 290a 2020 2020 2020 2020  s(data).        
-0001f110: 0a20 2020 2020 2020 2023 2069 6d70 7574  .        # imput
-0001f120: 6520 6461 7461 2062 6173 6564 206f 6e20  e data based on 
-0001f130: 6e6f 726d 616c 2064 6973 7472 6962 7574  normal distribut
-0001f140: 696f 6e0a 2020 2020 2020 2020 6461 7461  ion.        data
-0001f150: 203d 2073 656c 662e 5f70 7265 7072 6f63   = self._preproc
-0001f160: 6573 7369 6e67 2e5f 696d 7075 7465 5f62  essing._impute_b
-0001f170: 6173 6564 5f6f 6e5f 6761 7573 7369 616e  ased_on_gaussian
-0001f180: 2864 6174 6129 0a20 2020 2020 2020 2020  (data).         
-0001f190: 2020 2020 2020 200a 2020 2020 2020 2020         .        
-0001f1a0: 7265 7475 726e 2064 6174 610a 2020 2020  return data.    
-0001f1b0: 0a20 2020 2064 6566 205f 6368 616e 6765  .    def _change
-0001f1c0: 5f64 7479 7065 7328 7365 6c66 2c20 6461  _dtypes(self, da
-0001f1d0: 7461 293a 0a20 2020 2020 2020 2020 2020  ta):.           
-0001f1e0: 2020 2020 200a 2020 2020 2020 2020 2320       .        # 
-0001f1f0: 6368 616e 6765 2074 6865 2064 6174 6174  change the datat
-0001f200: 7970 6573 0a20 2020 2020 2020 2064 6174  ypes.        dat
-0001f210: 6120 3d20 7365 6c66 2e5f 7072 6570 726f  a = self._prepro
-0001f220: 6365 7373 696e 672e 5f63 6861 6e67 655f  cessing._change_
-0001f230: 6461 7461 7479 7065 7328 6461 7461 290a  datatypes(data).
-0001f240: 2020 2020 2020 2020 0a20 2020 2020 2020          .       
-0001f250: 2072 6574 7572 6e20 6461 7461 0000 0000   return data....
-0001f260: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001f270: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001f280: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001f290: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001f2a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001f2b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001f2c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001f2d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001f2e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001f2f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001f300: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001f310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001f320: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001f330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001f340: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001f350: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001f360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001f370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001f380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001f390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001f3a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001f3b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001f3c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001f3d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001f3e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001f3f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001f400: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-0001f410: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001f420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001f430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001f440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001f450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001f460: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-0001f470: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-0001f480: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
-0001f490: 3030 3000 3031 3032 3133 0020 7800 0000  000.010213. x...
-0001f4a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001f4b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001f4c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001f4d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001f4e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001f4f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001f500: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-0001f510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001f520: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001f530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001f540: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001f550: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001f560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001f570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001f580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001f590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001f5a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001f5b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001f5c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001f5d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001f5e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001f5f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001f600: 3232 206d 7469 6d65 3d31 3638 3834 3937  22 mtime=1688497
-0001f610: 3330 392e 300a 0000 0000 0000 0000 0000  309.0...........
-0001f620: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001f630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001f640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001f650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001ee00: 3232 206d 7469 6d65 3d31 3638 3835 3732  22 mtime=1688572
+0001ee10: 3039 322e 300a 0000 0000 0000 0000 0000  092.0...........
+0001ee20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001ee30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001ee40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001ee50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001ee60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001ee70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001ee80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001ee90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001eea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001eeb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001eec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001eed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001eee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001eef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001ef00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001ef10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001ef20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001ef30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001ef40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001ef50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001ef60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001ef70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001ef80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001ef90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001efa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001efb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001efc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001efd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001efe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001eff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f000: 7072 6f74 656f 6d69 6373 5f64 6f77 6e73  proteomics_downs
+0001f010: 7472 6561 6d5f 616e 616c 7973 6973 2d30  tream_analysis-0
+0001f020: 2e31 2e33 2f70 726f 7465 6f6d 6963 735f  .1.3/proteomics_
+0001f030: 646f 776e 7374 7265 616d 5f61 6e61 6c79  downstream_analy
+0001f040: 7369 732f 7072 6570 726f 6365 7373 6f72  sis/preprocessor
+0001f050: 2e70 7900 0000 0000 0000 0000 0000 0000  .py.............
+0001f060: 0000 0000 3030 3030 3634 3400 3030 3031  ....0000644.0001
+0001f070: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
+0001f080: 3030 3032 3133 3400 3134 3435 3133 3130  0002134.14451310
+0001f090: 3237 3400 3033 3131 3031 0020 3000 0000  274.031101. 0...
+0001f0a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f0b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f0c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f0d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f0e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f0f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f100: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
+0001f110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f120: 0000 0000 0000 0000 0064 6f63 6b65 7200  .........docker.
+0001f130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f140: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f150: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f1a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f1b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f1c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f1d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f1e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f1f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f200: 6672 6f6d 2070 726f 7465 6f6d 6963 735f  from proteomics_
+0001f210: 646f 776e 7374 7265 616d 5f61 6e61 6c79  downstream_analy
+0001f220: 7369 732e 7072 6570 726f 6365 7373 696e  sis.preprocessin
+0001f230: 6720 696d 706f 7274 2050 7265 7072 6f63  g import Preproc
+0001f240: 6573 7369 6e67 0a0a 636c 6173 7320 5072  essing..class Pr
+0001f250: 6570 726f 6365 7373 6f72 3a0a 2020 2020  eprocessor:.    
+0001f260: 0a20 2020 2022 2222 0a20 2020 2054 6869  .    """.    Thi
+0001f270: 7320 636c 6173 7320 6170 706c 6965 7320  s class applies 
+0001f280: 7072 6570 726f 6365 7373 696e 6720 7374  preprocessing st
+0001f290: 6570 7320 746f 2044 4941 4e4e 2064 6174  eps to DIANN dat
+0001f2a0: 610a 2020 2020 2222 220a 2020 2020 0a20  a.    """.    . 
+0001f2b0: 2020 2064 6566 205f 5f69 6e69 745f 5f28     def __init__(
+0001f2c0: 7365 6c66 293a 0a20 2020 2020 2020 2073  self):.        s
+0001f2d0: 656c 662e 6461 7461 203d 204e 6f6e 650a  elf.data = None.
+0001f2e0: 2020 2020 2020 2020 7365 6c66 2e5f 7072          self._pr
+0001f2f0: 6570 726f 6365 7373 696e 6720 3d20 5072  eprocessing = Pr
+0001f300: 6570 726f 6365 7373 696e 6728 290a 2020  eprocessing().  
+0001f310: 2020 0a20 2020 2064 6566 205f 7072 6f63    .    def _proc
+0001f320: 6573 7328 7365 6c66 2c20 6461 7461 293a  ess(self, data):
+0001f330: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001f340: 200a 2020 2020 2020 2020 2320 6368 616e   .        # chan
+0001f350: 6765 2074 6865 2064 6174 6174 7970 6573  ge the datatypes
+0001f360: 0a20 2020 2020 2020 2064 6174 6120 3d20  .        data = 
+0001f370: 7365 6c66 2e5f 7072 6570 726f 6365 7373  self._preprocess
+0001f380: 696e 672e 5f63 6861 6e67 655f 6461 7461  ing._change_data
+0001f390: 7479 7065 7328 6461 7461 290a 2020 2020  types(data).    
+0001f3a0: 2020 2020 0a20 2020 2020 2020 2023 206c      .        # l
+0001f3b0: 6f67 3220 7472 616e 7366 6f72 6d20 6461  og2 transform da
+0001f3c0: 7461 0a20 2020 2020 2020 2064 6174 6120  ta.        data 
+0001f3d0: 3d20 7365 6c66 2e5f 7072 6570 726f 6365  = self._preproce
+0001f3e0: 7373 696e 672e 5f6c 6f67 325f 7472 616e  ssing._log2_tran
+0001f3f0: 7366 6f72 6d28 6461 7461 290a 2020 2020  sform(data).    
+0001f400: 2020 2020 0a20 2020 2020 2020 2023 2066      .        # f
+0001f410: 696c 7465 7220 666f 7220 7661 6c69 6420  ilter for valid 
+0001f420: 7661 6c75 6573 2069 6e20 6174 206c 6561  values in at lea
+0001f430: 7374 206f 6e65 2065 7870 6572 696d 656e  st one experimen
+0001f440: 7461 6c20 6772 6f75 700a 2020 2020 2020  tal group.      
+0001f450: 2020 6461 7461 203d 2073 656c 662e 5f70    data = self._p
+0001f460: 7265 7072 6f63 6573 7369 6e67 2e5f 6669  reprocessing._fi
+0001f470: 6c74 6572 5f66 6f72 5f76 616c 6964 5f76  lter_for_valid_v
+0001f480: 616c 735f 696e 5f6f 6e65 5f65 7870 5f67  als_in_one_exp_g
+0001f490: 726f 7570 2864 6174 6129 0a20 2020 2020  roup(data).     
+0001f4a0: 2020 200a 2020 2020 2020 2020 2320 696d     .        # im
+0001f4b0: 7075 7465 2067 656e 6573 2064 6174 610a  pute genes data.
+0001f4c0: 2020 2020 2020 2020 6461 7461 203d 2073          data = s
+0001f4d0: 656c 662e 5f70 7265 7072 6f63 6573 7369  elf._preprocessi
+0001f4e0: 6e67 2e5f 696d 7075 7465 5f67 656e 6573  ng._impute_genes
+0001f4f0: 5f77 6974 685f 7072 6f74 6569 6e5f 6964  _with_protein_id
+0001f500: 7328 6461 7461 290a 2020 2020 2020 2020  s(data).        
+0001f510: 0a20 2020 2020 2020 2023 2069 6d70 7574  .        # imput
+0001f520: 6520 6461 7461 2062 6173 6564 206f 6e20  e data based on 
+0001f530: 6e6f 726d 616c 2064 6973 7472 6962 7574  normal distribut
+0001f540: 696f 6e0a 2020 2020 2020 2020 6461 7461  ion.        data
+0001f550: 203d 2073 656c 662e 5f70 7265 7072 6f63   = self._preproc
+0001f560: 6573 7369 6e67 2e5f 696d 7075 7465 5f62  essing._impute_b
+0001f570: 6173 6564 5f6f 6e5f 6761 7573 7369 616e  ased_on_gaussian
+0001f580: 2864 6174 6129 0a20 2020 2020 2020 2020  (data).         
+0001f590: 2020 2020 2020 200a 2020 2020 2020 2020         .        
+0001f5a0: 7265 7475 726e 2064 6174 610a 2020 2020  return data.    
+0001f5b0: 0a20 2020 2064 6566 205f 6368 616e 6765  .    def _change
+0001f5c0: 5f64 7479 7065 7328 7365 6c66 2c20 6461  _dtypes(self, da
+0001f5d0: 7461 293a 0a20 2020 2020 2020 2020 2020  ta):.           
+0001f5e0: 2020 2020 200a 2020 2020 2020 2020 2320       .        # 
+0001f5f0: 6368 616e 6765 2074 6865 2064 6174 6174  change the datat
+0001f600: 7970 6573 0a20 2020 2020 2020 2064 6174  ypes.        dat
+0001f610: 6120 3d20 7365 6c66 2e5f 7072 6570 726f  a = self._prepro
+0001f620: 6365 7373 696e 672e 5f63 6861 6e67 655f  cessing._change_
+0001f630: 6461 7461 7479 7065 7328 6461 7461 290a  datatypes(data).
+0001f640: 2020 2020 2020 2020 0a20 2020 2020 2020          .       
+0001f650: 2072 6574 7572 6e20 6461 7461 0000 0000   return data....
 0001f660: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f670: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f680: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f690: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f6a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f6b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f6c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -8058,1687 +8058,1687 @@
 0001f790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f7a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f7b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f7c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f7d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f7e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f7f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001f800: 7072 6f74 656f 6d69 6373 5f64 6f77 6e73  proteomics_downs
-0001f810: 7472 6561 6d5f 616e 616c 7973 6973 2d30  tream_analysis-0
-0001f820: 2e31 2e32 2f70 726f 7465 6f6d 6963 735f  .1.2/proteomics_
-0001f830: 646f 776e 7374 7265 616d 5f61 6e61 6c79  downstream_analy
-0001f840: 7369 732f 7374 6174 6973 7469 6373 2e70  sis/statistics.p
-0001f850: 7900 0000 0000 0000 0000 0000 0000 0000  y...............
-0001f860: 0000 0000 3030 3030 3634 3400 3030 3031  ....0000644.0001
-0001f870: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
-0001f880: 3030 3132 3736 3400 3134 3435 3130 3636  0012764.14451066
-0001f890: 3233 3500 3033 3035 3633 0020 3000 0000  235.030563. 0...
+0001f800: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+0001f810: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f820: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f860: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+0001f870: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+0001f880: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
+0001f890: 3030 3000 3031 3032 3133 0020 7800 0000  000.010213. x...
 0001f8a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f8b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f8c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f8d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f8e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f8f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001f900: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
+0001f900: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
 0001f910: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001f920: 0000 0000 0000 0000 0064 6f63 6b65 7200  .........docker.
+0001f920: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f930: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f940: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f950: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f960: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f970: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f980: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f9a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f9b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f9c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f9d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f9e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f9f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001fa00: 696d 706f 7274 2070 616e 6461 7320 6173  import pandas as
-0001fa10: 2070 640a 696d 706f 7274 206e 756d 7079   pd.import numpy
-0001fa20: 2061 7320 6e70 0a66 726f 6d20 7374 6174   as np.from stat
-0001fa30: 736d 6f64 656c 732e 7374 6174 732e 6d75  smodels.stats.mu
-0001fa40: 6c74 6974 6573 7420 696d 706f 7274 2066  ltitest import f
-0001fa50: 6472 636f 7272 6563 7469 6f6e 0a66 726f  drcorrection.fro
-0001fa60: 6d20 7363 6970 7920 696d 706f 7274 2073  m scipy import s
-0001fa70: 7461 7473 0a0a 636c 6173 7320 5374 6174  tats..class Stat
-0001fa80: 6973 7469 6373 3a0a 2020 2020 2222 2220  istics:.    """ 
-0001fa90: 2222 220a 0a20 2020 2064 6566 2061 6e6f  """..    def ano
-0001faa0: 7661 2873 656c 6629 3a0a 2020 2020 2020  va(self):.      
-0001fab0: 2020 0a20 2020 2020 2020 2066 5f73 7461    .        f_sta
-0001fac0: 745f 6461 7461 203d 2070 642e 4461 7461  t_data = pd.Data
-0001fad0: 4672 616d 6528 290a 2020 2020 2020 2020  Frame().        
-0001fae0: 616e 6f76 615f 7076 5f64 6174 6120 3d20  anova_pv_data = 
-0001faf0: 7064 2e44 6174 6146 7261 6d65 2829 0a0a  pd.DataFrame()..
-0001fb00: 2020 2020 2020 2020 636f 6c75 6d6e 7320          columns 
-0001fb10: 3d20 7365 6c66 2e64 6174 612e 7365 6c65  = self.data.sele
-0001fb20: 6374 5f64 7479 7065 7328 2773 7472 696e  ct_dtypes('strin
-0001fb30: 6727 292e 636f 6c75 6d6e 730a 0a20 2020  g').columns..   
-0001fb40: 2020 2020 2073 616d 706c 6573 203d 205b       samples = [
-0001fb50: 7365 6c66 2e64 6174 615b 636f 6c5d 2066  self.data[col] f
-0001fb60: 6f72 2063 6f6c 2069 6e20 636f 6c75 6d6e  or col in column
-0001fb70: 735d 0a0a 2020 2020 2020 2020 665f 7374  s]..        f_st
-0001fb80: 6174 2c20 7076 616c 7565 7320 3d20 7374  at, pvalues = st
-0001fb90: 6174 732e 665f 6f6e 6577 6179 282a 7361  ats.f_oneway(*sa
-0001fba0: 6d70 6c65 732c 2061 7869 733d 3129 0a20  mples, axis=1). 
-0001fbb0: 2020 2020 2020 2066 5f73 7461 745f 6461         f_stat_da
-0001fbc0: 7461 5b27 665f 7374 6174 275d 203d 2066  ta['f_stat'] = f
-0001fbd0: 5f73 7461 740a 2020 2020 2020 2020 616e  _stat.        an
-0001fbe0: 6f76 615f 7076 5f64 6174 615b 2770 7661  ova_pv_data['pva
-0001fbf0: 6c75 6527 5d20 3d20 7076 616c 7565 730a  lue'] = pvalues.
-0001fc00: 0a20 2020 2020 2020 2073 656c 662e 665f  .        self.f_
-0001fc10: 7374 6174 5f64 6174 6120 3d20 665f 7374  stat_data = f_st
-0001fc20: 6174 5f64 6174 610a 2020 2020 2020 2020  at_data.        
-0001fc30: 7365 6c66 2e61 6e6f 7661 5f70 765f 6461  self.anova_pv_da
-0001fc40: 7461 203d 2061 6e6f 7661 5f70 765f 6461  ta = anova_pv_da
-0001fc50: 7461 0a0a 2020 2020 6465 6620 7374 7564  ta..    def stud
-0001fc60: 656e 745f 7474 6573 7428 7365 6c66 2c20  ent_ttest(self, 
-0001fc70: 636f 6d70 6172 6973 6f6e 732c 2072 6574  comparisons, ret
-0001fc80: 7572 6e5f 6f75 7470 7574 203d 4661 6c73  urn_output =Fals
-0001fc90: 6529 3a0a 2020 2020 0a20 2020 2020 2020  e):.    .       
-0001fca0: 2022 2222 556e 7061 6972 6564 2074 776f   """Unpaired two
-0001fcb0: 2074 6169 6c65 6420 7374 7564 656e 7427   tailed student'
-0001fcc0: 7320 742d 7465 7374 2077 6974 6820 4248  s t-test with BH
-0001fcd0: 2070 7661 6c75 6520 6164 6a75 7374 6d65   pvalue adjustme
-0001fce0: 6e74 2061 6e64 2066 6f6c 6420 6368 616e  nt and fold chan
-0001fcf0: 6765 2063 616c 6375 6c61 7469 6f6e 0a0a  ge calculation..
-0001fd00: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
-0001fd10: 7273 0a20 2020 2020 2020 202d 2d2d 2d2d  rs.        -----
-0001fd20: 2d2d 2d2d 2d0a 2020 2020 2020 2020 636f  -----.        co
-0001fd30: 6d70 6172 6973 6f6e 7320 3a20 6c69 7374  mparisons : list
-0001fd40: 0a20 2020 2020 2020 2020 2020 204c 6973  .            Lis
-0001fd50: 7420 6f66 2074 7570 6c65 7320 7769 7468  t of tuples with
-0001fd60: 2063 6f6d 7061 7269 736f 6e73 2074 6f20   comparisons to 
-0001fd70: 6265 206d 6164 652e 0a20 2020 2020 2020  be made..       
-0001fd80: 2072 6574 7572 6e5f 6f75 7470 7574 203a   return_output :
-0001fd90: 2062 6f6f 6c65 616e 0a20 2020 2020 2020   boolean.       
-0001fda0: 2020 2020 2020 4966 2054 7275 652c 2066        If True, f
-0001fdb0: 635f 6461 7461 2c20 7076 5f64 6174 6120  c_data, pv_data 
-0001fdc0: 616e 6420 7176 5f64 6174 6120 7769 6c6c  and qv_data will
-0001fdd0: 2062 6520 7265 7475 726e 6564 2e20 2844   be returned. (D
-0001fde0: 6566 6175 6c74 2076 616c 7565 203d 2046  efault value = F
-0001fdf0: 616c 7365 2920 200a 0a20 2020 2020 2020  alse)  ..       
-0001fe00: 2052 6574 7572 6e73 0a20 2020 2020 2020   Returns.       
-0001fe10: 202d 2d2d 2d2d 2d2d 0a20 2020 2020 2020   -------.       
-0001fe20: 2066 635f 6461 7461 203a 2070 616e 6461   fc_data : panda
-0001fe30: 732e 4461 7461 4672 616d 650a 2020 2020  s.DataFrame.    
-0001fe40: 2020 2020 2020 2020 466f 6c64 2063 6861          Fold cha
-0001fe50: 6e67 6520 6461 7461 2e0a 2020 2020 2020  nge data..      
-0001fe60: 2020 7076 5f64 6174 6120 3a20 7061 6e64    pv_data : pand
-0001fe70: 6173 2e44 6174 6146 7261 6d65 0a20 2020  as.DataFrame.   
-0001fe80: 2020 2020 2020 2020 202d 6c6f 6731 3020           -log10 
-0001fe90: 7076 616c 7565 2064 6174 612e 0a20 2020  pvalue data..   
-0001fea0: 2020 2020 2071 765f 6461 7461 203a 2070       qv_data : p
-0001feb0: 616e 6461 732e 4461 7461 4672 616d 650a  andas.DataFrame.
-0001fec0: 2020 2020 2020 2020 2020 2020 712d 7661              q-va
-0001fed0: 6c75 6520 6461 7461 2e20 4265 6e6a 616d  lue data. Benjam
-0001fee0: 696e 692d 486f 6368 6265 7267 2061 646a  ini-Hochberg adj
-0001fef0: 7573 7465 6420 7076 616c 7565 732e 0a20  usted pvalues.. 
-0001ff00: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-0001ff10: 2020 200a 2020 2020 2020 2020 2320 6372     .        # cr
-0001ff20: 6561 7465 2066 635f 6461 7461 2c20 7076  eate fc_data, pv
-0001ff30: 5f64 6174 612c 2071 765f 6461 7461 0a20  _data, qv_data. 
-0001ff40: 2020 2020 2020 2066 635f 6461 7461 203d         fc_data =
-0001ff50: 2070 642e 4461 7461 4672 616d 6528 290a   pd.DataFrame().
-0001ff60: 2020 2020 2020 2020 7076 5f64 6174 6120          pv_data 
-0001ff70: 3d20 7064 2e44 6174 6146 7261 6d65 2829  = pd.DataFrame()
-0001ff80: 0a20 2020 2020 2020 2071 765f 6461 7461  .        qv_data
-0001ff90: 203d 2070 642e 4461 7461 4672 616d 6528   = pd.DataFrame(
-0001ffa0: 290a 2020 2020 2020 2020 745f 7374 6174  ).        t_stat
-0001ffb0: 5f64 6174 6120 3d20 7064 2e44 6174 6146  _data = pd.DataF
-0001ffc0: 7261 6d65 2829 0a20 2020 2020 2020 2063  rame().        c
-0001ffd0: 695f 6461 7461 203d 2070 642e 4461 7461  i_data = pd.Data
-0001ffe0: 4672 616d 6528 290a 2020 2020 2020 2020  Frame().        
-0001fff0: 636f 6865 6e73 645f 6461 7461 203d 2070  cohensd_data = p
-00020000: 642e 4461 7461 4672 616d 6528 290a 0a20  d.DataFrame().. 
-00020010: 2020 2020 2020 2066 6f72 2061 2c20 6220         for a, b 
-00020020: 696e 2063 6f6d 7061 7269 736f 6e73 3a0a  in comparisons:.
-00020030: 2020 2020 2020 2020 2020 2020 0a20 2020              .   
-00020040: 2020 2020 2020 2020 2023 2054 2074 6573           # T tes
-00020050: 7420 666f 7220 6561 6368 2072 6f77 2070  t for each row p
-00020060: 6169 722e 0a20 2020 2020 2020 2020 2020  air..           
-00020070: 2074 5f73 7461 7473 2c20 7076 616c 7565   t_stats, pvalue
-00020080: 7320 3d20 7374 6174 732e 7474 6573 745f  s = stats.ttest_
-00020090: 696e 6428 613d 7365 6c66 2e64 6174 615b  ind(a=self.data[
-000200a0: 615d 2c20 623d 7365 6c66 2e64 6174 615b  a], b=self.data[
-000200b0: 625d 2c20 6178 6973 3d31 290a 0a20 2020  b], axis=1)..   
-000200c0: 2020 2020 2020 2020 2074 5f73 7461 745f           t_stat_
-000200d0: 6461 7461 5b66 277b 617d 2f7b 627d 275d  data[f'{a}/{b}']
-000200e0: 203d 2074 5f73 7461 7473 0a0a 2020 2020   = t_stats..    
-000200f0: 2020 2020 2020 2020 7076 5f64 6174 615b          pv_data[
-00020100: 6627 7b61 7d2f 7b62 7d27 5d20 3d20 2d20  f'{a}/{b}'] = - 
-00020110: 6e70 2e6c 6f67 3130 2870 7661 6c75 6573  np.log10(pvalues
-00020120: 290a 0a20 2020 2020 2020 2020 2020 2023  )..            #
-00020130: 204d 6561 6e20 6469 6666 6572 656e 6365   Mean difference
-00020140: 2066 6f72 2065 6163 6820 726f 772e 0a20   for each row.. 
-00020150: 2020 2020 2020 2020 2020 2066 635f 6461             fc_da
-00020160: 7461 5b66 277b 617d 2f7b 627d 275d 203d  ta[f'{a}/{b}'] =
-00020170: 2073 656c 662e 5f66 6f6c 645f 6368 616e   self._fold_chan
-00020180: 6765 2873 656c 662e 6461 7461 5b61 5d2c  ge(self.data[a],
-00020190: 2073 656c 662e 6461 7461 5b62 5d29 0a20   self.data[b]). 
-000201a0: 2020 2020 2020 2020 2020 200a 2020 2020             .    
-000201b0: 2020 2020 2020 2020 2320 3935 2520 636f          # 95% co
-000201c0: 6e66 6964 656e 6365 2069 6e74 6572 7661  nfidence interva
-000201d0: 6c20 666f 7220 6561 6368 2072 6f77 2e0a  l for each row..
-000201e0: 2020 2020 2020 2020 2020 2020 6369 5f64              ci_d
-000201f0: 6174 615b 6627 7b61 7d2f 7b62 7d27 5d20  ata[f'{a}/{b}'] 
-00020200: 3d20 7365 6c66 2e5f 7474 6573 745f 636f  = self._ttest_co
-00020210: 6e66 5f69 6e74 2873 656c 662e 6461 7461  nf_int(self.data
-00020220: 5b61 5d2c 2073 656c 662e 6461 7461 5b62  [a], self.data[b
-00020230: 5d29 0a0a 2020 2020 2020 2020 2020 2020  ])..            
-00020240: 2320 436f 6865 6e73 2064 2066 6f72 2065  # Cohens d for e
-00020250: 6163 6820 726f 772e 0a20 2020 2020 2020  ach row..       
-00020260: 2020 2020 2063 6f68 656e 7364 5f64 6174       cohensd_dat
-00020270: 615b 6627 7b61 7d2f 7b62 7d27 5d20 3d20  a[f'{a}/{b}'] = 
-00020280: 7365 6c66 2e5f 636f 6865 6e73 6428 7365  self._cohensd(se
-00020290: 6c66 2e64 6174 615b 615d 2c20 7365 6c66  lf.data[a], self
-000202a0: 2e64 6174 615b 625d 290a 0a20 2020 2020  .data[b])..     
-000202b0: 2020 2020 2020 2023 2062 6820 6164 6a75         # bh adju
-000202c0: 7374 6564 2070 7661 6c75 6520 0a20 2020  sted pvalue .   
-000202d0: 2020 2020 2020 2020 2071 765f 6461 7461           qv_data
-000202e0: 5b66 277b 617d 2f7b 627d 275d 203d 2066  [f'{a}/{b}'] = f
-000202f0: 6472 636f 7272 6563 7469 6f6e 2870 7661  drcorrection(pva
-00020300: 6c75 6573 295b 315d 0a0a 2020 2020 2020  lues)[1]..      
-00020310: 2020 7365 6c66 2e66 635f 6461 7461 203d    self.fc_data =
-00020320: 2073 656c 662e 6461 7461 2e73 656c 6563   self.data.selec
-00020330: 745f 6474 7970 6573 2827 7374 7269 6e67  t_dtypes('string
-00020340: 2729 2e6d 6572 6765 2866 635f 6461 7461  ').merge(fc_data
-00020350: 2c20 6c65 6674 5f69 6e64 6578 203d 2054  , left_index = T
-00020360: 7275 652c 2072 6967 6874 5f69 6e64 6578  rue, right_index
-00020370: 203d 2054 7275 6529 0a20 2020 2020 2020   = True).       
-00020380: 2073 656c 662e 7076 5f64 6174 6120 3d20   self.pv_data = 
-00020390: 7365 6c66 2e64 6174 612e 7365 6c65 6374  self.data.select
-000203a0: 5f64 7479 7065 7328 2773 7472 696e 6727  _dtypes('string'
-000203b0: 292e 6d65 7267 6528 7076 5f64 6174 612c  ).merge(pv_data,
-000203c0: 206c 6566 745f 696e 6465 7820 3d20 5472   left_index = Tr
-000203d0: 7565 2c20 7269 6768 745f 696e 6465 7820  ue, right_index 
-000203e0: 3d20 5472 7565 290a 2020 2020 2020 2020  = True).        
-000203f0: 7365 6c66 2e71 765f 6461 7461 203d 2073  self.qv_data = s
-00020400: 656c 662e 6461 7461 2e73 656c 6563 745f  elf.data.select_
-00020410: 6474 7970 6573 2827 7374 7269 6e67 2729  dtypes('string')
-00020420: 2e6d 6572 6765 2871 765f 6461 7461 2c20  .merge(qv_data, 
-00020430: 6c65 6674 5f69 6e64 6578 203d 2054 7275  left_index = Tru
-00020440: 652c 2072 6967 6874 5f69 6e64 6578 203d  e, right_index =
-00020450: 2054 7275 6529 0a20 2020 2020 2020 2073   True).        s
-00020460: 656c 662e 745f 7374 6174 5f64 6174 6120  elf.t_stat_data 
-00020470: 3d20 7365 6c66 2e64 6174 612e 7365 6c65  = self.data.sele
-00020480: 6374 5f64 7479 7065 7328 2773 7472 696e  ct_dtypes('strin
-00020490: 6727 292e 6d65 7267 6528 745f 7374 6174  g').merge(t_stat
-000204a0: 5f64 6174 612c 206c 6566 745f 696e 6465  _data, left_inde
-000204b0: 7820 3d20 5472 7565 2c20 7269 6768 745f  x = True, right_
-000204c0: 696e 6465 7820 3d20 5472 7565 290a 2020  index = True).  
-000204d0: 2020 2020 2020 7365 6c66 2e63 695f 6461        self.ci_da
-000204e0: 7461 203d 2073 656c 662e 6461 7461 2e73  ta = self.data.s
-000204f0: 656c 6563 745f 6474 7970 6573 2827 7374  elect_dtypes('st
-00020500: 7269 6e67 2729 2e6d 6572 6765 2863 695f  ring').merge(ci_
-00020510: 6461 7461 2c20 6c65 6674 5f69 6e64 6578  data, left_index
-00020520: 203d 2054 7275 652c 2072 6967 6874 5f69   = True, right_i
-00020530: 6e64 6578 203d 2054 7275 6529 0a20 2020  ndex = True).   
-00020540: 2020 2020 2073 656c 662e 636f 6865 6e73       self.cohens
-00020550: 645f 6461 7461 203d 2073 656c 662e 6461  d_data = self.da
-00020560: 7461 2e73 656c 6563 745f 6474 7970 6573  ta.select_dtypes
-00020570: 2827 7374 7269 6e67 2729 2e6d 6572 6765  ('string').merge
-00020580: 2863 6f68 656e 7364 5f64 6174 612c 206c  (cohensd_data, l
-00020590: 6566 745f 696e 6465 7820 3d20 5472 7565  eft_index = True
-000205a0: 2c20 7269 6768 745f 696e 6465 7820 3d20  , right_index = 
-000205b0: 5472 7565 290a 0a20 2020 2020 2020 2069  True)..        i
-000205c0: 6620 7265 7475 726e 5f6f 7574 7075 7420  f return_output 
-000205d0: 3d3d 2054 7275 653a 0a20 2020 2020 2020  == True:.       
-000205e0: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-000205f0: 2e66 635f 6461 7461 2c20 7365 6c66 2e70  .fc_data, self.p
-00020600: 765f 6461 7461 2c20 7365 6c66 2e71 765f  v_data, self.qv_
-00020610: 6461 7461 2c20 7365 6c66 2e74 5f73 7461  data, self.t_sta
-00020620: 745f 6461 7461 2c20 7365 6c66 2e63 695f  t_data, self.ci_
-00020630: 6461 7461 2c20 7365 6c66 2e63 6f68 656e  data, self.cohen
-00020640: 7364 5f64 6174 610a 2020 2020 0a20 2020  sd_data.    .   
-00020650: 2064 6566 205f 7474 6573 745f 636f 6e66   def _ttest_conf
-00020660: 5f69 6e74 2873 656c 662c 2061 2c20 622c  _int(self, a, b,
-00020670: 2063 6f6e 665f 696e 743d 302e 3935 293a   conf_int=0.95):
-00020680: 0a0a 2020 2020 2020 2020 7364 5f61 203d  ..        sd_a =
-00020690: 206e 702e 7374 6428 612c 2064 646f 663d   np.std(a, ddof=
-000206a0: 312c 2061 7869 733d 3129 0a20 2020 2020  1, axis=1).     
-000206b0: 2020 2073 645f 6220 3d20 6e70 2e73 7464     sd_b = np.std
-000206c0: 2862 2c20 6464 6f66 3d31 2c20 6178 6973  (b, ddof=1, axis
-000206d0: 3d31 290a 0a20 2020 2020 2020 206e 5f61  =1)..        n_a
-000206e0: 203d 2061 2e73 6861 7065 5b31 5d0a 2020   = a.shape[1].  
-000206f0: 2020 2020 2020 6e5f 6220 3d20 622e 7368        n_b = b.sh
-00020700: 6170 655b 315d 0a20 2020 2020 2020 2064  ape[1].        d
-00020710: 6620 3d20 6e5f 6120 2b20 6e5f 6220 2d20  f = n_a + n_b - 
-00020720: 320a 2020 2020 2020 2020 735f 706f 6f6c  2.        s_pool
-00020730: 6564 203d 206e 702e 7371 7274 2828 286e  ed = np.sqrt(((n
-00020740: 5f61 2d31 292a 7364 5f61 2a2a 3220 2b20  _a-1)*sd_a**2 + 
-00020750: 286e 5f62 2d31 292a 7364 5f62 2a2a 3229  (n_b-1)*sd_b**2)
-00020760: 202f 2064 6629 0a0a 2020 2020 2020 2020   / df)..        
-00020770: 7065 7263 656e 7469 6c65 203d 2028 3120  percentile = (1 
-00020780: 2b20 636f 6e66 5f69 6e74 292f 320a 2020  + conf_int)/2.  
-00020790: 2020 2020 2020 745f 6372 6974 203d 2073        t_crit = s
-000207a0: 7461 7473 2e74 2e70 7066 2870 6572 6365  tats.t.ppf(perce
-000207b0: 6e74 696c 652c 2064 6629 0a20 2020 2020  ntile, df).     
-000207c0: 2020 206c 6f77 6572 203d 2073 656c 662e     lower = self.
-000207d0: 5f66 6f6c 645f 6368 616e 6765 2861 2c20  _fold_change(a, 
-000207e0: 6229 202d 2074 5f63 7269 7420 2a20 735f  b) - t_crit * s_
-000207f0: 706f 6f6c 6564 0a20 2020 2020 2020 2075  pooled.        u
-00020800: 7070 6572 203d 2073 656c 662e 5f66 6f6c  pper = self._fol
-00020810: 645f 6368 616e 6765 2861 2c20 6229 202b  d_change(a, b) +
-00020820: 2074 5f63 7269 7420 2a20 735f 706f 6f6c   t_crit * s_pool
-00020830: 6564 0a0a 2020 2020 2020 2020 2320 436f  ed..        # Co
-00020840: 6d62 696e 6520 6c6f 7765 7220 7769 7468  mbine lower with
-00020850: 2075 7070 6572 0a20 2020 2020 2020 2063   upper.        c
-00020860: 6f6e 665f 696e 7465 7276 616c 7320 3d20  onf_intervals = 
-00020870: 6c69 7374 287a 6970 286c 6f77 6572 2c20  list(zip(lower, 
-00020880: 7570 7065 7229 290a 2020 2020 2020 2020  upper)).        
-00020890: 7265 7475 726e 2063 6f6e 665f 696e 7465  return conf_inte
-000208a0: 7276 616c 730a 0a20 2020 2064 6566 205f  rvals..    def _
-000208b0: 666f 6c64 5f63 6861 6e67 6528 7365 6c66  fold_change(self
-000208c0: 2c20 612c 2062 293a 0a0a 2020 2020 2020  , a, b):..      
-000208d0: 2020 666f 6c64 5f63 6861 6e67 6520 3d20    fold_change = 
-000208e0: 6e70 2e6d 6561 6e28 612c 2061 7869 733d  np.mean(a, axis=
-000208f0: 3129 202d 206e 702e 6d65 616e 2862 2c20  1) - np.mean(b, 
-00020900: 6178 6973 3d31 290a 2020 2020 2020 2020  axis=1).        
-00020910: 7265 7475 726e 2066 6f6c 645f 6368 616e  return fold_chan
-00020920: 6765 0a20 2020 200a 2020 2020 6465 6620  ge.    .    def 
-00020930: 5f63 6f68 656e 7364 2873 656c 662c 2061  _cohensd(self, a
-00020940: 2c20 6229 3a0a 0a20 2020 2020 2020 206e  , b):..        n
-00020950: 312c 206e 3220 3d20 612e 7368 6170 655b  1, n2 = a.shape[
-00020960: 315d 2c20 622e 7368 6170 655b 315d 0a20  1], b.shape[1]. 
-00020970: 2020 2020 2020 2073 312c 2073 3220 3d20         s1, s2 = 
-00020980: 6e70 2e73 7464 2861 2c20 6464 6f66 3d31  np.std(a, ddof=1
-00020990: 2c20 6178 6973 3d31 292c 206e 702e 7374  , axis=1), np.st
-000209a0: 6428 622c 2064 646f 663d 312c 2061 7869  d(b, ddof=1, axi
-000209b0: 733d 3129 0a20 2020 2020 2020 2073 5f70  s=1).        s_p
-000209c0: 6f6f 6c65 6420 3d20 6e70 2e73 7172 7428  ooled = np.sqrt(
-000209d0: 2828 6e31 2d31 292a 7331 202b 2028 6e32  ((n1-1)*s1 + (n2
-000209e0: 2d31 292a 7332 2920 2f20 286e 3120 2b20  -1)*s2) / (n1 + 
-000209f0: 6e32 202d 2032 2929 0a0a 2020 2020 2020  n2 - 2))..      
-00020a00: 2020 7265 7475 726e 2028 7365 6c66 2e5f    return (self._
-00020a10: 666f 6c64 5f63 6861 6e67 6528 612c 2062  fold_change(a, b
-00020a20: 2929 202f 2073 5f70 6f6f 6c65 640a 2020  )) / s_pooled.  
-00020a30: 2020 0a20 2020 2064 6566 2067 6574 5f75    .    def get_u
-00020a40: 6e69 7175 655f 636f 6d62 2873 656c 662c  nique_comb(self,
-00020a50: 2061 2c20 6229 3a0a 0a20 2020 2020 2020   a, b):..       
-00020a60: 2022 2222 0a20 2020 2020 2020 2047 6574   """.        Get
-00020a70: 2075 6e69 7175 6520 636f 6d62 696e 6174   unique combinat
-00020a80: 696f 6e73 2062 6574 7765 656e 2061 7272  ions between arr
-00020a90: 6179 2061 2061 6e64 2062 0a0a 2020 2020  ay a and b..    
-00020aa0: 2020 2020 5061 7261 6d65 7465 7273 0a20      Parameters. 
-00020ab0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
-00020ac0: 2d0a 2020 2020 2020 2020 6120 3a20 6c69  -.        a : li
-00020ad0: 7374 0a20 2020 2020 2020 2020 2020 2061  st.            a
-00020ae0: 206c 6973 7420 6f66 2073 7472 696e 6773   list of strings
-00020af0: 2020 2020 200a 2020 2020 2020 2020 6220       .        b 
-00020b00: 3a20 6c69 7374 0a20 2020 2020 2020 2020  : list.         
-00020b10: 2020 2061 206c 6973 7420 6f66 2073 7472     a list of str
-00020b20: 696e 6773 0a0a 2020 2020 2020 2020 5265  ings..        Re
-00020b30: 7475 726e 730a 2020 2020 2020 2020 2d2d  turns.        --
-00020b40: 2d2d 2d2d 2d0a 2020 2020 2020 2020 636f  -----.        co
-00020b50: 6d70 6172 6973 6f6e 7320 3a20 6c69 7374  mparisons : list
-00020b60: 0a20 2020 2020 2020 2020 2020 2061 206c  .            a l
-00020b70: 6973 7420 6f66 2074 7570 6c65 7320 7769  ist of tuples wi
-00020b80: 7468 2075 6e69 7175 6520 636f 6d62 696e  th unique combin
-00020b90: 6174 696f 6e73 2062 6574 7765 656e 2061  ations between a
-00020ba0: 2061 6e64 2062 2e0a 2020 2020 2020 2020   and b..        
-00020bb0: 2222 220a 0a20 2020 2020 2020 2063 6f6d  """..        com
-00020bc0: 7061 7269 736f 6e73 203d 205b 5d0a 2020  parisons = [].  
-00020bd0: 2020 2020 2020 666f 7220 636f 6d70 3120        for comp1 
-00020be0: 696e 2061 3a0a 2020 2020 2020 2020 2020  in a:.          
-00020bf0: 2020 666f 7220 636f 6d70 3220 696e 2062    for comp2 in b
-00020c00: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00020c10: 2020 636f 6d70 6172 6973 6f6e 732e 6170    comparisons.ap
-00020c20: 7065 6e64 2828 636f 6d70 312c 2063 6f6d  pend((comp1, com
-00020c30: 7032 2929 0a0a 2020 2020 2020 2020 7265  p2))..        re
-00020c40: 7475 726e 2063 6f6d 7061 7269 736f 6e73  turn comparisons
-00020c50: 0a0a 2020 2020 6465 6620 6765 745f 7375  ..    def get_su
-00020c60: 6d6d 6172 795f 6461 7461 2873 656c 662c  mmary_data(self,
-00020c70: 2073 756d 6d61 7279 3d27 6d65 616e 2729   summary='mean')
-00020c80: 3a0a 0a20 2020 2020 2020 2022 2222 0a20  :..        """. 
-00020c90: 2020 2020 2020 2043 7265 6174 6520 6120         Create a 
-00020ca0: 7375 6d6d 6172 7920 6461 7461 6672 616d  summary datafram
-00020cb0: 6520 7769 7468 206d 6561 6e20 6f72 206d  e with mean or m
-00020cc0: 6564 6961 6e20 7661 6c75 6573 2066 6f72  edian values for
-00020cd0: 2065 6163 6820 7361 6d70 6c65 7479 7065   each sampletype
-00020ce0: 0a0a 2020 2020 2020 2020 5061 7261 6d65  ..        Parame
-00020cf0: 7465 7273 0a20 2020 2020 2020 202d 2d2d  ters.        ---
-00020d00: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-00020d10: 7375 6d6d 6172 7920 3a20 7374 720a 2020  summary : str.  
-00020d20: 2020 2020 2020 2020 2020 2043 616c 6375             Calcu
-00020d30: 6c61 7465 2074 6865 2027 6d65 616e 2720  late the 'mean' 
-00020d40: 6f72 2027 6d65 6469 616e 2720 2844 6566  or 'median' (Def
-00020d50: 6175 6c74 2076 616c 7565 203d 2027 6d65  ault value = 'me
-00020d60: 616e 2729 2e0a 0a20 2020 2020 2020 2052  an')...        R
-00020d70: 6574 7572 6e73 0a20 2020 2020 2020 202d  eturns.        -
-00020d80: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2073  ------.        s
-00020d90: 756d 6d61 7279 5f64 6174 6120 3a20 7061  ummary_data : pa
-00020da0: 6e64 6173 2e44 6174 6146 7261 6d65 0a20  ndas.DataFrame. 
-00020db0: 2020 2020 2020 2020 2020 2041 2073 756d             A sum
-00020dc0: 6d61 7279 2064 6174 6166 7261 6d65 2077  mary dataframe w
-00020dd0: 6974 6820 6d65 616e 206f 7220 6d65 6469  ith mean or medi
-00020de0: 616e 2076 616c 7565 7320 666f 7220 6561  an values for ea
-00020df0: 6368 2073 616d 706c 6574 7970 652e 0a20  ch sampletype.. 
-00020e00: 2020 2020 2020 2022 2222 0a0a 2020 2020         """..    
-00020e10: 2020 2020 7374 7269 6e67 5f64 6174 6120      string_data 
-00020e20: 3d20 7365 6c66 2e64 6174 612e 7365 6c65  = self.data.sele
-00020e30: 6374 5f64 7479 7065 7328 2773 7472 696e  ct_dtypes('strin
-00020e40: 6727 290a 0a20 2020 2020 2020 2069 6620  g')..        if 
-00020e50: 7375 6d6d 6172 7920 3d3d 2027 6d65 616e  summary == 'mean
-00020e60: 273a 0a20 2020 2020 2020 2020 2020 2066  ':.            f
-00020e70: 6c6f 6174 5f64 6174 6120 3d20 7365 6c66  loat_data = self
-00020e80: 2e64 6174 612e 7365 6c65 6374 5f64 7479  .data.select_dty
-00020e90: 7065 7328 2766 6c6f 6174 2729 2e54 2e72  pes('float').T.r
-00020ea0: 6573 6574 5f69 6e64 6578 286e 616d 6573  eset_index(names
-00020eb0: 3d27 7361 6d70 6c65 2729 2e67 726f 7570  ='sample').group
-00020ec0: 6279 2827 7361 6d70 6c65 2729 2e6d 6561  by('sample').mea
-00020ed0: 6e28 292e 540a 2020 2020 2020 2020 0a20  n().T.        . 
-00020ee0: 2020 2020 2020 2065 6c69 6620 7375 6d6d         elif summ
-00020ef0: 6172 7920 3d3d 2027 6d65 6469 616e 273a  ary == 'median':
-00020f00: 0a20 2020 2020 2020 2020 2020 2066 6c6f  .            flo
-00020f10: 6174 5f64 6174 6120 3d20 7365 6c66 2e64  at_data = self.d
-00020f20: 6174 612e 7365 6c65 6374 5f64 7479 7065  ata.select_dtype
-00020f30: 7328 2766 6c6f 6174 2729 2e54 2e72 6573  s('float').T.res
-00020f40: 6574 5f69 6e64 6578 286e 616d 6573 3d27  et_index(names='
-00020f50: 7361 6d70 6c65 2729 2e67 726f 7570 6279  sample').groupby
-00020f60: 2827 7361 6d70 6c65 2729 2e6d 6564 6961  ('sample').media
-00020f70: 6e28 292e 5420 0a20 2020 2020 2020 200a  n().T .        .
-00020f80: 2020 2020 2020 2020 7375 6d6d 6172 795f          summary_
-00020f90: 6461 7461 203d 2070 642e 636f 6e63 6174  data = pd.concat
-00020fa0: 285b 7374 7269 6e67 5f64 6174 612c 2066  ([string_data, f
-00020fb0: 6c6f 6174 5f64 6174 615d 2c20 6178 6973  loat_data], axis
-00020fc0: 3d31 290a 0a20 2020 2020 2020 2073 656c  =1)..        sel
-00020fd0: 662e 7375 6d6d 6172 795f 6461 7461 203d  f.summary_data =
-00020fe0: 2073 756d 6d61 7279 5f64 6174 612e 636f   summary_data.co
-00020ff0: 7079 2829 0000 0000 0000 0000 0000 0000  py()............
-00021000: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-00021010: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021020: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021060: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-00021070: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00021080: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
-00021090: 3030 3000 3031 3032 3133 0020 7800 0000  000.010213. x...
-000210a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000210b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000210c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000210d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000210e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000210f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021100: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-00021110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021120: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021140: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021150: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000211a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000211b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000211c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000211d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000211e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000211f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021200: 3232 206d 7469 6d65 3d31 3638 3834 3937  22 mtime=1688497
-00021210: 3330 392e 300a 0000 0000 0000 0000 0000  309.0...........
-00021220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021260: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021270: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021280: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021290: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000212a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000212b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000212c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000212d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000212e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000212f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021300: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021320: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021340: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021350: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000213a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000213b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000213c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000213d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000213e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000213f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021400: 7072 6f74 656f 6d69 6373 5f64 6f77 6e73  proteomics_downs
-00021410: 7472 6561 6d5f 616e 616c 7973 6973 2d30  tream_analysis-0
-00021420: 2e31 2e32 2f70 726f 7465 6f6d 6963 735f  .1.2/proteomics_
-00021430: 646f 776e 7374 7265 616d 5f61 6e61 6c79  downstream_analy
-00021440: 7369 732f 7574 696c 732e 7079 0000 0000  sis/utils.py....
+0001fa00: 3232 206d 7469 6d65 3d31 3638 3835 3732  22 mtime=1688572
+0001fa10: 3039 322e 300a 0000 0000 0000 0000 0000  092.0...........
+0001fa20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fa30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fa40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fa50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fa60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fa70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fa80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fa90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001faa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001faf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fb00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fb10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fb20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fb30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fb40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fb50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fb60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fb70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fb80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fb90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fbb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fbc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fbd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fbe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fbf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fc00: 7072 6f74 656f 6d69 6373 5f64 6f77 6e73  proteomics_downs
+0001fc10: 7472 6561 6d5f 616e 616c 7973 6973 2d30  tream_analysis-0
+0001fc20: 2e31 2e33 2f70 726f 7465 6f6d 6963 735f  .1.3/proteomics_
+0001fc30: 646f 776e 7374 7265 616d 5f61 6e61 6c79  downstream_analy
+0001fc40: 7369 732f 7374 6174 6973 7469 6373 2e70  sis/statistics.p
+0001fc50: 7900 0000 0000 0000 0000 0000 0000 0000  y...............
+0001fc60: 0000 0000 3030 3030 3634 3400 3030 3031  ....0000644.0001
+0001fc70: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
+0001fc80: 3030 3132 3736 3400 3134 3435 3133 3130  0012764.14451310
+0001fc90: 3237 3400 3033 3035 3537 0020 3000 0000  274.030557. 0...
+0001fca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fcb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fcc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fcd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fcf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fd00: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
+0001fd10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fd20: 0000 0000 0000 0000 0064 6f63 6b65 7200  .........docker.
+0001fd30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fd40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fd50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fd60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fd70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fd80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fd90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fda0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fdb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fdc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fdd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fde0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fdf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fe00: 696d 706f 7274 2070 616e 6461 7320 6173  import pandas as
+0001fe10: 2070 640a 696d 706f 7274 206e 756d 7079   pd.import numpy
+0001fe20: 2061 7320 6e70 0a66 726f 6d20 7374 6174   as np.from stat
+0001fe30: 736d 6f64 656c 732e 7374 6174 732e 6d75  smodels.stats.mu
+0001fe40: 6c74 6974 6573 7420 696d 706f 7274 2066  ltitest import f
+0001fe50: 6472 636f 7272 6563 7469 6f6e 0a66 726f  drcorrection.fro
+0001fe60: 6d20 7363 6970 7920 696d 706f 7274 2073  m scipy import s
+0001fe70: 7461 7473 0a0a 636c 6173 7320 5374 6174  tats..class Stat
+0001fe80: 6973 7469 6373 3a0a 2020 2020 2222 2220  istics:.    """ 
+0001fe90: 2222 220a 0a20 2020 2064 6566 2061 6e6f  """..    def ano
+0001fea0: 7661 2873 656c 6629 3a0a 2020 2020 2020  va(self):.      
+0001feb0: 2020 0a20 2020 2020 2020 2066 5f73 7461    .        f_sta
+0001fec0: 745f 6461 7461 203d 2070 642e 4461 7461  t_data = pd.Data
+0001fed0: 4672 616d 6528 290a 2020 2020 2020 2020  Frame().        
+0001fee0: 616e 6f76 615f 7076 5f64 6174 6120 3d20  anova_pv_data = 
+0001fef0: 7064 2e44 6174 6146 7261 6d65 2829 0a0a  pd.DataFrame()..
+0001ff00: 2020 2020 2020 2020 636f 6c75 6d6e 7320          columns 
+0001ff10: 3d20 7365 6c66 2e64 6174 612e 7365 6c65  = self.data.sele
+0001ff20: 6374 5f64 7479 7065 7328 2773 7472 696e  ct_dtypes('strin
+0001ff30: 6727 292e 636f 6c75 6d6e 730a 0a20 2020  g').columns..   
+0001ff40: 2020 2020 2073 616d 706c 6573 203d 205b       samples = [
+0001ff50: 7365 6c66 2e64 6174 615b 636f 6c5d 2066  self.data[col] f
+0001ff60: 6f72 2063 6f6c 2069 6e20 636f 6c75 6d6e  or col in column
+0001ff70: 735d 0a0a 2020 2020 2020 2020 665f 7374  s]..        f_st
+0001ff80: 6174 2c20 7076 616c 7565 7320 3d20 7374  at, pvalues = st
+0001ff90: 6174 732e 665f 6f6e 6577 6179 282a 7361  ats.f_oneway(*sa
+0001ffa0: 6d70 6c65 732c 2061 7869 733d 3129 0a20  mples, axis=1). 
+0001ffb0: 2020 2020 2020 2066 5f73 7461 745f 6461         f_stat_da
+0001ffc0: 7461 5b27 665f 7374 6174 275d 203d 2066  ta['f_stat'] = f
+0001ffd0: 5f73 7461 740a 2020 2020 2020 2020 616e  _stat.        an
+0001ffe0: 6f76 615f 7076 5f64 6174 615b 2770 7661  ova_pv_data['pva
+0001fff0: 6c75 6527 5d20 3d20 7076 616c 7565 730a  lue'] = pvalues.
+00020000: 0a20 2020 2020 2020 2073 656c 662e 665f  .        self.f_
+00020010: 7374 6174 5f64 6174 6120 3d20 665f 7374  stat_data = f_st
+00020020: 6174 5f64 6174 610a 2020 2020 2020 2020  at_data.        
+00020030: 7365 6c66 2e61 6e6f 7661 5f70 765f 6461  self.anova_pv_da
+00020040: 7461 203d 2061 6e6f 7661 5f70 765f 6461  ta = anova_pv_da
+00020050: 7461 0a0a 2020 2020 6465 6620 7374 7564  ta..    def stud
+00020060: 656e 745f 7474 6573 7428 7365 6c66 2c20  ent_ttest(self, 
+00020070: 636f 6d70 6172 6973 6f6e 732c 2072 6574  comparisons, ret
+00020080: 7572 6e5f 6f75 7470 7574 203d 4661 6c73  urn_output =Fals
+00020090: 6529 3a0a 2020 2020 0a20 2020 2020 2020  e):.    .       
+000200a0: 2022 2222 556e 7061 6972 6564 2074 776f   """Unpaired two
+000200b0: 2074 6169 6c65 6420 7374 7564 656e 7427   tailed student'
+000200c0: 7320 742d 7465 7374 2077 6974 6820 4248  s t-test with BH
+000200d0: 2070 7661 6c75 6520 6164 6a75 7374 6d65   pvalue adjustme
+000200e0: 6e74 2061 6e64 2066 6f6c 6420 6368 616e  nt and fold chan
+000200f0: 6765 2063 616c 6375 6c61 7469 6f6e 0a0a  ge calculation..
+00020100: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
+00020110: 7273 0a20 2020 2020 2020 202d 2d2d 2d2d  rs.        -----
+00020120: 2d2d 2d2d 2d0a 2020 2020 2020 2020 636f  -----.        co
+00020130: 6d70 6172 6973 6f6e 7320 3a20 6c69 7374  mparisons : list
+00020140: 0a20 2020 2020 2020 2020 2020 204c 6973  .            Lis
+00020150: 7420 6f66 2074 7570 6c65 7320 7769 7468  t of tuples with
+00020160: 2063 6f6d 7061 7269 736f 6e73 2074 6f20   comparisons to 
+00020170: 6265 206d 6164 652e 0a20 2020 2020 2020  be made..       
+00020180: 2072 6574 7572 6e5f 6f75 7470 7574 203a   return_output :
+00020190: 2062 6f6f 6c65 616e 0a20 2020 2020 2020   boolean.       
+000201a0: 2020 2020 2020 4966 2054 7275 652c 2066        If True, f
+000201b0: 635f 6461 7461 2c20 7076 5f64 6174 6120  c_data, pv_data 
+000201c0: 616e 6420 7176 5f64 6174 6120 7769 6c6c  and qv_data will
+000201d0: 2062 6520 7265 7475 726e 6564 2e20 2844   be returned. (D
+000201e0: 6566 6175 6c74 2076 616c 7565 203d 2046  efault value = F
+000201f0: 616c 7365 2920 200a 0a20 2020 2020 2020  alse)  ..       
+00020200: 2052 6574 7572 6e73 0a20 2020 2020 2020   Returns.       
+00020210: 202d 2d2d 2d2d 2d2d 0a20 2020 2020 2020   -------.       
+00020220: 2066 635f 6461 7461 203a 2070 616e 6461   fc_data : panda
+00020230: 732e 4461 7461 4672 616d 650a 2020 2020  s.DataFrame.    
+00020240: 2020 2020 2020 2020 466f 6c64 2063 6861          Fold cha
+00020250: 6e67 6520 6461 7461 2e0a 2020 2020 2020  nge data..      
+00020260: 2020 7076 5f64 6174 6120 3a20 7061 6e64    pv_data : pand
+00020270: 6173 2e44 6174 6146 7261 6d65 0a20 2020  as.DataFrame.   
+00020280: 2020 2020 2020 2020 202d 6c6f 6731 3020           -log10 
+00020290: 7076 616c 7565 2064 6174 612e 0a20 2020  pvalue data..   
+000202a0: 2020 2020 2071 765f 6461 7461 203a 2070       qv_data : p
+000202b0: 616e 6461 732e 4461 7461 4672 616d 650a  andas.DataFrame.
+000202c0: 2020 2020 2020 2020 2020 2020 712d 7661              q-va
+000202d0: 6c75 6520 6461 7461 2e20 4265 6e6a 616d  lue data. Benjam
+000202e0: 696e 692d 486f 6368 6265 7267 2061 646a  ini-Hochberg adj
+000202f0: 7573 7465 6420 7076 616c 7565 732e 0a20  usted pvalues.. 
+00020300: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+00020310: 2020 200a 2020 2020 2020 2020 2320 6372     .        # cr
+00020320: 6561 7465 2066 635f 6461 7461 2c20 7076  eate fc_data, pv
+00020330: 5f64 6174 612c 2071 765f 6461 7461 0a20  _data, qv_data. 
+00020340: 2020 2020 2020 2066 635f 6461 7461 203d         fc_data =
+00020350: 2070 642e 4461 7461 4672 616d 6528 290a   pd.DataFrame().
+00020360: 2020 2020 2020 2020 7076 5f64 6174 6120          pv_data 
+00020370: 3d20 7064 2e44 6174 6146 7261 6d65 2829  = pd.DataFrame()
+00020380: 0a20 2020 2020 2020 2071 765f 6461 7461  .        qv_data
+00020390: 203d 2070 642e 4461 7461 4672 616d 6528   = pd.DataFrame(
+000203a0: 290a 2020 2020 2020 2020 745f 7374 6174  ).        t_stat
+000203b0: 5f64 6174 6120 3d20 7064 2e44 6174 6146  _data = pd.DataF
+000203c0: 7261 6d65 2829 0a20 2020 2020 2020 2063  rame().        c
+000203d0: 695f 6461 7461 203d 2070 642e 4461 7461  i_data = pd.Data
+000203e0: 4672 616d 6528 290a 2020 2020 2020 2020  Frame().        
+000203f0: 636f 6865 6e73 645f 6461 7461 203d 2070  cohensd_data = p
+00020400: 642e 4461 7461 4672 616d 6528 290a 0a20  d.DataFrame().. 
+00020410: 2020 2020 2020 2066 6f72 2061 2c20 6220         for a, b 
+00020420: 696e 2063 6f6d 7061 7269 736f 6e73 3a0a  in comparisons:.
+00020430: 2020 2020 2020 2020 2020 2020 0a20 2020              .   
+00020440: 2020 2020 2020 2020 2023 2054 2074 6573           # T tes
+00020450: 7420 666f 7220 6561 6368 2072 6f77 2070  t for each row p
+00020460: 6169 722e 0a20 2020 2020 2020 2020 2020  air..           
+00020470: 2074 5f73 7461 7473 2c20 7076 616c 7565   t_stats, pvalue
+00020480: 7320 3d20 7374 6174 732e 7474 6573 745f  s = stats.ttest_
+00020490: 696e 6428 613d 7365 6c66 2e64 6174 615b  ind(a=self.data[
+000204a0: 615d 2c20 623d 7365 6c66 2e64 6174 615b  a], b=self.data[
+000204b0: 625d 2c20 6178 6973 3d31 290a 0a20 2020  b], axis=1)..   
+000204c0: 2020 2020 2020 2020 2074 5f73 7461 745f           t_stat_
+000204d0: 6461 7461 5b66 277b 617d 2f7b 627d 275d  data[f'{a}/{b}']
+000204e0: 203d 2074 5f73 7461 7473 0a0a 2020 2020   = t_stats..    
+000204f0: 2020 2020 2020 2020 7076 5f64 6174 615b          pv_data[
+00020500: 6627 7b61 7d2f 7b62 7d27 5d20 3d20 2d20  f'{a}/{b}'] = - 
+00020510: 6e70 2e6c 6f67 3130 2870 7661 6c75 6573  np.log10(pvalues
+00020520: 290a 0a20 2020 2020 2020 2020 2020 2023  )..            #
+00020530: 204d 6561 6e20 6469 6666 6572 656e 6365   Mean difference
+00020540: 2066 6f72 2065 6163 6820 726f 772e 0a20   for each row.. 
+00020550: 2020 2020 2020 2020 2020 2066 635f 6461             fc_da
+00020560: 7461 5b66 277b 617d 2f7b 627d 275d 203d  ta[f'{a}/{b}'] =
+00020570: 2073 656c 662e 5f66 6f6c 645f 6368 616e   self._fold_chan
+00020580: 6765 2873 656c 662e 6461 7461 5b61 5d2c  ge(self.data[a],
+00020590: 2073 656c 662e 6461 7461 5b62 5d29 0a20   self.data[b]). 
+000205a0: 2020 2020 2020 2020 2020 200a 2020 2020             .    
+000205b0: 2020 2020 2020 2020 2320 3935 2520 636f          # 95% co
+000205c0: 6e66 6964 656e 6365 2069 6e74 6572 7661  nfidence interva
+000205d0: 6c20 666f 7220 6561 6368 2072 6f77 2e0a  l for each row..
+000205e0: 2020 2020 2020 2020 2020 2020 6369 5f64              ci_d
+000205f0: 6174 615b 6627 7b61 7d2f 7b62 7d27 5d20  ata[f'{a}/{b}'] 
+00020600: 3d20 7365 6c66 2e5f 7474 6573 745f 636f  = self._ttest_co
+00020610: 6e66 5f69 6e74 2873 656c 662e 6461 7461  nf_int(self.data
+00020620: 5b61 5d2c 2073 656c 662e 6461 7461 5b62  [a], self.data[b
+00020630: 5d29 0a0a 2020 2020 2020 2020 2020 2020  ])..            
+00020640: 2320 436f 6865 6e73 2064 2066 6f72 2065  # Cohens d for e
+00020650: 6163 6820 726f 772e 0a20 2020 2020 2020  ach row..       
+00020660: 2020 2020 2063 6f68 656e 7364 5f64 6174       cohensd_dat
+00020670: 615b 6627 7b61 7d2f 7b62 7d27 5d20 3d20  a[f'{a}/{b}'] = 
+00020680: 7365 6c66 2e5f 636f 6865 6e73 6428 7365  self._cohensd(se
+00020690: 6c66 2e64 6174 615b 615d 2c20 7365 6c66  lf.data[a], self
+000206a0: 2e64 6174 615b 625d 290a 0a20 2020 2020  .data[b])..     
+000206b0: 2020 2020 2020 2023 2062 6820 6164 6a75         # bh adju
+000206c0: 7374 6564 2070 7661 6c75 6520 0a20 2020  sted pvalue .   
+000206d0: 2020 2020 2020 2020 2071 765f 6461 7461           qv_data
+000206e0: 5b66 277b 617d 2f7b 627d 275d 203d 2066  [f'{a}/{b}'] = f
+000206f0: 6472 636f 7272 6563 7469 6f6e 2870 7661  drcorrection(pva
+00020700: 6c75 6573 295b 315d 0a0a 2020 2020 2020  lues)[1]..      
+00020710: 2020 7365 6c66 2e66 635f 6461 7461 203d    self.fc_data =
+00020720: 2073 656c 662e 6461 7461 2e73 656c 6563   self.data.selec
+00020730: 745f 6474 7970 6573 2827 7374 7269 6e67  t_dtypes('string
+00020740: 2729 2e6d 6572 6765 2866 635f 6461 7461  ').merge(fc_data
+00020750: 2c20 6c65 6674 5f69 6e64 6578 203d 2054  , left_index = T
+00020760: 7275 652c 2072 6967 6874 5f69 6e64 6578  rue, right_index
+00020770: 203d 2054 7275 6529 0a20 2020 2020 2020   = True).       
+00020780: 2073 656c 662e 7076 5f64 6174 6120 3d20   self.pv_data = 
+00020790: 7365 6c66 2e64 6174 612e 7365 6c65 6374  self.data.select
+000207a0: 5f64 7479 7065 7328 2773 7472 696e 6727  _dtypes('string'
+000207b0: 292e 6d65 7267 6528 7076 5f64 6174 612c  ).merge(pv_data,
+000207c0: 206c 6566 745f 696e 6465 7820 3d20 5472   left_index = Tr
+000207d0: 7565 2c20 7269 6768 745f 696e 6465 7820  ue, right_index 
+000207e0: 3d20 5472 7565 290a 2020 2020 2020 2020  = True).        
+000207f0: 7365 6c66 2e71 765f 6461 7461 203d 2073  self.qv_data = s
+00020800: 656c 662e 6461 7461 2e73 656c 6563 745f  elf.data.select_
+00020810: 6474 7970 6573 2827 7374 7269 6e67 2729  dtypes('string')
+00020820: 2e6d 6572 6765 2871 765f 6461 7461 2c20  .merge(qv_data, 
+00020830: 6c65 6674 5f69 6e64 6578 203d 2054 7275  left_index = Tru
+00020840: 652c 2072 6967 6874 5f69 6e64 6578 203d  e, right_index =
+00020850: 2054 7275 6529 0a20 2020 2020 2020 2073   True).        s
+00020860: 656c 662e 745f 7374 6174 5f64 6174 6120  elf.t_stat_data 
+00020870: 3d20 7365 6c66 2e64 6174 612e 7365 6c65  = self.data.sele
+00020880: 6374 5f64 7479 7065 7328 2773 7472 696e  ct_dtypes('strin
+00020890: 6727 292e 6d65 7267 6528 745f 7374 6174  g').merge(t_stat
+000208a0: 5f64 6174 612c 206c 6566 745f 696e 6465  _data, left_inde
+000208b0: 7820 3d20 5472 7565 2c20 7269 6768 745f  x = True, right_
+000208c0: 696e 6465 7820 3d20 5472 7565 290a 2020  index = True).  
+000208d0: 2020 2020 2020 7365 6c66 2e63 695f 6461        self.ci_da
+000208e0: 7461 203d 2073 656c 662e 6461 7461 2e73  ta = self.data.s
+000208f0: 656c 6563 745f 6474 7970 6573 2827 7374  elect_dtypes('st
+00020900: 7269 6e67 2729 2e6d 6572 6765 2863 695f  ring').merge(ci_
+00020910: 6461 7461 2c20 6c65 6674 5f69 6e64 6578  data, left_index
+00020920: 203d 2054 7275 652c 2072 6967 6874 5f69   = True, right_i
+00020930: 6e64 6578 203d 2054 7275 6529 0a20 2020  ndex = True).   
+00020940: 2020 2020 2073 656c 662e 636f 6865 6e73       self.cohens
+00020950: 645f 6461 7461 203d 2073 656c 662e 6461  d_data = self.da
+00020960: 7461 2e73 656c 6563 745f 6474 7970 6573  ta.select_dtypes
+00020970: 2827 7374 7269 6e67 2729 2e6d 6572 6765  ('string').merge
+00020980: 2863 6f68 656e 7364 5f64 6174 612c 206c  (cohensd_data, l
+00020990: 6566 745f 696e 6465 7820 3d20 5472 7565  eft_index = True
+000209a0: 2c20 7269 6768 745f 696e 6465 7820 3d20  , right_index = 
+000209b0: 5472 7565 290a 0a20 2020 2020 2020 2069  True)..        i
+000209c0: 6620 7265 7475 726e 5f6f 7574 7075 7420  f return_output 
+000209d0: 3d3d 2054 7275 653a 0a20 2020 2020 2020  == True:.       
+000209e0: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+000209f0: 2e66 635f 6461 7461 2c20 7365 6c66 2e70  .fc_data, self.p
+00020a00: 765f 6461 7461 2c20 7365 6c66 2e71 765f  v_data, self.qv_
+00020a10: 6461 7461 2c20 7365 6c66 2e74 5f73 7461  data, self.t_sta
+00020a20: 745f 6461 7461 2c20 7365 6c66 2e63 695f  t_data, self.ci_
+00020a30: 6461 7461 2c20 7365 6c66 2e63 6f68 656e  data, self.cohen
+00020a40: 7364 5f64 6174 610a 2020 2020 0a20 2020  sd_data.    .   
+00020a50: 2064 6566 205f 7474 6573 745f 636f 6e66   def _ttest_conf
+00020a60: 5f69 6e74 2873 656c 662c 2061 2c20 622c  _int(self, a, b,
+00020a70: 2063 6f6e 665f 696e 743d 302e 3935 293a   conf_int=0.95):
+00020a80: 0a0a 2020 2020 2020 2020 7364 5f61 203d  ..        sd_a =
+00020a90: 206e 702e 7374 6428 612c 2064 646f 663d   np.std(a, ddof=
+00020aa0: 312c 2061 7869 733d 3129 0a20 2020 2020  1, axis=1).     
+00020ab0: 2020 2073 645f 6220 3d20 6e70 2e73 7464     sd_b = np.std
+00020ac0: 2862 2c20 6464 6f66 3d31 2c20 6178 6973  (b, ddof=1, axis
+00020ad0: 3d31 290a 0a20 2020 2020 2020 206e 5f61  =1)..        n_a
+00020ae0: 203d 2061 2e73 6861 7065 5b31 5d0a 2020   = a.shape[1].  
+00020af0: 2020 2020 2020 6e5f 6220 3d20 622e 7368        n_b = b.sh
+00020b00: 6170 655b 315d 0a20 2020 2020 2020 2064  ape[1].        d
+00020b10: 6620 3d20 6e5f 6120 2b20 6e5f 6220 2d20  f = n_a + n_b - 
+00020b20: 320a 2020 2020 2020 2020 735f 706f 6f6c  2.        s_pool
+00020b30: 6564 203d 206e 702e 7371 7274 2828 286e  ed = np.sqrt(((n
+00020b40: 5f61 2d31 292a 7364 5f61 2a2a 3220 2b20  _a-1)*sd_a**2 + 
+00020b50: 286e 5f62 2d31 292a 7364 5f62 2a2a 3229  (n_b-1)*sd_b**2)
+00020b60: 202f 2064 6629 0a0a 2020 2020 2020 2020   / df)..        
+00020b70: 7065 7263 656e 7469 6c65 203d 2028 3120  percentile = (1 
+00020b80: 2b20 636f 6e66 5f69 6e74 292f 320a 2020  + conf_int)/2.  
+00020b90: 2020 2020 2020 745f 6372 6974 203d 2073        t_crit = s
+00020ba0: 7461 7473 2e74 2e70 7066 2870 6572 6365  tats.t.ppf(perce
+00020bb0: 6e74 696c 652c 2064 6629 0a20 2020 2020  ntile, df).     
+00020bc0: 2020 206c 6f77 6572 203d 2073 656c 662e     lower = self.
+00020bd0: 5f66 6f6c 645f 6368 616e 6765 2861 2c20  _fold_change(a, 
+00020be0: 6229 202d 2074 5f63 7269 7420 2a20 735f  b) - t_crit * s_
+00020bf0: 706f 6f6c 6564 0a20 2020 2020 2020 2075  pooled.        u
+00020c00: 7070 6572 203d 2073 656c 662e 5f66 6f6c  pper = self._fol
+00020c10: 645f 6368 616e 6765 2861 2c20 6229 202b  d_change(a, b) +
+00020c20: 2074 5f63 7269 7420 2a20 735f 706f 6f6c   t_crit * s_pool
+00020c30: 6564 0a0a 2020 2020 2020 2020 2320 436f  ed..        # Co
+00020c40: 6d62 696e 6520 6c6f 7765 7220 7769 7468  mbine lower with
+00020c50: 2075 7070 6572 0a20 2020 2020 2020 2063   upper.        c
+00020c60: 6f6e 665f 696e 7465 7276 616c 7320 3d20  onf_intervals = 
+00020c70: 6c69 7374 287a 6970 286c 6f77 6572 2c20  list(zip(lower, 
+00020c80: 7570 7065 7229 290a 2020 2020 2020 2020  upper)).        
+00020c90: 7265 7475 726e 2063 6f6e 665f 696e 7465  return conf_inte
+00020ca0: 7276 616c 730a 0a20 2020 2064 6566 205f  rvals..    def _
+00020cb0: 666f 6c64 5f63 6861 6e67 6528 7365 6c66  fold_change(self
+00020cc0: 2c20 612c 2062 293a 0a0a 2020 2020 2020  , a, b):..      
+00020cd0: 2020 666f 6c64 5f63 6861 6e67 6520 3d20    fold_change = 
+00020ce0: 6e70 2e6d 6561 6e28 612c 2061 7869 733d  np.mean(a, axis=
+00020cf0: 3129 202d 206e 702e 6d65 616e 2862 2c20  1) - np.mean(b, 
+00020d00: 6178 6973 3d31 290a 2020 2020 2020 2020  axis=1).        
+00020d10: 7265 7475 726e 2066 6f6c 645f 6368 616e  return fold_chan
+00020d20: 6765 0a20 2020 200a 2020 2020 6465 6620  ge.    .    def 
+00020d30: 5f63 6f68 656e 7364 2873 656c 662c 2061  _cohensd(self, a
+00020d40: 2c20 6229 3a0a 0a20 2020 2020 2020 206e  , b):..        n
+00020d50: 312c 206e 3220 3d20 612e 7368 6170 655b  1, n2 = a.shape[
+00020d60: 315d 2c20 622e 7368 6170 655b 315d 0a20  1], b.shape[1]. 
+00020d70: 2020 2020 2020 2073 312c 2073 3220 3d20         s1, s2 = 
+00020d80: 6e70 2e73 7464 2861 2c20 6464 6f66 3d31  np.std(a, ddof=1
+00020d90: 2c20 6178 6973 3d31 292c 206e 702e 7374  , axis=1), np.st
+00020da0: 6428 622c 2064 646f 663d 312c 2061 7869  d(b, ddof=1, axi
+00020db0: 733d 3129 0a20 2020 2020 2020 2073 5f70  s=1).        s_p
+00020dc0: 6f6f 6c65 6420 3d20 6e70 2e73 7172 7428  ooled = np.sqrt(
+00020dd0: 2828 6e31 2d31 292a 7331 202b 2028 6e32  ((n1-1)*s1 + (n2
+00020de0: 2d31 292a 7332 2920 2f20 286e 3120 2b20  -1)*s2) / (n1 + 
+00020df0: 6e32 202d 2032 2929 0a0a 2020 2020 2020  n2 - 2))..      
+00020e00: 2020 7265 7475 726e 2028 7365 6c66 2e5f    return (self._
+00020e10: 666f 6c64 5f63 6861 6e67 6528 612c 2062  fold_change(a, b
+00020e20: 2929 202f 2073 5f70 6f6f 6c65 640a 2020  )) / s_pooled.  
+00020e30: 2020 0a20 2020 2064 6566 2067 6574 5f75    .    def get_u
+00020e40: 6e69 7175 655f 636f 6d62 2873 656c 662c  nique_comb(self,
+00020e50: 2061 2c20 6229 3a0a 0a20 2020 2020 2020   a, b):..       
+00020e60: 2022 2222 0a20 2020 2020 2020 2047 6574   """.        Get
+00020e70: 2075 6e69 7175 6520 636f 6d62 696e 6174   unique combinat
+00020e80: 696f 6e73 2062 6574 7765 656e 2061 7272  ions between arr
+00020e90: 6179 2061 2061 6e64 2062 0a0a 2020 2020  ay a and b..    
+00020ea0: 2020 2020 5061 7261 6d65 7465 7273 0a20      Parameters. 
+00020eb0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
+00020ec0: 2d0a 2020 2020 2020 2020 6120 3a20 6c69  -.        a : li
+00020ed0: 7374 0a20 2020 2020 2020 2020 2020 2061  st.            a
+00020ee0: 206c 6973 7420 6f66 2073 7472 696e 6773   list of strings
+00020ef0: 2020 2020 200a 2020 2020 2020 2020 6220       .        b 
+00020f00: 3a20 6c69 7374 0a20 2020 2020 2020 2020  : list.         
+00020f10: 2020 2061 206c 6973 7420 6f66 2073 7472     a list of str
+00020f20: 696e 6773 0a0a 2020 2020 2020 2020 5265  ings..        Re
+00020f30: 7475 726e 730a 2020 2020 2020 2020 2d2d  turns.        --
+00020f40: 2d2d 2d2d 2d0a 2020 2020 2020 2020 636f  -----.        co
+00020f50: 6d70 6172 6973 6f6e 7320 3a20 6c69 7374  mparisons : list
+00020f60: 0a20 2020 2020 2020 2020 2020 2061 206c  .            a l
+00020f70: 6973 7420 6f66 2074 7570 6c65 7320 7769  ist of tuples wi
+00020f80: 7468 2075 6e69 7175 6520 636f 6d62 696e  th unique combin
+00020f90: 6174 696f 6e73 2062 6574 7765 656e 2061  ations between a
+00020fa0: 2061 6e64 2062 2e0a 2020 2020 2020 2020   and b..        
+00020fb0: 2222 220a 0a20 2020 2020 2020 2063 6f6d  """..        com
+00020fc0: 7061 7269 736f 6e73 203d 205b 5d0a 2020  parisons = [].  
+00020fd0: 2020 2020 2020 666f 7220 636f 6d70 3120        for comp1 
+00020fe0: 696e 2061 3a0a 2020 2020 2020 2020 2020  in a:.          
+00020ff0: 2020 666f 7220 636f 6d70 3220 696e 2062    for comp2 in b
+00021000: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00021010: 2020 636f 6d70 6172 6973 6f6e 732e 6170    comparisons.ap
+00021020: 7065 6e64 2828 636f 6d70 312c 2063 6f6d  pend((comp1, com
+00021030: 7032 2929 0a0a 2020 2020 2020 2020 7265  p2))..        re
+00021040: 7475 726e 2063 6f6d 7061 7269 736f 6e73  turn comparisons
+00021050: 0a0a 2020 2020 6465 6620 6765 745f 7375  ..    def get_su
+00021060: 6d6d 6172 795f 6461 7461 2873 656c 662c  mmary_data(self,
+00021070: 2073 756d 6d61 7279 3d27 6d65 616e 2729   summary='mean')
+00021080: 3a0a 0a20 2020 2020 2020 2022 2222 0a20  :..        """. 
+00021090: 2020 2020 2020 2043 7265 6174 6520 6120         Create a 
+000210a0: 7375 6d6d 6172 7920 6461 7461 6672 616d  summary datafram
+000210b0: 6520 7769 7468 206d 6561 6e20 6f72 206d  e with mean or m
+000210c0: 6564 6961 6e20 7661 6c75 6573 2066 6f72  edian values for
+000210d0: 2065 6163 6820 7361 6d70 6c65 7479 7065   each sampletype
+000210e0: 0a0a 2020 2020 2020 2020 5061 7261 6d65  ..        Parame
+000210f0: 7465 7273 0a20 2020 2020 2020 202d 2d2d  ters.        ---
+00021100: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+00021110: 7375 6d6d 6172 7920 3a20 7374 720a 2020  summary : str.  
+00021120: 2020 2020 2020 2020 2020 2043 616c 6375             Calcu
+00021130: 6c61 7465 2074 6865 2027 6d65 616e 2720  late the 'mean' 
+00021140: 6f72 2027 6d65 6469 616e 2720 2844 6566  or 'median' (Def
+00021150: 6175 6c74 2076 616c 7565 203d 2027 6d65  ault value = 'me
+00021160: 616e 2729 2e0a 0a20 2020 2020 2020 2052  an')...        R
+00021170: 6574 7572 6e73 0a20 2020 2020 2020 202d  eturns.        -
+00021180: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2073  ------.        s
+00021190: 756d 6d61 7279 5f64 6174 6120 3a20 7061  ummary_data : pa
+000211a0: 6e64 6173 2e44 6174 6146 7261 6d65 0a20  ndas.DataFrame. 
+000211b0: 2020 2020 2020 2020 2020 2041 2073 756d             A sum
+000211c0: 6d61 7279 2064 6174 6166 7261 6d65 2077  mary dataframe w
+000211d0: 6974 6820 6d65 616e 206f 7220 6d65 6469  ith mean or medi
+000211e0: 616e 2076 616c 7565 7320 666f 7220 6561  an values for ea
+000211f0: 6368 2073 616d 706c 6574 7970 652e 0a20  ch sampletype.. 
+00021200: 2020 2020 2020 2022 2222 0a0a 2020 2020         """..    
+00021210: 2020 2020 7374 7269 6e67 5f64 6174 6120      string_data 
+00021220: 3d20 7365 6c66 2e64 6174 612e 7365 6c65  = self.data.sele
+00021230: 6374 5f64 7479 7065 7328 2773 7472 696e  ct_dtypes('strin
+00021240: 6727 290a 0a20 2020 2020 2020 2069 6620  g')..        if 
+00021250: 7375 6d6d 6172 7920 3d3d 2027 6d65 616e  summary == 'mean
+00021260: 273a 0a20 2020 2020 2020 2020 2020 2066  ':.            f
+00021270: 6c6f 6174 5f64 6174 6120 3d20 7365 6c66  loat_data = self
+00021280: 2e64 6174 612e 7365 6c65 6374 5f64 7479  .data.select_dty
+00021290: 7065 7328 2766 6c6f 6174 2729 2e54 2e72  pes('float').T.r
+000212a0: 6573 6574 5f69 6e64 6578 286e 616d 6573  eset_index(names
+000212b0: 3d27 7361 6d70 6c65 2729 2e67 726f 7570  ='sample').group
+000212c0: 6279 2827 7361 6d70 6c65 2729 2e6d 6561  by('sample').mea
+000212d0: 6e28 292e 540a 2020 2020 2020 2020 0a20  n().T.        . 
+000212e0: 2020 2020 2020 2065 6c69 6620 7375 6d6d         elif summ
+000212f0: 6172 7920 3d3d 2027 6d65 6469 616e 273a  ary == 'median':
+00021300: 0a20 2020 2020 2020 2020 2020 2066 6c6f  .            flo
+00021310: 6174 5f64 6174 6120 3d20 7365 6c66 2e64  at_data = self.d
+00021320: 6174 612e 7365 6c65 6374 5f64 7479 7065  ata.select_dtype
+00021330: 7328 2766 6c6f 6174 2729 2e54 2e72 6573  s('float').T.res
+00021340: 6574 5f69 6e64 6578 286e 616d 6573 3d27  et_index(names='
+00021350: 7361 6d70 6c65 2729 2e67 726f 7570 6279  sample').groupby
+00021360: 2827 7361 6d70 6c65 2729 2e6d 6564 6961  ('sample').media
+00021370: 6e28 292e 5420 0a20 2020 2020 2020 200a  n().T .        .
+00021380: 2020 2020 2020 2020 7375 6d6d 6172 795f          summary_
+00021390: 6461 7461 203d 2070 642e 636f 6e63 6174  data = pd.concat
+000213a0: 285b 7374 7269 6e67 5f64 6174 612c 2066  ([string_data, f
+000213b0: 6c6f 6174 5f64 6174 615d 2c20 6178 6973  loat_data], axis
+000213c0: 3d31 290a 0a20 2020 2020 2020 2073 656c  =1)..        sel
+000213d0: 662e 7375 6d6d 6172 795f 6461 7461 203d  f.summary_data =
+000213e0: 2073 756d 6d61 7279 5f64 6174 612e 636f   summary_data.co
+000213f0: 7079 2829 0000 0000 0000 0000 0000 0000  py()............
+00021400: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+00021410: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00021420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00021430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00021440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021460: 0000 0000 3030 3030 3634 3400 3030 3031  ....0000644.0001
-00021470: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
-00021480: 3030 3030 3737 3500 3134 3435 3130 3636  0000775.14451066
-00021490: 3233 3500 3032 3735 3330 0020 3000 0000  235.027530. 0...
+00021460: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+00021470: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00021480: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
+00021490: 3030 3000 3031 3032 3133 0020 7800 0000  000.010213. x...
 000214a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000214b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000214c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000214d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000214e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000214f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021500: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
+00021500: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
 00021510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021520: 0000 0000 0000 0000 0064 6f63 6b65 7200  .........docker.
+00021520: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021540: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021550: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000215a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000215b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000215c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000215d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000215e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000215f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021600: 696d 706f 7274 206f 730a 696d 706f 7274  import os.import
-00021610: 2069 7079 6b65 726e 656c 0a66 726f 6d20   ipykernel.from 
-00021620: 4950 7974 686f 6e2e 636f 7265 2e67 6574  IPython.core.get
-00021630: 6970 7974 686f 6e20 696d 706f 7274 2067  ipython import g
-00021640: 6574 5f69 7079 7468 6f6e 0a0a 6465 6620  et_ipython..def 
-00021650: 6973 5f6a 7570 7974 6572 5f6e 6f74 6562  is_jupyter_noteb
-00021660: 6f6f 6b28 293a 0a20 2020 2072 6574 7572  ook():.    retur
-00021670: 6e20 6765 745f 6970 7974 686f 6e28 2920  n get_ipython() 
-00021680: 6973 206e 6f74 204e 6f6e 6520 616e 6420  is not None and 
-00021690: 6973 696e 7374 616e 6365 2867 6574 5f69  isinstance(get_i
-000216a0: 7079 7468 6f6e 2829 2c20 6970 796b 6572  python(), ipyker
-000216b0: 6e65 6c2e 7a6d 7173 6865 6c6c 2e5a 4d51  nel.zmqshell.ZMQ
-000216c0: 496e 7465 7261 6374 6976 6553 6865 6c6c  InteractiveShell
-000216d0: 290a 0a64 6566 2066 6f72 6d61 745f 7974  )..def format_yt
-000216e0: 6963 6b5f 6c61 6265 6c28 7974 6963 6b29  ick_label(ytick)
-000216f0: 3a0a 2020 2020 6d61 785f 7769 6474 6820  :.    max_width 
-00021700: 3d20 3135 0a20 2020 2077 6f72 6473 203d  = 15.    words =
-00021710: 2079 7469 636b 2e73 706c 6974 2829 0a20   ytick.split(). 
-00021720: 2020 2072 6573 203d 2027 270a 2020 2020     res = ''.    
-00021730: 6c69 6e65 203d 2027 270a 2020 2020 666f  line = ''.    fo
-00021740: 7220 7720 696e 2077 6f72 6473 3a0a 2020  r w in words:.  
-00021750: 2020 2020 2020 6c69 6e65 202b 3d20 2877        line += (w
-00021760: 202b 2027 2027 290a 2020 2020 2020 2020   + ' ').        
-00021770: 6966 206c 656e 286c 696e 6529 203e 206d  if len(line) > m
-00021780: 6178 5f77 6964 7468 3a0a 2020 2020 2020  ax_width:.      
-00021790: 2020 2020 2020 7265 7320 2b3d 206c 696e        res += lin
-000217a0: 652e 7374 7269 7028 2920 2b20 273c 6272  e.strip() + '<br
-000217b0: 3e27 0a20 2020 2020 2020 2020 2020 206c  >'.            l
-000217c0: 696e 6520 3d20 2727 0a20 2020 2020 2020  ine = ''.       
-000217d0: 2020 2020 200a 2020 2020 7265 7320 2b3d       .    res +=
-000217e0: 206c 696e 652e 7374 7269 7028 290a 2020   line.strip().  
-000217f0: 2020 7265 7475 726e 2072 6573 0a00 0000    return res....
-00021800: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-00021810: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021820: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00021600: 3232 206d 7469 6d65 3d31 3638 3835 3732  22 mtime=1688572
+00021610: 3039 322e 300a 0000 0000 0000 0000 0000  092.0...........
+00021620: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00021630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00021640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00021650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00021660: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00021670: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00021680: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00021690: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000216a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000216b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000216c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000216d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000216e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000216f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00021700: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00021710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00021720: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00021730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00021740: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00021750: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00021760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00021770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00021780: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00021790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000217a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000217b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000217c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000217d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000217e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000217f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00021800: 7072 6f74 656f 6d69 6373 5f64 6f77 6e73  proteomics_downs
+00021810: 7472 6561 6d5f 616e 616c 7973 6973 2d30  tream_analysis-0
+00021820: 2e31 2e33 2f70 726f 7465 6f6d 6963 735f  .1.3/proteomics_
+00021830: 646f 776e 7374 7265 616d 5f61 6e61 6c79  downstream_analy
+00021840: 7369 732f 7574 696c 732e 7079 0000 0000  sis/utils.py....
 00021850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021860: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-00021870: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00021880: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
-00021890: 3030 3000 3031 3032 3133 0020 7800 0000  000.010213. x...
+00021860: 0000 0000 3030 3030 3634 3400 3030 3031  ....0000644.0001
+00021870: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
+00021880: 3030 3030 3737 3500 3134 3435 3133 3130  0000775.14451310
+00021890: 3237 3400 3032 3735 3234 0020 3000 0000  274.027524. 0...
 000218a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000218b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000218c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000218d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000218e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000218f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021900: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00021900: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
 00021910: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021920: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00021920: 0000 0000 0000 0000 0064 6f63 6b65 7200  .........docker.
 00021930: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021940: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021950: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021960: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021970: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021980: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000219a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000219b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000219c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000219d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000219e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000219f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021a00: 3232 206d 7469 6d65 3d31 3638 3834 3937  22 mtime=1688497
-00021a10: 3330 392e 300a 0000 0000 0000 0000 0000  309.0...........
-00021a20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021a30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021a40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021a50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021a60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021a70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021a80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021a90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021aa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021ab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021ac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021ad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021ae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021af0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021b00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021b10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021b20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021b30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021b40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021b50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021b60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021b70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021b80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021b90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021ba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021bb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021bc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021bd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021be0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021bf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021c00: 7072 6f74 656f 6d69 6373 5f64 6f77 6e73  proteomics_downs
-00021c10: 7472 6561 6d5f 616e 616c 7973 6973 2d30  tream_analysis-0
-00021c20: 2e31 2e32 2f70 726f 7465 6f6d 6963 735f  .1.2/proteomics_
-00021c30: 646f 776e 7374 7265 616d 5f61 6e61 6c79  downstream_analy
-00021c40: 7369 732f 7669 7375 616c 697a 6572 2e70  sis/visualizer.p
-00021c50: 7900 0000 0000 0000 0000 0000 0000 0000  y...............
-00021c60: 0000 0000 3030 3030 3634 3400 3030 3031  ....0000644.0001
-00021c70: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
-00021c80: 3030 3337 3230 3600 3134 3435 3130 3636  0037206.14451066
-00021c90: 3233 3500 3033 3035 3634 0020 3000 0000  235.030564. 0...
+00021a00: 696d 706f 7274 206f 730a 696d 706f 7274  import os.import
+00021a10: 2069 7079 6b65 726e 656c 0a66 726f 6d20   ipykernel.from 
+00021a20: 4950 7974 686f 6e2e 636f 7265 2e67 6574  IPython.core.get
+00021a30: 6970 7974 686f 6e20 696d 706f 7274 2067  ipython import g
+00021a40: 6574 5f69 7079 7468 6f6e 0a0a 6465 6620  et_ipython..def 
+00021a50: 6973 5f6a 7570 7974 6572 5f6e 6f74 6562  is_jupyter_noteb
+00021a60: 6f6f 6b28 293a 0a20 2020 2072 6574 7572  ook():.    retur
+00021a70: 6e20 6765 745f 6970 7974 686f 6e28 2920  n get_ipython() 
+00021a80: 6973 206e 6f74 204e 6f6e 6520 616e 6420  is not None and 
+00021a90: 6973 696e 7374 616e 6365 2867 6574 5f69  isinstance(get_i
+00021aa0: 7079 7468 6f6e 2829 2c20 6970 796b 6572  python(), ipyker
+00021ab0: 6e65 6c2e 7a6d 7173 6865 6c6c 2e5a 4d51  nel.zmqshell.ZMQ
+00021ac0: 496e 7465 7261 6374 6976 6553 6865 6c6c  InteractiveShell
+00021ad0: 290a 0a64 6566 2066 6f72 6d61 745f 7974  )..def format_yt
+00021ae0: 6963 6b5f 6c61 6265 6c28 7974 6963 6b29  ick_label(ytick)
+00021af0: 3a0a 2020 2020 6d61 785f 7769 6474 6820  :.    max_width 
+00021b00: 3d20 3135 0a20 2020 2077 6f72 6473 203d  = 15.    words =
+00021b10: 2079 7469 636b 2e73 706c 6974 2829 0a20   ytick.split(). 
+00021b20: 2020 2072 6573 203d 2027 270a 2020 2020     res = ''.    
+00021b30: 6c69 6e65 203d 2027 270a 2020 2020 666f  line = ''.    fo
+00021b40: 7220 7720 696e 2077 6f72 6473 3a0a 2020  r w in words:.  
+00021b50: 2020 2020 2020 6c69 6e65 202b 3d20 2877        line += (w
+00021b60: 202b 2027 2027 290a 2020 2020 2020 2020   + ' ').        
+00021b70: 6966 206c 656e 286c 696e 6529 203e 206d  if len(line) > m
+00021b80: 6178 5f77 6964 7468 3a0a 2020 2020 2020  ax_width:.      
+00021b90: 2020 2020 2020 7265 7320 2b3d 206c 696e        res += lin
+00021ba0: 652e 7374 7269 7028 2920 2b20 273c 6272  e.strip() + '<br
+00021bb0: 3e27 0a20 2020 2020 2020 2020 2020 206c  >'.            l
+00021bc0: 696e 6520 3d20 2727 0a20 2020 2020 2020  ine = ''.       
+00021bd0: 2020 2020 200a 2020 2020 7265 7320 2b3d       .    res +=
+00021be0: 206c 696e 652e 7374 7269 7028 290a 2020   line.strip().  
+00021bf0: 2020 7265 7475 726e 2072 6573 0a00 0000    return res....
+00021c00: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+00021c10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00021c20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00021c30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00021c40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00021c50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00021c60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+00021c70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00021c80: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
+00021c90: 3030 3000 3031 3032 3133 0020 7800 0000  000.010213. x...
 00021ca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021cb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021cc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021cd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021ce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021cf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021d00: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
+00021d00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
 00021d10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021d20: 0000 0000 0000 0000 0064 6f63 6b65 7200  .........docker.
+00021d20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021d30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021d40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021d50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021d60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021d70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021d80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021d90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021da0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021db0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021dc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021dd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021de0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021df0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021e00: 696d 706f 7274 2073 6561 626f 726e 2061  import seaborn a
-00021e10: 7320 736e 730a 696d 706f 7274 206d 6174  s sns.import mat
-00021e20: 706c 6f74 6c69 622e 7079 706c 6f74 2061  plotlib.pyplot a
-00021e30: 7320 706c 740a 6672 6f6d 2061 646a 7573  s plt.from adjus
-00021e40: 7454 6578 7420 696d 706f 7274 2061 646a  tText import adj
-00021e50: 7573 745f 7465 7874 0a0a 696d 706f 7274  ust_text..import
-00021e60: 2074 6578 7477 7261 700a 696d 706f 7274   textwrap.import
-00021e70: 206e 756d 7079 2061 7320 6e70 0a69 6d70   numpy as np.imp
-00021e80: 6f72 7420 7061 6e64 6173 2061 7320 7064  ort pandas as pd
-00021e90: 0a0a 0a69 6d70 6f72 7420 706c 6f74 6c79  ...import plotly
-00021ea0: 2e67 7261 7068 5f6f 626a 6563 7473 2061  .graph_objects a
-00021eb0: 7320 676f 0a66 726f 6d20 706c 6f74 6c79  s go.from plotly
-00021ec0: 2e73 7562 706c 6f74 7320 696d 706f 7274  .subplots import
-00021ed0: 206d 616b 655f 7375 6270 6c6f 7473 0a69   make_subplots.i
-00021ee0: 6d70 6f72 7420 7374 7265 616d 6c69 7420  mport streamlit 
-00021ef0: 6173 2073 740a 6672 6f6d 202e 7574 696c  as st.from .util
-00021f00: 7320 696d 706f 7274 2069 735f 6a75 7079  s import is_jupy
-00021f10: 7465 725f 6e6f 7465 626f 6f6b 0a0a 636c  ter_notebook..cl
-00021f20: 6173 7320 5669 7375 616c 697a 6572 3a0a  ass Visualizer:.
-00021f30: 2020 2020 2222 2220 5669 7375 616c 697a      """ Visualiz
-00021f40: 6572 2063 6c61 7373 2066 6f72 2070 6c6f  er class for plo
-00021f50: 7474 696e 672e 2222 220a 0a20 2020 2064  tting."""..    d
-00021f60: 6566 205f 5f69 6e69 745f 5f28 7365 6c66  ef __init__(self
-00021f70: 293a 0a20 2020 2020 2020 2070 6173 730a  ):.        pass.
-00021f80: 0a20 2020 2064 6566 2076 6f6c 6361 6e6f  .    def volcano
-00021f90: 5f70 6c6f 7428 7365 6c66 2c20 6e5f 726f  _plot(self, n_ro
-00021fa0: 7773 2c20 6e5f 636f 6c73 2c20 6765 6e65  ws, n_cols, gene
-00021fb0: 5f6c 6973 743d 4e6f 6e65 2c20 6669 6773  _list=None, figs
-00021fc0: 697a 6520 3d20 2838 2c38 292c 2073 6176  ize = (8,8), sav
-00021fd0: 6566 6967 203d 2046 616c 7365 2c20 7570  efig = False, up
-00021fe0: 7065 725f 6663 5f63 7574 6f66 6620 3d20  per_fc_cutoff = 
-00021ff0: 312c 206c 6f77 6572 5f66 635f 6375 746f  1, lower_fc_cuto
-00022000: 6666 203d 2031 2c0a 2020 2020 2020 2020  ff = 1,.        
-00022010: 2020 2020 2020 2020 2061 6e6e 6f74 203d           annot =
-00022020: 204e 6f6e 652c 2067 656e 655f 636f 6c75   None, gene_colu
-00022030: 6d6e 203d 2027 4765 6e65 7327 2c20 7176  mn = 'Genes', qv
-00022040: 616c 7565 3d54 7275 6529 3a0a 2020 2020  alue=True):.    
-00022050: 0a20 2020 2020 2020 2022 2222 506c 6f74  .        """Plot
-00022060: 2061 2076 6f6c 6361 6e6f 2070 6c6f 742e   a volcano plot.
-00022070: 0a0a 2020 2020 2020 2020 5061 7261 6d65  ..        Parame
-00022080: 7465 7273 0a20 2020 2020 2020 202d 2d2d  ters.        ---
-00022090: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-000220a0: 6e5f 726f 7773 203a 2069 6e74 0a20 2020  n_rows : int.   
-000220b0: 2020 2020 2020 2020 206e 756d 6265 7220           number 
-000220c0: 6f66 2072 6f77 7320 666f 7220 7468 6520  of rows for the 
-000220d0: 7375 6270 6c6f 742e 0a20 2020 2020 2020  subplot..       
-000220e0: 206e 5f63 6f6c 7320 3a20 696e 740a 2020   n_cols : int.  
-000220f0: 2020 2020 2020 2020 2020 6e75 6d62 6572            number
-00022100: 206f 6620 636f 6c75 6d6e 7320 666f 7220   of columns for 
-00022110: 7468 6520 7375 6270 6c6f 742e 0a20 2020  the subplot..   
-00022120: 2020 2020 2067 656e 655f 6c69 7374 203a       gene_list :
-00022130: 206c 6973 740a 2020 2020 2020 2020 2020   list.          
-00022140: 2020 6e61 6d65 206f 6620 6765 6e65 7320    name of genes 
-00022150: 696e 2061 206c 6973 7420 666f 7220 616e  in a list for an
-00022160: 6e6f 7461 7469 6f6e 2069 6e20 766f 6c63  notation in volc
-00022170: 616e 6f20 706c 6f74 2028 4465 6661 756c  ano plot (Defaul
-00022180: 7420 7661 6c75 6520 3d20 4e6f 6e65 292e  t value = None).
-00022190: 0a20 2020 2020 2020 2066 6967 7369 7a65  .        figsize
-000221a0: 203a 0a20 2020 2020 2020 2020 2020 2066   :.            f
-000221b0: 6967 7572 6520 7369 7a65 2e20 2844 6566  igure size. (Def
-000221c0: 6175 6c74 2076 616c 7565 203d 2028 3829  ault value = (8)
-000221d0: 0a20 2020 2020 2020 2038 2920 3a0a 2020  .        8) :.  
-000221e0: 2020 2020 2020 2020 2020 0a20 2020 2020            .     
-000221f0: 2020 2073 6176 6566 6967 203a 2062 6f6f     savefig : boo
-00022200: 6c65 616e 0a20 2020 2020 2020 2020 2020  lean.           
-00022210: 2073 6176 6520 7468 6520 6669 6775 7265   save the figure
-00022220: 2e20 2844 6566 6175 6c74 2076 616c 7565  . (Default value
-00022230: 203d 2046 616c 7365 290a 2020 2020 2020   = False).      
-00022240: 2020 7570 7065 725f 6663 5f63 7574 6f66    upper_fc_cutof
-00022250: 6620 3a20 696e 7420 6f72 2066 6c6f 6174  f : int or float
-00022260: 0a20 2020 2020 2020 2020 2020 2053 6574  .            Set
-00022270: 2061 6e20 7570 7065 7220 666f 6c64 2063   an upper fold c
-00022280: 6861 6e67 6520 6375 746f 6666 2066 6f72  hange cutoff for
-00022290: 2061 6e6e 6f74 6174 696f 6e20 2844 6566   annotation (Def
-000222a0: 6175 6c74 2076 616c 7565 203d 2031 292e  ault value = 1).
-000222b0: 0a20 2020 2020 2020 206c 6f77 6572 5f66  .        lower_f
-000222c0: 635f 6375 746f 6666 203a 2069 6e74 206f  c_cutoff : int o
-000222d0: 7220 666c 6f61 740a 2020 2020 2020 2020  r float.        
-000222e0: 2020 2020 5365 7420 6120 6c6f 7765 7220      Set a lower 
-000222f0: 666f 6c64 2063 6861 6e67 6520 6375 746f  fold change cuto
-00022300: 6666 2066 6f72 2061 6e6e 6f74 6174 696f  ff for annotatio
-00022310: 6e20 2844 6566 6175 6c74 2076 616c 7565  n (Default value
-00022320: 203d 2031 292e 0a20 2020 2020 2020 2061   = 1)..        a
-00022330: 6e6e 6f74 203a 2073 7472 206f 7220 4e6f  nnot : str or No
-00022340: 6e65 7479 7065 0a20 2020 2020 2020 2020  netype.         
-00022350: 2020 2049 6620 616e 6e6f 7420 3d3d 2027     If annot == '
-00022360: 6663 5f63 7574 6f66 6627 2067 656e 6573  fc_cutoff' genes
-00022370: 2061 7265 2061 6e6e 6f74 6174 6564 2062   are annotated b
-00022380: 7920 666f 6c64 2063 6861 6e67 6520 6375  y fold change cu
-00022390: 746f 6666 2061 6e64 2067 656e 655f 6c69  toff and gene_li
-000223a0: 7374 2e0a 2020 2020 2020 2020 2020 2020  st..            
-000223b0: 4966 204e 6f6e 6520 6e6f 2061 6e6e 6f74  If None no annot
-000223c0: 6174 696f 6e20 6279 2066 6f6c 6420 6368  ation by fold ch
-000223d0: 616e 6765 2063 7574 6f66 6620 6973 2061  ange cutoff is a
-000223e0: 7070 6c69 6564 2c20 6f6e 6c79 2067 656e  pplied, only gen
-000223f0: 655f 6c69 7374 2e20 2844 6566 6175 6c74  e_list. (Default
-00022400: 2076 616c 7565 203d 204e 6f6e 6529 0a20   value = None). 
-00022410: 2020 2020 2020 2067 656e 655f 636f 6c75         gene_colu
-00022420: 6d6e 203a 2073 7472 696e 670a 2020 2020  mn : string.    
-00022430: 2020 2020 2020 2020 5768 6174 2063 6f6c          What col
-00022440: 756d 6e20 746f 2075 7365 2074 6865 2061  umn to use the a
-00022450: 6e6e 6f74 6174 696f 6e20 7769 7468 2028  nnotation with (
-00022460: 4465 6661 756c 7420 7661 6c75 6520 3d20  Default value = 
-00022470: 2747 656e 6573 2729 2e0a 2020 2020 2020  'Genes')..      
-00022480: 2020 7176 616c 7565 203a 2062 6f6f 6c65    qvalue : boole
-00022490: 616e 0a20 2020 2020 2020 2020 2020 2049  an.            I
-000224a0: 6620 7176 616c 7565 203d 3d20 5472 7565  f qvalue == True
-000224b0: 2074 6865 6e20 3525 2061 646a 7573 7465   then 5% adjuste
-000224c0: 6420 702d 7661 6c75 6520 6375 746f 6666  d p-value cutoff
-000224d0: 2069 7320 7573 6564 2e0a 2020 2020 2020   is used..      
-000224e0: 2020 2020 2020 456c 7365 2c20 3525 2070        Else, 5% p
-000224f0: 2d76 616c 7565 2063 7574 6f66 6620 6973  -value cutoff is
-00022500: 2075 7365 6420 2844 6566 6175 6c74 2076   used (Default v
-00022510: 616c 7565 203d 2054 7275 6529 2e0a 0a20  alue = True)... 
-00022520: 2020 2020 2020 2052 6574 7572 6e73 0a20         Returns. 
-00022530: 2020 2020 2020 202d 2d2d 2d2d 2d2d 0a0a         -------..
-00022540: 2020 2020 2020 2020 0a20 2020 2020 2020          .       
-00022550: 2022 2222 0a20 2020 2020 2020 2066 6967   """.        fig
-00022560: 2c20 6178 203d 2070 6c74 2e73 7562 706c  , ax = plt.subpl
-00022570: 6f74 7328 6e5f 726f 7773 2c20 6e5f 636f  ots(n_rows, n_co
-00022580: 6c73 2c20 6669 6773 697a 6520 3d20 6669  ls, figsize = fi
-00022590: 6773 697a 6529 0a0a 2020 2020 2020 2020  gsize)..        
-000225a0: 666f 7220 692c 2061 7865 7320 696e 207a  for i, axes in z
-000225b0: 6970 2873 656c 662e 6663 5f64 6174 612e  ip(self.fc_data.
-000225c0: 7365 6c65 6374 5f64 7479 7065 7328 2766  select_dtypes('f
-000225d0: 6c6f 6174 2729 2e63 6f6c 756d 6e73 2c20  loat').columns, 
-000225e0: 6e70 2e61 7272 6179 2861 7829 2e66 6c61  np.array(ax).fla
-000225f0: 7474 656e 2829 293a 0a20 2020 2020 2020  tten()):.       
-00022600: 2020 2020 200a 2020 2020 2020 2020 2020       .          
-00022610: 2020 6966 2071 7661 6c75 6520 6973 2054    if qvalue is T
-00022620: 7275 653a 0a0a 2020 2020 2020 2020 2020  rue:..          
-00022630: 2020 2020 2020 6966 2028 7365 6c66 2e71        if (self.q
-00022640: 765f 6461 7461 5b69 5d20 3c20 302e 3035  v_data[i] < 0.05
-00022650: 292e 7375 6d28 2920 3d3d 2030 3a0a 0a20  ).sum() == 0:.. 
-00022660: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022670: 2020 2073 6e73 2e73 6361 7474 6572 706c     sns.scatterpl
-00022680: 6f74 2878 203d 2073 656c 662e 6663 5f64  ot(x = self.fc_d
-00022690: 6174 615b 695d 2c20 7920 3d20 7365 6c66  ata[i], y = self
-000226a0: 2e70 765f 6461 7461 5b69 5d2c 2063 6f6c  .pv_data[i], col
-000226b0: 6f72 203d 2027 6c69 6768 7467 7265 7927  or = 'lightgrey'
-000226c0: 2c20 616c 7068 6120 3d20 302e 352c 2061  , alpha = 0.5, a
-000226d0: 783d 6178 6573 290a 2020 2020 2020 2020  x=axes).        
-000226e0: 2020 2020 2020 2020 2020 2020 736e 732e              sns.
-000226f0: 7363 6174 7465 7270 6c6f 7428 7820 3d20  scatterplot(x = 
-00022700: 7365 6c66 2e66 635f 6461 7461 5b73 656c  self.fc_data[sel
-00022710: 662e 7076 5f64 6174 612e 7365 6c65 6374  f.pv_data.select
-00022720: 5f64 7479 7065 7328 2766 6c6f 6174 2729  _dtypes('float')
-00022730: 203e 2031 2e33 5d5b 695d 2c0a 2020 2020   > 1.3][i],.    
-00022740: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022750: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022760: 7920 3d20 7365 6c66 2e70 765f 6461 7461  y = self.pv_data
-00022770: 5b73 656c 662e 7076 5f64 6174 612e 7365  [self.pv_data.se
-00022780: 6c65 6374 5f64 7479 7065 7328 2766 6c6f  lect_dtypes('flo
-00022790: 6174 2729 203e 2031 2e33 5d5b 695d 2c20  at') > 1.3][i], 
-000227a0: 636f 6c6f 7220 3d20 736e 732e 636f 6c6f  color = sns.colo
-000227b0: 725f 7061 6c65 7474 6528 2264 6565 7022  r_palette("deep"
-000227c0: 2c20 3230 295b 315d 2c20 6178 3d61 7865  , 20)[1], ax=axe
-000227d0: 7329 0a20 2020 2020 2020 2020 2020 2020  s).             
-000227e0: 2020 2020 2020 2073 6e73 2e73 6361 7474         sns.scatt
-000227f0: 6572 706c 6f74 2878 203d 2073 656c 662e  erplot(x = self.
-00022800: 6663 5f64 6174 615b 2873 656c 662e 7076  fc_data[(self.pv
-00022810: 5f64 6174 612e 7365 6c65 6374 5f64 7479  _data.select_dty
-00022820: 7065 7328 2766 6c6f 6174 2729 203e 2031  pes('float') > 1
-00022830: 2e33 2920 2620 2873 656c 662e 6663 5f64  .3) & (self.fc_d
-00022840: 6174 612e 7365 6c65 6374 5f64 7479 7065  ata.select_dtype
-00022850: 7328 2766 6c6f 6174 2729 203c 2030 295d  s('float') < 0)]
-00022860: 5b69 5d2c 0a20 2020 2020 2020 2020 2020  [i],.           
-00022870: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022880: 2020 2020 2020 2020 2079 203d 2073 656c           y = sel
-00022890: 662e 7076 5f64 6174 615b 2873 656c 662e  f.pv_data[(self.
-000228a0: 7076 5f64 6174 612e 7365 6c65 6374 5f64  pv_data.select_d
-000228b0: 7479 7065 7328 2766 6c6f 6174 2729 203e  types('float') >
-000228c0: 2031 2e33 2920 2620 2873 656c 662e 6663   1.3) & (self.fc
-000228d0: 5f64 6174 612e 7365 6c65 6374 5f64 7479  _data.select_dty
-000228e0: 7065 7328 2766 6c6f 6174 2729 203c 2030  pes('float') < 0
-000228f0: 295d 5b69 5d2c 0a20 2020 2020 2020 2020  )][i],.         
-00022900: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022910: 2020 2020 2020 2020 2020 2063 6f6c 6f72             color
-00022920: 203d 2073 6e73 2e63 6f6c 6f72 5f70 616c   = sns.color_pal
-00022930: 6574 7465 2822 6465 6570 222c 2032 3029  ette("deep", 20)
-00022940: 5b32 5d2c 2061 783d 6178 6573 290a 2020  [2], ax=axes).  
-00022950: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022960: 2020 0a20 2020 2020 2020 2020 2020 2020    .             
-00022970: 2020 2020 2020 2061 7865 732e 7365 7428         axes.set(
-00022980: 786c 6162 656c 3d66 276c 6f67 3220 666f  xlabel=f'log2 fo
-00022990: 6c64 2063 6861 6e67 6520 287b 697d 2927  ld change ({i})'
-000229a0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-000229b0: 2020 2020 2020 2020 2020 2020 2020 2079                 y
-000229c0: 6c61 6265 6c3d 6627 2d6c 6f67 3130 2070  label=f'-log10 p
-000229d0: 2d76 616c 7565 2028 7b69 7d29 2729 0a20  -value ({i})'). 
-000229e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000229f0: 2020 200a 2020 2020 2020 2020 2020 2020     .            
-00022a00: 2020 2020 2020 2020 2320 7365 7420 702d          # set p-
-00022a10: 7661 6c75 6520 7468 7265 7368 6f6c 6420  value threshold 
-00022a20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00022a30: 2020 2020 2061 7865 732e 6178 686c 696e       axes.axhlin
-00022a40: 6528 312e 332c 6c73 203d 2027 2d2d 272c  e(1.3,ls = '--',
-00022a50: 2063 6f6c 6f72 203d 2027 6c69 6768 7467   color = 'lightg
-00022a60: 7265 7927 290a 0a20 2020 2020 2020 2020  rey')..         
-00022a70: 2020 2020 2020 2020 2020 2069 6620 616e             if an
-00022a80: 6e6f 7420 3d3d 2027 6663 5f63 7574 6f66  not == 'fc_cutof
-00022a90: 6627 3a0a 2020 2020 2020 2020 2020 2020  f':.            
-00022aa0: 2020 2020 2020 2020 2020 2020 696e 6469              indi
-00022ab0: 6365 7320 3d20 7365 6c66 2e66 635f 6461  ces = self.fc_da
-00022ac0: 7461 5b28 2873 656c 662e 6663 5f64 6174  ta[((self.fc_dat
-00022ad0: 615b 695d 203c 206c 6f77 6572 5f66 635f  a[i] < lower_fc_
-00022ae0: 6375 746f 6666 2920 7c20 0a20 2020 2020  cutoff) | .     
-00022af0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022b00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022b10: 2020 2020 2020 2020 2020 2028 7365 6c66             (self
-00022b20: 2e66 635f 6461 7461 5b69 5d20 3e20 7570  .fc_data[i] > up
-00022b30: 7065 725f 6663 5f63 7574 6f66 6629 2920  per_fc_cutoff)) 
-00022b40: 260a 2020 2020 2020 2020 2020 2020 2020  &.              
+00021e00: 3232 206d 7469 6d65 3d31 3638 3835 3732  22 mtime=1688572
+00021e10: 3039 322e 300a 0000 0000 0000 0000 0000  092.0...........
+00021e20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00021e30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00021e40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00021e50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00021e60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00021e70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00021e80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00021e90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00021ea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00021eb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00021ec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00021ed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00021ee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00021ef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00021f00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00021f10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00021f20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00021f30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00021f40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00021f50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00021f60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00021f70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00021f80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00021f90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00021fa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00021fb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00021fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00021fd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00021fe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00021ff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00022000: 7072 6f74 656f 6d69 6373 5f64 6f77 6e73  proteomics_downs
+00022010: 7472 6561 6d5f 616e 616c 7973 6973 2d30  tream_analysis-0
+00022020: 2e31 2e33 2f70 726f 7465 6f6d 6963 735f  .1.3/proteomics_
+00022030: 646f 776e 7374 7265 616d 5f61 6e61 6c79  downstream_analy
+00022040: 7369 732f 7669 7375 616c 697a 6572 2e70  sis/visualizer.p
+00022050: 7900 0000 0000 0000 0000 0000 0000 0000  y...............
+00022060: 0000 0000 3030 3030 3634 3400 3030 3031  ....0000644.0001
+00022070: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
+00022080: 3030 3337 3230 3600 3134 3435 3133 3130  0037206.14451310
+00022090: 3237 3400 3033 3035 3630 0020 3000 0000  274.030560. 0...
+000220a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000220b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000220c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000220d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000220e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000220f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00022100: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
+00022110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00022120: 0000 0000 0000 0000 0064 6f63 6b65 7200  .........docker.
+00022130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00022140: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00022150: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00022160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00022170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00022180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00022190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000221a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000221b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000221c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000221d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000221e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000221f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00022200: 696d 706f 7274 2073 6561 626f 726e 2061  import seaborn a
+00022210: 7320 736e 730a 696d 706f 7274 206d 6174  s sns.import mat
+00022220: 706c 6f74 6c69 622e 7079 706c 6f74 2061  plotlib.pyplot a
+00022230: 7320 706c 740a 6672 6f6d 2061 646a 7573  s plt.from adjus
+00022240: 7454 6578 7420 696d 706f 7274 2061 646a  tText import adj
+00022250: 7573 745f 7465 7874 0a0a 696d 706f 7274  ust_text..import
+00022260: 2074 6578 7477 7261 700a 696d 706f 7274   textwrap.import
+00022270: 206e 756d 7079 2061 7320 6e70 0a69 6d70   numpy as np.imp
+00022280: 6f72 7420 7061 6e64 6173 2061 7320 7064  ort pandas as pd
+00022290: 0a0a 0a69 6d70 6f72 7420 706c 6f74 6c79  ...import plotly
+000222a0: 2e67 7261 7068 5f6f 626a 6563 7473 2061  .graph_objects a
+000222b0: 7320 676f 0a66 726f 6d20 706c 6f74 6c79  s go.from plotly
+000222c0: 2e73 7562 706c 6f74 7320 696d 706f 7274  .subplots import
+000222d0: 206d 616b 655f 7375 6270 6c6f 7473 0a69   make_subplots.i
+000222e0: 6d70 6f72 7420 7374 7265 616d 6c69 7420  mport streamlit 
+000222f0: 6173 2073 740a 6672 6f6d 202e 7574 696c  as st.from .util
+00022300: 7320 696d 706f 7274 2069 735f 6a75 7079  s import is_jupy
+00022310: 7465 725f 6e6f 7465 626f 6f6b 0a0a 636c  ter_notebook..cl
+00022320: 6173 7320 5669 7375 616c 697a 6572 3a0a  ass Visualizer:.
+00022330: 2020 2020 2222 2220 5669 7375 616c 697a      """ Visualiz
+00022340: 6572 2063 6c61 7373 2066 6f72 2070 6c6f  er class for plo
+00022350: 7474 696e 672e 2222 220a 0a20 2020 2064  tting."""..    d
+00022360: 6566 205f 5f69 6e69 745f 5f28 7365 6c66  ef __init__(self
+00022370: 293a 0a20 2020 2020 2020 2070 6173 730a  ):.        pass.
+00022380: 0a20 2020 2064 6566 2076 6f6c 6361 6e6f  .    def volcano
+00022390: 5f70 6c6f 7428 7365 6c66 2c20 6e5f 726f  _plot(self, n_ro
+000223a0: 7773 2c20 6e5f 636f 6c73 2c20 6765 6e65  ws, n_cols, gene
+000223b0: 5f6c 6973 743d 4e6f 6e65 2c20 6669 6773  _list=None, figs
+000223c0: 697a 6520 3d20 2838 2c38 292c 2073 6176  ize = (8,8), sav
+000223d0: 6566 6967 203d 2046 616c 7365 2c20 7570  efig = False, up
+000223e0: 7065 725f 6663 5f63 7574 6f66 6620 3d20  per_fc_cutoff = 
+000223f0: 312c 206c 6f77 6572 5f66 635f 6375 746f  1, lower_fc_cuto
+00022400: 6666 203d 2031 2c0a 2020 2020 2020 2020  ff = 1,.        
+00022410: 2020 2020 2020 2020 2061 6e6e 6f74 203d           annot =
+00022420: 204e 6f6e 652c 2067 656e 655f 636f 6c75   None, gene_colu
+00022430: 6d6e 203d 2027 4765 6e65 7327 2c20 7176  mn = 'Genes', qv
+00022440: 616c 7565 3d54 7275 6529 3a0a 2020 2020  alue=True):.    
+00022450: 0a20 2020 2020 2020 2022 2222 506c 6f74  .        """Plot
+00022460: 2061 2076 6f6c 6361 6e6f 2070 6c6f 742e   a volcano plot.
+00022470: 0a0a 2020 2020 2020 2020 5061 7261 6d65  ..        Parame
+00022480: 7465 7273 0a20 2020 2020 2020 202d 2d2d  ters.        ---
+00022490: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+000224a0: 6e5f 726f 7773 203a 2069 6e74 0a20 2020  n_rows : int.   
+000224b0: 2020 2020 2020 2020 206e 756d 6265 7220           number 
+000224c0: 6f66 2072 6f77 7320 666f 7220 7468 6520  of rows for the 
+000224d0: 7375 6270 6c6f 742e 0a20 2020 2020 2020  subplot..       
+000224e0: 206e 5f63 6f6c 7320 3a20 696e 740a 2020   n_cols : int.  
+000224f0: 2020 2020 2020 2020 2020 6e75 6d62 6572            number
+00022500: 206f 6620 636f 6c75 6d6e 7320 666f 7220   of columns for 
+00022510: 7468 6520 7375 6270 6c6f 742e 0a20 2020  the subplot..   
+00022520: 2020 2020 2067 656e 655f 6c69 7374 203a       gene_list :
+00022530: 206c 6973 740a 2020 2020 2020 2020 2020   list.          
+00022540: 2020 6e61 6d65 206f 6620 6765 6e65 7320    name of genes 
+00022550: 696e 2061 206c 6973 7420 666f 7220 616e  in a list for an
+00022560: 6e6f 7461 7469 6f6e 2069 6e20 766f 6c63  notation in volc
+00022570: 616e 6f20 706c 6f74 2028 4465 6661 756c  ano plot (Defaul
+00022580: 7420 7661 6c75 6520 3d20 4e6f 6e65 292e  t value = None).
+00022590: 0a20 2020 2020 2020 2066 6967 7369 7a65  .        figsize
+000225a0: 203a 0a20 2020 2020 2020 2020 2020 2066   :.            f
+000225b0: 6967 7572 6520 7369 7a65 2e20 2844 6566  igure size. (Def
+000225c0: 6175 6c74 2076 616c 7565 203d 2028 3829  ault value = (8)
+000225d0: 0a20 2020 2020 2020 2038 2920 3a0a 2020  .        8) :.  
+000225e0: 2020 2020 2020 2020 2020 0a20 2020 2020            .     
+000225f0: 2020 2073 6176 6566 6967 203a 2062 6f6f     savefig : boo
+00022600: 6c65 616e 0a20 2020 2020 2020 2020 2020  lean.           
+00022610: 2073 6176 6520 7468 6520 6669 6775 7265   save the figure
+00022620: 2e20 2844 6566 6175 6c74 2076 616c 7565  . (Default value
+00022630: 203d 2046 616c 7365 290a 2020 2020 2020   = False).      
+00022640: 2020 7570 7065 725f 6663 5f63 7574 6f66    upper_fc_cutof
+00022650: 6620 3a20 696e 7420 6f72 2066 6c6f 6174  f : int or float
+00022660: 0a20 2020 2020 2020 2020 2020 2053 6574  .            Set
+00022670: 2061 6e20 7570 7065 7220 666f 6c64 2063   an upper fold c
+00022680: 6861 6e67 6520 6375 746f 6666 2066 6f72  hange cutoff for
+00022690: 2061 6e6e 6f74 6174 696f 6e20 2844 6566   annotation (Def
+000226a0: 6175 6c74 2076 616c 7565 203d 2031 292e  ault value = 1).
+000226b0: 0a20 2020 2020 2020 206c 6f77 6572 5f66  .        lower_f
+000226c0: 635f 6375 746f 6666 203a 2069 6e74 206f  c_cutoff : int o
+000226d0: 7220 666c 6f61 740a 2020 2020 2020 2020  r float.        
+000226e0: 2020 2020 5365 7420 6120 6c6f 7765 7220      Set a lower 
+000226f0: 666f 6c64 2063 6861 6e67 6520 6375 746f  fold change cuto
+00022700: 6666 2066 6f72 2061 6e6e 6f74 6174 696f  ff for annotatio
+00022710: 6e20 2844 6566 6175 6c74 2076 616c 7565  n (Default value
+00022720: 203d 2031 292e 0a20 2020 2020 2020 2061   = 1)..        a
+00022730: 6e6e 6f74 203a 2073 7472 206f 7220 4e6f  nnot : str or No
+00022740: 6e65 7479 7065 0a20 2020 2020 2020 2020  netype.         
+00022750: 2020 2049 6620 616e 6e6f 7420 3d3d 2027     If annot == '
+00022760: 6663 5f63 7574 6f66 6627 2067 656e 6573  fc_cutoff' genes
+00022770: 2061 7265 2061 6e6e 6f74 6174 6564 2062   are annotated b
+00022780: 7920 666f 6c64 2063 6861 6e67 6520 6375  y fold change cu
+00022790: 746f 6666 2061 6e64 2067 656e 655f 6c69  toff and gene_li
+000227a0: 7374 2e0a 2020 2020 2020 2020 2020 2020  st..            
+000227b0: 4966 204e 6f6e 6520 6e6f 2061 6e6e 6f74  If None no annot
+000227c0: 6174 696f 6e20 6279 2066 6f6c 6420 6368  ation by fold ch
+000227d0: 616e 6765 2063 7574 6f66 6620 6973 2061  ange cutoff is a
+000227e0: 7070 6c69 6564 2c20 6f6e 6c79 2067 656e  pplied, only gen
+000227f0: 655f 6c69 7374 2e20 2844 6566 6175 6c74  e_list. (Default
+00022800: 2076 616c 7565 203d 204e 6f6e 6529 0a20   value = None). 
+00022810: 2020 2020 2020 2067 656e 655f 636f 6c75         gene_colu
+00022820: 6d6e 203a 2073 7472 696e 670a 2020 2020  mn : string.    
+00022830: 2020 2020 2020 2020 5768 6174 2063 6f6c          What col
+00022840: 756d 6e20 746f 2075 7365 2074 6865 2061  umn to use the a
+00022850: 6e6e 6f74 6174 696f 6e20 7769 7468 2028  nnotation with (
+00022860: 4465 6661 756c 7420 7661 6c75 6520 3d20  Default value = 
+00022870: 2747 656e 6573 2729 2e0a 2020 2020 2020  'Genes')..      
+00022880: 2020 7176 616c 7565 203a 2062 6f6f 6c65    qvalue : boole
+00022890: 616e 0a20 2020 2020 2020 2020 2020 2049  an.            I
+000228a0: 6620 7176 616c 7565 203d 3d20 5472 7565  f qvalue == True
+000228b0: 2074 6865 6e20 3525 2061 646a 7573 7465   then 5% adjuste
+000228c0: 6420 702d 7661 6c75 6520 6375 746f 6666  d p-value cutoff
+000228d0: 2069 7320 7573 6564 2e0a 2020 2020 2020   is used..      
+000228e0: 2020 2020 2020 456c 7365 2c20 3525 2070        Else, 5% p
+000228f0: 2d76 616c 7565 2063 7574 6f66 6620 6973  -value cutoff is
+00022900: 2075 7365 6420 2844 6566 6175 6c74 2076   used (Default v
+00022910: 616c 7565 203d 2054 7275 6529 2e0a 0a20  alue = True)... 
+00022920: 2020 2020 2020 2052 6574 7572 6e73 0a20         Returns. 
+00022930: 2020 2020 2020 202d 2d2d 2d2d 2d2d 0a0a         -------..
+00022940: 2020 2020 2020 2020 0a20 2020 2020 2020          .       
+00022950: 2022 2222 0a20 2020 2020 2020 2066 6967   """.        fig
+00022960: 2c20 6178 203d 2070 6c74 2e73 7562 706c  , ax = plt.subpl
+00022970: 6f74 7328 6e5f 726f 7773 2c20 6e5f 636f  ots(n_rows, n_co
+00022980: 6c73 2c20 6669 6773 697a 6520 3d20 6669  ls, figsize = fi
+00022990: 6773 697a 6529 0a0a 2020 2020 2020 2020  gsize)..        
+000229a0: 666f 7220 692c 2061 7865 7320 696e 207a  for i, axes in z
+000229b0: 6970 2873 656c 662e 6663 5f64 6174 612e  ip(self.fc_data.
+000229c0: 7365 6c65 6374 5f64 7479 7065 7328 2766  select_dtypes('f
+000229d0: 6c6f 6174 2729 2e63 6f6c 756d 6e73 2c20  loat').columns, 
+000229e0: 6e70 2e61 7272 6179 2861 7829 2e66 6c61  np.array(ax).fla
+000229f0: 7474 656e 2829 293a 0a20 2020 2020 2020  tten()):.       
+00022a00: 2020 2020 200a 2020 2020 2020 2020 2020       .          
+00022a10: 2020 6966 2071 7661 6c75 6520 6973 2054    if qvalue is T
+00022a20: 7275 653a 0a0a 2020 2020 2020 2020 2020  rue:..          
+00022a30: 2020 2020 2020 6966 2028 7365 6c66 2e71        if (self.q
+00022a40: 765f 6461 7461 5b69 5d20 3c20 302e 3035  v_data[i] < 0.05
+00022a50: 292e 7375 6d28 2920 3d3d 2030 3a0a 0a20  ).sum() == 0:.. 
+00022a60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022a70: 2020 2073 6e73 2e73 6361 7474 6572 706c     sns.scatterpl
+00022a80: 6f74 2878 203d 2073 656c 662e 6663 5f64  ot(x = self.fc_d
+00022a90: 6174 615b 695d 2c20 7920 3d20 7365 6c66  ata[i], y = self
+00022aa0: 2e70 765f 6461 7461 5b69 5d2c 2063 6f6c  .pv_data[i], col
+00022ab0: 6f72 203d 2027 6c69 6768 7467 7265 7927  or = 'lightgrey'
+00022ac0: 2c20 616c 7068 6120 3d20 302e 352c 2061  , alpha = 0.5, a
+00022ad0: 783d 6178 6573 290a 2020 2020 2020 2020  x=axes).        
+00022ae0: 2020 2020 2020 2020 2020 2020 736e 732e              sns.
+00022af0: 7363 6174 7465 7270 6c6f 7428 7820 3d20  scatterplot(x = 
+00022b00: 7365 6c66 2e66 635f 6461 7461 5b73 656c  self.fc_data[sel
+00022b10: 662e 7076 5f64 6174 612e 7365 6c65 6374  f.pv_data.select
+00022b20: 5f64 7479 7065 7328 2766 6c6f 6174 2729  _dtypes('float')
+00022b30: 203e 2031 2e33 5d5b 695d 2c0a 2020 2020   > 1.3][i],.    
+00022b40: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00022b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022b60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022b70: 2020 2873 656c 662e 7076 5f64 6174 615b    (self.pv_data[
-00022b80: 695d 203e 312e 3329 5d2e 696e 6465 780a  i] >1.3)].index.
-00022b90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00022ba0: 2020 2020 2020 2020 2061 7865 732e 6178           axes.ax
-00022bb0: 766c 696e 6528 6c6f 7765 725f 6663 5f63  vline(lower_fc_c
-00022bc0: 7574 6f66 662c 206c 7320 3d20 272d 2d27  utoff, ls = '--'
-00022bd0: 2c20 636f 6c6f 7220 3d20 276c 6967 6874  , color = 'light
-00022be0: 6772 6579 2729 0a20 2020 2020 2020 2020  grey').         
-00022bf0: 2020 2020 2020 2020 2020 2020 2020 2061                 a
-00022c00: 7865 732e 6178 766c 696e 6528 7570 7065  xes.axvline(uppe
-00022c10: 725f 6663 5f63 7574 6f66 662c 206c 7320  r_fc_cutoff, ls 
-00022c20: 3d20 272d 2d27 2c20 636f 6c6f 7220 3d20  = '--', color = 
-00022c30: 276c 6967 6874 6772 6579 2729 0a20 2020  'lightgrey').   
-00022c40: 2020 2020 2020 2020 2020 2020 200a 2020               .  
-00022c50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022c60: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+00022b60: 7920 3d20 7365 6c66 2e70 765f 6461 7461  y = self.pv_data
+00022b70: 5b73 656c 662e 7076 5f64 6174 612e 7365  [self.pv_data.se
+00022b80: 6c65 6374 5f64 7479 7065 7328 2766 6c6f  lect_dtypes('flo
+00022b90: 6174 2729 203e 2031 2e33 5d5b 695d 2c20  at') > 1.3][i], 
+00022ba0: 636f 6c6f 7220 3d20 736e 732e 636f 6c6f  color = sns.colo
+00022bb0: 725f 7061 6c65 7474 6528 2264 6565 7022  r_palette("deep"
+00022bc0: 2c20 3230 295b 315d 2c20 6178 3d61 7865  , 20)[1], ax=axe
+00022bd0: 7329 0a20 2020 2020 2020 2020 2020 2020  s).             
+00022be0: 2020 2020 2020 2073 6e73 2e73 6361 7474         sns.scatt
+00022bf0: 6572 706c 6f74 2878 203d 2073 656c 662e  erplot(x = self.
+00022c00: 6663 5f64 6174 615b 2873 656c 662e 7076  fc_data[(self.pv
+00022c10: 5f64 6174 612e 7365 6c65 6374 5f64 7479  _data.select_dty
+00022c20: 7065 7328 2766 6c6f 6174 2729 203e 2031  pes('float') > 1
+00022c30: 2e33 2920 2620 2873 656c 662e 6663 5f64  .3) & (self.fc_d
+00022c40: 6174 612e 7365 6c65 6374 5f64 7479 7065  ata.select_dtype
+00022c50: 7328 2766 6c6f 6174 2729 203c 2030 295d  s('float') < 0)]
+00022c60: 5b69 5d2c 0a20 2020 2020 2020 2020 2020  [i],.           
 00022c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022c80: 696e 6469 6365 7320 3d20 7365 6c66 2e66  indices = self.f
-00022c90: 635f 6461 7461 5b73 656c 662e 6663 5f64  c_data[self.fc_d
-00022ca0: 6174 615b 6765 6e65 5f63 6f6c 756d 6e5d  ata[gene_column]
-00022cb0: 2e69 7369 6e28 6765 6e65 5f6c 6973 7429  .isin(gene_list)
-00022cc0: 5d2e 696e 6465 780a 0a20 2020 2020 2020  ].index..       
-00022cd0: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
-00022ce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022cf0: 2020 2073 6e73 2e73 6361 7474 6572 706c     sns.scatterpl
-00022d00: 6f74 2878 203d 2073 656c 662e 6663 5f64  ot(x = self.fc_d
-00022d10: 6174 615b 695d 2c20 7920 3d20 7365 6c66  ata[i], y = self
-00022d20: 2e70 765f 6461 7461 5b69 5d2c 2063 6f6c  .pv_data[i], col
-00022d30: 6f72 203d 2027 6c69 6768 7467 7265 7927  or = 'lightgrey'
-00022d40: 2c20 616c 7068 6120 3d20 302e 352c 2061  , alpha = 0.5, a
-00022d50: 783d 6178 6573 290a 2020 2020 2020 2020  x=axes).        
-00022d60: 2020 2020 2020 2020 2020 2020 736e 732e              sns.
-00022d70: 7363 6174 7465 7270 6c6f 7428 7820 3d20  scatterplot(x = 
-00022d80: 7365 6c66 2e66 635f 6461 7461 5b73 656c  self.fc_data[sel
-00022d90: 662e 7176 5f64 6174 612e 7365 6c65 6374  f.qv_data.select
-00022da0: 5f64 7479 7065 7328 2766 6c6f 6174 2729  _dtypes('float')
-00022db0: 203c 2030 2e30 355d 5b69 5d2c 0a20 2020   < 0.05][i],.   
-00022dc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022de0: 2079 203d 2073 656c 662e 7076 5f64 6174   y = self.pv_dat
-00022df0: 615b 7365 6c66 2e71 765f 6461 7461 2e73  a[self.qv_data.s
-00022e00: 656c 6563 745f 6474 7970 6573 2827 666c  elect_dtypes('fl
-00022e10: 6f61 7427 2920 3c20 302e 3035 5d5b 695d  oat') < 0.05][i]
-00022e20: 2c20 636f 6c6f 7220 3d20 276c 6967 6874  , color = 'light
-00022e30: 636f 7261 6c27 2c20 6178 3d61 7865 7329  coral', ax=axes)
-00022e40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00022e50: 2020 2020 2073 6e73 2e73 6361 7474 6572       sns.scatter
-00022e60: 706c 6f74 2878 203d 2073 656c 662e 6663  plot(x = self.fc
-00022e70: 5f64 6174 615b 2873 656c 662e 7176 5f64  _data[(self.qv_d
-00022e80: 6174 612e 7365 6c65 6374 5f64 7479 7065  ata.select_dtype
-00022e90: 7328 2766 6c6f 6174 2729 203c 2030 2e30  s('float') < 0.0
-00022ea0: 3529 2026 2028 7365 6c66 2e66 635f 6461  5) & (self.fc_da
-00022eb0: 7461 2e73 656c 6563 745f 6474 7970 6573  ta.select_dtypes
-00022ec0: 2827 666c 6f61 7427 2920 3c20 3029 5d5b  ('float') < 0)][
-00022ed0: 695d 2c0a 2020 2020 2020 2020 2020 2020  i],.            
-00022ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022ef0: 2020 2020 2020 2020 7920 3d20 7365 6c66          y = self
-00022f00: 2e70 765f 6461 7461 5b28 7365 6c66 2e71  .pv_data[(self.q
-00022f10: 765f 6461 7461 2e73 656c 6563 745f 6474  v_data.select_dt
-00022f20: 7970 6573 2827 666c 6f61 7427 2920 3c20  ypes('float') < 
-00022f30: 302e 3035 2920 2620 2873 656c 662e 6663  0.05) & (self.fc
-00022f40: 5f64 6174 612e 7365 6c65 6374 5f64 7479  _data.select_dty
-00022f50: 7065 7328 2766 6c6f 6174 2729 203c 2030  pes('float') < 0
-00022f60: 295d 5b69 5d2c 0a20 2020 2020 2020 2020  )][i],.         
-00022f70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022f80: 2020 2020 2020 2020 2020 2063 6f6c 6f72             color
-00022f90: 203d 2027 636f 726e 666c 6f77 6572 626c   = 'cornflowerbl
-00022fa0: 7565 272c 2061 783d 6178 6573 290a 2020  ue', ax=axes).  
-00022fb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022fc0: 2020 0a20 2020 2020 2020 2020 2020 2020    .             
-00022fd0: 2020 2020 2020 2061 7865 732e 7365 7428         axes.set(
-00022fe0: 786c 6162 656c 3d66 276c 6f67 3220 666f  xlabel=f'log2 fo
-00022ff0: 6c64 2063 6861 6e67 6520 287b 697d 2927  ld change ({i})'
-00023000: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00023010: 2020 2020 2020 2020 2020 2020 2020 2079                 y
-00023020: 6c61 6265 6c3d 6627 2d6c 6f67 3130 2070  label=f'-log10 p
-00023030: 2d76 616c 7565 2028 7b69 7d29 2729 0a20  -value ({i})'). 
-00023040: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023050: 2020 200a 2020 2020 2020 2020 2020 2020     .            
-00023060: 2020 2020 2020 2020 2320 7365 7420 712d          # set q-
-00023070: 7661 6c75 6520 7468 7265 7368 6f6c 640a  value threshold.
-00023080: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023090: 2020 2020 7468 7265 7368 6f6c 6420 3d20      threshold = 
-000230a0: 7365 6c66 2e70 765f 6461 7461 5b73 656c  self.pv_data[sel
-000230b0: 662e 7176 5f64 6174 615b 695d 203c 2030  f.qv_data[i] < 0
-000230c0: 2e30 355d 5b69 5d2e 736f 7274 5f76 616c  .05][i].sort_val
-000230d0: 7565 7328 292e 7661 6c75 6573 5b30 5d0a  ues().values[0].
+00022c80: 2020 2020 2020 2020 2079 203d 2073 656c           y = sel
+00022c90: 662e 7076 5f64 6174 615b 2873 656c 662e  f.pv_data[(self.
+00022ca0: 7076 5f64 6174 612e 7365 6c65 6374 5f64  pv_data.select_d
+00022cb0: 7479 7065 7328 2766 6c6f 6174 2729 203e  types('float') >
+00022cc0: 2031 2e33 2920 2620 2873 656c 662e 6663   1.3) & (self.fc
+00022cd0: 5f64 6174 612e 7365 6c65 6374 5f64 7479  _data.select_dty
+00022ce0: 7065 7328 2766 6c6f 6174 2729 203c 2030  pes('float') < 0
+00022cf0: 295d 5b69 5d2c 0a20 2020 2020 2020 2020  )][i],.         
+00022d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022d10: 2020 2020 2020 2020 2020 2063 6f6c 6f72             color
+00022d20: 203d 2073 6e73 2e63 6f6c 6f72 5f70 616c   = sns.color_pal
+00022d30: 6574 7465 2822 6465 6570 222c 2032 3029  ette("deep", 20)
+00022d40: 5b32 5d2c 2061 783d 6178 6573 290a 2020  [2], ax=axes).  
+00022d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022d60: 2020 0a20 2020 2020 2020 2020 2020 2020    .             
+00022d70: 2020 2020 2020 2061 7865 732e 7365 7428         axes.set(
+00022d80: 786c 6162 656c 3d66 276c 6f67 3220 666f  xlabel=f'log2 fo
+00022d90: 6c64 2063 6861 6e67 6520 287b 697d 2927  ld change ({i})'
+00022da0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00022db0: 2020 2020 2020 2020 2020 2020 2020 2079                 y
+00022dc0: 6c61 6265 6c3d 6627 2d6c 6f67 3130 2070  label=f'-log10 p
+00022dd0: 2d76 616c 7565 2028 7b69 7d29 2729 0a20  -value ({i})'). 
+00022de0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022df0: 2020 200a 2020 2020 2020 2020 2020 2020     .            
+00022e00: 2020 2020 2020 2020 2320 7365 7420 702d          # set p-
+00022e10: 7661 6c75 6520 7468 7265 7368 6f6c 6420  value threshold 
+00022e20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00022e30: 2020 2020 2061 7865 732e 6178 686c 696e       axes.axhlin
+00022e40: 6528 312e 332c 6c73 203d 2027 2d2d 272c  e(1.3,ls = '--',
+00022e50: 2063 6f6c 6f72 203d 2027 6c69 6768 7467   color = 'lightg
+00022e60: 7265 7927 290a 0a20 2020 2020 2020 2020  rey')..         
+00022e70: 2020 2020 2020 2020 2020 2069 6620 616e             if an
+00022e80: 6e6f 7420 3d3d 2027 6663 5f63 7574 6f66  not == 'fc_cutof
+00022e90: 6627 3a0a 2020 2020 2020 2020 2020 2020  f':.            
+00022ea0: 2020 2020 2020 2020 2020 2020 696e 6469              indi
+00022eb0: 6365 7320 3d20 7365 6c66 2e66 635f 6461  ces = self.fc_da
+00022ec0: 7461 5b28 2873 656c 662e 6663 5f64 6174  ta[((self.fc_dat
+00022ed0: 615b 695d 203c 206c 6f77 6572 5f66 635f  a[i] < lower_fc_
+00022ee0: 6375 746f 6666 2920 7c20 0a20 2020 2020  cutoff) | .     
+00022ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022f00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022f10: 2020 2020 2020 2020 2020 2028 7365 6c66             (self
+00022f20: 2e66 635f 6461 7461 5b69 5d20 3e20 7570  .fc_data[i] > up
+00022f30: 7065 725f 6663 5f63 7574 6f66 6629 2920  per_fc_cutoff)) 
+00022f40: 260a 2020 2020 2020 2020 2020 2020 2020  &.              
+00022f50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022f60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022f70: 2020 2873 656c 662e 7076 5f64 6174 615b    (self.pv_data[
+00022f80: 695d 203e 312e 3329 5d2e 696e 6465 780a  i] >1.3)].index.
+00022f90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00022fa0: 2020 2020 2020 2020 2061 7865 732e 6178           axes.ax
+00022fb0: 766c 696e 6528 6c6f 7765 725f 6663 5f63  vline(lower_fc_c
+00022fc0: 7574 6f66 662c 206c 7320 3d20 272d 2d27  utoff, ls = '--'
+00022fd0: 2c20 636f 6c6f 7220 3d20 276c 6967 6874  , color = 'light
+00022fe0: 6772 6579 2729 0a20 2020 2020 2020 2020  grey').         
+00022ff0: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+00023000: 7865 732e 6178 766c 696e 6528 7570 7065  xes.axvline(uppe
+00023010: 725f 6663 5f63 7574 6f66 662c 206c 7320  r_fc_cutoff, ls 
+00023020: 3d20 272d 2d27 2c20 636f 6c6f 7220 3d20  = '--', color = 
+00023030: 276c 6967 6874 6772 6579 2729 0a20 2020  'lightgrey').   
+00023040: 2020 2020 2020 2020 2020 2020 200a 2020               .  
+00023050: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023060: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+00023070: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023080: 696e 6469 6365 7320 3d20 7365 6c66 2e66  indices = self.f
+00023090: 635f 6461 7461 5b73 656c 662e 6663 5f64  c_data[self.fc_d
+000230a0: 6174 615b 6765 6e65 5f63 6f6c 756d 6e5d  ata[gene_column]
+000230b0: 2e69 7369 6e28 6765 6e65 5f6c 6973 7429  .isin(gene_list)
+000230c0: 5d2e 696e 6465 780a 0a20 2020 2020 2020  ].index..       
+000230d0: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
 000230e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000230f0: 2020 2020 6178 6573 2e61 7868 6c69 6e65      axes.axhline
-00023100: 2874 6872 6573 686f 6c64 2c20 6c73 203d  (threshold, ls =
-00023110: 2027 2d2d 272c 2063 6f6c 6f72 203d 2027   '--', color = '
-00023120: 6c69 6768 7467 7265 7927 290a 0a20 2020  lightgrey')..   
-00023130: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023140: 2069 6620 616e 6e6f 7420 3d3d 2027 6663   if annot == 'fc
-00023150: 5f63 7574 6f66 6627 3a0a 2020 2020 2020  _cutoff':.      
-00023160: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023170: 2020 696e 6469 6365 7320 3d20 7365 6c66    indices = self
-00023180: 2e66 635f 6461 7461 5b28 2873 656c 662e  .fc_data[((self.
-00023190: 6663 5f64 6174 615b 695d 203c 206c 6f77  fc_data[i] < low
-000231a0: 6572 5f66 635f 6375 746f 6666 2920 7c0a  er_fc_cutoff) |.
-000231b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000230f0: 2020 2073 6e73 2e73 6361 7474 6572 706c     sns.scatterpl
+00023100: 6f74 2878 203d 2073 656c 662e 6663 5f64  ot(x = self.fc_d
+00023110: 6174 615b 695d 2c20 7920 3d20 7365 6c66  ata[i], y = self
+00023120: 2e70 765f 6461 7461 5b69 5d2c 2063 6f6c  .pv_data[i], col
+00023130: 6f72 203d 2027 6c69 6768 7467 7265 7927  or = 'lightgrey'
+00023140: 2c20 616c 7068 6120 3d20 302e 352c 2061  , alpha = 0.5, a
+00023150: 783d 6178 6573 290a 2020 2020 2020 2020  x=axes).        
+00023160: 2020 2020 2020 2020 2020 2020 736e 732e              sns.
+00023170: 7363 6174 7465 7270 6c6f 7428 7820 3d20  scatterplot(x = 
+00023180: 7365 6c66 2e66 635f 6461 7461 5b73 656c  self.fc_data[sel
+00023190: 662e 7176 5f64 6174 612e 7365 6c65 6374  f.qv_data.select
+000231a0: 5f64 7479 7065 7328 2766 6c6f 6174 2729  _dtypes('float')
+000231b0: 203c 2030 2e30 355d 5b69 5d2c 0a20 2020   < 0.05][i],.   
 000231c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000231d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000231e0: 2873 656c 662e 6663 5f64 6174 615b 695d  (self.fc_data[i]
-000231f0: 203e 2075 7070 6572 5f66 635f 6375 746f   > upper_fc_cuto
-00023200: 6666 2929 2026 0a20 2020 2020 2020 2020  ff)) &.         
-00023210: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023220: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023230: 2020 2020 2020 2028 7365 6c66 2e71 765f         (self.qv_
-00023240: 6461 7461 5b69 5d20 3c30 2e30 3529 5d2e  data[i] <0.05)].
-00023250: 696e 6465 780a 2020 2020 2020 2020 2020  index.          
-00023260: 2020 2020 2020 2020 2020 2020 2020 6178                ax
-00023270: 6573 2e61 7876 6c69 6e65 286c 6f77 6572  es.axvline(lower
-00023280: 5f66 635f 6375 746f 6666 2c20 6c73 203d  _fc_cutoff, ls =
-00023290: 2027 2d2d 272c 2063 6f6c 6f72 203d 2027   '--', color = '
-000232a0: 6c69 6768 7467 7265 7927 290a 2020 2020  lightgrey').    
-000232b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000232c0: 2020 2020 6178 6573 2e61 7876 6c69 6e65      axes.axvline
-000232d0: 2875 7070 6572 5f66 635f 6375 746f 6666  (upper_fc_cutoff
-000232e0: 2c20 6c73 203d 2027 2d2d 272c 2063 6f6c  , ls = '--', col
-000232f0: 6f72 203d 2027 6c69 6768 7467 7265 7927  or = 'lightgrey'
-00023300: 290a 0a20 2020 2020 2020 2020 2020 2020  )..             
-00023310: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-00023320: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023330: 2020 2020 2069 6e64 6963 6573 203d 2073       indices = s
-00023340: 656c 662e 6663 5f64 6174 615b 7365 6c66  elf.fc_data[self
-00023350: 2e66 635f 6461 7461 5b67 656e 655f 636f  .fc_data[gene_co
-00023360: 6c75 6d6e 5d2e 6973 696e 2867 656e 655f  lumn].isin(gene_
-00023370: 6c69 7374 295d 2e69 6e64 6578 0a0a 2020  list)].index..  
-00023380: 2020 2020 2020 2020 2020 6966 2071 7661            if qva
-00023390: 6c75 6520 6973 2046 616c 7365 3a0a 2020  lue is False:.  
-000233a0: 2020 2020 2020 2020 2020 2020 2020 736e                sn
-000233b0: 732e 7363 6174 7465 7270 6c6f 7428 7820  s.scatterplot(x 
-000233c0: 3d20 7365 6c66 2e66 635f 6461 7461 5b69  = self.fc_data[i
-000233d0: 5d2c 2079 203d 2073 656c 662e 7076 5f64  ], y = self.pv_d
-000233e0: 6174 615b 695d 2c20 636f 6c6f 7220 3d20  ata[i], color = 
-000233f0: 276c 6967 6874 6772 6579 272c 2061 6c70  'lightgrey', alp
-00023400: 6861 203d 2030 2e35 2c20 6178 3d61 7865  ha = 0.5, ax=axe
-00023410: 7329 0a20 2020 2020 2020 2020 2020 2020  s).             
-00023420: 2020 2073 6e73 2e73 6361 7474 6572 706c     sns.scatterpl
-00023430: 6f74 2878 203d 2073 656c 662e 6663 5f64  ot(x = self.fc_d
-00023440: 6174 615b 7365 6c66 2e70 765f 6461 7461  ata[self.pv_data
-00023450: 2e73 656c 6563 745f 6474 7970 6573 2827  .select_dtypes('
-00023460: 666c 6f61 7427 2920 3e20 312e 335d 5b69  float') > 1.3][i
-00023470: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
+000231e0: 2079 203d 2073 656c 662e 7076 5f64 6174   y = self.pv_dat
+000231f0: 615b 7365 6c66 2e71 765f 6461 7461 2e73  a[self.qv_data.s
+00023200: 656c 6563 745f 6474 7970 6573 2827 666c  elect_dtypes('fl
+00023210: 6f61 7427 2920 3c20 302e 3035 5d5b 695d  oat') < 0.05][i]
+00023220: 2c20 636f 6c6f 7220 3d20 276c 6967 6874  , color = 'light
+00023230: 636f 7261 6c27 2c20 6178 3d61 7865 7329  coral', ax=axes)
+00023240: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00023250: 2020 2020 2073 6e73 2e73 6361 7474 6572       sns.scatter
+00023260: 706c 6f74 2878 203d 2073 656c 662e 6663  plot(x = self.fc
+00023270: 5f64 6174 615b 2873 656c 662e 7176 5f64  _data[(self.qv_d
+00023280: 6174 612e 7365 6c65 6374 5f64 7479 7065  ata.select_dtype
+00023290: 7328 2766 6c6f 6174 2729 203c 2030 2e30  s('float') < 0.0
+000232a0: 3529 2026 2028 7365 6c66 2e66 635f 6461  5) & (self.fc_da
+000232b0: 7461 2e73 656c 6563 745f 6474 7970 6573  ta.select_dtypes
+000232c0: 2827 666c 6f61 7427 2920 3c20 3029 5d5b  ('float') < 0)][
+000232d0: 695d 2c0a 2020 2020 2020 2020 2020 2020  i],.            
+000232e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000232f0: 2020 2020 2020 2020 7920 3d20 7365 6c66          y = self
+00023300: 2e70 765f 6461 7461 5b28 7365 6c66 2e71  .pv_data[(self.q
+00023310: 765f 6461 7461 2e73 656c 6563 745f 6474  v_data.select_dt
+00023320: 7970 6573 2827 666c 6f61 7427 2920 3c20  ypes('float') < 
+00023330: 302e 3035 2920 2620 2873 656c 662e 6663  0.05) & (self.fc
+00023340: 5f64 6174 612e 7365 6c65 6374 5f64 7479  _data.select_dty
+00023350: 7065 7328 2766 6c6f 6174 2729 203c 2030  pes('float') < 0
+00023360: 295d 5b69 5d2c 0a20 2020 2020 2020 2020  )][i],.         
+00023370: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023380: 2020 2020 2020 2020 2020 2063 6f6c 6f72             color
+00023390: 203d 2027 636f 726e 666c 6f77 6572 626c   = 'cornflowerbl
+000233a0: 7565 272c 2061 783d 6178 6573 290a 2020  ue', ax=axes).  
+000233b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000233c0: 2020 0a20 2020 2020 2020 2020 2020 2020    .             
+000233d0: 2020 2020 2020 2061 7865 732e 7365 7428         axes.set(
+000233e0: 786c 6162 656c 3d66 276c 6f67 3220 666f  xlabel=f'log2 fo
+000233f0: 6c64 2063 6861 6e67 6520 287b 697d 2927  ld change ({i})'
+00023400: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00023410: 2020 2020 2020 2020 2020 2020 2020 2079                 y
+00023420: 6c61 6265 6c3d 6627 2d6c 6f67 3130 2070  label=f'-log10 p
+00023430: 2d76 616c 7565 2028 7b69 7d29 2729 0a20  -value ({i})'). 
+00023440: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023450: 2020 200a 2020 2020 2020 2020 2020 2020     .            
+00023460: 2020 2020 2020 2020 2320 7365 7420 712d          # set q-
+00023470: 7661 6c75 6520 7468 7265 7368 6f6c 640a  value threshold.
 00023480: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023490: 2020 2079 203d 2073 656c 662e 7076 5f64     y = self.pv_d
-000234a0: 6174 615b 7365 6c66 2e70 765f 6461 7461  ata[self.pv_data
-000234b0: 2e73 656c 6563 745f 6474 7970 6573 2827  .select_dtypes('
-000234c0: 666c 6f61 7427 2920 3e20 312e 335d 5b69  float') > 1.3][i
-000234d0: 5d2c 2063 6f6c 6f72 203d 2073 6e73 2e63  ], color = sns.c
-000234e0: 6f6c 6f72 5f70 616c 6574 7465 2822 6465  olor_palette("de
-000234f0: 6570 222c 2032 3029 5b31 5d2c 2061 783d  ep", 20)[1], ax=
-00023500: 6178 6573 290a 2020 2020 2020 2020 2020  axes).          
-00023510: 2020 2020 2020 736e 732e 7363 6174 7465        sns.scatte
-00023520: 7270 6c6f 7428 7820 3d20 7365 6c66 2e66  rplot(x = self.f
-00023530: 635f 6461 7461 5b28 7365 6c66 2e70 765f  c_data[(self.pv_
-00023540: 6461 7461 2e73 656c 6563 745f 6474 7970  data.select_dtyp
-00023550: 6573 2827 666c 6f61 7427 2920 3e20 312e  es('float') > 1.
-00023560: 3329 2026 2028 7365 6c66 2e66 635f 6461  3) & (self.fc_da
-00023570: 7461 2e73 656c 6563 745f 6474 7970 6573  ta.select_dtypes
-00023580: 2827 666c 6f61 7427 2920 3c20 3029 5d5b  ('float') < 0)][
-00023590: 695d 2c0a 2020 2020 2020 2020 2020 2020  i],.            
-000235a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000235b0: 2020 2020 7920 3d20 7365 6c66 2e70 765f      y = self.pv_
-000235c0: 6461 7461 5b28 7365 6c66 2e70 765f 6461  data[(self.pv_da
-000235d0: 7461 2e73 656c 6563 745f 6474 7970 6573  ta.select_dtypes
-000235e0: 2827 666c 6f61 7427 2920 3e20 312e 3329  ('float') > 1.3)
-000235f0: 2026 2028 7365 6c66 2e66 635f 6461 7461   & (self.fc_data
-00023600: 2e73 656c 6563 745f 6474 7970 6573 2827  .select_dtypes('
-00023610: 666c 6f61 7427 2920 3c20 3029 5d5b 695d  float') < 0)][i]
-00023620: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00023630: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023640: 2020 636f 6c6f 7220 3d20 736e 732e 636f    color = sns.co
-00023650: 6c6f 725f 7061 6c65 7474 6528 2264 6565  lor_palette("dee
-00023660: 7022 2c20 3230 295b 325d 2c20 6178 3d61  p", 20)[2], ax=a
-00023670: 7865 7329 0a20 2020 2020 2020 2020 2020  xes).           
-00023680: 2020 2020 200a 2020 2020 2020 2020 2020       .          
-00023690: 2020 2020 2020 6178 6573 2e73 6574 2878        axes.set(x
-000236a0: 6c61 6265 6c3d 6627 6c6f 6732 2066 6f6c  label=f'log2 fol
-000236b0: 6420 6368 616e 6765 2028 7b69 7d29 272c  d change ({i})',
-000236c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000236d0: 2020 2020 2020 2020 2020 2020 2020 796c                yl
-000236e0: 6162 656c 3d66 272d 6c6f 6731 3020 702d  abel=f'-log10 p-
-000236f0: 7661 6c75 6520 287b 697d 2927 290a 2020  value ({i})').  
-00023700: 2020 2020 2020 2020 2020 2020 2020 0a20                . 
-00023710: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-00023720: 2073 6574 2070 2d76 616c 7565 2074 6872   set p-value thr
-00023730: 6573 686f 6c64 200a 2020 2020 2020 2020  eshold .        
-00023740: 2020 2020 2020 2020 6178 6573 2e61 7868          axes.axh
-00023750: 6c69 6e65 2831 2e33 2c6c 7320 3d20 272d  line(1.3,ls = '-
-00023760: 2d27 2c20 636f 6c6f 7220 3d20 276c 6967  -', color = 'lig
-00023770: 6874 6772 6579 2729 0a0a 2020 2020 2020  htgrey')..      
-00023780: 2020 2020 2020 2020 2020 6966 2061 6e6e            if ann
-00023790: 6f74 203d 3d20 2766 635f 6375 746f 6666  ot == 'fc_cutoff
-000237a0: 273a 0a20 2020 2020 2020 2020 2020 2020  ':.             
-000237b0: 2020 2020 2020 2069 6e64 6963 6573 203d         indices =
-000237c0: 2073 656c 662e 6663 5f64 6174 615b 2828   self.fc_data[((
-000237d0: 7365 6c66 2e66 635f 6461 7461 5b69 5d20  self.fc_data[i] 
-000237e0: 3c20 6c6f 7765 725f 6663 5f63 7574 6f66  < lower_fc_cutof
-000237f0: 6629 207c 0a20 2020 2020 2020 2020 2020  f) |.           
-00023800: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023810: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023820: 2028 7365 6c66 2e66 635f 6461 7461 5b69   (self.fc_data[i
-00023830: 5d20 3e20 7570 7065 725f 6663 5f63 7574  ] > upper_fc_cut
-00023840: 6f66 6629 207c 0a20 2020 2020 2020 2020  off) |.         
-00023850: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023860: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023870: 2020 2028 7365 6c66 2e66 635f 6461 7461     (self.fc_data
-00023880: 5b27 4765 6e65 7327 5d2e 6973 696e 2867  ['Genes'].isin(g
-00023890: 656e 655f 6c69 7374 2929 2920 260a 2020  ene_list))) &.  
-000238a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000238b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000238c0: 2020 2020 2020 2020 2020 2873 656c 662e            (self.
-000238d0: 7076 5f64 6174 615b 695d 203e 312e 3329  pv_data[i] >1.3)
-000238e0: 5d2e 696e 6465 780a 2020 2020 2020 2020  ].index.        
-000238f0: 2020 2020 2020 2020 2020 2020 6178 6573              axes
-00023900: 2e61 7876 6c69 6e65 286c 6f77 6572 5f66  .axvline(lower_f
-00023910: 635f 6375 746f 6666 2c20 6c73 203d 2027  c_cutoff, ls = '
-00023920: 2d2d 272c 2063 6f6c 6f72 203d 2027 6c69  --', color = 'li
-00023930: 6768 7467 7265 7927 290a 2020 2020 2020  ghtgrey').      
-00023940: 2020 2020 2020 2020 2020 2020 2020 6178                ax
-00023950: 6573 2e61 7876 6c69 6e65 2875 7070 6572  es.axvline(upper
-00023960: 5f66 635f 6375 746f 6666 2c20 6c73 203d  _fc_cutoff, ls =
-00023970: 2027 2d2d 272c 2063 6f6c 6f72 203d 2027   '--', color = '
-00023980: 6c69 6768 7467 7265 7927 290a 2020 2020  lightgrey').    
-00023990: 2020 2020 2020 2020 2020 2020 0a20 2020              .   
-000239a0: 2020 2020 2020 2020 2020 2020 2065 6c73               els
-000239b0: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-000239c0: 2020 2020 2020 2069 6e64 6963 6573 203d         indices =
-000239d0: 2073 656c 662e 6663 5f64 6174 615b 7365   self.fc_data[se
-000239e0: 6c66 2e66 635f 6461 7461 5b67 656e 655f  lf.fc_data[gene_
-000239f0: 636f 6c75 6d6e 5d2e 6973 696e 2867 656e  column].isin(gen
-00023a00: 655f 6c69 7374 295d 2e69 6e64 6578 0a0a  e_list)].index..
-00023a10: 2020 2020 2020 2020 2020 2020 6966 2067              if g
-00023a20: 656e 655f 6c69 7374 2069 7320 6e6f 7420  ene_list is not 
-00023a30: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
-00023a40: 2020 2020 2020 6765 6e65 735f 696e 6469        genes_indi
-00023a50: 6365 7320 3d20 7365 6c66 2e66 635f 6461  ces = self.fc_da
-00023a60: 7461 5b73 656c 662e 6663 5f64 6174 615b  ta[self.fc_data[
-00023a70: 6765 6e65 5f63 6f6c 756d 6e5d 2e69 7369  gene_column].isi
-00023a80: 6e28 6765 6e65 5f6c 6973 7429 5d2e 696e  n(gene_list)].in
-00023a90: 6465 780a 2020 2020 2020 2020 2020 2020  dex.            
-00023aa0: 2020 2020 0a20 2020 2020 2020 2020 2020      .           
-00023ab0: 2020 2020 2069 6620 696e 6469 6365 732e       if indices.
-00023ac0: 746f 6c69 7374 2829 3a0a 2020 2020 2020  tolist():.      
-00023ad0: 2020 2020 2020 2020 2020 2020 2020 696e                in
-00023ae0: 6469 6365 7320 3d20 696e 6469 6365 732e  dices = indices.
-00023af0: 746f 6c69 7374 2829 202b 2067 656e 6573  tolist() + genes
-00023b00: 5f69 6e64 6963 6573 2e74 6f6c 6973 7428  _indices.tolist(
-00023b10: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00023b20: 2020 2020 2020 0a20 2020 2020 2020 2020        .         
-00023b30: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-00023b40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023b50: 2069 6e64 6963 6573 203d 2067 656e 6573   indices = genes
-00023b60: 5f69 6e64 6963 6573 2e74 6f6c 6973 7428  _indices.tolist(
-00023b70: 290a 0a20 2020 2020 2020 2020 2020 2073  )..            s
-00023b80: 6e73 2e73 6361 7474 6572 706c 6f74 2878  ns.scatterplot(x
-00023b90: 203d 2073 656c 662e 6663 5f64 6174 612e   = self.fc_data.
-00023ba0: 6c6f 635b 696e 6469 6365 735d 5b69 5d2c  loc[indices][i],
-00023bb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00023bc0: 2020 2020 2020 2020 2020 2020 2079 203d               y =
-00023bd0: 2073 656c 662e 7076 5f64 6174 612e 6c6f   self.pv_data.lo
-00023be0: 635b 696e 6469 6365 735d 5b69 5d2c 0a20  c[indices][i],. 
-00023bf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023c00: 2020 2020 2020 2020 2020 2063 6f6c 6f72             color
-00023c10: 203d 2027 6c69 6768 7462 6c75 6527 2c0a   = 'lightblue',.
-00023c20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023c30: 2020 2020 2020 2020 2020 2020 6178 3d61              ax=a
-00023c40: 7865 7329 0a20 2020 2020 2020 2020 2020  xes).           
-00023c50: 2073 6e73 2e64 6573 7069 6e65 2829 0a0a   sns.despine()..
-00023c60: 2020 2020 2020 2020 2020 2020 2320 616e              # an
-00023c70: 6e6f 7461 7469 6f6e 0a20 2020 2020 2020  notation.       
-00023c80: 2020 2020 2069 6620 696e 6469 6365 733a       if indices:
-00023c90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00023ca0: 2074 6578 7473 203d 205b 6178 6573 2e74   texts = [axes.t
-00023cb0: 6578 7428 7365 6c66 2e66 635f 6461 7461  ext(self.fc_data
-00023cc0: 5b69 5d5b 6964 785d 2c20 7365 6c66 2e70  [i][idx], self.p
-00023cd0: 765f 6461 7461 5b69 5d5b 6964 785d 2c20  v_data[i][idx], 
-00023ce0: 7365 6c66 2e66 635f 6461 7461 5b67 656e  self.fc_data[gen
-00023cf0: 655f 636f 6c75 6d6e 5d5b 6964 785d 2c20  e_column][idx], 
-00023d00: 6861 3d27 6365 6e74 6572 272c 2076 613d  ha='center', va=
-00023d10: 2763 656e 7465 7227 2c20 666f 6e74 7369  'center', fontsi
-00023d20: 7a65 3d39 2920 666f 7220 6964 7820 696e  ze=9) for idx in
-00023d30: 2069 6e64 6963 6573 5d0a 2020 2020 2020   indices].      
-00023d40: 2020 2020 2020 2020 2020 6164 6a75 7374            adjust
-00023d50: 5f74 6578 7428 7465 7874 732c 2061 7272  _text(texts, arr
-00023d60: 6f77 7072 6f70 7320 3d20 6469 6374 2861  owprops = dict(a
-00023d70: 7272 6f77 7374 796c 6520 3d20 272d 272c  rrowstyle = '-',
-00023d80: 2063 6f6c 6f72 203d 2027 626c 6163 6b27   color = 'black'
-00023d90: 292c 2061 783d 6178 6573 290a 2020 2020  ), ax=axes).    
-00023da0: 2020 2020 2020 2020 0a20 2020 2020 2020          .       
-00023db0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-00023dc0: 2020 2020 2020 2020 2020 2070 6173 730a             pass.
-00023dd0: 2020 2020 2020 2020 2020 2020 0a20 2020              .   
-00023de0: 2020 2020 2020 2020 2073 616d 706c 655f           sample_
-00023df0: 616e 6e6f 7420 3d20 692e 7370 6c69 7428  annot = i.split(
-00023e00: 272f 2729 0a20 2020 2020 2020 2020 2020  '/').           
-00023e10: 2078 3120 3d20 7365 6c66 2e66 635f 6461   x1 = self.fc_da
-00023e20: 7461 5b69 5d2e 6d61 7828 290a 2020 2020  ta[i].max().    
-00023e30: 2020 2020 2020 2020 7832 203d 2073 656c          x2 = sel
-00023e40: 662e 6663 5f64 6174 615b 695d 2e6d 696e  f.fc_data[i].min
-00023e50: 2829 0a20 2020 2020 2020 2020 2020 2079  ().            y
-00023e60: 203d 2073 656c 662e 7076 5f64 6174 615b   = self.pv_data[
-00023e70: 695d 2e6d 6178 2829 0a0a 2020 2020 2020  i].max()..      
-00023e80: 2020 2020 2020 6178 6573 2e74 6578 7428        axes.text(
-00023e90: 7831 2c20 792c 2073 616d 706c 655f 616e  x1, y, sample_an
-00023ea0: 6e6f 745b 305d 2c20 666f 6e74 7369 7a65  not[0], fontsize
-00023eb0: 3d31 322c 0a20 2020 2020 2020 2020 2020  =12,.           
-00023ec0: 2020 2020 2020 2020 2062 626f 783d 6469           bbox=di
-00023ed0: 6374 2862 6f78 7374 796c 653d 2772 6f75  ct(boxstyle='rou
-00023ee0: 6e64 272c 2066 633d 2777 272c 2065 633d  nd', fc='w', ec=
-00023ef0: 2762 6c61 636b 272c 2061 6c70 6861 3d30  'black', alpha=0
-00023f00: 2e33 2929 0a20 2020 2020 2020 2020 2020  .3)).           
-00023f10: 2061 7865 732e 7465 7874 2878 322c 2079   axes.text(x2, y
-00023f20: 2c20 7361 6d70 6c65 5f61 6e6e 6f74 5b31  , sample_annot[1
-00023f30: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
-00023f40: 2020 2020 2020 2066 6f6e 7473 697a 653d         fontsize=
-00023f50: 3132 2c0a 2020 2020 2020 2020 2020 2020  12,.            
-00023f60: 2020 2020 2020 2020 6262 6f78 3d64 6963          bbox=dic
-00023f70: 7428 626f 7873 7479 6c65 3d27 726f 756e  t(boxstyle='roun
-00023f80: 6427 2c20 6663 3d27 7727 2c20 6563 3d27  d', fc='w', ec='
-00023f90: 626c 6163 6b27 2c20 616c 7068 613d 302e  black', alpha=0.
-00023fa0: 3329 290a 0a20 2020 2020 2020 2020 2020  3))..           
-00023fb0: 2066 6967 2e74 6967 6874 5f6c 6179 6f75   fig.tight_layou
-00023fc0: 7428 290a 0a20 2020 2020 2020 2020 2020  t()..           
-00023fd0: 2069 6620 7361 7665 6669 6720 3d3d 2054   if savefig == T
-00023fe0: 7275 653a 0a20 2020 2020 2020 2020 2020  rue:.           
-00023ff0: 2020 2020 2066 6967 2e73 6176 6566 6967       fig.savefig
-00024000: 2866 277b 692e 7265 706c 6163 6528 222f  (f'{i.replace("/
-00024010: 222c 2022 5f76 735f 2229 7d5f 766f 6c63  ", "_vs_")}_volc
-00024020: 616e 6f2e 7064 6627 2c20 6262 6f78 5f69  ano.pdf', bbox_i
-00024030: 6e63 6865 7320 3d20 2274 6967 6874 2229  nches = "tight")
-00024040: 0a0a 2020 2020 6465 6620 7369 676e 5f70  ..    def sign_p
-00024050: 726f 7473 5f70 6c6f 7428 7365 6c66 2c20  rots_plot(self, 
-00024060: 6e6f 726d 616c 697a 6564 3d46 616c 7365  normalized=False
-00024070: 2c20 6669 6773 697a 653d 2838 2c20 3529  , figsize=(8, 5)
-00024080: 2c20 7361 7665 6669 673d 4661 6c73 6529  , savefig=False)
-00024090: 3a0a 0a20 2020 2020 2020 2022 2222 506c  :..        """Pl
-000240a0: 6f74 206e 756d 6265 7220 6f66 2073 6967  ot number of sig
-000240b0: 6e69 6669 6361 6e74 2070 726f 7465 696e  nificant protein
-000240c0: 732e 0a0a 2020 2020 2020 2020 5061 7261  s...        Para
-000240d0: 6d65 7465 7273 0a20 2020 2020 2020 202d  meters.        -
-000240e0: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
-000240f0: 2020 6e6f 726d 616c 697a 6564 203a 2062    normalized : b
-00024100: 6f6f 6c65 616e 0a20 2020 2020 2020 2020  oolean.         
-00024110: 2020 2049 6620 5472 7565 2064 6973 706c     If True displ
-00024120: 6179 7320 6e75 6d62 6572 206f 6620 7369  ays number of si
-00024130: 676e 6966 6963 616e 7420 7072 6f74 6569  gnificant protei
-00024140: 6e73 2069 6e20 2520 2844 6566 6175 6c74  ns in % (Default
-00024150: 2076 616c 7565 203d 2046 616c 7365 292e   value = False).
-00024160: 0a20 2020 2020 2020 2066 6967 7369 7a65  .        figsize
-00024170: 203a 2074 7570 6c65 0a20 2020 2020 2020   : tuple.       
-00024180: 2020 2020 2046 6967 7572 6520 7369 7a65       Figure size
-00024190: 2028 4465 6661 756c 7420 7661 6c75 6520   (Default value 
-000241a0: 3d20 2838 2c35 292e 0a20 2020 2020 2020  = (8,5)..       
-000241b0: 2073 6176 6566 6967 203a 2062 6f6f 6c65   savefig : boole
-000241c0: 616e 0a20 2020 2020 2020 2020 2020 2049  an.            I
-000241d0: 6620 5472 7565 2073 6176 6573 2066 6967  f True saves fig
-000241e0: 7572 6520 2844 6566 6175 6c74 2076 616c  ure (Default val
-000241f0: 7565 203d 2046 616c 7365 292e 0a20 2020  ue = False)..   
-00024200: 2020 2020 2035 2920 3a0a 2020 2020 2020       5) :.      
-00024210: 2020 2020 2020 0a0a 2020 2020 2020 2020        ..        
-00024220: 5265 7475 726e 730a 2020 2020 2020 2020  Returns.        
-00024230: 2d2d 2d2d 2d2d 2d0a 0a20 2020 2020 2020  -------..       
-00024240: 200a 2020 2020 2020 2020 2222 220a 0a20   .        """.. 
-00024250: 2020 2020 2020 2073 6967 6e5f 6461 7461         sign_data
-00024260: 203d 2028 7365 6c66 2e71 765f 6461 7461   = (self.qv_data
-00024270: 2e73 656c 6563 745f 6474 7970 6573 2827  .select_dtypes('
-00024280: 666c 6f61 7427 2920 3c20 302e 3035 292e  float') < 0.05).
-00024290: 7375 6d28 6178 6973 3d30 290a 2020 2020  sum(axis=0).    
-000242a0: 2020 2020 6e6f 726d 5f73 6967 6e5f 6461      norm_sign_da
-000242b0: 7461 203d 2028 2873 656c 662e 7176 5f64  ta = ((self.qv_d
-000242c0: 6174 612e 7365 6c65 6374 5f64 7479 7065  ata.select_dtype
-000242d0: 7328 2766 6c6f 6174 2729 203c 2030 2e30  s('float') < 0.0
-000242e0: 3529 2e73 756d 2861 7869 733d 3029 2f73  5).sum(axis=0)/s
-000242f0: 656c 662e 7176 5f64 6174 612e 7368 6170  elf.qv_data.shap
-00024300: 655b 305d 292a 3130 300a 2020 2020 2020  e[0])*100.      
-00024310: 2020 7820 3d20 5b74 6578 7477 7261 702e    x = [textwrap.
-00024320: 6669 6c6c 2869 2c38 2920 2066 6f72 2069  fill(i,8)  for i
-00024330: 2069 6e20 7369 676e 5f64 6174 612e 696e   in sign_data.in
-00024340: 6465 785d 0a20 2020 2020 2020 2070 6c74  dex].        plt
-00024350: 2e66 6967 7572 6528 6669 6773 697a 653d  .figure(figsize=
-00024360: 6669 6773 697a 6529 0a20 2020 2020 2020  figsize).       
-00024370: 2069 6620 6e6f 726d 616c 697a 6564 2069   if normalized i
-00024380: 7320 5472 7565 3a0a 2020 2020 2020 2020  s True:.        
-00024390: 2020 2020 736e 732e 6261 7270 6c6f 7428      sns.barplot(
-000243a0: 783d 782c 2079 3d6e 6f72 6d5f 7369 676e  x=x, y=norm_sign
-000243b0: 5f64 6174 612e 7661 6c75 6573 290a 2020  _data.values).  
-000243c0: 2020 2020 2020 2020 2020 706c 742e 796c            plt.yl
-000243d0: 6162 656c 2827 6e75 6d62 6572 206f 6620  abel('number of 
-000243e0: 7369 676e 6966 6963 616e 7420 7072 6f74  significant prot
-000243f0: 6569 6e73 2069 6e20 2527 290a 2020 2020  eins in %').    
-00024400: 2020 2020 0a20 2020 2020 2020 2065 6c73      .        els
-00024410: 653a 0a20 2020 2020 2020 2020 2020 2073  e:.            s
-00024420: 6e73 2e62 6172 706c 6f74 2878 3d78 2c20  ns.barplot(x=x, 
-00024430: 793d 7369 676e 5f64 6174 612e 7661 6c75  y=sign_data.valu
-00024440: 6573 290a 2020 2020 2020 2020 2020 2020  es).            
-00024450: 706c 742e 796c 6162 656c 2827 6e75 6d62  plt.ylabel('numb
-00024460: 6572 206f 6620 7369 676e 6966 6963 616e  er of significan
-00024470: 7420 7072 6f74 6569 6e73 2729 0a20 2020  t proteins').   
-00024480: 2020 2020 2020 2020 200a 2020 2020 2020           .      
-00024490: 2020 2020 2020 736e 732e 6465 7370 696e        sns.despin
-000244a0: 6528 290a 0a20 2020 2020 2020 2069 6620  e()..        if 
-000244b0: 7361 7665 6669 6720 6973 2054 7275 653a  savefig is True:
-000244c0: 0a20 2020 2020 2020 2020 2020 2070 6c74  .            plt
-000244d0: 2e73 6176 6566 6967 2827 7369 676e 5f70  .savefig('sign_p
-000244e0: 726f 7473 5f70 6c6f 742e 7064 6627 2c20  rots_plot.pdf', 
-000244f0: 7472 616e 7370 6172 656e 743d 5472 7565  transparent=True
-00024500: 2c20 6262 6f78 5f69 6e63 6865 733d 2774  , bbox_inches='t
-00024510: 6967 6874 2729 0a0a 2020 2020 6465 6620  ight')..    def 
-00024520: 696e 745f 766f 6c63 616e 6f5f 706c 6f74  int_volcano_plot
-00024530: 2873 656c 662c 206e 5f72 6f77 732c 206e  (self, n_rows, n
-00024540: 5f63 6f6c 732c 2068 6569 6768 742c 2077  _cols, height, w
-00024550: 6964 7468 2c20 616e 6e6f 745f 6765 6e65  idth, annot_gene
-00024560: 7320 3d5b 5d2c 2075 7070 6572 5f66 635f  s =[], upper_fc_
-00024570: 6375 746f 6666 203d 204e 6f6e 652c 206c  cutoff = None, l
-00024580: 6f77 6572 5f66 635f 6375 746f 6666 3d4e  ower_fc_cutoff=N
-00024590: 6f6e 652c 2071 765f 6375 746f 6666 203d  one, qv_cutoff =
-000245a0: 2046 616c 7365 293a 0a0a 2020 2020 2020   False):..      
-000245b0: 2020 696e 6469 6365 7320 3d20 7365 6c66    indices = self
-000245c0: 2e66 635f 6461 7461 5b73 656c 662e 6663  .fc_data[self.fc
-000245d0: 5f64 6174 615b 2747 656e 6573 275d 2e69  _data['Genes'].i
-000245e0: 7369 6e28 616e 6e6f 745f 6765 6e65 7329  sin(annot_genes)
-000245f0: 5d2e 696e 6465 782e 746f 5f6c 6973 7428  ].index.to_list(
-00024600: 290a 0a20 2020 2020 2020 2066 6967 203d  )..        fig =
-00024610: 206d 616b 655f 7375 6270 6c6f 7473 2872   make_subplots(r
-00024620: 6f77 733d 6e5f 726f 7773 2c20 636f 6c73  ows=n_rows, cols
-00024630: 3d6e 5f63 6f6c 7329 0a20 2020 2020 2020  =n_cols).       
-00024640: 200a 2020 2020 2020 2020 666f 7220 692c   .        for i,
-00024650: 2063 6f6c 5f6e 616d 6520 696e 2065 6e75   col_name in enu
-00024660: 6d65 7261 7465 2873 656c 662e 6663 5f64  merate(self.fc_d
-00024670: 6174 612e 7365 6c65 6374 5f64 7479 7065  ata.select_dtype
-00024680: 7328 666c 6f61 7429 2e63 6f6c 756d 6e73  s(float).columns
-00024690: 2e74 6f6c 6973 7428 292c 2073 7461 7274  .tolist(), start
-000246a0: 3d31 293a 0a20 2020 2020 2020 2020 2020  =1):.           
-000246b0: 200a 2020 2020 2020 2020 2020 2020 2320   .            # 
-000246c0: 4372 6561 7465 2061 206c 6973 7420 6f66  Create a list of
-000246d0: 2063 6f6c 6f72 7320 6261 7365 6420 6f6e   colors based on
-000246e0: 2074 6865 2071 7620 616e 6420 6663 2076   the qv and fc v
-000246f0: 616c 7565 730a 2020 2020 2020 2020 2020  alues.          
-00024700: 2020 636f 6c6f 725f 6c69 7374 203d 5b5d    color_list =[]
-00024710: 0a20 2020 2020 2020 2020 2020 2066 635f  .            fc_
-00024720: 696e 6469 6365 7320 3d20 5b5d 0a0a 2020  indices = []..  
-00024730: 2020 2020 2020 2020 2020 666f 7220 6964            for id
-00024740: 7820 696e 206e 702e 6172 616e 6765 2873  x in np.arange(s
-00024750: 656c 662e 6663 5f64 6174 612e 7368 6170  elf.fc_data.shap
-00024760: 655b 305d 293a 0a0a 2020 2020 2020 2020  e[0]):..        
-00024770: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-00024780: 7176 5f64 6174 612e 6c6f 635b 6964 782c  qv_data.loc[idx,
-00024790: 2063 6f6c 5f6e 616d 655d 203c 2030 2e30   col_name] < 0.0
-000247a0: 3520 616e 6420 7365 6c66 2e66 635f 6461  5 and self.fc_da
-000247b0: 7461 2e6c 6f63 5b69 6478 2c20 636f 6c5f  ta.loc[idx, col_
-000247c0: 6e61 6d65 5d20 3e30 3a0a 2020 2020 2020  name] >0:.      
-000247d0: 2020 2020 2020 2020 2020 2020 2020 636f                co
-000247e0: 6c6f 725f 6c69 7374 2e61 7070 656e 6428  lor_list.append(
-000247f0: 276c 6967 6874 636f 7261 6c27 290a 0a20  'lightcoral').. 
-00024800: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-00024810: 6c69 6620 7365 6c66 2e71 765f 6461 7461  lif self.qv_data
-00024820: 2e6c 6f63 5b69 6478 2c20 636f 6c5f 6e61  .loc[idx, col_na
-00024830: 6d65 5d20 3c30 2e30 3520 616e 6420 7365  me] <0.05 and se
-00024840: 6c66 2e66 635f 6461 7461 2e6c 6f63 5b69  lf.fc_data.loc[i
-00024850: 6478 2c20 636f 6c5f 6e61 6d65 5d20 3c30  dx, col_name] <0
-00024860: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00024870: 2020 2020 2020 636f 6c6f 725f 6c69 7374        color_list
-00024880: 2e61 7070 656e 6428 2763 6f72 6e66 6c6f  .append('cornflo
-00024890: 7765 7262 6c75 6527 290a 0a20 2020 2020  werblue')..     
-000248a0: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-000248b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000248c0: 2020 2020 2063 6f6c 6f72 5f6c 6973 742e       color_list.
-000248d0: 6170 7065 6e64 2827 6c69 6768 7467 7265  append('lightgre
-000248e0: 7927 290a 2020 2020 2020 2020 2020 2020  y').            
-000248f0: 0a20 2020 2020 2020 2020 2020 2023 2043  .            # C
-00024900: 7265 6174 6520 616e 2061 6e6e 6f74 6174  reate an annotat
-00024910: 696f 6e20 6c69 7374 2062 6173 6564 206f  ion list based o
-00024920: 6e20 666f 6c64 2063 6861 6e67 6520 6375  n fold change cu
-00024930: 746f 6666 0a20 2020 2020 2020 2020 2020  toff.           
-00024940: 2069 6620 7176 5f63 7574 6f66 6620 6973   if qv_cutoff is
-00024950: 2054 7275 653a 0a20 2020 2020 2020 2020   True:.         
-00024960: 2020 2020 2020 2069 6620 7570 7065 725f         if upper_
-00024970: 6663 5f63 7574 6f66 6620 6973 206e 6f74  fc_cutoff is not
-00024980: 204e 6f6e 6520 616e 6420 6c6f 7765 725f   None and lower_
-00024990: 6663 5f63 7574 6f66 6620 6973 204e 6f6e  fc_cutoff is Non
-000249a0: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-000249b0: 2020 2020 2020 2066 635f 696e 6469 6365         fc_indice
-000249c0: 7320 3d20 7365 6c66 2e66 635f 6461 7461  s = self.fc_data
-000249d0: 5b28 7365 6c66 2e71 765f 6461 7461 5b63  [(self.qv_data[c
-000249e0: 6f6c 5f6e 616d 655d 203c 2030 2e30 3529  ol_name] < 0.05)
-000249f0: 2026 0a20 2020 2020 2020 2020 2020 2020   &.             
-00024a00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024a10: 2020 2020 2020 2020 2020 2020 2020 2028                 (
-00024a20: 7365 6c66 2e66 635f 6461 7461 5b63 6f6c  self.fc_data[col
-00024a30: 5f6e 616d 655d 203e 2075 7070 6572 5f66  _name] > upper_f
-00024a40: 635f 6375 746f 6666 295d 2e69 6e64 6578  c_cutoff)].index
-00024a50: 2e74 6f5f 6c69 7374 2829 0a20 2020 2020  .to_list().     
-00024a60: 2020 2020 2020 2020 2020 200a 2020 2020             .    
-00024a70: 2020 2020 2020 2020 2020 2020 656c 6966              elif
-00024a80: 206c 6f77 6572 5f66 635f 6375 746f 6666   lower_fc_cutoff
-00024a90: 2069 7320 6e6f 7420 4e6f 6e65 2061 6e64   is not None and
-00024aa0: 2075 7070 6572 5f66 635f 6375 746f 6666   upper_fc_cutoff
-00024ab0: 2069 7320 4e6f 6e65 3a0a 2020 2020 2020   is None:.      
-00024ac0: 2020 2020 2020 2020 2020 2020 2020 6663                fc
-00024ad0: 5f69 6e64 6963 6573 203d 2073 656c 662e  _indices = self.
-00024ae0: 6663 5f64 6174 615b 2873 656c 662e 7176  fc_data[(self.qv
-00024af0: 5f64 6174 615b 636f 6c5f 6e61 6d65 5d20  _data[col_name] 
-00024b00: 3c20 302e 3035 2920 260a 2020 2020 2020  < 0.05) &.      
-00024b10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024b20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024b30: 2020 2020 2020 2873 656c 662e 6663 5f64        (self.fc_d
-00024b40: 6174 615b 636f 6c5f 6e61 6d65 5d20 3c20  ata[col_name] < 
-00024b50: 6c6f 7765 725f 6663 5f63 7574 6f66 6629  lower_fc_cutoff)
-00024b60: 5d2e 696e 6465 782e 746f 5f6c 6973 7428  ].index.to_list(
-00024b70: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00024b80: 2020 0a20 2020 2020 2020 2020 2020 2020    .             
-00024b90: 2020 2065 6c69 6620 6c6f 7765 725f 6663     elif lower_fc
-00024ba0: 5f63 7574 6f66 6620 6973 206e 6f74 204e  _cutoff is not N
-00024bb0: 6f6e 6520 616e 6420 7570 7065 725f 6663  one and upper_fc
-00024bc0: 5f63 7574 6f66 6620 6973 206e 6f74 204e  _cutoff is not N
-00024bd0: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
-00024be0: 2020 2020 2020 2020 2066 635f 696e 6469           fc_indi
-00024bf0: 6365 7320 3d20 7365 6c66 2e66 635f 6461  ces = self.fc_da
-00024c00: 7461 5b28 7365 6c66 2e71 765f 6461 7461  ta[(self.qv_data
-00024c10: 5b63 6f6c 5f6e 616d 655d 203c 2030 2e30  [col_name] < 0.0
-00024c20: 3529 2026 0a20 2020 2020 2020 2020 2020  5) &.           
-00024c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024c50: 2028 2873 656c 662e 6663 5f64 6174 615b   ((self.fc_data[
-00024c60: 636f 6c5f 6e61 6d65 5d20 3e20 7570 7065  col_name] > uppe
-00024c70: 725f 6663 5f63 7574 6f66 6629 207c 0a20  r_fc_cutoff) |. 
-00024c80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024c90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024ca0: 2020 2020 2020 2020 2020 2028 7365 6c66             (self
-00024cb0: 2e66 635f 6461 7461 5b63 6f6c 5f6e 616d  .fc_data[col_nam
-00024cc0: 655d 203c 206c 6f77 6572 5f66 635f 6375  e] < lower_fc_cu
-00024cd0: 746f 6666 2929 5d2e 696e 6465 782e 746f  toff))].index.to
-00024ce0: 5f6c 6973 7428 290a 2020 2020 2020 2020  _list().        
-00024cf0: 2020 2020 2020 2020 2020 2020 0a20 2020              .   
-00024d00: 2020 2020 2020 2020 2069 6620 7176 5f63           if qv_c
-00024d10: 7574 6f66 6620 6973 2046 616c 7365 3a0a  utoff is False:.
-00024d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024d30: 6966 2075 7070 6572 5f66 635f 6375 746f  if upper_fc_cuto
-00024d40: 6666 2069 7320 6e6f 7420 4e6f 6e65 2061  ff is not None a
-00024d50: 6e64 206c 6f77 6572 5f66 635f 6375 746f  nd lower_fc_cuto
-00024d60: 6666 2069 7320 4e6f 6e65 3a0a 2020 2020  ff is None:.    
-00024d70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024d80: 6663 5f69 6e64 6963 6573 203d 2073 656c  fc_indices = sel
-00024d90: 662e 6663 5f64 6174 615b 2873 656c 662e  f.fc_data[(self.
-00024da0: 6663 5f64 6174 615b 636f 6c5f 6e61 6d65  fc_data[col_name
-00024db0: 5d20 3e20 7570 7065 725f 6663 5f63 7574  ] > upper_fc_cut
-00024dc0: 6f66 6629 5d2e 696e 6465 782e 746f 5f6c  off)].index.to_l
-00024dd0: 6973 7428 290a 2020 2020 2020 2020 2020  ist().          
-00024de0: 2020 2020 2020 0a20 2020 2020 2020 2020        .         
-00024df0: 2020 2020 2020 2065 6c69 6620 6c6f 7765         elif lowe
-00024e00: 725f 6663 5f63 7574 6f66 6620 6973 206e  r_fc_cutoff is n
-00024e10: 6f74 204e 6f6e 6520 616e 6420 7570 7065  ot None and uppe
-00024e20: 725f 6663 5f63 7574 6f66 6620 6973 204e  r_fc_cutoff is N
-00024e30: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
-00024e40: 2020 2020 2020 2020 2066 635f 696e 6469           fc_indi
-00024e50: 6365 7320 3d20 7365 6c66 2e66 635f 6461  ces = self.fc_da
-00024e60: 7461 5b28 7365 6c66 2e66 635f 6461 7461  ta[(self.fc_data
-00024e70: 5b63 6f6c 5f6e 616d 655d 203c 206c 6f77  [col_name] < low
-00024e80: 6572 5f66 635f 6375 746f 6666 295d 2e69  er_fc_cutoff)].i
-00024e90: 6e64 6578 2e74 6f5f 6c69 7374 2829 0a20  ndex.to_list(). 
-00024ea0: 2020 2020 2020 2020 2020 2020 2020 200a                 .
-00024eb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024ec0: 656c 6966 206c 6f77 6572 5f66 635f 6375  elif lower_fc_cu
-00024ed0: 746f 6666 2069 7320 6e6f 7420 4e6f 6e65  toff is not None
-00024ee0: 2061 6e64 2075 7070 6572 5f66 635f 6375   and upper_fc_cu
-00024ef0: 746f 6666 2069 7320 6e6f 7420 4e6f 6e65  toff is not None
-00024f00: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00024f10: 2020 2020 2020 6663 5f69 6e64 6963 6573        fc_indices
-00024f20: 203d 2073 656c 662e 6663 5f64 6174 615b   = self.fc_data[
-00024f30: 2828 7365 6c66 2e66 635f 6461 7461 5b63  ((self.fc_data[c
-00024f40: 6f6c 5f6e 616d 655d 203e 2075 7070 6572  ol_name] > upper
-00024f50: 5f66 635f 6375 746f 6666 2920 7c0a 2020  _fc_cutoff) |.  
-00024f60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024f70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024f80: 2020 2020 2020 2020 2020 2020 2028 7365               (se
-00024f90: 6c66 2e66 635f 6461 7461 5b63 6f6c 5f6e  lf.fc_data[col_n
-00024fa0: 616d 655d 203c 206c 6f77 6572 5f66 635f  ame] < lower_fc_
-00024fb0: 6375 746f 6666 2929 5d2e 696e 6465 782e  cutoff))].index.
-00024fc0: 746f 5f6c 6973 7428 290a 2020 2020 2020  to_list().      
-00024fd0: 2020 2020 2020 2020 2020 2020 2020 0a20                . 
-00024fe0: 2020 2020 2020 2020 2020 2023 2043 616c             # Cal
-00024ff0: 6375 6c61 7465 2072 6f77 2061 6e64 2063  culate row and c
-00025000: 6f6c 2076 616c 7565 7320 666f 7220 7468  ol values for th
-00025010: 6520 7375 6270 6c6f 7473 2062 6173 6564  e subplots based
-00025020: 206f 6e20 690a 2020 2020 2020 2020 2020   on i.          
-00025030: 2020 726f 7720 3d20 2869 202d 2031 2920    row = (i - 1) 
-00025040: 2f2f 206e 5f63 6f6c 7320 2b20 310a 2020  // n_cols + 1.  
-00025050: 2020 2020 2020 2020 2020 636f 6c20 3d20            col = 
-00025060: 2869 202d 2031 2920 2520 6e5f 636f 6c73  (i - 1) % n_cols
-00025070: 202b 2031 0a20 2020 2020 2020 2020 2020   + 1.           
-00025080: 200a 2020 2020 2020 2020 2020 2020 7465   .            te
-00025090: 7874 203d 205b 6765 6e65 2b27 2c20 272b  xt = [gene+', '+
-000250a0: 6465 7363 7269 7074 696f 6e0a 2020 2020  description.    
-000250b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000250c0: 666f 7220 6765 6e65 2c20 6465 7363 7269  for gene, descri
-000250d0: 7074 696f 6e0a 2020 2020 2020 2020 2020  ption.          
-000250e0: 2020 2020 2020 2020 2020 696e 207a 6970            in zip
-000250f0: 2873 656c 662e 6663 5f64 6174 615b 2747  (self.fc_data['G
-00025100: 656e 6573 275d 2c0a 2020 2020 2020 2020  enes'],.        
-00025110: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025120: 2020 2073 656c 662e 6663 5f64 6174 615b     self.fc_data[
-00025130: 2746 6972 7374 2e50 726f 7465 696e 2e44  'First.Protein.D
-00025140: 6573 6372 6970 7469 6f6e 275d 295d 0a20  escription'])]. 
-00025150: 2020 2020 2020 2020 2020 200a 2020 2020             .    
-00025160: 2020 2020 2020 2020 2320 4164 6420 7468          # Add th
-00025170: 6520 7363 6174 7465 7220 706c 6f74 7320  e scatter plots 
-00025180: 746f 2074 6865 2073 7562 706c 6f74 7320  to the subplots 
-00025190: 6c61 796f 7574 0a20 2020 2020 2020 2020  layout.         
-000251a0: 2020 2066 6967 2e61 6464 5f74 7261 6365     fig.add_trace
-000251b0: 2867 6f2e 5363 6174 7465 7228 783d 7365  (go.Scatter(x=se
-000251c0: 6c66 2e66 635f 6461 7461 5b63 6f6c 5f6e  lf.fc_data[col_n
-000251d0: 616d 655d 2c0a 2020 2020 2020 2020 2020  ame],.          
-000251e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000251f0: 2020 2020 2020 2020 2020 2079 3d73 656c             y=sel
-00025200: 662e 7076 5f64 6174 615b 636f 6c5f 6e61  f.pv_data[col_na
-00025210: 6d65 5d2c 0a20 2020 2020 2020 2020 2020  me],.           
-00025220: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025230: 2020 2020 2020 2020 2020 6d6f 6465 3d27            mode='
-00025240: 6d61 726b 6572 7327 2c0a 2020 2020 2020  markers',.      
-00025250: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025260: 2020 2020 2020 2020 2020 2020 2020 206d                 m
-00025270: 6172 6b65 723d 6469 6374 2863 6f6c 6f72  arker=dict(color
-00025280: 3d63 6f6c 6f72 5f6c 6973 7429 2c0a 2020  =color_list),.  
-00025290: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000252a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000252b0: 2020 2074 6578 743d 7465 7874 292c 0a20     text=text),. 
-000252c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000252d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000252e0: 2020 2020 726f 773d 726f 772c 0a20 2020      row=row,.   
-000252f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025300: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025310: 2020 636f 6c3d 636f 6c29 0a0a 2020 2020    col=col)..    
-00025320: 2020 2020 2020 2020 6669 672e 6164 645f          fig.add_
-00025330: 7472 6163 6528 676f 2e53 6361 7474 6572  trace(go.Scatter
-00025340: 2878 3d73 656c 662e 6663 5f64 6174 612e  (x=self.fc_data.
-00025350: 6c6f 635b 696e 6469 6365 7320 2b20 6663  loc[indices + fc
-00025360: 5f69 6e64 6963 6573 2c20 636f 6c5f 6e61  _indices, col_na
-00025370: 6d65 5d2c 0a20 2020 2020 2020 2020 2020  me],.           
-00025380: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025390: 2020 2020 2020 2020 2020 793d 7365 6c66            y=self
-000253a0: 2e70 765f 6461 7461 2e6c 6f63 5b69 6e64  .pv_data.loc[ind
-000253b0: 6963 6573 202b 2066 635f 696e 6469 6365  ices + fc_indice
-000253c0: 732c 2063 6f6c 5f6e 616d 655d 2c0a 2020  s, col_name],.  
-000253d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000253e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000253f0: 2020 206d 6f64 653d 276d 6172 6b65 7273     mode='markers
-00025400: 272c 0a20 2020 2020 2020 2020 2020 2020  ',.             
-00025410: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025420: 2020 2020 2020 2020 6d61 726b 6572 3d64          marker=d
-00025430: 6963 7428 636f 6c6f 723d 276c 6967 6874  ict(color='light
-00025440: 626c 7565 2729 292c 0a20 2020 2020 2020  blue')),.       
-00025450: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025460: 2020 2020 2020 2020 2020 2020 2020 726f                ro
-00025470: 773d 726f 772c 0a20 2020 2020 2020 2020  w=row,.         
-00025480: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025490: 2020 2020 2020 2020 2020 2020 636f 6c3d              col=
-000254a0: 636f 6c29 0a0a 2020 2020 2020 2020 2020  col)..          
-000254b0: 2020 2320 4164 6420 616e 6e6f 7461 7469    # Add annotati
-000254c0: 6f6e 7320 746f 2074 6865 2073 7562 706c  ons to the subpl
-000254d0: 6f74 730a 2020 2020 2020 2020 2020 2020  ots.            
-000254e0: 666f 7220 6964 7820 696e 2028 696e 6469  for idx in (indi
-000254f0: 6365 7320 2b20 6663 5f69 6e64 6963 6573  ces + fc_indices
-00025500: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-00025510: 2020 2066 6967 2e61 6464 5f61 6e6e 6f74     fig.add_annot
-00025520: 6174 696f 6e28 0a20 2020 2020 2020 2020  ation(.         
-00025530: 2020 2020 2020 2020 2020 2064 6963 7428             dict(
-00025540: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00025550: 2020 2020 2020 2020 2078 3d73 656c 662e           x=self.
-00025560: 6663 5f64 6174 612e 6c6f 635b 6964 782c  fc_data.loc[idx,
-00025570: 2063 6f6c 5f6e 616d 655d 2c0a 2020 2020   col_name],.    
-00025580: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025590: 2020 2020 793d 7365 6c66 2e70 765f 6461      y=self.pv_da
-000255a0: 7461 2e6c 6f63 5b69 6478 2c20 636f 6c5f  ta.loc[idx, col_
-000255b0: 6e61 6d65 5d2c 0a20 2020 2020 2020 2020  name],.         
-000255c0: 2020 2020 2020 2020 2020 2020 2020 2074                 t
-000255d0: 6578 743d 7365 6c66 2e66 635f 6461 7461  ext=self.fc_data
-000255e0: 2e6c 6f63 5b69 6478 2c20 2747 656e 6573  .loc[idx, 'Genes
-000255f0: 275d 2c0a 2020 2020 2020 2020 2020 2020  '],.            
-00025600: 2020 2020 2020 2020 2020 2020 666f 6e74              font
-00025610: 3d7b 2763 6f6c 6f72 273a 2027 626c 6163  ={'color': 'blac
-00025620: 6b27 2c20 2773 697a 6527 3a20 3132 7d2c  k', 'size': 12},
-00025630: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00025640: 2020 2020 2020 2020 2078 7265 663d 6627           xref=f'
-00025650: 787b 697d 272c 2020 2320 7573 6520 7072  x{i}',  # use pr
-00025660: 6f70 6572 2078 7265 660a 2020 2020 2020  oper xref.      
-00025670: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025680: 2020 7972 6566 3d66 2779 7b69 7d27 2c20    yref=f'y{i}', 
-00025690: 2023 2075 7365 2070 726f 7065 7220 7972   # use proper yr
-000256a0: 6566 0a20 2020 2020 2020 2020 2020 2020  ef.             
-000256b0: 2020 2020 2020 2029 2c0a 2020 2020 2020         ),.      
-000256c0: 2020 2020 2020 2020 2020 2020 2020 726f                ro
-000256d0: 773d 726f 772c 0a20 2020 2020 2020 2020  w=row,.         
-000256e0: 2020 2020 2020 2020 2020 2063 6f6c 3d63             col=c
-000256f0: 6f6c 0a20 2020 2020 2020 2020 2020 2020  ol.             
-00025700: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
-00025710: 200a 2020 2020 2020 2020 2020 2020 795f   .            y_
-00025720: 6d61 7820 3d20 7365 6c66 2e70 765f 6461  max = self.pv_da
-00025730: 7461 5b63 6f6c 5f6e 616d 655d 2e6d 6178  ta[col_name].max
-00025740: 2829 0a20 2020 2020 2020 2020 2020 2078  ().            x
-00025750: 5f6d 6178 203d 2073 656c 662e 6663 5f64  _max = self.fc_d
-00025760: 6174 615b 636f 6c5f 6e61 6d65 5d2e 6d61  ata[col_name].ma
-00025770: 7828 290a 2020 2020 2020 2020 2020 2020  x().            
-00025780: 785f 6d69 6e20 3d20 7365 6c66 2e66 635f  x_min = self.fc_
-00025790: 6461 7461 5b63 6f6c 5f6e 616d 655d 2e6d  data[col_name].m
-000257a0: 696e 2829 0a0a 2020 2020 2020 2020 2020  in()..          
-000257b0: 2020 666f 7220 636f 6f72 642c 2073 616d    for coord, sam
-000257c0: 706c 6520 696e 207a 6970 285b 785f 6d61  ple in zip([x_ma
-000257d0: 782c 2078 5f6d 696e 5d2c 2063 6f6c 5f6e  x, x_min], col_n
-000257e0: 616d 652e 7370 6c69 7428 272f 2729 293a  ame.split('/')):
-000257f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00025800: 2066 6967 2e61 6464 5f61 6e6e 6f74 6174   fig.add_annotat
-00025810: 696f 6e28 0a20 2020 2020 2020 2020 2020  ion(.           
-00025820: 2020 2020 2020 2020 2064 6963 7428 783d           dict(x=
-00025830: 636f 6f72 642c 0a20 2020 2020 2020 2020  coord,.         
-00025840: 2020 2020 2020 2020 2020 2020 2020 2079                 y
-00025850: 3d79 5f6d 6178 2c0a 2020 2020 2020 2020  =y_max,.        
-00025860: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025870: 7465 7874 3d73 616d 706c 652c 0a20 2020  text=sample,.   
+00023490: 2020 2020 7468 7265 7368 6f6c 6420 3d20      threshold = 
+000234a0: 7365 6c66 2e70 765f 6461 7461 5b73 656c  self.pv_data[sel
+000234b0: 662e 7176 5f64 6174 615b 695d 203c 2030  f.qv_data[i] < 0
+000234c0: 2e30 355d 5b69 5d2e 736f 7274 5f76 616c  .05][i].sort_val
+000234d0: 7565 7328 292e 7661 6c75 6573 5b30 5d0a  ues().values[0].
+000234e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000234f0: 2020 2020 6178 6573 2e61 7868 6c69 6e65      axes.axhline
+00023500: 2874 6872 6573 686f 6c64 2c20 6c73 203d  (threshold, ls =
+00023510: 2027 2d2d 272c 2063 6f6c 6f72 203d 2027   '--', color = '
+00023520: 6c69 6768 7467 7265 7927 290a 0a20 2020  lightgrey')..   
+00023530: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023540: 2069 6620 616e 6e6f 7420 3d3d 2027 6663   if annot == 'fc
+00023550: 5f63 7574 6f66 6627 3a0a 2020 2020 2020  _cutoff':.      
+00023560: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023570: 2020 696e 6469 6365 7320 3d20 7365 6c66    indices = self
+00023580: 2e66 635f 6461 7461 5b28 2873 656c 662e  .fc_data[((self.
+00023590: 6663 5f64 6174 615b 695d 203c 206c 6f77  fc_data[i] < low
+000235a0: 6572 5f66 635f 6375 746f 6666 2920 7c0a  er_fc_cutoff) |.
+000235b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000235c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000235d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000235e0: 2873 656c 662e 6663 5f64 6174 615b 695d  (self.fc_data[i]
+000235f0: 203e 2075 7070 6572 5f66 635f 6375 746f   > upper_fc_cuto
+00023600: 6666 2929 2026 0a20 2020 2020 2020 2020  ff)) &.         
+00023610: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023620: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023630: 2020 2020 2020 2028 7365 6c66 2e71 765f         (self.qv_
+00023640: 6461 7461 5b69 5d20 3c30 2e30 3529 5d2e  data[i] <0.05)].
+00023650: 696e 6465 780a 2020 2020 2020 2020 2020  index.          
+00023660: 2020 2020 2020 2020 2020 2020 2020 6178                ax
+00023670: 6573 2e61 7876 6c69 6e65 286c 6f77 6572  es.axvline(lower
+00023680: 5f66 635f 6375 746f 6666 2c20 6c73 203d  _fc_cutoff, ls =
+00023690: 2027 2d2d 272c 2063 6f6c 6f72 203d 2027   '--', color = '
+000236a0: 6c69 6768 7467 7265 7927 290a 2020 2020  lightgrey').    
+000236b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000236c0: 2020 2020 6178 6573 2e61 7876 6c69 6e65      axes.axvline
+000236d0: 2875 7070 6572 5f66 635f 6375 746f 6666  (upper_fc_cutoff
+000236e0: 2c20 6c73 203d 2027 2d2d 272c 2063 6f6c  , ls = '--', col
+000236f0: 6f72 203d 2027 6c69 6768 7467 7265 7927  or = 'lightgrey'
+00023700: 290a 0a20 2020 2020 2020 2020 2020 2020  )..             
+00023710: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+00023720: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023730: 2020 2020 2069 6e64 6963 6573 203d 2073       indices = s
+00023740: 656c 662e 6663 5f64 6174 615b 7365 6c66  elf.fc_data[self
+00023750: 2e66 635f 6461 7461 5b67 656e 655f 636f  .fc_data[gene_co
+00023760: 6c75 6d6e 5d2e 6973 696e 2867 656e 655f  lumn].isin(gene_
+00023770: 6c69 7374 295d 2e69 6e64 6578 0a0a 2020  list)].index..  
+00023780: 2020 2020 2020 2020 2020 6966 2071 7661            if qva
+00023790: 6c75 6520 6973 2046 616c 7365 3a0a 2020  lue is False:.  
+000237a0: 2020 2020 2020 2020 2020 2020 2020 736e                sn
+000237b0: 732e 7363 6174 7465 7270 6c6f 7428 7820  s.scatterplot(x 
+000237c0: 3d20 7365 6c66 2e66 635f 6461 7461 5b69  = self.fc_data[i
+000237d0: 5d2c 2079 203d 2073 656c 662e 7076 5f64  ], y = self.pv_d
+000237e0: 6174 615b 695d 2c20 636f 6c6f 7220 3d20  ata[i], color = 
+000237f0: 276c 6967 6874 6772 6579 272c 2061 6c70  'lightgrey', alp
+00023800: 6861 203d 2030 2e35 2c20 6178 3d61 7865  ha = 0.5, ax=axe
+00023810: 7329 0a20 2020 2020 2020 2020 2020 2020  s).             
+00023820: 2020 2073 6e73 2e73 6361 7474 6572 706c     sns.scatterpl
+00023830: 6f74 2878 203d 2073 656c 662e 6663 5f64  ot(x = self.fc_d
+00023840: 6174 615b 7365 6c66 2e70 765f 6461 7461  ata[self.pv_data
+00023850: 2e73 656c 6563 745f 6474 7970 6573 2827  .select_dtypes('
+00023860: 666c 6f61 7427 2920 3e20 312e 335d 5b69  float') > 1.3][i
+00023870: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
+00023880: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023890: 2020 2079 203d 2073 656c 662e 7076 5f64     y = self.pv_d
+000238a0: 6174 615b 7365 6c66 2e70 765f 6461 7461  ata[self.pv_data
+000238b0: 2e73 656c 6563 745f 6474 7970 6573 2827  .select_dtypes('
+000238c0: 666c 6f61 7427 2920 3e20 312e 335d 5b69  float') > 1.3][i
+000238d0: 5d2c 2063 6f6c 6f72 203d 2073 6e73 2e63  ], color = sns.c
+000238e0: 6f6c 6f72 5f70 616c 6574 7465 2822 6465  olor_palette("de
+000238f0: 6570 222c 2032 3029 5b31 5d2c 2061 783d  ep", 20)[1], ax=
+00023900: 6178 6573 290a 2020 2020 2020 2020 2020  axes).          
+00023910: 2020 2020 2020 736e 732e 7363 6174 7465        sns.scatte
+00023920: 7270 6c6f 7428 7820 3d20 7365 6c66 2e66  rplot(x = self.f
+00023930: 635f 6461 7461 5b28 7365 6c66 2e70 765f  c_data[(self.pv_
+00023940: 6461 7461 2e73 656c 6563 745f 6474 7970  data.select_dtyp
+00023950: 6573 2827 666c 6f61 7427 2920 3e20 312e  es('float') > 1.
+00023960: 3329 2026 2028 7365 6c66 2e66 635f 6461  3) & (self.fc_da
+00023970: 7461 2e73 656c 6563 745f 6474 7970 6573  ta.select_dtypes
+00023980: 2827 666c 6f61 7427 2920 3c20 3029 5d5b  ('float') < 0)][
+00023990: 695d 2c0a 2020 2020 2020 2020 2020 2020  i],.            
+000239a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000239b0: 2020 2020 7920 3d20 7365 6c66 2e70 765f      y = self.pv_
+000239c0: 6461 7461 5b28 7365 6c66 2e70 765f 6461  data[(self.pv_da
+000239d0: 7461 2e73 656c 6563 745f 6474 7970 6573  ta.select_dtypes
+000239e0: 2827 666c 6f61 7427 2920 3e20 312e 3329  ('float') > 1.3)
+000239f0: 2026 2028 7365 6c66 2e66 635f 6461 7461   & (self.fc_data
+00023a00: 2e73 656c 6563 745f 6474 7970 6573 2827  .select_dtypes('
+00023a10: 666c 6f61 7427 2920 3c20 3029 5d5b 695d  float') < 0)][i]
+00023a20: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00023a30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023a40: 2020 636f 6c6f 7220 3d20 736e 732e 636f    color = sns.co
+00023a50: 6c6f 725f 7061 6c65 7474 6528 2264 6565  lor_palette("dee
+00023a60: 7022 2c20 3230 295b 325d 2c20 6178 3d61  p", 20)[2], ax=a
+00023a70: 7865 7329 0a20 2020 2020 2020 2020 2020  xes).           
+00023a80: 2020 2020 200a 2020 2020 2020 2020 2020       .          
+00023a90: 2020 2020 2020 6178 6573 2e73 6574 2878        axes.set(x
+00023aa0: 6c61 6265 6c3d 6627 6c6f 6732 2066 6f6c  label=f'log2 fol
+00023ab0: 6420 6368 616e 6765 2028 7b69 7d29 272c  d change ({i})',
+00023ac0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00023ad0: 2020 2020 2020 2020 2020 2020 2020 796c                yl
+00023ae0: 6162 656c 3d66 272d 6c6f 6731 3020 702d  abel=f'-log10 p-
+00023af0: 7661 6c75 6520 287b 697d 2927 290a 2020  value ({i})').  
+00023b00: 2020 2020 2020 2020 2020 2020 2020 0a20                . 
+00023b10: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+00023b20: 2073 6574 2070 2d76 616c 7565 2074 6872   set p-value thr
+00023b30: 6573 686f 6c64 200a 2020 2020 2020 2020  eshold .        
+00023b40: 2020 2020 2020 2020 6178 6573 2e61 7868          axes.axh
+00023b50: 6c69 6e65 2831 2e33 2c6c 7320 3d20 272d  line(1.3,ls = '-
+00023b60: 2d27 2c20 636f 6c6f 7220 3d20 276c 6967  -', color = 'lig
+00023b70: 6874 6772 6579 2729 0a0a 2020 2020 2020  htgrey')..      
+00023b80: 2020 2020 2020 2020 2020 6966 2061 6e6e            if ann
+00023b90: 6f74 203d 3d20 2766 635f 6375 746f 6666  ot == 'fc_cutoff
+00023ba0: 273a 0a20 2020 2020 2020 2020 2020 2020  ':.             
+00023bb0: 2020 2020 2020 2069 6e64 6963 6573 203d         indices =
+00023bc0: 2073 656c 662e 6663 5f64 6174 615b 2828   self.fc_data[((
+00023bd0: 7365 6c66 2e66 635f 6461 7461 5b69 5d20  self.fc_data[i] 
+00023be0: 3c20 6c6f 7765 725f 6663 5f63 7574 6f66  < lower_fc_cutof
+00023bf0: 6629 207c 0a20 2020 2020 2020 2020 2020  f) |.           
+00023c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023c10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023c20: 2028 7365 6c66 2e66 635f 6461 7461 5b69   (self.fc_data[i
+00023c30: 5d20 3e20 7570 7065 725f 6663 5f63 7574  ] > upper_fc_cut
+00023c40: 6f66 6629 207c 0a20 2020 2020 2020 2020  off) |.         
+00023c50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023c70: 2020 2028 7365 6c66 2e66 635f 6461 7461     (self.fc_data
+00023c80: 5b27 4765 6e65 7327 5d2e 6973 696e 2867  ['Genes'].isin(g
+00023c90: 656e 655f 6c69 7374 2929 2920 260a 2020  ene_list))) &.  
+00023ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023cc0: 2020 2020 2020 2020 2020 2873 656c 662e            (self.
+00023cd0: 7076 5f64 6174 615b 695d 203e 312e 3329  pv_data[i] >1.3)
+00023ce0: 5d2e 696e 6465 780a 2020 2020 2020 2020  ].index.        
+00023cf0: 2020 2020 2020 2020 2020 2020 6178 6573              axes
+00023d00: 2e61 7876 6c69 6e65 286c 6f77 6572 5f66  .axvline(lower_f
+00023d10: 635f 6375 746f 6666 2c20 6c73 203d 2027  c_cutoff, ls = '
+00023d20: 2d2d 272c 2063 6f6c 6f72 203d 2027 6c69  --', color = 'li
+00023d30: 6768 7467 7265 7927 290a 2020 2020 2020  ghtgrey').      
+00023d40: 2020 2020 2020 2020 2020 2020 2020 6178                ax
+00023d50: 6573 2e61 7876 6c69 6e65 2875 7070 6572  es.axvline(upper
+00023d60: 5f66 635f 6375 746f 6666 2c20 6c73 203d  _fc_cutoff, ls =
+00023d70: 2027 2d2d 272c 2063 6f6c 6f72 203d 2027   '--', color = '
+00023d80: 6c69 6768 7467 7265 7927 290a 2020 2020  lightgrey').    
+00023d90: 2020 2020 2020 2020 2020 2020 0a20 2020              .   
+00023da0: 2020 2020 2020 2020 2020 2020 2065 6c73               els
+00023db0: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+00023dc0: 2020 2020 2020 2069 6e64 6963 6573 203d         indices =
+00023dd0: 2073 656c 662e 6663 5f64 6174 615b 7365   self.fc_data[se
+00023de0: 6c66 2e66 635f 6461 7461 5b67 656e 655f  lf.fc_data[gene_
+00023df0: 636f 6c75 6d6e 5d2e 6973 696e 2867 656e  column].isin(gen
+00023e00: 655f 6c69 7374 295d 2e69 6e64 6578 0a0a  e_list)].index..
+00023e10: 2020 2020 2020 2020 2020 2020 6966 2067              if g
+00023e20: 656e 655f 6c69 7374 2069 7320 6e6f 7420  ene_list is not 
+00023e30: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+00023e40: 2020 2020 2020 6765 6e65 735f 696e 6469        genes_indi
+00023e50: 6365 7320 3d20 7365 6c66 2e66 635f 6461  ces = self.fc_da
+00023e60: 7461 5b73 656c 662e 6663 5f64 6174 615b  ta[self.fc_data[
+00023e70: 6765 6e65 5f63 6f6c 756d 6e5d 2e69 7369  gene_column].isi
+00023e80: 6e28 6765 6e65 5f6c 6973 7429 5d2e 696e  n(gene_list)].in
+00023e90: 6465 780a 2020 2020 2020 2020 2020 2020  dex.            
+00023ea0: 2020 2020 0a20 2020 2020 2020 2020 2020      .           
+00023eb0: 2020 2020 2069 6620 696e 6469 6365 732e       if indices.
+00023ec0: 746f 6c69 7374 2829 3a0a 2020 2020 2020  tolist():.      
+00023ed0: 2020 2020 2020 2020 2020 2020 2020 696e                in
+00023ee0: 6469 6365 7320 3d20 696e 6469 6365 732e  dices = indices.
+00023ef0: 746f 6c69 7374 2829 202b 2067 656e 6573  tolist() + genes
+00023f00: 5f69 6e64 6963 6573 2e74 6f6c 6973 7428  _indices.tolist(
+00023f10: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00023f20: 2020 2020 2020 0a20 2020 2020 2020 2020        .         
+00023f30: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+00023f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023f50: 2069 6e64 6963 6573 203d 2067 656e 6573   indices = genes
+00023f60: 5f69 6e64 6963 6573 2e74 6f6c 6973 7428  _indices.tolist(
+00023f70: 290a 0a20 2020 2020 2020 2020 2020 2073  )..            s
+00023f80: 6e73 2e73 6361 7474 6572 706c 6f74 2878  ns.scatterplot(x
+00023f90: 203d 2073 656c 662e 6663 5f64 6174 612e   = self.fc_data.
+00023fa0: 6c6f 635b 696e 6469 6365 735d 5b69 5d2c  loc[indices][i],
+00023fb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00023fc0: 2020 2020 2020 2020 2020 2020 2079 203d               y =
+00023fd0: 2073 656c 662e 7076 5f64 6174 612e 6c6f   self.pv_data.lo
+00023fe0: 635b 696e 6469 6365 735d 5b69 5d2c 0a20  c[indices][i],. 
+00023ff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024000: 2020 2020 2020 2020 2020 2063 6f6c 6f72             color
+00024010: 203d 2027 6c69 6768 7462 6c75 6527 2c0a   = 'lightblue',.
+00024020: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024030: 2020 2020 2020 2020 2020 2020 6178 3d61              ax=a
+00024040: 7865 7329 0a20 2020 2020 2020 2020 2020  xes).           
+00024050: 2073 6e73 2e64 6573 7069 6e65 2829 0a0a   sns.despine()..
+00024060: 2020 2020 2020 2020 2020 2020 2320 616e              # an
+00024070: 6e6f 7461 7469 6f6e 0a20 2020 2020 2020  notation.       
+00024080: 2020 2020 2069 6620 696e 6469 6365 733a       if indices:
+00024090: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000240a0: 2074 6578 7473 203d 205b 6178 6573 2e74   texts = [axes.t
+000240b0: 6578 7428 7365 6c66 2e66 635f 6461 7461  ext(self.fc_data
+000240c0: 5b69 5d5b 6964 785d 2c20 7365 6c66 2e70  [i][idx], self.p
+000240d0: 765f 6461 7461 5b69 5d5b 6964 785d 2c20  v_data[i][idx], 
+000240e0: 7365 6c66 2e66 635f 6461 7461 5b67 656e  self.fc_data[gen
+000240f0: 655f 636f 6c75 6d6e 5d5b 6964 785d 2c20  e_column][idx], 
+00024100: 6861 3d27 6365 6e74 6572 272c 2076 613d  ha='center', va=
+00024110: 2763 656e 7465 7227 2c20 666f 6e74 7369  'center', fontsi
+00024120: 7a65 3d39 2920 666f 7220 6964 7820 696e  ze=9) for idx in
+00024130: 2069 6e64 6963 6573 5d0a 2020 2020 2020   indices].      
+00024140: 2020 2020 2020 2020 2020 6164 6a75 7374            adjust
+00024150: 5f74 6578 7428 7465 7874 732c 2061 7272  _text(texts, arr
+00024160: 6f77 7072 6f70 7320 3d20 6469 6374 2861  owprops = dict(a
+00024170: 7272 6f77 7374 796c 6520 3d20 272d 272c  rrowstyle = '-',
+00024180: 2063 6f6c 6f72 203d 2027 626c 6163 6b27   color = 'black'
+00024190: 292c 2061 783d 6178 6573 290a 2020 2020  ), ax=axes).    
+000241a0: 2020 2020 2020 2020 0a20 2020 2020 2020          .       
+000241b0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+000241c0: 2020 2020 2020 2020 2020 2070 6173 730a             pass.
+000241d0: 2020 2020 2020 2020 2020 2020 0a20 2020              .   
+000241e0: 2020 2020 2020 2020 2073 616d 706c 655f           sample_
+000241f0: 616e 6e6f 7420 3d20 692e 7370 6c69 7428  annot = i.split(
+00024200: 272f 2729 0a20 2020 2020 2020 2020 2020  '/').           
+00024210: 2078 3120 3d20 7365 6c66 2e66 635f 6461   x1 = self.fc_da
+00024220: 7461 5b69 5d2e 6d61 7828 290a 2020 2020  ta[i].max().    
+00024230: 2020 2020 2020 2020 7832 203d 2073 656c          x2 = sel
+00024240: 662e 6663 5f64 6174 615b 695d 2e6d 696e  f.fc_data[i].min
+00024250: 2829 0a20 2020 2020 2020 2020 2020 2079  ().            y
+00024260: 203d 2073 656c 662e 7076 5f64 6174 615b   = self.pv_data[
+00024270: 695d 2e6d 6178 2829 0a0a 2020 2020 2020  i].max()..      
+00024280: 2020 2020 2020 6178 6573 2e74 6578 7428        axes.text(
+00024290: 7831 2c20 792c 2073 616d 706c 655f 616e  x1, y, sample_an
+000242a0: 6e6f 745b 305d 2c20 666f 6e74 7369 7a65  not[0], fontsize
+000242b0: 3d31 322c 0a20 2020 2020 2020 2020 2020  =12,.           
+000242c0: 2020 2020 2020 2020 2062 626f 783d 6469           bbox=di
+000242d0: 6374 2862 6f78 7374 796c 653d 2772 6f75  ct(boxstyle='rou
+000242e0: 6e64 272c 2066 633d 2777 272c 2065 633d  nd', fc='w', ec=
+000242f0: 2762 6c61 636b 272c 2061 6c70 6861 3d30  'black', alpha=0
+00024300: 2e33 2929 0a20 2020 2020 2020 2020 2020  .3)).           
+00024310: 2061 7865 732e 7465 7874 2878 322c 2079   axes.text(x2, y
+00024320: 2c20 7361 6d70 6c65 5f61 6e6e 6f74 5b31  , sample_annot[1
+00024330: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
+00024340: 2020 2020 2020 2066 6f6e 7473 697a 653d         fontsize=
+00024350: 3132 2c0a 2020 2020 2020 2020 2020 2020  12,.            
+00024360: 2020 2020 2020 2020 6262 6f78 3d64 6963          bbox=dic
+00024370: 7428 626f 7873 7479 6c65 3d27 726f 756e  t(boxstyle='roun
+00024380: 6427 2c20 6663 3d27 7727 2c20 6563 3d27  d', fc='w', ec='
+00024390: 626c 6163 6b27 2c20 616c 7068 613d 302e  black', alpha=0.
+000243a0: 3329 290a 0a20 2020 2020 2020 2020 2020  3))..           
+000243b0: 2066 6967 2e74 6967 6874 5f6c 6179 6f75   fig.tight_layou
+000243c0: 7428 290a 0a20 2020 2020 2020 2020 2020  t()..           
+000243d0: 2069 6620 7361 7665 6669 6720 3d3d 2054   if savefig == T
+000243e0: 7275 653a 0a20 2020 2020 2020 2020 2020  rue:.           
+000243f0: 2020 2020 2066 6967 2e73 6176 6566 6967       fig.savefig
+00024400: 2866 277b 692e 7265 706c 6163 6528 222f  (f'{i.replace("/
+00024410: 222c 2022 5f76 735f 2229 7d5f 766f 6c63  ", "_vs_")}_volc
+00024420: 616e 6f2e 7064 6627 2c20 6262 6f78 5f69  ano.pdf', bbox_i
+00024430: 6e63 6865 7320 3d20 2274 6967 6874 2229  nches = "tight")
+00024440: 0a0a 2020 2020 6465 6620 7369 676e 5f70  ..    def sign_p
+00024450: 726f 7473 5f70 6c6f 7428 7365 6c66 2c20  rots_plot(self, 
+00024460: 6e6f 726d 616c 697a 6564 3d46 616c 7365  normalized=False
+00024470: 2c20 6669 6773 697a 653d 2838 2c20 3529  , figsize=(8, 5)
+00024480: 2c20 7361 7665 6669 673d 4661 6c73 6529  , savefig=False)
+00024490: 3a0a 0a20 2020 2020 2020 2022 2222 506c  :..        """Pl
+000244a0: 6f74 206e 756d 6265 7220 6f66 2073 6967  ot number of sig
+000244b0: 6e69 6669 6361 6e74 2070 726f 7465 696e  nificant protein
+000244c0: 732e 0a0a 2020 2020 2020 2020 5061 7261  s...        Para
+000244d0: 6d65 7465 7273 0a20 2020 2020 2020 202d  meters.        -
+000244e0: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
+000244f0: 2020 6e6f 726d 616c 697a 6564 203a 2062    normalized : b
+00024500: 6f6f 6c65 616e 0a20 2020 2020 2020 2020  oolean.         
+00024510: 2020 2049 6620 5472 7565 2064 6973 706c     If True displ
+00024520: 6179 7320 6e75 6d62 6572 206f 6620 7369  ays number of si
+00024530: 676e 6966 6963 616e 7420 7072 6f74 6569  gnificant protei
+00024540: 6e73 2069 6e20 2520 2844 6566 6175 6c74  ns in % (Default
+00024550: 2076 616c 7565 203d 2046 616c 7365 292e   value = False).
+00024560: 0a20 2020 2020 2020 2066 6967 7369 7a65  .        figsize
+00024570: 203a 2074 7570 6c65 0a20 2020 2020 2020   : tuple.       
+00024580: 2020 2020 2046 6967 7572 6520 7369 7a65       Figure size
+00024590: 2028 4465 6661 756c 7420 7661 6c75 6520   (Default value 
+000245a0: 3d20 2838 2c35 292e 0a20 2020 2020 2020  = (8,5)..       
+000245b0: 2073 6176 6566 6967 203a 2062 6f6f 6c65   savefig : boole
+000245c0: 616e 0a20 2020 2020 2020 2020 2020 2049  an.            I
+000245d0: 6620 5472 7565 2073 6176 6573 2066 6967  f True saves fig
+000245e0: 7572 6520 2844 6566 6175 6c74 2076 616c  ure (Default val
+000245f0: 7565 203d 2046 616c 7365 292e 0a20 2020  ue = False)..   
+00024600: 2020 2020 2035 2920 3a0a 2020 2020 2020       5) :.      
+00024610: 2020 2020 2020 0a0a 2020 2020 2020 2020        ..        
+00024620: 5265 7475 726e 730a 2020 2020 2020 2020  Returns.        
+00024630: 2d2d 2d2d 2d2d 2d0a 0a20 2020 2020 2020  -------..       
+00024640: 200a 2020 2020 2020 2020 2222 220a 0a20   .        """.. 
+00024650: 2020 2020 2020 2073 6967 6e5f 6461 7461         sign_data
+00024660: 203d 2028 7365 6c66 2e71 765f 6461 7461   = (self.qv_data
+00024670: 2e73 656c 6563 745f 6474 7970 6573 2827  .select_dtypes('
+00024680: 666c 6f61 7427 2920 3c20 302e 3035 292e  float') < 0.05).
+00024690: 7375 6d28 6178 6973 3d30 290a 2020 2020  sum(axis=0).    
+000246a0: 2020 2020 6e6f 726d 5f73 6967 6e5f 6461      norm_sign_da
+000246b0: 7461 203d 2028 2873 656c 662e 7176 5f64  ta = ((self.qv_d
+000246c0: 6174 612e 7365 6c65 6374 5f64 7479 7065  ata.select_dtype
+000246d0: 7328 2766 6c6f 6174 2729 203c 2030 2e30  s('float') < 0.0
+000246e0: 3529 2e73 756d 2861 7869 733d 3029 2f73  5).sum(axis=0)/s
+000246f0: 656c 662e 7176 5f64 6174 612e 7368 6170  elf.qv_data.shap
+00024700: 655b 305d 292a 3130 300a 2020 2020 2020  e[0])*100.      
+00024710: 2020 7820 3d20 5b74 6578 7477 7261 702e    x = [textwrap.
+00024720: 6669 6c6c 2869 2c38 2920 2066 6f72 2069  fill(i,8)  for i
+00024730: 2069 6e20 7369 676e 5f64 6174 612e 696e   in sign_data.in
+00024740: 6465 785d 0a20 2020 2020 2020 2070 6c74  dex].        plt
+00024750: 2e66 6967 7572 6528 6669 6773 697a 653d  .figure(figsize=
+00024760: 6669 6773 697a 6529 0a20 2020 2020 2020  figsize).       
+00024770: 2069 6620 6e6f 726d 616c 697a 6564 2069   if normalized i
+00024780: 7320 5472 7565 3a0a 2020 2020 2020 2020  s True:.        
+00024790: 2020 2020 736e 732e 6261 7270 6c6f 7428      sns.barplot(
+000247a0: 783d 782c 2079 3d6e 6f72 6d5f 7369 676e  x=x, y=norm_sign
+000247b0: 5f64 6174 612e 7661 6c75 6573 290a 2020  _data.values).  
+000247c0: 2020 2020 2020 2020 2020 706c 742e 796c            plt.yl
+000247d0: 6162 656c 2827 6e75 6d62 6572 206f 6620  abel('number of 
+000247e0: 7369 676e 6966 6963 616e 7420 7072 6f74  significant prot
+000247f0: 6569 6e73 2069 6e20 2527 290a 2020 2020  eins in %').    
+00024800: 2020 2020 0a20 2020 2020 2020 2065 6c73      .        els
+00024810: 653a 0a20 2020 2020 2020 2020 2020 2073  e:.            s
+00024820: 6e73 2e62 6172 706c 6f74 2878 3d78 2c20  ns.barplot(x=x, 
+00024830: 793d 7369 676e 5f64 6174 612e 7661 6c75  y=sign_data.valu
+00024840: 6573 290a 2020 2020 2020 2020 2020 2020  es).            
+00024850: 706c 742e 796c 6162 656c 2827 6e75 6d62  plt.ylabel('numb
+00024860: 6572 206f 6620 7369 676e 6966 6963 616e  er of significan
+00024870: 7420 7072 6f74 6569 6e73 2729 0a20 2020  t proteins').   
+00024880: 2020 2020 2020 2020 200a 2020 2020 2020           .      
+00024890: 2020 2020 2020 736e 732e 6465 7370 696e        sns.despin
+000248a0: 6528 290a 0a20 2020 2020 2020 2069 6620  e()..        if 
+000248b0: 7361 7665 6669 6720 6973 2054 7275 653a  savefig is True:
+000248c0: 0a20 2020 2020 2020 2020 2020 2070 6c74  .            plt
+000248d0: 2e73 6176 6566 6967 2827 7369 676e 5f70  .savefig('sign_p
+000248e0: 726f 7473 5f70 6c6f 742e 7064 6627 2c20  rots_plot.pdf', 
+000248f0: 7472 616e 7370 6172 656e 743d 5472 7565  transparent=True
+00024900: 2c20 6262 6f78 5f69 6e63 6865 733d 2774  , bbox_inches='t
+00024910: 6967 6874 2729 0a0a 2020 2020 6465 6620  ight')..    def 
+00024920: 696e 745f 766f 6c63 616e 6f5f 706c 6f74  int_volcano_plot
+00024930: 2873 656c 662c 206e 5f72 6f77 732c 206e  (self, n_rows, n
+00024940: 5f63 6f6c 732c 2068 6569 6768 742c 2077  _cols, height, w
+00024950: 6964 7468 2c20 616e 6e6f 745f 6765 6e65  idth, annot_gene
+00024960: 7320 3d5b 5d2c 2075 7070 6572 5f66 635f  s =[], upper_fc_
+00024970: 6375 746f 6666 203d 204e 6f6e 652c 206c  cutoff = None, l
+00024980: 6f77 6572 5f66 635f 6375 746f 6666 3d4e  ower_fc_cutoff=N
+00024990: 6f6e 652c 2071 765f 6375 746f 6666 203d  one, qv_cutoff =
+000249a0: 2046 616c 7365 293a 0a0a 2020 2020 2020   False):..      
+000249b0: 2020 696e 6469 6365 7320 3d20 7365 6c66    indices = self
+000249c0: 2e66 635f 6461 7461 5b73 656c 662e 6663  .fc_data[self.fc
+000249d0: 5f64 6174 615b 2747 656e 6573 275d 2e69  _data['Genes'].i
+000249e0: 7369 6e28 616e 6e6f 745f 6765 6e65 7329  sin(annot_genes)
+000249f0: 5d2e 696e 6465 782e 746f 5f6c 6973 7428  ].index.to_list(
+00024a00: 290a 0a20 2020 2020 2020 2066 6967 203d  )..        fig =
+00024a10: 206d 616b 655f 7375 6270 6c6f 7473 2872   make_subplots(r
+00024a20: 6f77 733d 6e5f 726f 7773 2c20 636f 6c73  ows=n_rows, cols
+00024a30: 3d6e 5f63 6f6c 7329 0a20 2020 2020 2020  =n_cols).       
+00024a40: 200a 2020 2020 2020 2020 666f 7220 692c   .        for i,
+00024a50: 2063 6f6c 5f6e 616d 6520 696e 2065 6e75   col_name in enu
+00024a60: 6d65 7261 7465 2873 656c 662e 6663 5f64  merate(self.fc_d
+00024a70: 6174 612e 7365 6c65 6374 5f64 7479 7065  ata.select_dtype
+00024a80: 7328 666c 6f61 7429 2e63 6f6c 756d 6e73  s(float).columns
+00024a90: 2e74 6f6c 6973 7428 292c 2073 7461 7274  .tolist(), start
+00024aa0: 3d31 293a 0a20 2020 2020 2020 2020 2020  =1):.           
+00024ab0: 200a 2020 2020 2020 2020 2020 2020 2320   .            # 
+00024ac0: 4372 6561 7465 2061 206c 6973 7420 6f66  Create a list of
+00024ad0: 2063 6f6c 6f72 7320 6261 7365 6420 6f6e   colors based on
+00024ae0: 2074 6865 2071 7620 616e 6420 6663 2076   the qv and fc v
+00024af0: 616c 7565 730a 2020 2020 2020 2020 2020  alues.          
+00024b00: 2020 636f 6c6f 725f 6c69 7374 203d 5b5d    color_list =[]
+00024b10: 0a20 2020 2020 2020 2020 2020 2066 635f  .            fc_
+00024b20: 696e 6469 6365 7320 3d20 5b5d 0a0a 2020  indices = []..  
+00024b30: 2020 2020 2020 2020 2020 666f 7220 6964            for id
+00024b40: 7820 696e 206e 702e 6172 616e 6765 2873  x in np.arange(s
+00024b50: 656c 662e 6663 5f64 6174 612e 7368 6170  elf.fc_data.shap
+00024b60: 655b 305d 293a 0a0a 2020 2020 2020 2020  e[0]):..        
+00024b70: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+00024b80: 7176 5f64 6174 612e 6c6f 635b 6964 782c  qv_data.loc[idx,
+00024b90: 2063 6f6c 5f6e 616d 655d 203c 2030 2e30   col_name] < 0.0
+00024ba0: 3520 616e 6420 7365 6c66 2e66 635f 6461  5 and self.fc_da
+00024bb0: 7461 2e6c 6f63 5b69 6478 2c20 636f 6c5f  ta.loc[idx, col_
+00024bc0: 6e61 6d65 5d20 3e30 3a0a 2020 2020 2020  name] >0:.      
+00024bd0: 2020 2020 2020 2020 2020 2020 2020 636f                co
+00024be0: 6c6f 725f 6c69 7374 2e61 7070 656e 6428  lor_list.append(
+00024bf0: 276c 6967 6874 636f 7261 6c27 290a 0a20  'lightcoral').. 
+00024c00: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+00024c10: 6c69 6620 7365 6c66 2e71 765f 6461 7461  lif self.qv_data
+00024c20: 2e6c 6f63 5b69 6478 2c20 636f 6c5f 6e61  .loc[idx, col_na
+00024c30: 6d65 5d20 3c30 2e30 3520 616e 6420 7365  me] <0.05 and se
+00024c40: 6c66 2e66 635f 6461 7461 2e6c 6f63 5b69  lf.fc_data.loc[i
+00024c50: 6478 2c20 636f 6c5f 6e61 6d65 5d20 3c30  dx, col_name] <0
+00024c60: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00024c70: 2020 2020 2020 636f 6c6f 725f 6c69 7374        color_list
+00024c80: 2e61 7070 656e 6428 2763 6f72 6e66 6c6f  .append('cornflo
+00024c90: 7765 7262 6c75 6527 290a 0a20 2020 2020  werblue')..     
+00024ca0: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+00024cb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00024cc0: 2020 2020 2063 6f6c 6f72 5f6c 6973 742e       color_list.
+00024cd0: 6170 7065 6e64 2827 6c69 6768 7467 7265  append('lightgre
+00024ce0: 7927 290a 2020 2020 2020 2020 2020 2020  y').            
+00024cf0: 0a20 2020 2020 2020 2020 2020 2023 2043  .            # C
+00024d00: 7265 6174 6520 616e 2061 6e6e 6f74 6174  reate an annotat
+00024d10: 696f 6e20 6c69 7374 2062 6173 6564 206f  ion list based o
+00024d20: 6e20 666f 6c64 2063 6861 6e67 6520 6375  n fold change cu
+00024d30: 746f 6666 0a20 2020 2020 2020 2020 2020  toff.           
+00024d40: 2069 6620 7176 5f63 7574 6f66 6620 6973   if qv_cutoff is
+00024d50: 2054 7275 653a 0a20 2020 2020 2020 2020   True:.         
+00024d60: 2020 2020 2020 2069 6620 7570 7065 725f         if upper_
+00024d70: 6663 5f63 7574 6f66 6620 6973 206e 6f74  fc_cutoff is not
+00024d80: 204e 6f6e 6520 616e 6420 6c6f 7765 725f   None and lower_
+00024d90: 6663 5f63 7574 6f66 6620 6973 204e 6f6e  fc_cutoff is Non
+00024da0: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+00024db0: 2020 2020 2020 2066 635f 696e 6469 6365         fc_indice
+00024dc0: 7320 3d20 7365 6c66 2e66 635f 6461 7461  s = self.fc_data
+00024dd0: 5b28 7365 6c66 2e71 765f 6461 7461 5b63  [(self.qv_data[c
+00024de0: 6f6c 5f6e 616d 655d 203c 2030 2e30 3529  ol_name] < 0.05)
+00024df0: 2026 0a20 2020 2020 2020 2020 2020 2020   &.             
+00024e00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024e10: 2020 2020 2020 2020 2020 2020 2020 2028                 (
+00024e20: 7365 6c66 2e66 635f 6461 7461 5b63 6f6c  self.fc_data[col
+00024e30: 5f6e 616d 655d 203e 2075 7070 6572 5f66  _name] > upper_f
+00024e40: 635f 6375 746f 6666 295d 2e69 6e64 6578  c_cutoff)].index
+00024e50: 2e74 6f5f 6c69 7374 2829 0a20 2020 2020  .to_list().     
+00024e60: 2020 2020 2020 2020 2020 200a 2020 2020             .    
+00024e70: 2020 2020 2020 2020 2020 2020 656c 6966              elif
+00024e80: 206c 6f77 6572 5f66 635f 6375 746f 6666   lower_fc_cutoff
+00024e90: 2069 7320 6e6f 7420 4e6f 6e65 2061 6e64   is not None and
+00024ea0: 2075 7070 6572 5f66 635f 6375 746f 6666   upper_fc_cutoff
+00024eb0: 2069 7320 4e6f 6e65 3a0a 2020 2020 2020   is None:.      
+00024ec0: 2020 2020 2020 2020 2020 2020 2020 6663                fc
+00024ed0: 5f69 6e64 6963 6573 203d 2073 656c 662e  _indices = self.
+00024ee0: 6663 5f64 6174 615b 2873 656c 662e 7176  fc_data[(self.qv
+00024ef0: 5f64 6174 615b 636f 6c5f 6e61 6d65 5d20  _data[col_name] 
+00024f00: 3c20 302e 3035 2920 260a 2020 2020 2020  < 0.05) &.      
+00024f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024f30: 2020 2020 2020 2873 656c 662e 6663 5f64        (self.fc_d
+00024f40: 6174 615b 636f 6c5f 6e61 6d65 5d20 3c20  ata[col_name] < 
+00024f50: 6c6f 7765 725f 6663 5f63 7574 6f66 6629  lower_fc_cutoff)
+00024f60: 5d2e 696e 6465 782e 746f 5f6c 6973 7428  ].index.to_list(
+00024f70: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00024f80: 2020 0a20 2020 2020 2020 2020 2020 2020    .             
+00024f90: 2020 2065 6c69 6620 6c6f 7765 725f 6663     elif lower_fc
+00024fa0: 5f63 7574 6f66 6620 6973 206e 6f74 204e  _cutoff is not N
+00024fb0: 6f6e 6520 616e 6420 7570 7065 725f 6663  one and upper_fc
+00024fc0: 5f63 7574 6f66 6620 6973 206e 6f74 204e  _cutoff is not N
+00024fd0: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
+00024fe0: 2020 2020 2020 2020 2066 635f 696e 6469           fc_indi
+00024ff0: 6365 7320 3d20 7365 6c66 2e66 635f 6461  ces = self.fc_da
+00025000: 7461 5b28 7365 6c66 2e71 765f 6461 7461  ta[(self.qv_data
+00025010: 5b63 6f6c 5f6e 616d 655d 203c 2030 2e30  [col_name] < 0.0
+00025020: 3529 2026 0a20 2020 2020 2020 2020 2020  5) &.           
+00025030: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025040: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025050: 2028 2873 656c 662e 6663 5f64 6174 615b   ((self.fc_data[
+00025060: 636f 6c5f 6e61 6d65 5d20 3e20 7570 7065  col_name] > uppe
+00025070: 725f 6663 5f63 7574 6f66 6629 207c 0a20  r_fc_cutoff) |. 
+00025080: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025090: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000250a0: 2020 2020 2020 2020 2020 2028 7365 6c66             (self
+000250b0: 2e66 635f 6461 7461 5b63 6f6c 5f6e 616d  .fc_data[col_nam
+000250c0: 655d 203c 206c 6f77 6572 5f66 635f 6375  e] < lower_fc_cu
+000250d0: 746f 6666 2929 5d2e 696e 6465 782e 746f  toff))].index.to
+000250e0: 5f6c 6973 7428 290a 2020 2020 2020 2020  _list().        
+000250f0: 2020 2020 2020 2020 2020 2020 0a20 2020              .   
+00025100: 2020 2020 2020 2020 2069 6620 7176 5f63           if qv_c
+00025110: 7574 6f66 6620 6973 2046 616c 7365 3a0a  utoff is False:.
+00025120: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025130: 6966 2075 7070 6572 5f66 635f 6375 746f  if upper_fc_cuto
+00025140: 6666 2069 7320 6e6f 7420 4e6f 6e65 2061  ff is not None a
+00025150: 6e64 206c 6f77 6572 5f66 635f 6375 746f  nd lower_fc_cuto
+00025160: 6666 2069 7320 4e6f 6e65 3a0a 2020 2020  ff is None:.    
+00025170: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025180: 6663 5f69 6e64 6963 6573 203d 2073 656c  fc_indices = sel
+00025190: 662e 6663 5f64 6174 615b 2873 656c 662e  f.fc_data[(self.
+000251a0: 6663 5f64 6174 615b 636f 6c5f 6e61 6d65  fc_data[col_name
+000251b0: 5d20 3e20 7570 7065 725f 6663 5f63 7574  ] > upper_fc_cut
+000251c0: 6f66 6629 5d2e 696e 6465 782e 746f 5f6c  off)].index.to_l
+000251d0: 6973 7428 290a 2020 2020 2020 2020 2020  ist().          
+000251e0: 2020 2020 2020 0a20 2020 2020 2020 2020        .         
+000251f0: 2020 2020 2020 2065 6c69 6620 6c6f 7765         elif lowe
+00025200: 725f 6663 5f63 7574 6f66 6620 6973 206e  r_fc_cutoff is n
+00025210: 6f74 204e 6f6e 6520 616e 6420 7570 7065  ot None and uppe
+00025220: 725f 6663 5f63 7574 6f66 6620 6973 204e  r_fc_cutoff is N
+00025230: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
+00025240: 2020 2020 2020 2020 2066 635f 696e 6469           fc_indi
+00025250: 6365 7320 3d20 7365 6c66 2e66 635f 6461  ces = self.fc_da
+00025260: 7461 5b28 7365 6c66 2e66 635f 6461 7461  ta[(self.fc_data
+00025270: 5b63 6f6c 5f6e 616d 655d 203c 206c 6f77  [col_name] < low
+00025280: 6572 5f66 635f 6375 746f 6666 295d 2e69  er_fc_cutoff)].i
+00025290: 6e64 6578 2e74 6f5f 6c69 7374 2829 0a20  ndex.to_list(). 
+000252a0: 2020 2020 2020 2020 2020 2020 2020 200a                 .
+000252b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000252c0: 656c 6966 206c 6f77 6572 5f66 635f 6375  elif lower_fc_cu
+000252d0: 746f 6666 2069 7320 6e6f 7420 4e6f 6e65  toff is not None
+000252e0: 2061 6e64 2075 7070 6572 5f66 635f 6375   and upper_fc_cu
+000252f0: 746f 6666 2069 7320 6e6f 7420 4e6f 6e65  toff is not None
+00025300: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00025310: 2020 2020 2020 6663 5f69 6e64 6963 6573        fc_indices
+00025320: 203d 2073 656c 662e 6663 5f64 6174 615b   = self.fc_data[
+00025330: 2828 7365 6c66 2e66 635f 6461 7461 5b63  ((self.fc_data[c
+00025340: 6f6c 5f6e 616d 655d 203e 2075 7070 6572  ol_name] > upper
+00025350: 5f66 635f 6375 746f 6666 2920 7c0a 2020  _fc_cutoff) |.  
+00025360: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025370: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025380: 2020 2020 2020 2020 2020 2020 2028 7365               (se
+00025390: 6c66 2e66 635f 6461 7461 5b63 6f6c 5f6e  lf.fc_data[col_n
+000253a0: 616d 655d 203c 206c 6f77 6572 5f66 635f  ame] < lower_fc_
+000253b0: 6375 746f 6666 2929 5d2e 696e 6465 782e  cutoff))].index.
+000253c0: 746f 5f6c 6973 7428 290a 2020 2020 2020  to_list().      
+000253d0: 2020 2020 2020 2020 2020 2020 2020 0a20                . 
+000253e0: 2020 2020 2020 2020 2020 2023 2043 616c             # Cal
+000253f0: 6375 6c61 7465 2072 6f77 2061 6e64 2063  culate row and c
+00025400: 6f6c 2076 616c 7565 7320 666f 7220 7468  ol values for th
+00025410: 6520 7375 6270 6c6f 7473 2062 6173 6564  e subplots based
+00025420: 206f 6e20 690a 2020 2020 2020 2020 2020   on i.          
+00025430: 2020 726f 7720 3d20 2869 202d 2031 2920    row = (i - 1) 
+00025440: 2f2f 206e 5f63 6f6c 7320 2b20 310a 2020  // n_cols + 1.  
+00025450: 2020 2020 2020 2020 2020 636f 6c20 3d20            col = 
+00025460: 2869 202d 2031 2920 2520 6e5f 636f 6c73  (i - 1) % n_cols
+00025470: 202b 2031 0a20 2020 2020 2020 2020 2020   + 1.           
+00025480: 200a 2020 2020 2020 2020 2020 2020 7465   .            te
+00025490: 7874 203d 205b 6765 6e65 2b27 2c20 272b  xt = [gene+', '+
+000254a0: 6465 7363 7269 7074 696f 6e0a 2020 2020  description.    
+000254b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000254c0: 666f 7220 6765 6e65 2c20 6465 7363 7269  for gene, descri
+000254d0: 7074 696f 6e0a 2020 2020 2020 2020 2020  ption.          
+000254e0: 2020 2020 2020 2020 2020 696e 207a 6970            in zip
+000254f0: 2873 656c 662e 6663 5f64 6174 615b 2747  (self.fc_data['G
+00025500: 656e 6573 275d 2c0a 2020 2020 2020 2020  enes'],.        
+00025510: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025520: 2020 2073 656c 662e 6663 5f64 6174 615b     self.fc_data[
+00025530: 2746 6972 7374 2e50 726f 7465 696e 2e44  'First.Protein.D
+00025540: 6573 6372 6970 7469 6f6e 275d 295d 0a20  escription'])]. 
+00025550: 2020 2020 2020 2020 2020 200a 2020 2020             .    
+00025560: 2020 2020 2020 2020 2320 4164 6420 7468          # Add th
+00025570: 6520 7363 6174 7465 7220 706c 6f74 7320  e scatter plots 
+00025580: 746f 2074 6865 2073 7562 706c 6f74 7320  to the subplots 
+00025590: 6c61 796f 7574 0a20 2020 2020 2020 2020  layout.         
+000255a0: 2020 2066 6967 2e61 6464 5f74 7261 6365     fig.add_trace
+000255b0: 2867 6f2e 5363 6174 7465 7228 783d 7365  (go.Scatter(x=se
+000255c0: 6c66 2e66 635f 6461 7461 5b63 6f6c 5f6e  lf.fc_data[col_n
+000255d0: 616d 655d 2c0a 2020 2020 2020 2020 2020  ame],.          
+000255e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000255f0: 2020 2020 2020 2020 2020 2079 3d73 656c             y=sel
+00025600: 662e 7076 5f64 6174 615b 636f 6c5f 6e61  f.pv_data[col_na
+00025610: 6d65 5d2c 0a20 2020 2020 2020 2020 2020  me],.           
+00025620: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025630: 2020 2020 2020 2020 2020 6d6f 6465 3d27            mode='
+00025640: 6d61 726b 6572 7327 2c0a 2020 2020 2020  markers',.      
+00025650: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025660: 2020 2020 2020 2020 2020 2020 2020 206d                 m
+00025670: 6172 6b65 723d 6469 6374 2863 6f6c 6f72  arker=dict(color
+00025680: 3d63 6f6c 6f72 5f6c 6973 7429 2c0a 2020  =color_list),.  
+00025690: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000256a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000256b0: 2020 2074 6578 743d 7465 7874 292c 0a20     text=text),. 
+000256c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000256d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000256e0: 2020 2020 726f 773d 726f 772c 0a20 2020      row=row,.   
+000256f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025700: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025710: 2020 636f 6c3d 636f 6c29 0a0a 2020 2020    col=col)..    
+00025720: 2020 2020 2020 2020 6669 672e 6164 645f          fig.add_
+00025730: 7472 6163 6528 676f 2e53 6361 7474 6572  trace(go.Scatter
+00025740: 2878 3d73 656c 662e 6663 5f64 6174 612e  (x=self.fc_data.
+00025750: 6c6f 635b 696e 6469 6365 7320 2b20 6663  loc[indices + fc
+00025760: 5f69 6e64 6963 6573 2c20 636f 6c5f 6e61  _indices, col_na
+00025770: 6d65 5d2c 0a20 2020 2020 2020 2020 2020  me],.           
+00025780: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025790: 2020 2020 2020 2020 2020 793d 7365 6c66            y=self
+000257a0: 2e70 765f 6461 7461 2e6c 6f63 5b69 6e64  .pv_data.loc[ind
+000257b0: 6963 6573 202b 2066 635f 696e 6469 6365  ices + fc_indice
+000257c0: 732c 2063 6f6c 5f6e 616d 655d 2c0a 2020  s, col_name],.  
+000257d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000257e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000257f0: 2020 206d 6f64 653d 276d 6172 6b65 7273     mode='markers
+00025800: 272c 0a20 2020 2020 2020 2020 2020 2020  ',.             
+00025810: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025820: 2020 2020 2020 2020 6d61 726b 6572 3d64          marker=d
+00025830: 6963 7428 636f 6c6f 723d 276c 6967 6874  ict(color='light
+00025840: 626c 7565 2729 292c 0a20 2020 2020 2020  blue')),.       
+00025850: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025860: 2020 2020 2020 2020 2020 2020 2020 726f                ro
+00025870: 773d 726f 772c 0a20 2020 2020 2020 2020  w=row,.         
 00025880: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025890: 2020 2020 2066 6f6e 743d 7b27 636f 6c6f       font={'colo
-000258a0: 7227 3a20 2762 6c61 636b 272c 2027 7369  r': 'black', 'si
-000258b0: 7a65 273a 2031 367d 2c0a 2020 2020 2020  ze': 16},.      
-000258c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000258d0: 2020 7368 6f77 6172 726f 773d 4661 6c73    showarrow=Fals
-000258e0: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
-000258f0: 2020 2020 2020 2020 2020 2062 6763 6f6c             bgcol
-00025900: 6f72 3d27 7267 6261 2832 3435 2c20 3232  or='rgba(245, 22
-00025910: 322c 2031 3739 2c20 302e 3229 272c 200a  2, 179, 0.2)', .
-00025920: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025930: 2020 2020 2020 2020 626f 7264 6572 636f          borderco
-00025940: 6c6f 723d 2262 6c61 636b 222c 200a 2020  lor="black", .  
-00025950: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025960: 2020 2020 2020 626f 7264 6572 7769 6474        borderwidt
-00025970: 683d 312c 0a20 2020 2020 2020 2020 2020  h=1,.           
-00025980: 2020 2020 2020 2020 2020 2020 2062 6f72               bor
-00025990: 6465 7270 6164 3d33 2c20 200a 2020 2020  derpad=3,  .    
-000259a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000259b0: 2020 2020 292c 0a20 2020 2020 2020 2020      ),.         
-000259c0: 2020 2020 2020 2072 6f77 3d72 6f77 2c0a         row=row,.
-000259d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000259e0: 636f 6c3d 636f 6c20 2020 200a 2020 2020  col=col    .    
-000259f0: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
-00025a00: 2020 2020 2020 2020 2020 2066 6967 2e75             fig.u
-00025a10: 7064 6174 655f 7861 7865 7328 7469 746c  pdate_xaxes(titl
-00025a20: 655f 7465 7874 3d66 276c 6f67 3220 666f  e_text=f'log2 fo
-00025a30: 6c64 2063 6861 6e67 6527 290a 2020 2020  ld change').    
-00025a40: 2020 2020 2020 2020 6669 672e 7570 6461          fig.upda
-00025a50: 7465 5f79 6178 6573 2874 6974 6c65 5f74  te_yaxes(title_t
-00025a60: 6578 743d 6627 2d6c 6f67 3130 2070 2d76  ext=f'-log10 p-v
-00025a70: 616c 7565 2729 0a0a 2020 2020 2020 2020  alue')..        
-00025a80: 2320 5570 6461 7465 2074 6865 206c 6179  # Update the lay
-00025a90: 6f75 7420 616e 6420 7472 6163 6573 0a20  out and traces. 
-00025aa0: 2020 2020 2020 2066 6967 2e75 7064 6174         fig.updat
-00025ab0: 655f 6c61 796f 7574 2874 656d 706c 6174  e_layout(templat
-00025ac0: 653d 2773 696d 706c 655f 7768 6974 6527  e='simple_white'
-00025ad0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00025ae0: 2020 2020 2020 2020 2020 2020 6865 6967              heig
-00025af0: 6874 3d68 6569 6768 742c 0a20 2020 2020  ht=height,.     
-00025b00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025b10: 2020 2020 2077 6964 7468 3d77 6964 7468       width=width
-00025b20: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00025b30: 2020 2020 2020 2020 2020 2020 686f 7665              hove
-00025b40: 726c 6162 656c 3d64 6963 7428 0a20 2020  rlabel=dict(.   
-00025b50: 2020 2020 2020 2020 2062 6763 6f6c 6f72           bgcolor
-00025b60: 3d22 7768 6974 6522 2c0a 2020 2020 2020  ="white",.      
-00025b70: 2020 2020 2020 666f 6e74 5f73 697a 653d        font_size=
-00025b80: 3136 290a 2020 2020 2020 2020 2020 2020  16).            
-00025b90: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-00025ba0: 2020 2020 2020 6669 672e 7570 6461 7465        fig.update
-00025bb0: 5f74 7261 6365 7328 6d61 726b 6572 3d64  _traces(marker=d
-00025bc0: 6963 7428 7369 7a65 3d38 292c 2073 656c  ict(size=8), sel
-00025bd0: 6563 746f 723d 6469 6374 286d 6f64 653d  ector=dict(mode=
-00025be0: 276d 6172 6b65 7273 2729 290a 0a20 2020  'markers'))..   
-00025bf0: 2020 2020 2023 2053 686f 7720 7468 6520       # Show the 
-00025c00: 706c 6f74 0a20 2020 2020 2020 2069 6620  plot.        if 
-00025c10: 6973 5f6a 7570 7974 6572 5f6e 6f74 6562  is_jupyter_noteb
-00025c20: 6f6f 6b28 293a 0a20 2020 2020 2020 2020  ook():.         
-00025c30: 2020 2066 6967 2e73 686f 7728 290a 2020     fig.show().  
-00025c40: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-00025c50: 2020 2020 2020 2020 7374 2e70 6c6f 746c          st.plotl
-00025c60: 795f 6368 6172 7428 6669 672c 2075 7365  y_chart(fig, use
-00025c70: 5f63 6f6e 7461 696e 6572 5f77 6964 7468  _container_width
-00025c80: 3d54 7275 6529 0000 0000 0000 0000 0000  =True)..........
-00025c90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00025ca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00025cb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00025cc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00025cd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00025ce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00025cf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00025d00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00025d10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00025d20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00025d30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00025d40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00025d50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00025d60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00025d70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00025d80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00025d90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00025da0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00025db0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00025dc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00025dd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00025de0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00025df0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00025e00: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-00025e10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00025e20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00025e30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00025e40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00025e50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00025e60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-00025e70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00025e80: 3030 3030 3033 3400 3030 3030 3030 3030  0000034.00000000
-00025e90: 3030 3000 3031 3032 3132 0020 7800 0000  000.010212. x...
-00025ea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00025eb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00025ec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00025ed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00025ee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00025ef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00025f00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-00025f10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00025f20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00025f30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00025f40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00025f50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00025f60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00025f70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00025f80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00025f90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00025fa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00025fb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00025fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00025fd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00025fe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00025ff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026000: 3238 206d 7469 6d65 3d31 3638 3834 3937  28 mtime=1688497
-00026010: 3331 392e 3830 3535 3933 350a 0000 0000  319.8055935.....
-00026020: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026060: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026070: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026080: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00025890: 2020 2020 2020 2020 2020 2020 636f 6c3d              col=
+000258a0: 636f 6c29 0a0a 2020 2020 2020 2020 2020  col)..          
+000258b0: 2020 2320 4164 6420 616e 6e6f 7461 7469    # Add annotati
+000258c0: 6f6e 7320 746f 2074 6865 2073 7562 706c  ons to the subpl
+000258d0: 6f74 730a 2020 2020 2020 2020 2020 2020  ots.            
+000258e0: 666f 7220 6964 7820 696e 2028 696e 6469  for idx in (indi
+000258f0: 6365 7320 2b20 6663 5f69 6e64 6963 6573  ces + fc_indices
+00025900: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+00025910: 2020 2066 6967 2e61 6464 5f61 6e6e 6f74     fig.add_annot
+00025920: 6174 696f 6e28 0a20 2020 2020 2020 2020  ation(.         
+00025930: 2020 2020 2020 2020 2020 2064 6963 7428             dict(
+00025940: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00025950: 2020 2020 2020 2020 2078 3d73 656c 662e           x=self.
+00025960: 6663 5f64 6174 612e 6c6f 635b 6964 782c  fc_data.loc[idx,
+00025970: 2063 6f6c 5f6e 616d 655d 2c0a 2020 2020   col_name],.    
+00025980: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025990: 2020 2020 793d 7365 6c66 2e70 765f 6461      y=self.pv_da
+000259a0: 7461 2e6c 6f63 5b69 6478 2c20 636f 6c5f  ta.loc[idx, col_
+000259b0: 6e61 6d65 5d2c 0a20 2020 2020 2020 2020  name],.         
+000259c0: 2020 2020 2020 2020 2020 2020 2020 2074                 t
+000259d0: 6578 743d 7365 6c66 2e66 635f 6461 7461  ext=self.fc_data
+000259e0: 2e6c 6f63 5b69 6478 2c20 2747 656e 6573  .loc[idx, 'Genes
+000259f0: 275d 2c0a 2020 2020 2020 2020 2020 2020  '],.            
+00025a00: 2020 2020 2020 2020 2020 2020 666f 6e74              font
+00025a10: 3d7b 2763 6f6c 6f72 273a 2027 626c 6163  ={'color': 'blac
+00025a20: 6b27 2c20 2773 697a 6527 3a20 3132 7d2c  k', 'size': 12},
+00025a30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00025a40: 2020 2020 2020 2020 2078 7265 663d 6627           xref=f'
+00025a50: 787b 697d 272c 2020 2320 7573 6520 7072  x{i}',  # use pr
+00025a60: 6f70 6572 2078 7265 660a 2020 2020 2020  oper xref.      
+00025a70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025a80: 2020 7972 6566 3d66 2779 7b69 7d27 2c20    yref=f'y{i}', 
+00025a90: 2023 2075 7365 2070 726f 7065 7220 7972   # use proper yr
+00025aa0: 6566 0a20 2020 2020 2020 2020 2020 2020  ef.             
+00025ab0: 2020 2020 2020 2029 2c0a 2020 2020 2020         ),.      
+00025ac0: 2020 2020 2020 2020 2020 2020 2020 726f                ro
+00025ad0: 773d 726f 772c 0a20 2020 2020 2020 2020  w=row,.         
+00025ae0: 2020 2020 2020 2020 2020 2063 6f6c 3d63             col=c
+00025af0: 6f6c 0a20 2020 2020 2020 2020 2020 2020  ol.             
+00025b00: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
+00025b10: 200a 2020 2020 2020 2020 2020 2020 795f   .            y_
+00025b20: 6d61 7820 3d20 7365 6c66 2e70 765f 6461  max = self.pv_da
+00025b30: 7461 5b63 6f6c 5f6e 616d 655d 2e6d 6178  ta[col_name].max
+00025b40: 2829 0a20 2020 2020 2020 2020 2020 2078  ().            x
+00025b50: 5f6d 6178 203d 2073 656c 662e 6663 5f64  _max = self.fc_d
+00025b60: 6174 615b 636f 6c5f 6e61 6d65 5d2e 6d61  ata[col_name].ma
+00025b70: 7828 290a 2020 2020 2020 2020 2020 2020  x().            
+00025b80: 785f 6d69 6e20 3d20 7365 6c66 2e66 635f  x_min = self.fc_
+00025b90: 6461 7461 5b63 6f6c 5f6e 616d 655d 2e6d  data[col_name].m
+00025ba0: 696e 2829 0a0a 2020 2020 2020 2020 2020  in()..          
+00025bb0: 2020 666f 7220 636f 6f72 642c 2073 616d    for coord, sam
+00025bc0: 706c 6520 696e 207a 6970 285b 785f 6d61  ple in zip([x_ma
+00025bd0: 782c 2078 5f6d 696e 5d2c 2063 6f6c 5f6e  x, x_min], col_n
+00025be0: 616d 652e 7370 6c69 7428 272f 2729 293a  ame.split('/')):
+00025bf0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00025c00: 2066 6967 2e61 6464 5f61 6e6e 6f74 6174   fig.add_annotat
+00025c10: 696f 6e28 0a20 2020 2020 2020 2020 2020  ion(.           
+00025c20: 2020 2020 2020 2020 2064 6963 7428 783d           dict(x=
+00025c30: 636f 6f72 642c 0a20 2020 2020 2020 2020  coord,.         
+00025c40: 2020 2020 2020 2020 2020 2020 2020 2079                 y
+00025c50: 3d79 5f6d 6178 2c0a 2020 2020 2020 2020  =y_max,.        
+00025c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025c70: 7465 7874 3d73 616d 706c 652c 0a20 2020  text=sample,.   
+00025c80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025c90: 2020 2020 2066 6f6e 743d 7b27 636f 6c6f       font={'colo
+00025ca0: 7227 3a20 2762 6c61 636b 272c 2027 7369  r': 'black', 'si
+00025cb0: 7a65 273a 2031 367d 2c0a 2020 2020 2020  ze': 16},.      
+00025cc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025cd0: 2020 7368 6f77 6172 726f 773d 4661 6c73    showarrow=Fals
+00025ce0: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
+00025cf0: 2020 2020 2020 2020 2020 2062 6763 6f6c             bgcol
+00025d00: 6f72 3d27 7267 6261 2832 3435 2c20 3232  or='rgba(245, 22
+00025d10: 322c 2031 3739 2c20 302e 3229 272c 200a  2, 179, 0.2)', .
+00025d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025d30: 2020 2020 2020 2020 626f 7264 6572 636f          borderco
+00025d40: 6c6f 723d 2262 6c61 636b 222c 200a 2020  lor="black", .  
+00025d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025d60: 2020 2020 2020 626f 7264 6572 7769 6474        borderwidt
+00025d70: 683d 312c 0a20 2020 2020 2020 2020 2020  h=1,.           
+00025d80: 2020 2020 2020 2020 2020 2020 2062 6f72               bor
+00025d90: 6465 7270 6164 3d33 2c20 200a 2020 2020  derpad=3,  .    
+00025da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025db0: 2020 2020 292c 0a20 2020 2020 2020 2020      ),.         
+00025dc0: 2020 2020 2020 2072 6f77 3d72 6f77 2c0a         row=row,.
+00025dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025de0: 636f 6c3d 636f 6c20 2020 200a 2020 2020  col=col    .    
+00025df0: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
+00025e00: 2020 2020 2020 2020 2020 2066 6967 2e75             fig.u
+00025e10: 7064 6174 655f 7861 7865 7328 7469 746c  pdate_xaxes(titl
+00025e20: 655f 7465 7874 3d66 276c 6f67 3220 666f  e_text=f'log2 fo
+00025e30: 6c64 2063 6861 6e67 6527 290a 2020 2020  ld change').    
+00025e40: 2020 2020 2020 2020 6669 672e 7570 6461          fig.upda
+00025e50: 7465 5f79 6178 6573 2874 6974 6c65 5f74  te_yaxes(title_t
+00025e60: 6578 743d 6627 2d6c 6f67 3130 2070 2d76  ext=f'-log10 p-v
+00025e70: 616c 7565 2729 0a0a 2020 2020 2020 2020  alue')..        
+00025e80: 2320 5570 6461 7465 2074 6865 206c 6179  # Update the lay
+00025e90: 6f75 7420 616e 6420 7472 6163 6573 0a20  out and traces. 
+00025ea0: 2020 2020 2020 2066 6967 2e75 7064 6174         fig.updat
+00025eb0: 655f 6c61 796f 7574 2874 656d 706c 6174  e_layout(templat
+00025ec0: 653d 2773 696d 706c 655f 7768 6974 6527  e='simple_white'
+00025ed0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00025ee0: 2020 2020 2020 2020 2020 2020 6865 6967              heig
+00025ef0: 6874 3d68 6569 6768 742c 0a20 2020 2020  ht=height,.     
+00025f00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025f10: 2020 2020 2077 6964 7468 3d77 6964 7468       width=width
+00025f20: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00025f30: 2020 2020 2020 2020 2020 2020 686f 7665              hove
+00025f40: 726c 6162 656c 3d64 6963 7428 0a20 2020  rlabel=dict(.   
+00025f50: 2020 2020 2020 2020 2062 6763 6f6c 6f72           bgcolor
+00025f60: 3d22 7768 6974 6522 2c0a 2020 2020 2020  ="white",.      
+00025f70: 2020 2020 2020 666f 6e74 5f73 697a 653d        font_size=
+00025f80: 3136 290a 2020 2020 2020 2020 2020 2020  16).            
+00025f90: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+00025fa0: 2020 2020 2020 6669 672e 7570 6461 7465        fig.update
+00025fb0: 5f74 7261 6365 7328 6d61 726b 6572 3d64  _traces(marker=d
+00025fc0: 6963 7428 7369 7a65 3d38 292c 2073 656c  ict(size=8), sel
+00025fd0: 6563 746f 723d 6469 6374 286d 6f64 653d  ector=dict(mode=
+00025fe0: 276d 6172 6b65 7273 2729 290a 0a20 2020  'markers'))..   
+00025ff0: 2020 2020 2023 2053 686f 7720 7468 6520       # Show the 
+00026000: 706c 6f74 0a20 2020 2020 2020 2069 6620  plot.        if 
+00026010: 6973 5f6a 7570 7974 6572 5f6e 6f74 6562  is_jupyter_noteb
+00026020: 6f6f 6b28 293a 0a20 2020 2020 2020 2020  ook():.         
+00026030: 2020 2066 6967 2e73 686f 7728 290a 2020     fig.show().  
+00026040: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+00026050: 2020 2020 2020 2020 7374 2e70 6c6f 746c          st.plotl
+00026060: 795f 6368 6172 7428 6669 672c 2075 7365  y_chart(fig, use
+00026070: 5f63 6f6e 7461 696e 6572 5f77 6964 7468  _container_width
+00026080: 3d54 7275 6529 0000 0000 0000 0000 0000  =True)..........
 00026090: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000260a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000260b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000260c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000260d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000260e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000260f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -9754,63 +9754,63 @@
 00026190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000261a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000261b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000261c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000261d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000261e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000261f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026200: 7072 6f74 656f 6d69 6373 5f64 6f77 6e73  proteomics_downs
-00026210: 7472 6561 6d5f 616e 616c 7973 6973 2d30  tream_analysis-0
-00026220: 2e31 2e32 2f70 726f 7465 6f6d 6963 735f  .1.2/proteomics_
-00026230: 646f 776e 7374 7265 616d 5f61 6e61 6c79  downstream_analy
-00026240: 7369 732e 6567 672d 696e 666f 2f00 0000  sis.egg-info/...
+00026200: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+00026210: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00026250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026260: 0000 0000 3030 3030 3735 3500 3030 3031  ....0000755.0001
-00026270: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
-00026280: 3030 3030 3030 3000 3134 3435 3130 3636  0000000.14451066
-00026290: 3235 3000 3032 3734 3734 0020 3500 0000  250.027474. 5...
+00026260: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+00026270: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00026280: 3030 3030 3033 3300 3030 3030 3030 3030  0000033.00000000
+00026290: 3030 3000 3031 3032 3131 0020 7800 0000  000.010211. x...
 000262a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000262b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000262c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000262d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000262e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000262f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026300: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
+00026300: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
 00026310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026320: 0000 0000 0000 0000 0064 6f63 6b65 7200  .........docker.
+00026320: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00026330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00026340: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00026350: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00026360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00026370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00026380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00026390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000263a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000263b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000263c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000263d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000263e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000263f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026400: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-00026410: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026400: 3237 206d 7469 6d65 3d31 3638 3835 3732  27 mtime=1688572
+00026410: 3130 322e 3531 3438 3134 0a00 0000 0000  102.514814......
 00026420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00026430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00026440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00026450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026460: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-00026470: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00026480: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
-00026490: 3030 3000 3031 3032 3133 0020 7800 0000  000.010213. x...
+00026460: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026470: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026480: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026490: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000264a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000264b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000264c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000264d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000264e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000264f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026500: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00026500: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00026510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00026520: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00026530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00026540: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00026550: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00026560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00026570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -9818,374 +9818,374 @@
 00026590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000265a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000265b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000265c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000265d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000265e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000265f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026600: 3232 206d 7469 6d65 3d31 3638 3834 3937  22 mtime=1688497
-00026610: 3331 392e 300a 0000 0000 0000 0000 0000  319.0...........
-00026620: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026600: 7072 6f74 656f 6d69 6373 5f64 6f77 6e73  proteomics_downs
+00026610: 7472 6561 6d5f 616e 616c 7973 6973 2d30  tream_analysis-0
+00026620: 2e31 2e33 2f70 726f 7465 6f6d 6963 735f  .1.3/proteomics_
+00026630: 646f 776e 7374 7265 616d 5f61 6e61 6c79  downstream_analy
+00026640: 7369 732e 6567 672d 696e 666f 2f00 0000  sis.egg-info/...
 00026650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026660: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026670: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026680: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026690: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026660: 0000 0000 3030 3030 3735 3500 3030 3031  ....0000755.0001
+00026670: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
+00026680: 3030 3030 3030 3000 3134 3435 3133 3130  0000000.14451310
+00026690: 3330 3700 3032 3734 3730 0020 3500 0000  307.027470. 5...
 000266a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000266b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000266c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000266d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000266e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000266f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026700: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026700: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
 00026710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026720: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026720: 0000 0000 0000 0000 0064 6f63 6b65 7200  .........docker.
 00026730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00026740: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00026750: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00026760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00026770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00026780: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00026790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000267a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000267b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000267c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000267d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000267e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000267f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026800: 7072 6f74 656f 6d69 6373 5f64 6f77 6e73  proteomics_downs
-00026810: 7472 6561 6d5f 616e 616c 7973 6973 2d30  tream_analysis-0
-00026820: 2e31 2e32 2f70 726f 7465 6f6d 6963 735f  .1.2/proteomics_
-00026830: 646f 776e 7374 7265 616d 5f61 6e61 6c79  downstream_analy
-00026840: 7369 732e 6567 672d 696e 666f 2f50 4b47  sis.egg-info/PKG
-00026850: 2d49 4e46 4f00 0000 0000 0000 0000 0000  -INFO...........
-00026860: 0000 0000 3030 3030 3634 3400 3030 3031  ....0000644.0001
-00026870: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
-00026880: 3030 3037 3136 3600 3134 3435 3130 3636  0007166.14451066
-00026890: 3234 3700 3033 3036 3131 0020 3000 0000  247.030611. 0...
+00026800: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+00026810: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026820: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026860: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+00026870: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00026880: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
+00026890: 3030 3000 3031 3032 3133 0020 7800 0000  000.010213. x...
 000268a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000268b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000268c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000268d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000268e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000268f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026900: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
+00026900: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
 00026910: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026920: 0000 0000 0000 0000 0064 6f63 6b65 7200  .........docker.
+00026920: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00026930: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00026940: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00026950: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00026960: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00026970: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00026980: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00026990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000269a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000269b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000269c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000269d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000269e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000269f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026a00: 4d65 7461 6461 7461 2d56 6572 7369 6f6e  Metadata-Version
-00026a10: 3a20 322e 310a 4e61 6d65 3a20 7072 6f74  : 2.1.Name: prot
-00026a20: 656f 6d69 6373 2d64 6f77 6e73 7472 6561  eomics-downstrea
-00026a30: 6d2d 616e 616c 7973 6973 0a56 6572 7369  m-analysis.Versi
-00026a40: 6f6e 3a20 302e 312e 320a 5375 6d6d 6172  on: 0.1.2.Summar
-00026a50: 793a 2041 2070 6163 6b61 6765 2066 6f72  y: A package for
-00026a60: 2064 6f77 6e73 7472 6561 6d20 6461 7461   downstream data
-00026a70: 2061 6e61 6c79 7369 7320 6f66 2070 726f   analysis of pro
-00026a80: 7465 6f6d 6963 7320 6461 7461 0a48 6f6d  teomics data.Hom
-00026a90: 652d 7061 6765 3a20 6874 7470 733a 2f2f  e-page: https://
-00026aa0: 6769 7468 7562 2e63 6f6d 2f76 7564 7563  github.com/vuduc
-00026ab0: 7475 6e67 2f70 726f 7465 6f6d 6963 732d  tung/proteomics-
-00026ac0: 646f 776e 7374 7265 616d 2d61 6e6c 6179  downstream-anlay
-00026ad0: 7369 730a 4175 7468 6f72 3a20 5675 2044  sis.Author: Vu D
-00026ae0: 7563 2054 756e 670a 4175 7468 6f72 2d65  uc Tung.Author-e
-00026af0: 6d61 696c 3a20 7475 6e67 7675 6475 6340  mail: tungvuduc@
-00026b00: 6f75 746c 6f6f 6b2e 6465 0a4b 6579 776f  outlook.de.Keywo
-00026b10: 7264 733a 2070 726f 7465 6f6d 6963 732c  rds: proteomics,
-00026b20: 646f 776e 7374 7265 616d 2061 6e61 6c79  downstream analy
-00026b30: 7369 732c 6461 7461 2061 6e61 6c79 7369  sis,data analysi
-00026b40: 732c 6461 7461 2076 6973 7561 6c69 7a61  s,data visualiza
-00026b50: 7469 6f6e 2c6d 6173 7320 7370 6563 7472  tion,mass spectr
-00026b60: 6f6d 6574 7279 0a52 6571 7569 7265 732d  ometry.Requires-
-00026b70: 5079 7468 6f6e 3a20 3e3d 332e 362e 310a  Python: >=3.6.1.
-00026b80: 4465 7363 7269 7074 696f 6e2d 436f 6e74  Description-Cont
-00026b90: 656e 742d 5479 7065 3a20 7465 7874 2f6d  ent-Type: text/m
-00026ba0: 6172 6b64 6f77 6e0a 4c69 6365 6e73 652d  arkdown.License-
-00026bb0: 4669 6c65 3a20 4c49 4345 4e53 450a 0a3c  File: LICENSE..<
-00026bc0: 6465 7461 696c 733e 0a20 203c 7375 6d6d  details>.  <summ
-00026bd0: 6172 793e 5461 626c 6520 6f66 2043 6f6e  ary>Table of Con
-00026be0: 7465 6e74 733c 2f73 756d 6d61 7279 3e0a  tents</summary>.
-00026bf0: 2020 3c6f 6c3e 0a20 2020 203c 6c69 3e0a    <ol>.    <li>.
-00026c00: 2020 2020 2020 3c61 2068 7265 663d 2223        <a href="#
-00026c10: 7061 636b 6167 652d 6465 7363 7269 7074  package-descript
-00026c20: 696f 6e22 3e50 6163 6b61 6765 2064 6573  ion">Package des
-00026c30: 6372 6970 7469 6f6e 3c2f 613e 0a20 2020  cription</a>.   
-00026c40: 2020 203c 756c 3e0a 2020 2020 2020 3c2f     <ul>.      </
-00026c50: 756c 3e0a 2020 2020 3c2f 6c69 3e0a 2020  ul>.    </li>.  
-00026c60: 2020 3c6c 693e 0a20 2020 2020 203c 6120    <li>.      <a 
-00026c70: 6872 6566 3d22 2367 6574 7469 6e67 2d73  href="#getting-s
-00026c80: 7461 7274 6564 223e 4765 7474 696e 6720  tarted">Getting 
-00026c90: 5374 6172 7465 643c 2f61 3e0a 2020 2020  Started</a>.    
-00026ca0: 2020 3c75 6c3e 0a20 2020 2020 203c 2f75    <ul>.      </u
-00026cb0: 6c3e 0a20 2020 203c 2f6c 693e 0a20 2020  l>.    </li>.   
-00026cc0: 203c 6c69 3e3c 6120 6872 6566 3d22 2375   <li><a href="#u
-00026cd0: 7361 6765 223e 5573 6167 653c 2f61 3e3c  sage">Usage</a><
-00026ce0: 2f6c 693e 0a20 2020 203c 6c69 3e3c 6120  /li>.    <li><a 
-00026cf0: 6872 6566 3d22 2363 6f6e 7472 6962 7574  href="#contribut
-00026d00: 696e 6722 3e43 6f6e 7472 6962 7574 696e  ing">Contributin
-00026d10: 673c 2f61 3e3c 2f6c 693e 0a20 2020 203c  g</a></li>.    <
-00026d20: 6c69 3e3c 6120 6872 6566 3d22 236c 6963  li><a href="#lic
-00026d30: 656e 7365 223e 4c69 6365 6e73 653c 2f61  ense">License</a
-00026d40: 3e3c 2f6c 693e 0a3c 2f64 6574 6169 6c73  ></li>.</details
-00026d50: 3e0a 0a3c 7020 616c 6967 6e3d 2272 6967  >..<p align="rig
-00026d60: 6874 223e 283c 6120 6872 6566 3d22 2372  ht">(<a href="#r
-00026d70: 6561 646d 652d 746f 7022 3e62 6163 6b20  eadme-top">back 
-00026d80: 746f 2074 6f70 3c2f 613e 293c 2f70 3e0a  to top</a>)</p>.
-00026d90: 0a23 2320 5061 636b 6167 6520 6465 7363  .## Package desc
-00026da0: 7269 7074 696f 6e0a 496e 7472 6f64 7563  ription.Introduc
-00026db0: 696e 6720 5072 6f74 656f 6d69 6373 2044  ing Proteomics D
-00026dc0: 6f77 6e73 7472 6561 6d20 416e 616c 7973  ownstream Analys
-00026dd0: 6973 2076 302e 312e 302c 2061 2063 6f6d  is v0.1.0, a com
-00026de0: 7072 6568 656e 7369 7665 2050 7974 686f  prehensive Pytho
-00026df0: 6e20 7061 636b 6167 6520 6465 7369 676e  n package design
-00026e00: 6564 2074 6f20 7369 6d70 6c69 6679 2061  ed to simplify a
-00026e10: 6e64 2073 7472 6561 6d6c 696e 6520 7468  nd streamline th
-00026e20: 6520 7072 6f63 6573 7320 6f66 2064 6f77  e process of dow
-00026e30: 6e73 7472 6561 6d20 6461 7461 2061 6e61  nstream data ana
-00026e40: 6c79 7369 7320 666f 7220 7072 6f74 656f  lysis for proteo
-00026e50: 6d69 6373 2072 6573 6561 7263 682e 2054  mics research. T
-00026e60: 6869 7320 7061 636b 6167 6520 6f66 6665  his package offe
-00026e70: 7273 2061 2075 7365 722d 6672 6965 6e64  rs a user-friend
-00026e80: 6c79 2061 6e64 2065 6666 6963 6965 6e74  ly and efficient
-00026e90: 2077 6179 2074 6f20 6861 6e64 6c65 2c20   way to handle, 
-00026ea0: 6d61 6e69 7075 6c61 7465 2c20 7072 6f63  manipulate, proc
-00026eb0: 6573 732c 2061 6e64 2076 6973 7561 6c69  ess, and visuali
-00026ec0: 7a65 206c 6172 6765 2070 726f 7465 6f6d  ze large proteom
-00026ed0: 6963 7320 6461 7461 7365 7473 2c20 6865  ics datasets, he
-00026ee0: 6c70 696e 6720 7265 7365 6172 6368 6572  lping researcher
-00026ef0: 7320 6761 696e 2076 616c 7561 626c 6520  s gain valuable 
-00026f00: 696e 7369 6768 7473 2066 726f 6d20 7468  insights from th
-00026f10: 6569 7220 6461 7461 206d 6f72 6520 7175  eir data more qu
-00026f20: 6963 6b6c 7920 616e 6420 6566 6665 6374  ickly and effect
-00026f30: 6976 656c 792e 0a0a 4b65 7920 6665 6174  ively...Key feat
-00026f40: 7572 6573 206f 6620 7072 6f74 656f 6d69  ures of proteomi
-00026f50: 6373 5f64 6f77 6e73 7472 6561 6d5f 616e  cs_downstream_an
-00026f60: 616c 7973 6973 2076 302e 312e 3020 696e  alysis v0.1.0 in
-00026f70: 636c 7564 653a 0a0a 4461 7461 2069 6d70  clude:..Data imp
-00026f80: 6f72 7420 616e 6420 7072 6570 726f 6365  ort and preproce
-00026f90: 7373 696e 673a 2045 6173 696c 7920 696d  ssing: Easily im
-00026fa0: 706f 7274 2061 6e64 2070 7265 7072 6f63  port and preproc
-00026fb0: 6573 7320 7261 7720 7072 6f74 656f 6d69  ess raw proteomi
-00026fc0: 6373 2064 6174 6120 6672 6f6d 2044 4941  cs data from DIA
-00026fd0: 2d4e 4e2e 2041 7574 6f6d 6174 6963 616c  -NN. Automatical
-00026fe0: 6c79 2068 616e 646c 6520 6d69 7373 696e  ly handle missin
-00026ff0: 6720 7661 6c75 6573 2c20 6e6f 726d 616c  g values, normal
-00027000: 697a 6174 696f 6e2c 2061 6e64 2064 6174  ization, and dat
-00027010: 6120 7472 616e 7366 6f72 6d61 7469 6f6e  a transformation
-00027020: 2061 7320 6e65 6564 6564 2e0a 0a53 7461   as needed...Sta
-00027030: 7469 7374 6963 616c 2061 6e61 6c79 7369  tistical analysi
-00027040: 733a 2050 6572 666f 726d 2065 7373 656e  s: Perform essen
-00027050: 7469 616c 2073 7461 7469 7374 6963 616c  tial statistical
-00027060: 2074 6573 7473 2073 7563 6820 6173 2074   tests such as t
-00027070: 2d74 6573 7473 2c20 414e 4f56 412c 2061  -tests, ANOVA, a
-00027080: 6e64 206d 756c 7469 706c 6520 7465 7374  nd multiple test
-00027090: 696e 6720 636f 7272 6563 7469 6f6e 206d  ing correction m
-000270a0: 6574 686f 6473 2074 6f20 6173 7365 7373  ethods to assess
-000270b0: 2074 6865 2073 6967 6e69 6669 6361 6e63   the significanc
-000270c0: 6520 6f66 2064 6966 6665 7265 6e74 6961  e of differentia
-000270d0: 6c6c 7920 6578 7072 6573 7365 6420 7072  lly expressed pr
-000270e0: 6f74 6569 6e73 2e0a 0a45 6e72 6963 686d  oteins...Enrichm
-000270f0: 656e 7420 616e 616c 7973 6973 3a20 436f  ent analysis: Co
-00027100: 6e64 7563 7420 6675 6e63 7469 6f6e 616c  nduct functional
-00027110: 2065 6e72 6963 686d 656e 7420 616e 616c   enrichment anal
-00027120: 7973 6973 2074 6f20 6964 656e 7469 6679  ysis to identify
-00027130: 206f 7665 722d 7265 7072 6573 656e 7465   over-represente
-00027140: 6420 6675 6e63 7469 6f6e 616c 2063 6174  d functional cat
-00027150: 6567 6f72 6965 732c 2062 696f 6c6f 6769  egories, biologi
-00027160: 6361 6c20 7072 6f63 6573 7365 732c 206f  cal processes, o
-00027170: 7220 7061 7468 7761 7973 2069 6e20 796f  r pathways in yo
-00027180: 7572 2070 726f 7465 696e 2073 6574 732c  ur protein sets,
-00027190: 2073 7570 706f 7274 696e 6720 706f 7075   supporting popu
-000271a0: 6c61 7220 6461 7461 6261 7365 7320 6c69  lar databases li
-000271b0: 6b65 2047 656e 6520 4f6e 746f 6c6f 6779  ke Gene Ontology
-000271c0: 2061 6e64 204b 4547 472e 0a0a 436c 7573   and KEGG...Clus
-000271d0: 7465 7269 6e67 2061 6e64 2064 696d 656e  tering and dimen
-000271e0: 7369 6f6e 616c 6974 7920 7265 6475 6374  sionality reduct
-000271f0: 696f 6e3a 2041 7070 6c79 2061 6476 616e  ion: Apply advan
-00027200: 6365 6420 756e 7375 7065 7276 6973 6564  ced unsupervised
-00027210: 206c 6561 726e 696e 6720 7465 6368 6e69   learning techni
-00027220: 7175 6573 2074 6f20 6772 6f75 7020 7369  ques to group si
-00027230: 6d69 6c61 7220 7072 6f74 6569 6e73 2061  milar proteins a
-00027240: 6e64 2075 6e63 6f76 6572 2075 6e64 6572  nd uncover under
-00027250: 6c79 696e 6720 6269 6f6c 6f67 6963 616c  lying biological
-00027260: 2070 6174 7465 726e 732e 2054 6563 686e   patterns. Techn
-00027270: 6971 7565 7320 696e 636c 7564 6520 6869  iques include hi
-00027280: 6572 6172 6368 6963 616c 2063 6c75 7374  erarchical clust
-00027290: 6572 696e 672c 206b 2d6d 6561 6e73 2063  ering, k-means c
-000272a0: 6c75 7374 6572 696e 672c 2070 7269 6e63  lustering, princ
-000272b0: 6970 616c 2063 6f6d 706f 6e65 6e74 2061  ipal component a
-000272c0: 6e61 6c79 7369 7320 2850 4341 292c 2061  nalysis (PCA), a
-000272d0: 6e64 2074 2d64 6973 7472 6962 7574 6564  nd t-distributed
-000272e0: 2073 746f 6368 6173 7469 6320 6e65 6967   stochastic neig
-000272f0: 6862 6f72 2065 6d62 6564 6469 6e67 2028  hbor embedding (
-00027300: 742d 534e 4529 2e0a 0a43 7573 746f 6d69  t-SNE)...Customi
-00027310: 7a61 626c 6520 6461 7461 2076 6973 7561  zable data visua
-00027320: 6c69 7a61 7469 6f6e 3a20 4372 6561 7465  lization: Create
-00027330: 2073 7475 6e6e 696e 6720 616e 6420 696e   stunning and in
-00027340: 666f 726d 6174 6976 6520 7669 7375 616c  formative visual
-00027350: 697a 6174 696f 6e73 2074 6f20 6265 7474  izations to bett
-00027360: 6572 2075 6e64 6572 7374 616e 6420 616e  er understand an
-00027370: 6420 636f 6d6d 756e 6963 6174 6520 796f  d communicate yo
-00027380: 7572 2072 6573 756c 7473 2e20 4765 6e65  ur results. Gene
-00027390: 7261 7465 2068 6561 746d 6170 732c 2076  rate heatmaps, v
-000273a0: 6f6c 6361 6e6f 2070 6c6f 7473 2c20 5665  olcano plots, Ve
-000273b0: 6e6e 2064 6961 6772 616d 732c 2061 6e64  nn diagrams, and
-000273c0: 206d 6f72 6520 7769 7468 2066 756c 6c20   more with full 
-000273d0: 6375 7374 6f6d 697a 6174 696f 6e20 6f70  customization op
-000273e0: 7469 6f6e 732e 0a0a 496e 7465 6772 6174  tions...Integrat
-000273f0: 696f 6e20 7769 7468 2065 7869 7374 696e  ion with existin
-00027400: 6720 746f 6f6c 733a 2043 6f6d 7061 7469  g tools: Compati
-00027410: 6269 6c69 7479 2077 6974 6820 706f 7075  bility with popu
-00027420: 6c61 7220 5079 7468 6f6e 206c 6962 7261  lar Python libra
-00027430: 7269 6573 2069 6e63 6c75 6469 6e67 204e  ries including N
-00027440: 756d 5079 2c20 7061 6e64 6173 2c20 616e  umPy, pandas, an
-00027450: 6420 6d61 7470 6c6f 746c 6962 2c20 616c  d matplotlib, al
-00027460: 6c6f 7769 6e67 2079 6f75 2074 6f20 7365  lowing you to se
-00027470: 616d 6c65 7373 6c79 2069 6e74 6567 7261  amlessly integra
-00027480: 7465 2074 6869 7320 7061 636b 6167 6520  te this package 
-00027490: 696e 746f 2079 6f75 7220 6578 6973 7469  into your existi
-000274a0: 6e67 2064 6174 6120 616e 616c 7973 6973  ng data analysis
-000274b0: 2077 6f72 6b66 6c6f 772e 0a0a 5072 6f74   workflow...Prot
-000274c0: 656f 6d69 6373 2044 6f77 6e73 7472 6561  eomics Downstrea
-000274d0: 6d20 416e 616c 7973 6973 2076 302e 312e  m Analysis v0.1.
-000274e0: 3020 7072 6f76 6964 6573 2061 2073 6f6c  0 provides a sol
-000274f0: 6964 2066 6f75 6e64 6174 696f 6e20 666f  id foundation fo
-00027500: 7220 796f 7572 2070 726f 7465 6f6d 6963  r your proteomic
-00027510: 7320 7265 7365 6172 6368 206e 6565 6473  s research needs
-00027520: 2e0a 0a0a 3c70 2061 6c69 676e 3d22 7269  ....<p align="ri
-00027530: 6768 7422 3e28 3c61 2068 7265 663d 2223  ght">(<a href="#
-00027540: 7265 6164 6d65 2d74 6f70 223e 6261 636b  readme-top">back
-00027550: 2074 6f20 746f 703c 2f61 3e29 3c2f 703e   to top</a>)</p>
-00027560: 0a0a 0a23 2320 4765 7474 696e 6720 5374  ...## Getting St
-00027570: 6172 7465 640a 0a50 726f 7465 6f6d 6963  arted..Proteomic
-00027580: 7344 6f77 6e73 7472 6561 6d41 6e61 6c79  sDownstreamAnaly
-00027590: 7369 7320 6361 6e20 6265 2069 6e73 7461  sis can be insta
-000275a0: 6c6c 6564 2075 7369 6e67 3a0a 6060 600a  lled using:.```.
-000275b0: 7069 7020 696e 7374 616c 6c20 7072 6f74  pip install prot
-000275c0: 656f 6d69 6373 2d64 6f77 6e73 7472 6561  eomics-downstrea
-000275d0: 6d2d 616e 616c 7973 6973 0a60 6060 0a0a  m-analysis.```..
-000275e0: 3c70 2061 6c69 676e 3d22 7269 6768 7422  <p align="right"
-000275f0: 3e28 3c61 2068 7265 663d 2223 7265 6164  >(<a href="#read
-00027600: 6d65 2d74 6f70 223e 6261 636b 2074 6f20  me-top">back to 
-00027610: 746f 703c 2f61 3e29 3c2f 703e 0a0a 0a23  top</a>)</p>...#
-00027620: 2320 5573 6167 650a 6060 600a 696d 706f  # Usage.```.impo
-00027630: 7274 2070 726f 7465 6f6d 6963 735f 646f  rt proteomics_do
-00027640: 776e 7374 7265 616d 5f61 6e61 6c79 7369  wnstream_analysi
-00027650: 7320 6173 2070 6461 0a60 6060 0a3c 7020  s as pda.```.<p 
-00027660: 616c 6967 6e3d 2272 6967 6874 223e 283c  align="right">(<
-00027670: 6120 6872 6566 3d22 2372 6561 646d 652d  a href="#readme-
-00027680: 746f 7022 3e62 6163 6b20 746f 2074 6f70  top">back to top
-00027690: 3c2f 613e 293c 2f70 3e0a 0a23 2320 436f  </a>)</p>..## Co
-000276a0: 6e74 7269 6275 7469 6e67 0a0a 436f 6e74  ntributing..Cont
-000276b0: 7269 6275 7469 6f6e 2069 7320 6d75 6368  ribution is much
-000276c0: 2061 7070 7265 6369 6174 6564 2e20 4861   appreciated. Ha
-000276d0: 7070 7920 746f 2067 6574 2066 6565 6462  ppy to get feedb
-000276e0: 6163 6b20 616e 6420 7375 6767 6573 7469  ack and suggesti
-000276f0: 6f6e 7321 200a 0a53 686f 756c 6420 796f  ons! ..Should yo
-00027700: 7520 6861 7665 2061 2073 7567 6765 7374  u have a suggest
-00027710: 696f 6e20 7468 6174 2063 6f75 6c64 2065  ion that could e
-00027720: 6e68 616e 6365 2074 6869 7320 7072 6f6a  nhance this proj
-00027730: 6563 742c 206b 696e 646c 7920 666f 726b  ect, kindly fork
-00027740: 2074 6865 2072 6570 6f73 6974 6f72 7920   the repository 
-00027750: 616e 6420 6372 6561 7465 2061 2070 756c  and create a pul
-00027760: 6c20 7265 7175 6573 742e 2059 6f75 206d  l request. You m
-00027770: 6179 2061 6c73 6f20 6f70 656e 2061 6e20  ay also open an 
-00027780: 6973 7375 6520 6c61 6265 6c65 6420 6173  issue labeled as
-00027790: 20e2 809c 696d 7072 6f76 656d 656e 74e2   ...improvement.
-000277a0: 809d 2e20 0a0a 3c70 2061 6c69 676e 3d22  ... ..<p align="
-000277b0: 7269 6768 7422 3e28 3c61 2068 7265 663d  right">(<a href=
-000277c0: 2223 7265 6164 6d65 2d74 6f70 223e 6261  "#readme-top">ba
-000277d0: 636b 2074 6f20 746f 703c 2f61 3e29 3c2f  ck to top</a>)</
-000277e0: 703e 0a0a 0a23 2320 4c69 6365 6e73 650a  p>...## License.
-000277f0: 0a44 6973 7472 6962 7574 6564 2075 6e64  .Distributed und
-00027800: 6572 2074 6865 204d 4954 204c 6963 656e  er the MIT Licen
-00027810: 7365 2e20 5365 6520 604d 4954 2e74 7874  se. See `MIT.txt
-00027820: 6020 666f 7220 6d6f 7265 2069 6e66 6f72  ` for more infor
-00027830: 6d61 7469 6f6e 2e0a 0a3c 7020 616c 6967  mation...<p alig
-00027840: 6e3d 2272 6967 6874 223e 283c 6120 6872  n="right">(<a hr
-00027850: 6566 3d22 2372 6561 646d 652d 746f 7022  ef="#readme-top"
-00027860: 3e62 6163 6b20 746f 2074 6f70 3c2f 613e  >back to top</a>
-00027870: 293c 2f70 3e0a 0000 0000 0000 0000 0000  )</p>...........
-00027880: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027890: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000278a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000278b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000278c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000278d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000278e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000278f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027900: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027910: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027920: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027930: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027940: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027950: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027960: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027970: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027980: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000279a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000279b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000279c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000279d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000279e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000279f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027a00: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-00027a10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027a20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027a30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027a40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027a50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027a60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-00027a70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00027a80: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
-00027a90: 3030 3000 3031 3032 3133 0020 7800 0000  000.010213. x...
-00027aa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027ab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027ac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027ad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027ae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027af0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027b00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-00027b10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027b20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027b30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027b40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027b50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027b60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027b70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027b80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027b90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027ba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027bb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027bc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027bd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027be0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027bf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027c00: 3232 206d 7469 6d65 3d31 3638 3834 3937  22 mtime=1688497
-00027c10: 3331 392e 300a 0000 0000 0000 0000 0000  319.0...........
-00027c20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027c30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027c40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027c50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027c60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027c70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026a00: 3232 206d 7469 6d65 3d31 3638 3835 3732  22 mtime=1688572
+00026a10: 3130 322e 300a 0000 0000 0000 0000 0000  102.0...........
+00026a20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026a30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026a40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026a50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026a60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026a70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026a80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026a90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026aa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026ab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026ac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026ad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026ae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026af0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026b00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026b10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026b20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026b30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026b40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026b50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026b60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026b70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026b80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026b90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026ba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026bb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026bc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026bd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026be0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026bf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026c00: 7072 6f74 656f 6d69 6373 5f64 6f77 6e73  proteomics_downs
+00026c10: 7472 6561 6d5f 616e 616c 7973 6973 2d30  tream_analysis-0
+00026c20: 2e31 2e33 2f70 726f 7465 6f6d 6963 735f  .1.3/proteomics_
+00026c30: 646f 776e 7374 7265 616d 5f61 6e61 6c79  downstream_analy
+00026c40: 7369 732e 6567 672d 696e 666f 2f50 4b47  sis.egg-info/PKG
+00026c50: 2d49 4e46 4f00 0000 0000 0000 0000 0000  -INFO...........
+00026c60: 0000 0000 3030 3030 3634 3400 3030 3031  ....0000644.0001
+00026c70: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
+00026c80: 3030 3037 3136 3600 3134 3435 3133 3130  0007166.14451310
+00026c90: 3330 3600 3033 3035 3736 0020 3000 0000  306.030576. 0...
+00026ca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026cb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026cc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026cd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026ce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026cf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026d00: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
+00026d10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026d20: 0000 0000 0000 0000 0064 6f63 6b65 7200  .........docker.
+00026d30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026d40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026d50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026d60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026d70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026d80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026d90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026da0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026db0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026dc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026dd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026de0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026df0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026e00: 4d65 7461 6461 7461 2d56 6572 7369 6f6e  Metadata-Version
+00026e10: 3a20 322e 310a 4e61 6d65 3a20 7072 6f74  : 2.1.Name: prot
+00026e20: 656f 6d69 6373 2d64 6f77 6e73 7472 6561  eomics-downstrea
+00026e30: 6d2d 616e 616c 7973 6973 0a56 6572 7369  m-analysis.Versi
+00026e40: 6f6e 3a20 302e 312e 330a 5375 6d6d 6172  on: 0.1.3.Summar
+00026e50: 793a 2041 2070 6163 6b61 6765 2066 6f72  y: A package for
+00026e60: 2064 6f77 6e73 7472 6561 6d20 6461 7461   downstream data
+00026e70: 2061 6e61 6c79 7369 7320 6f66 2070 726f   analysis of pro
+00026e80: 7465 6f6d 6963 7320 6461 7461 0a48 6f6d  teomics data.Hom
+00026e90: 652d 7061 6765 3a20 6874 7470 733a 2f2f  e-page: https://
+00026ea0: 6769 7468 7562 2e63 6f6d 2f76 7564 7563  github.com/vuduc
+00026eb0: 7475 6e67 2f70 726f 7465 6f6d 6963 732d  tung/proteomics-
+00026ec0: 646f 776e 7374 7265 616d 2d61 6e6c 6179  downstream-anlay
+00026ed0: 7369 730a 4175 7468 6f72 3a20 5675 2044  sis.Author: Vu D
+00026ee0: 7563 2054 756e 670a 4175 7468 6f72 2d65  uc Tung.Author-e
+00026ef0: 6d61 696c 3a20 7475 6e67 7675 6475 6340  mail: tungvuduc@
+00026f00: 6f75 746c 6f6f 6b2e 6465 0a4b 6579 776f  outlook.de.Keywo
+00026f10: 7264 733a 2070 726f 7465 6f6d 6963 732c  rds: proteomics,
+00026f20: 646f 776e 7374 7265 616d 2061 6e61 6c79  downstream analy
+00026f30: 7369 732c 6461 7461 2061 6e61 6c79 7369  sis,data analysi
+00026f40: 732c 6461 7461 2076 6973 7561 6c69 7a61  s,data visualiza
+00026f50: 7469 6f6e 2c6d 6173 7320 7370 6563 7472  tion,mass spectr
+00026f60: 6f6d 6574 7279 0a52 6571 7569 7265 732d  ometry.Requires-
+00026f70: 5079 7468 6f6e 3a20 3e3d 332e 362e 310a  Python: >=3.6.1.
+00026f80: 4465 7363 7269 7074 696f 6e2d 436f 6e74  Description-Cont
+00026f90: 656e 742d 5479 7065 3a20 7465 7874 2f6d  ent-Type: text/m
+00026fa0: 6172 6b64 6f77 6e0a 4c69 6365 6e73 652d  arkdown.License-
+00026fb0: 4669 6c65 3a20 4c49 4345 4e53 450a 0a3c  File: LICENSE..<
+00026fc0: 6465 7461 696c 733e 0a20 203c 7375 6d6d  details>.  <summ
+00026fd0: 6172 793e 5461 626c 6520 6f66 2043 6f6e  ary>Table of Con
+00026fe0: 7465 6e74 733c 2f73 756d 6d61 7279 3e0a  tents</summary>.
+00026ff0: 2020 3c6f 6c3e 0a20 2020 203c 6c69 3e0a    <ol>.    <li>.
+00027000: 2020 2020 2020 3c61 2068 7265 663d 2223        <a href="#
+00027010: 7061 636b 6167 652d 6465 7363 7269 7074  package-descript
+00027020: 696f 6e22 3e50 6163 6b61 6765 2064 6573  ion">Package des
+00027030: 6372 6970 7469 6f6e 3c2f 613e 0a20 2020  cription</a>.   
+00027040: 2020 203c 756c 3e0a 2020 2020 2020 3c2f     <ul>.      </
+00027050: 756c 3e0a 2020 2020 3c2f 6c69 3e0a 2020  ul>.    </li>.  
+00027060: 2020 3c6c 693e 0a20 2020 2020 203c 6120    <li>.      <a 
+00027070: 6872 6566 3d22 2367 6574 7469 6e67 2d73  href="#getting-s
+00027080: 7461 7274 6564 223e 4765 7474 696e 6720  tarted">Getting 
+00027090: 5374 6172 7465 643c 2f61 3e0a 2020 2020  Started</a>.    
+000270a0: 2020 3c75 6c3e 0a20 2020 2020 203c 2f75    <ul>.      </u
+000270b0: 6c3e 0a20 2020 203c 2f6c 693e 0a20 2020  l>.    </li>.   
+000270c0: 203c 6c69 3e3c 6120 6872 6566 3d22 2375   <li><a href="#u
+000270d0: 7361 6765 223e 5573 6167 653c 2f61 3e3c  sage">Usage</a><
+000270e0: 2f6c 693e 0a20 2020 203c 6c69 3e3c 6120  /li>.    <li><a 
+000270f0: 6872 6566 3d22 2363 6f6e 7472 6962 7574  href="#contribut
+00027100: 696e 6722 3e43 6f6e 7472 6962 7574 696e  ing">Contributin
+00027110: 673c 2f61 3e3c 2f6c 693e 0a20 2020 203c  g</a></li>.    <
+00027120: 6c69 3e3c 6120 6872 6566 3d22 236c 6963  li><a href="#lic
+00027130: 656e 7365 223e 4c69 6365 6e73 653c 2f61  ense">License</a
+00027140: 3e3c 2f6c 693e 0a3c 2f64 6574 6169 6c73  ></li>.</details
+00027150: 3e0a 0a3c 7020 616c 6967 6e3d 2272 6967  >..<p align="rig
+00027160: 6874 223e 283c 6120 6872 6566 3d22 2372  ht">(<a href="#r
+00027170: 6561 646d 652d 746f 7022 3e62 6163 6b20  eadme-top">back 
+00027180: 746f 2074 6f70 3c2f 613e 293c 2f70 3e0a  to top</a>)</p>.
+00027190: 0a23 2320 5061 636b 6167 6520 6465 7363  .## Package desc
+000271a0: 7269 7074 696f 6e0a 496e 7472 6f64 7563  ription.Introduc
+000271b0: 696e 6720 5072 6f74 656f 6d69 6373 2044  ing Proteomics D
+000271c0: 6f77 6e73 7472 6561 6d20 416e 616c 7973  ownstream Analys
+000271d0: 6973 2076 302e 312e 302c 2061 2063 6f6d  is v0.1.0, a com
+000271e0: 7072 6568 656e 7369 7665 2050 7974 686f  prehensive Pytho
+000271f0: 6e20 7061 636b 6167 6520 6465 7369 676e  n package design
+00027200: 6564 2074 6f20 7369 6d70 6c69 6679 2061  ed to simplify a
+00027210: 6e64 2073 7472 6561 6d6c 696e 6520 7468  nd streamline th
+00027220: 6520 7072 6f63 6573 7320 6f66 2064 6f77  e process of dow
+00027230: 6e73 7472 6561 6d20 6461 7461 2061 6e61  nstream data ana
+00027240: 6c79 7369 7320 666f 7220 7072 6f74 656f  lysis for proteo
+00027250: 6d69 6373 2072 6573 6561 7263 682e 2054  mics research. T
+00027260: 6869 7320 7061 636b 6167 6520 6f66 6665  his package offe
+00027270: 7273 2061 2075 7365 722d 6672 6965 6e64  rs a user-friend
+00027280: 6c79 2061 6e64 2065 6666 6963 6965 6e74  ly and efficient
+00027290: 2077 6179 2074 6f20 6861 6e64 6c65 2c20   way to handle, 
+000272a0: 6d61 6e69 7075 6c61 7465 2c20 7072 6f63  manipulate, proc
+000272b0: 6573 732c 2061 6e64 2076 6973 7561 6c69  ess, and visuali
+000272c0: 7a65 206c 6172 6765 2070 726f 7465 6f6d  ze large proteom
+000272d0: 6963 7320 6461 7461 7365 7473 2c20 6865  ics datasets, he
+000272e0: 6c70 696e 6720 7265 7365 6172 6368 6572  lping researcher
+000272f0: 7320 6761 696e 2076 616c 7561 626c 6520  s gain valuable 
+00027300: 696e 7369 6768 7473 2066 726f 6d20 7468  insights from th
+00027310: 6569 7220 6461 7461 206d 6f72 6520 7175  eir data more qu
+00027320: 6963 6b6c 7920 616e 6420 6566 6665 6374  ickly and effect
+00027330: 6976 656c 792e 0a0a 4b65 7920 6665 6174  ively...Key feat
+00027340: 7572 6573 206f 6620 7072 6f74 656f 6d69  ures of proteomi
+00027350: 6373 5f64 6f77 6e73 7472 6561 6d5f 616e  cs_downstream_an
+00027360: 616c 7973 6973 2076 302e 312e 3020 696e  alysis v0.1.0 in
+00027370: 636c 7564 653a 0a0a 4461 7461 2069 6d70  clude:..Data imp
+00027380: 6f72 7420 616e 6420 7072 6570 726f 6365  ort and preproce
+00027390: 7373 696e 673a 2045 6173 696c 7920 696d  ssing: Easily im
+000273a0: 706f 7274 2061 6e64 2070 7265 7072 6f63  port and preproc
+000273b0: 6573 7320 7261 7720 7072 6f74 656f 6d69  ess raw proteomi
+000273c0: 6373 2064 6174 6120 6672 6f6d 2044 4941  cs data from DIA
+000273d0: 2d4e 4e2e 2041 7574 6f6d 6174 6963 616c  -NN. Automatical
+000273e0: 6c79 2068 616e 646c 6520 6d69 7373 696e  ly handle missin
+000273f0: 6720 7661 6c75 6573 2c20 6e6f 726d 616c  g values, normal
+00027400: 697a 6174 696f 6e2c 2061 6e64 2064 6174  ization, and dat
+00027410: 6120 7472 616e 7366 6f72 6d61 7469 6f6e  a transformation
+00027420: 2061 7320 6e65 6564 6564 2e0a 0a53 7461   as needed...Sta
+00027430: 7469 7374 6963 616c 2061 6e61 6c79 7369  tistical analysi
+00027440: 733a 2050 6572 666f 726d 2065 7373 656e  s: Perform essen
+00027450: 7469 616c 2073 7461 7469 7374 6963 616c  tial statistical
+00027460: 2074 6573 7473 2073 7563 6820 6173 2074   tests such as t
+00027470: 2d74 6573 7473 2c20 414e 4f56 412c 2061  -tests, ANOVA, a
+00027480: 6e64 206d 756c 7469 706c 6520 7465 7374  nd multiple test
+00027490: 696e 6720 636f 7272 6563 7469 6f6e 206d  ing correction m
+000274a0: 6574 686f 6473 2074 6f20 6173 7365 7373  ethods to assess
+000274b0: 2074 6865 2073 6967 6e69 6669 6361 6e63   the significanc
+000274c0: 6520 6f66 2064 6966 6665 7265 6e74 6961  e of differentia
+000274d0: 6c6c 7920 6578 7072 6573 7365 6420 7072  lly expressed pr
+000274e0: 6f74 6569 6e73 2e0a 0a45 6e72 6963 686d  oteins...Enrichm
+000274f0: 656e 7420 616e 616c 7973 6973 3a20 436f  ent analysis: Co
+00027500: 6e64 7563 7420 6675 6e63 7469 6f6e 616c  nduct functional
+00027510: 2065 6e72 6963 686d 656e 7420 616e 616c   enrichment anal
+00027520: 7973 6973 2074 6f20 6964 656e 7469 6679  ysis to identify
+00027530: 206f 7665 722d 7265 7072 6573 656e 7465   over-represente
+00027540: 6420 6675 6e63 7469 6f6e 616c 2063 6174  d functional cat
+00027550: 6567 6f72 6965 732c 2062 696f 6c6f 6769  egories, biologi
+00027560: 6361 6c20 7072 6f63 6573 7365 732c 206f  cal processes, o
+00027570: 7220 7061 7468 7761 7973 2069 6e20 796f  r pathways in yo
+00027580: 7572 2070 726f 7465 696e 2073 6574 732c  ur protein sets,
+00027590: 2073 7570 706f 7274 696e 6720 706f 7075   supporting popu
+000275a0: 6c61 7220 6461 7461 6261 7365 7320 6c69  lar databases li
+000275b0: 6b65 2047 656e 6520 4f6e 746f 6c6f 6779  ke Gene Ontology
+000275c0: 2061 6e64 204b 4547 472e 0a0a 436c 7573   and KEGG...Clus
+000275d0: 7465 7269 6e67 2061 6e64 2064 696d 656e  tering and dimen
+000275e0: 7369 6f6e 616c 6974 7920 7265 6475 6374  sionality reduct
+000275f0: 696f 6e3a 2041 7070 6c79 2061 6476 616e  ion: Apply advan
+00027600: 6365 6420 756e 7375 7065 7276 6973 6564  ced unsupervised
+00027610: 206c 6561 726e 696e 6720 7465 6368 6e69   learning techni
+00027620: 7175 6573 2074 6f20 6772 6f75 7020 7369  ques to group si
+00027630: 6d69 6c61 7220 7072 6f74 6569 6e73 2061  milar proteins a
+00027640: 6e64 2075 6e63 6f76 6572 2075 6e64 6572  nd uncover under
+00027650: 6c79 696e 6720 6269 6f6c 6f67 6963 616c  lying biological
+00027660: 2070 6174 7465 726e 732e 2054 6563 686e   patterns. Techn
+00027670: 6971 7565 7320 696e 636c 7564 6520 6869  iques include hi
+00027680: 6572 6172 6368 6963 616c 2063 6c75 7374  erarchical clust
+00027690: 6572 696e 672c 206b 2d6d 6561 6e73 2063  ering, k-means c
+000276a0: 6c75 7374 6572 696e 672c 2070 7269 6e63  lustering, princ
+000276b0: 6970 616c 2063 6f6d 706f 6e65 6e74 2061  ipal component a
+000276c0: 6e61 6c79 7369 7320 2850 4341 292c 2061  nalysis (PCA), a
+000276d0: 6e64 2074 2d64 6973 7472 6962 7574 6564  nd t-distributed
+000276e0: 2073 746f 6368 6173 7469 6320 6e65 6967   stochastic neig
+000276f0: 6862 6f72 2065 6d62 6564 6469 6e67 2028  hbor embedding (
+00027700: 742d 534e 4529 2e0a 0a43 7573 746f 6d69  t-SNE)...Customi
+00027710: 7a61 626c 6520 6461 7461 2076 6973 7561  zable data visua
+00027720: 6c69 7a61 7469 6f6e 3a20 4372 6561 7465  lization: Create
+00027730: 2073 7475 6e6e 696e 6720 616e 6420 696e   stunning and in
+00027740: 666f 726d 6174 6976 6520 7669 7375 616c  formative visual
+00027750: 697a 6174 696f 6e73 2074 6f20 6265 7474  izations to bett
+00027760: 6572 2075 6e64 6572 7374 616e 6420 616e  er understand an
+00027770: 6420 636f 6d6d 756e 6963 6174 6520 796f  d communicate yo
+00027780: 7572 2072 6573 756c 7473 2e20 4765 6e65  ur results. Gene
+00027790: 7261 7465 2068 6561 746d 6170 732c 2076  rate heatmaps, v
+000277a0: 6f6c 6361 6e6f 2070 6c6f 7473 2c20 5665  olcano plots, Ve
+000277b0: 6e6e 2064 6961 6772 616d 732c 2061 6e64  nn diagrams, and
+000277c0: 206d 6f72 6520 7769 7468 2066 756c 6c20   more with full 
+000277d0: 6375 7374 6f6d 697a 6174 696f 6e20 6f70  customization op
+000277e0: 7469 6f6e 732e 0a0a 496e 7465 6772 6174  tions...Integrat
+000277f0: 696f 6e20 7769 7468 2065 7869 7374 696e  ion with existin
+00027800: 6720 746f 6f6c 733a 2043 6f6d 7061 7469  g tools: Compati
+00027810: 6269 6c69 7479 2077 6974 6820 706f 7075  bility with popu
+00027820: 6c61 7220 5079 7468 6f6e 206c 6962 7261  lar Python libra
+00027830: 7269 6573 2069 6e63 6c75 6469 6e67 204e  ries including N
+00027840: 756d 5079 2c20 7061 6e64 6173 2c20 616e  umPy, pandas, an
+00027850: 6420 6d61 7470 6c6f 746c 6962 2c20 616c  d matplotlib, al
+00027860: 6c6f 7769 6e67 2079 6f75 2074 6f20 7365  lowing you to se
+00027870: 616d 6c65 7373 6c79 2069 6e74 6567 7261  amlessly integra
+00027880: 7465 2074 6869 7320 7061 636b 6167 6520  te this package 
+00027890: 696e 746f 2079 6f75 7220 6578 6973 7469  into your existi
+000278a0: 6e67 2064 6174 6120 616e 616c 7973 6973  ng data analysis
+000278b0: 2077 6f72 6b66 6c6f 772e 0a0a 5072 6f74   workflow...Prot
+000278c0: 656f 6d69 6373 2044 6f77 6e73 7472 6561  eomics Downstrea
+000278d0: 6d20 416e 616c 7973 6973 2076 302e 312e  m Analysis v0.1.
+000278e0: 3020 7072 6f76 6964 6573 2061 2073 6f6c  0 provides a sol
+000278f0: 6964 2066 6f75 6e64 6174 696f 6e20 666f  id foundation fo
+00027900: 7220 796f 7572 2070 726f 7465 6f6d 6963  r your proteomic
+00027910: 7320 7265 7365 6172 6368 206e 6565 6473  s research needs
+00027920: 2e0a 0a0a 3c70 2061 6c69 676e 3d22 7269  ....<p align="ri
+00027930: 6768 7422 3e28 3c61 2068 7265 663d 2223  ght">(<a href="#
+00027940: 7265 6164 6d65 2d74 6f70 223e 6261 636b  readme-top">back
+00027950: 2074 6f20 746f 703c 2f61 3e29 3c2f 703e   to top</a>)</p>
+00027960: 0a0a 0a23 2320 4765 7474 696e 6720 5374  ...## Getting St
+00027970: 6172 7465 640a 0a50 726f 7465 6f6d 6963  arted..Proteomic
+00027980: 7344 6f77 6e73 7472 6561 6d41 6e61 6c79  sDownstreamAnaly
+00027990: 7369 7320 6361 6e20 6265 2069 6e73 7461  sis can be insta
+000279a0: 6c6c 6564 2075 7369 6e67 3a0a 6060 600a  lled using:.```.
+000279b0: 7069 7020 696e 7374 616c 6c20 7072 6f74  pip install prot
+000279c0: 656f 6d69 6373 2d64 6f77 6e73 7472 6561  eomics-downstrea
+000279d0: 6d2d 616e 616c 7973 6973 0a60 6060 0a0a  m-analysis.```..
+000279e0: 3c70 2061 6c69 676e 3d22 7269 6768 7422  <p align="right"
+000279f0: 3e28 3c61 2068 7265 663d 2223 7265 6164  >(<a href="#read
+00027a00: 6d65 2d74 6f70 223e 6261 636b 2074 6f20  me-top">back to 
+00027a10: 746f 703c 2f61 3e29 3c2f 703e 0a0a 0a23  top</a>)</p>...#
+00027a20: 2320 5573 6167 650a 6060 600a 696d 706f  # Usage.```.impo
+00027a30: 7274 2070 726f 7465 6f6d 6963 735f 646f  rt proteomics_do
+00027a40: 776e 7374 7265 616d 5f61 6e61 6c79 7369  wnstream_analysi
+00027a50: 7320 6173 2070 6461 0a60 6060 0a3c 7020  s as pda.```.<p 
+00027a60: 616c 6967 6e3d 2272 6967 6874 223e 283c  align="right">(<
+00027a70: 6120 6872 6566 3d22 2372 6561 646d 652d  a href="#readme-
+00027a80: 746f 7022 3e62 6163 6b20 746f 2074 6f70  top">back to top
+00027a90: 3c2f 613e 293c 2f70 3e0a 0a23 2320 436f  </a>)</p>..## Co
+00027aa0: 6e74 7269 6275 7469 6e67 0a0a 436f 6e74  ntributing..Cont
+00027ab0: 7269 6275 7469 6f6e 2069 7320 6d75 6368  ribution is much
+00027ac0: 2061 7070 7265 6369 6174 6564 2e20 4861   appreciated. Ha
+00027ad0: 7070 7920 746f 2067 6574 2066 6565 6462  ppy to get feedb
+00027ae0: 6163 6b20 616e 6420 7375 6767 6573 7469  ack and suggesti
+00027af0: 6f6e 7321 200a 0a53 686f 756c 6420 796f  ons! ..Should yo
+00027b00: 7520 6861 7665 2061 2073 7567 6765 7374  u have a suggest
+00027b10: 696f 6e20 7468 6174 2063 6f75 6c64 2065  ion that could e
+00027b20: 6e68 616e 6365 2074 6869 7320 7072 6f6a  nhance this proj
+00027b30: 6563 742c 206b 696e 646c 7920 666f 726b  ect, kindly fork
+00027b40: 2074 6865 2072 6570 6f73 6974 6f72 7920   the repository 
+00027b50: 616e 6420 6372 6561 7465 2061 2070 756c  and create a pul
+00027b60: 6c20 7265 7175 6573 742e 2059 6f75 206d  l request. You m
+00027b70: 6179 2061 6c73 6f20 6f70 656e 2061 6e20  ay also open an 
+00027b80: 6973 7375 6520 6c61 6265 6c65 6420 6173  issue labeled as
+00027b90: 20e2 809c 696d 7072 6f76 656d 656e 74e2   ...improvement.
+00027ba0: 809d 2e20 0a0a 3c70 2061 6c69 676e 3d22  ... ..<p align="
+00027bb0: 7269 6768 7422 3e28 3c61 2068 7265 663d  right">(<a href=
+00027bc0: 2223 7265 6164 6d65 2d74 6f70 223e 6261  "#readme-top">ba
+00027bd0: 636b 2074 6f20 746f 703c 2f61 3e29 3c2f  ck to top</a>)</
+00027be0: 703e 0a0a 0a23 2320 4c69 6365 6e73 650a  p>...## License.
+00027bf0: 0a44 6973 7472 6962 7574 6564 2075 6e64  .Distributed und
+00027c00: 6572 2074 6865 204d 4954 204c 6963 656e  er the MIT Licen
+00027c10: 7365 2e20 5365 6520 604d 4954 2e74 7874  se. See `MIT.txt
+00027c20: 6020 666f 7220 6d6f 7265 2069 6e66 6f72  ` for more infor
+00027c30: 6d61 7469 6f6e 2e0a 0a3c 7020 616c 6967  mation...<p alig
+00027c40: 6e3d 2272 6967 6874 223e 283c 6120 6872  n="right">(<a hr
+00027c50: 6566 3d22 2372 6561 646d 652d 746f 7022  ef="#readme-top"
+00027c60: 3e62 6163 6b20 746f 2074 6f70 3c2f 613e  >back to top</a>
+00027c70: 293c 2f70 3e0a 0000 0000 0000 0000 0000  )</p>...........
 00027c80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00027c90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00027ca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00027cb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00027cc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00027cd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00027ce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -10202,176 +10202,176 @@
 00027d90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00027da0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00027db0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00027dc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00027dd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00027de0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00027df0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027e00: 7072 6f74 656f 6d69 6373 5f64 6f77 6e73  proteomics_downs
-00027e10: 7472 6561 6d5f 616e 616c 7973 6973 2d30  tream_analysis-0
-00027e20: 2e31 2e32 2f70 726f 7465 6f6d 6963 735f  .1.2/proteomics_
-00027e30: 646f 776e 7374 7265 616d 5f61 6e61 6c79  downstream_analy
-00027e40: 7369 732e 6567 672d 696e 666f 2f53 4f55  sis.egg-info/SOU
-00027e50: 5243 4553 2e74 7874 0000 0000 0000 0000  RCES.txt........
-00027e60: 0000 0000 3030 3030 3634 3400 3030 3031  ....0000644.0001
-00027e70: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
-00027e80: 3030 3032 3032 3300 3134 3435 3130 3636  0002023.14451066
-00027e90: 3234 3700 3033 3133 3633 0020 3000 0000  247.031363. 0...
+00027e00: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+00027e10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00027e20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00027e30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00027e40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00027e50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00027e60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+00027e70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00027e80: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
+00027e90: 3030 3000 3031 3032 3133 0020 7800 0000  000.010213. x...
 00027ea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00027eb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00027ec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00027ed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00027ee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00027ef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027f00: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
+00027f00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
 00027f10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027f20: 0000 0000 0000 0000 0064 6f63 6b65 7200  .........docker.
+00027f20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00027f30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00027f40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00027f50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00027f60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00027f70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00027f80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00027f90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00027fa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00027fb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00027fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00027fd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00027fe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00027ff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00028000: 4c49 4345 4e53 450a 5245 4144 4d45 2e6d  LICENSE.README.m
-00028010: 640a 7079 7072 6f6a 6563 742e 746f 6d6c  d.pyproject.toml
-00028020: 0a73 6574 7570 2e70 790a 7072 6f74 656f  .setup.py.proteo
-00028030: 6d69 6373 5f64 6f77 6e73 7472 6561 6d5f  mics_downstream_
-00028040: 616e 616c 7973 6973 2f5f 5f69 6e69 745f  analysis/__init_
-00028050: 5f2e 7079 0a70 726f 7465 6f6d 6963 735f  _.py.proteomics_
-00028060: 646f 776e 7374 7265 616d 5f61 6e61 6c79  downstream_analy
-00028070: 7369 732f 636f 6e74 616d 696e 6174 696f  sis/contaminatio
-00028080: 6e2e 7079 0a70 726f 7465 6f6d 6963 735f  n.py.proteomics_
-00028090: 646f 776e 7374 7265 616d 5f61 6e61 6c79  downstream_analy
-000280a0: 7369 732f 6461 7461 7175 616c 6974 7969  sis/dataqualityi
-000280b0: 6e66 6f72 6d61 7469 6f6e 2e70 790a 7072  nformation.py.pr
-000280c0: 6f74 656f 6d69 6373 5f64 6f77 6e73 7472  oteomics_downstr
-000280d0: 6561 6d5f 616e 616c 7973 6973 2f64 6961  eam_analysis/dia
-000280e0: 6e6e 6461 7461 2e70 790a 7072 6f74 656f  nndata.py.proteo
-000280f0: 6d69 6373 5f64 6f77 6e73 7472 6561 6d5f  mics_downstream_
-00028100: 616e 616c 7973 6973 2f64 696d 656e 7369  analysis/dimensi
-00028110: 6f6e 616c 6974 7972 6564 7563 7469 6f6e  onalityreduction
-00028120: 2e70 790a 7072 6f74 656f 6d69 6373 5f64  .py.proteomics_d
-00028130: 6f77 6e73 7472 6561 6d5f 616e 616c 7973  ownstream_analys
-00028140: 6973 2f65 6e72 6963 686d 656e 7461 6e61  is/enrichmentana
-00028150: 6c79 7369 732e 7079 0a70 726f 7465 6f6d  lysis.py.proteom
-00028160: 6963 735f 646f 776e 7374 7265 616d 5f61  ics_downstream_a
-00028170: 6e61 6c79 7369 732f 696d 7075 7465 722e  nalysis/imputer.
-00028180: 7079 0a70 726f 7465 6f6d 6963 735f 646f  py.proteomics_do
-00028190: 776e 7374 7265 616d 5f61 6e61 6c79 7369  wnstream_analysi
-000281a0: 732f 6d75 6c74 696c 6576 656c 6461 7461  s/multileveldata
-000281b0: 2e70 790a 7072 6f74 656f 6d69 6373 5f64  .py.proteomics_d
-000281c0: 6f77 6e73 7472 6561 6d5f 616e 616c 7973  ownstream_analys
-000281d0: 6973 2f70 7265 7072 6f63 6573 7369 6e67  is/preprocessing
-000281e0: 2e70 790a 7072 6f74 656f 6d69 6373 5f64  .py.proteomics_d
-000281f0: 6f77 6e73 7472 6561 6d5f 616e 616c 7973  ownstream_analys
-00028200: 6973 2f70 7265 7072 6f63 6573 7369 6e67  is/preprocessing
-00028210: 5f70 7265 7072 6f63 6573 736f 722e 7079  _preprocessor.py
-00028220: 0a70 726f 7465 6f6d 6963 735f 646f 776e  .proteomics_down
-00028230: 7374 7265 616d 5f61 6e61 6c79 7369 732f  stream_analysis/
-00028240: 7072 6570 726f 6365 7373 6f72 2e70 790a  preprocessor.py.
-00028250: 7072 6f74 656f 6d69 6373 5f64 6f77 6e73  proteomics_downs
-00028260: 7472 6561 6d5f 616e 616c 7973 6973 2f73  tream_analysis/s
-00028270: 7461 7469 7374 6963 732e 7079 0a70 726f  tatistics.py.pro
-00028280: 7465 6f6d 6963 735f 646f 776e 7374 7265  teomics_downstre
-00028290: 616d 5f61 6e61 6c79 7369 732f 7574 696c  am_analysis/util
-000282a0: 732e 7079 0a70 726f 7465 6f6d 6963 735f  s.py.proteomics_
-000282b0: 646f 776e 7374 7265 616d 5f61 6e61 6c79  downstream_analy
-000282c0: 7369 732f 7669 7375 616c 697a 6572 2e70  sis/visualizer.p
-000282d0: 790a 7072 6f74 656f 6d69 6373 5f64 6f77  y.proteomics_dow
-000282e0: 6e73 7472 6561 6d5f 616e 616c 7973 6973  nstream_analysis
-000282f0: 2e65 6767 2d69 6e66 6f2f 504b 472d 494e  .egg-info/PKG-IN
-00028300: 464f 0a70 726f 7465 6f6d 6963 735f 646f  FO.proteomics_do
-00028310: 776e 7374 7265 616d 5f61 6e61 6c79 7369  wnstream_analysi
-00028320: 732e 6567 672d 696e 666f 2f53 4f55 5243  s.egg-info/SOURC
-00028330: 4553 2e74 7874 0a70 726f 7465 6f6d 6963  ES.txt.proteomic
-00028340: 735f 646f 776e 7374 7265 616d 5f61 6e61  s_downstream_ana
-00028350: 6c79 7369 732e 6567 672d 696e 666f 2f64  lysis.egg-info/d
-00028360: 6570 656e 6465 6e63 795f 6c69 6e6b 732e  ependency_links.
-00028370: 7478 740a 7072 6f74 656f 6d69 6373 5f64  txt.proteomics_d
-00028380: 6f77 6e73 7472 6561 6d5f 616e 616c 7973  ownstream_analys
-00028390: 6973 2e65 6767 2d69 6e66 6f2f 7265 7175  is.egg-info/requ
-000283a0: 6972 6573 2e74 7874 0a70 726f 7465 6f6d  ires.txt.proteom
-000283b0: 6963 735f 646f 776e 7374 7265 616d 5f61  ics_downstream_a
-000283c0: 6e61 6c79 7369 732e 6567 672d 696e 666f  nalysis.egg-info
-000283d0: 2f74 6f70 5f6c 6576 656c 2e74 7874 0a74  /top_level.txt.t
-000283e0: 6573 7473 2f74 6573 745f 7072 6570 726f  ests/test_prepro
-000283f0: 6365 7373 696e 672e 7079 0a74 6573 7473  cessing.py.tests
-00028400: 2f74 6573 745f 7374 6174 6973 7469 6373  /test_statistics
-00028410: 2e70 7900 0000 0000 0000 0000 0000 0000  .py.............
-00028420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00028430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00028440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00028450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00028460: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00028470: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00028480: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00028490: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000284a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000284b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000284c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000284d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000284e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000284f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00028500: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00028510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00028520: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00028530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00028540: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00028550: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00028560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00028570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00028580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00028590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000285a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000285b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000285c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000285d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000285e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000285f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00028600: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-00028610: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00028620: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00028630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00028640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00028650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00028660: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-00028670: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00028680: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
-00028690: 3030 3000 3031 3032 3133 0020 7800 0000  000.010213. x...
-000286a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000286b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000286c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000286d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000286e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000286f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00028700: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-00028710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00028720: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00028730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00028740: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00028750: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00028760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00028770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00028780: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00028790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000287a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000287b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000287c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000287d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000287e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000287f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00028800: 3232 206d 7469 6d65 3d31 3638 3834 3937  22 mtime=1688497
-00028810: 3331 392e 300a 0000 0000 0000 0000 0000  319.0...........
+00028000: 3232 206d 7469 6d65 3d31 3638 3835 3732  22 mtime=1688572
+00028010: 3130 322e 300a 0000 0000 0000 0000 0000  102.0...........
+00028020: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00028030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00028040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00028050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00028060: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00028070: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00028080: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00028090: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000280a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000280b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000280c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000280d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000280e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000280f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00028100: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00028110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00028120: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00028130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00028140: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00028150: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00028160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00028170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00028180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00028190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000281a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000281b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000281c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000281d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000281e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000281f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00028200: 7072 6f74 656f 6d69 6373 5f64 6f77 6e73  proteomics_downs
+00028210: 7472 6561 6d5f 616e 616c 7973 6973 2d30  tream_analysis-0
+00028220: 2e31 2e33 2f70 726f 7465 6f6d 6963 735f  .1.3/proteomics_
+00028230: 646f 776e 7374 7265 616d 5f61 6e61 6c79  downstream_analy
+00028240: 7369 732e 6567 672d 696e 666f 2f53 4f55  sis.egg-info/SOU
+00028250: 5243 4553 2e74 7874 0000 0000 0000 0000  RCES.txt........
+00028260: 0000 0000 3030 3030 3634 3400 3030 3031  ....0000644.0001
+00028270: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
+00028280: 3030 3032 3032 3300 3134 3435 3133 3130  0002023.14451310
+00028290: 3330 3600 3033 3133 3530 0020 3000 0000  306.031350. 0...
+000282a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000282b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000282c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000282d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000282e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000282f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00028300: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
+00028310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00028320: 0000 0000 0000 0000 0064 6f63 6b65 7200  .........docker.
+00028330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00028340: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00028350: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00028360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00028370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00028380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00028390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000283a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000283b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000283c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000283d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000283e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000283f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00028400: 4c49 4345 4e53 450a 5245 4144 4d45 2e6d  LICENSE.README.m
+00028410: 640a 7079 7072 6f6a 6563 742e 746f 6d6c  d.pyproject.toml
+00028420: 0a73 6574 7570 2e70 790a 7072 6f74 656f  .setup.py.proteo
+00028430: 6d69 6373 5f64 6f77 6e73 7472 6561 6d5f  mics_downstream_
+00028440: 616e 616c 7973 6973 2f5f 5f69 6e69 745f  analysis/__init_
+00028450: 5f2e 7079 0a70 726f 7465 6f6d 6963 735f  _.py.proteomics_
+00028460: 646f 776e 7374 7265 616d 5f61 6e61 6c79  downstream_analy
+00028470: 7369 732f 636f 6e74 616d 696e 6174 696f  sis/contaminatio
+00028480: 6e2e 7079 0a70 726f 7465 6f6d 6963 735f  n.py.proteomics_
+00028490: 646f 776e 7374 7265 616d 5f61 6e61 6c79  downstream_analy
+000284a0: 7369 732f 6461 7461 7175 616c 6974 7969  sis/dataqualityi
+000284b0: 6e66 6f72 6d61 7469 6f6e 2e70 790a 7072  nformation.py.pr
+000284c0: 6f74 656f 6d69 6373 5f64 6f77 6e73 7472  oteomics_downstr
+000284d0: 6561 6d5f 616e 616c 7973 6973 2f64 6961  eam_analysis/dia
+000284e0: 6e6e 6461 7461 2e70 790a 7072 6f74 656f  nndata.py.proteo
+000284f0: 6d69 6373 5f64 6f77 6e73 7472 6561 6d5f  mics_downstream_
+00028500: 616e 616c 7973 6973 2f64 696d 656e 7369  analysis/dimensi
+00028510: 6f6e 616c 6974 7972 6564 7563 7469 6f6e  onalityreduction
+00028520: 2e70 790a 7072 6f74 656f 6d69 6373 5f64  .py.proteomics_d
+00028530: 6f77 6e73 7472 6561 6d5f 616e 616c 7973  ownstream_analys
+00028540: 6973 2f65 6e72 6963 686d 656e 7461 6e61  is/enrichmentana
+00028550: 6c79 7369 732e 7079 0a70 726f 7465 6f6d  lysis.py.proteom
+00028560: 6963 735f 646f 776e 7374 7265 616d 5f61  ics_downstream_a
+00028570: 6e61 6c79 7369 732f 696d 7075 7465 722e  nalysis/imputer.
+00028580: 7079 0a70 726f 7465 6f6d 6963 735f 646f  py.proteomics_do
+00028590: 776e 7374 7265 616d 5f61 6e61 6c79 7369  wnstream_analysi
+000285a0: 732f 6d75 6c74 696c 6576 656c 6461 7461  s/multileveldata
+000285b0: 2e70 790a 7072 6f74 656f 6d69 6373 5f64  .py.proteomics_d
+000285c0: 6f77 6e73 7472 6561 6d5f 616e 616c 7973  ownstream_analys
+000285d0: 6973 2f70 7265 7072 6f63 6573 7369 6e67  is/preprocessing
+000285e0: 2e70 790a 7072 6f74 656f 6d69 6373 5f64  .py.proteomics_d
+000285f0: 6f77 6e73 7472 6561 6d5f 616e 616c 7973  ownstream_analys
+00028600: 6973 2f70 7265 7072 6f63 6573 7369 6e67  is/preprocessing
+00028610: 5f70 7265 7072 6f63 6573 736f 722e 7079  _preprocessor.py
+00028620: 0a70 726f 7465 6f6d 6963 735f 646f 776e  .proteomics_down
+00028630: 7374 7265 616d 5f61 6e61 6c79 7369 732f  stream_analysis/
+00028640: 7072 6570 726f 6365 7373 6f72 2e70 790a  preprocessor.py.
+00028650: 7072 6f74 656f 6d69 6373 5f64 6f77 6e73  proteomics_downs
+00028660: 7472 6561 6d5f 616e 616c 7973 6973 2f73  tream_analysis/s
+00028670: 7461 7469 7374 6963 732e 7079 0a70 726f  tatistics.py.pro
+00028680: 7465 6f6d 6963 735f 646f 776e 7374 7265  teomics_downstre
+00028690: 616d 5f61 6e61 6c79 7369 732f 7574 696c  am_analysis/util
+000286a0: 732e 7079 0a70 726f 7465 6f6d 6963 735f  s.py.proteomics_
+000286b0: 646f 776e 7374 7265 616d 5f61 6e61 6c79  downstream_analy
+000286c0: 7369 732f 7669 7375 616c 697a 6572 2e70  sis/visualizer.p
+000286d0: 790a 7072 6f74 656f 6d69 6373 5f64 6f77  y.proteomics_dow
+000286e0: 6e73 7472 6561 6d5f 616e 616c 7973 6973  nstream_analysis
+000286f0: 2e65 6767 2d69 6e66 6f2f 504b 472d 494e  .egg-info/PKG-IN
+00028700: 464f 0a70 726f 7465 6f6d 6963 735f 646f  FO.proteomics_do
+00028710: 776e 7374 7265 616d 5f61 6e61 6c79 7369  wnstream_analysi
+00028720: 732e 6567 672d 696e 666f 2f53 4f55 5243  s.egg-info/SOURC
+00028730: 4553 2e74 7874 0a70 726f 7465 6f6d 6963  ES.txt.proteomic
+00028740: 735f 646f 776e 7374 7265 616d 5f61 6e61  s_downstream_ana
+00028750: 6c79 7369 732e 6567 672d 696e 666f 2f64  lysis.egg-info/d
+00028760: 6570 656e 6465 6e63 795f 6c69 6e6b 732e  ependency_links.
+00028770: 7478 740a 7072 6f74 656f 6d69 6373 5f64  txt.proteomics_d
+00028780: 6f77 6e73 7472 6561 6d5f 616e 616c 7973  ownstream_analys
+00028790: 6973 2e65 6767 2d69 6e66 6f2f 7265 7175  is.egg-info/requ
+000287a0: 6972 6573 2e74 7874 0a70 726f 7465 6f6d  ires.txt.proteom
+000287b0: 6963 735f 646f 776e 7374 7265 616d 5f61  ics_downstream_a
+000287c0: 6e61 6c79 7369 732e 6567 672d 696e 666f  nalysis.egg-info
+000287d0: 2f74 6f70 5f6c 6576 656c 2e74 7874 0a74  /top_level.txt.t
+000287e0: 6573 7473 2f74 6573 745f 7072 6570 726f  ests/test_prepro
+000287f0: 6365 7373 696e 672e 7079 0a74 6573 7473  cessing.py.tests
+00028800: 2f74 6573 745f 7374 6174 6973 7469 6373  /test_statistics
+00028810: 2e70 7900 0000 0000 0000 0000 0000 0000  .py.............
 00028820: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00028830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00028840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00028850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00028860: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00028870: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00028880: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -10394,48 +10394,48 @@
 00028990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000289a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000289b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000289c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000289d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000289e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000289f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00028a00: 7072 6f74 656f 6d69 6373 5f64 6f77 6e73  proteomics_downs
-00028a10: 7472 6561 6d5f 616e 616c 7973 6973 2d30  tream_analysis-0
-00028a20: 2e31 2e32 2f70 726f 7465 6f6d 6963 735f  .1.2/proteomics_
-00028a30: 646f 776e 7374 7265 616d 5f61 6e61 6c79  downstream_analy
-00028a40: 7369 732e 6567 672d 696e 666f 2f64 6570  sis.egg-info/dep
-00028a50: 656e 6465 6e63 795f 6c69 6e6b 732e 7478  endency_links.tx
-00028a60: 7400 0000 3030 3030 3634 3400 3030 3031  t...0000644.0001
-00028a70: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
-00028a80: 3030 3030 3030 3100 3134 3435 3130 3636  0000001.14451066
-00028a90: 3234 3700 3033 3335 3530 0020 3000 0000  247.033550. 0...
+00028a00: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+00028a10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00028a20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00028a30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00028a40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00028a50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00028a60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+00028a70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00028a80: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
+00028a90: 3030 3000 3031 3032 3133 0020 7800 0000  000.010213. x...
 00028aa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00028ab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00028ac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00028ad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00028ae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00028af0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00028b00: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
+00028b00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
 00028b10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00028b20: 0000 0000 0000 0000 0064 6f63 6b65 7200  .........docker.
+00028b20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00028b30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00028b40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00028b50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00028b60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00028b70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00028b80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00028b90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00028ba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00028bb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00028bc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00028bd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00028be0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00028bf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00028c00: 0a00 0000 0000 0000 0000 0000 0000 0000  ................
-00028c10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00028c00: 3232 206d 7469 6d65 3d31 3638 3835 3732  22 mtime=1688572
+00028c10: 3130 322e 300a 0000 0000 0000 0000 0000  102.0...........
 00028c20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00028c30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00028c40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00028c50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00028c60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00028c70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00028c80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -10458,48 +10458,48 @@
 00028d90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00028da0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00028db0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00028dc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00028dd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00028de0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00028df0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00028e00: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-00028e10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00028e20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00028e30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00028e40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00028e50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00028e60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-00028e70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00028e80: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
-00028e90: 3030 3000 3031 3032 3133 0020 7800 0000  000.010213. x...
+00028e00: 7072 6f74 656f 6d69 6373 5f64 6f77 6e73  proteomics_downs
+00028e10: 7472 6561 6d5f 616e 616c 7973 6973 2d30  tream_analysis-0
+00028e20: 2e31 2e33 2f70 726f 7465 6f6d 6963 735f  .1.3/proteomics_
+00028e30: 646f 776e 7374 7265 616d 5f61 6e61 6c79  downstream_analy
+00028e40: 7369 732e 6567 672d 696e 666f 2f64 6570  sis.egg-info/dep
+00028e50: 656e 6465 6e63 795f 6c69 6e6b 732e 7478  endency_links.tx
+00028e60: 7400 0000 3030 3030 3634 3400 3030 3031  t...0000644.0001
+00028e70: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
+00028e80: 3030 3030 3030 3100 3134 3435 3133 3130  0000001.14451310
+00028e90: 3330 3600 3033 3335 3335 0020 3000 0000  306.033535. 0...
 00028ea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00028eb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00028ec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00028ed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00028ee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00028ef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00028f00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00028f00: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
 00028f10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00028f20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00028f20: 0000 0000 0000 0000 0064 6f63 6b65 7200  .........docker.
 00028f30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00028f40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00028f50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00028f60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00028f70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00028f80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00028f90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00028fa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00028fb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00028fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00028fd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00028fe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00028ff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00029000: 3232 206d 7469 6d65 3d31 3638 3834 3937  22 mtime=1688497
-00029010: 3331 392e 300a 0000 0000 0000 0000 0000  319.0...........
+00029000: 0a00 0000 0000 0000 0000 0000 0000 0000  ................
+00029010: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00029020: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00029030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00029040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00029050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00029060: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00029070: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00029080: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -10522,57 +10522,57 @@
 00029190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000291a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000291b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000291c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000291d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000291e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000291f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00029200: 7072 6f74 656f 6d69 6373 5f64 6f77 6e73  proteomics_downs
-00029210: 7472 6561 6d5f 616e 616c 7973 6973 2d30  tream_analysis-0
-00029220: 2e31 2e32 2f70 726f 7465 6f6d 6963 735f  .1.2/proteomics_
-00029230: 646f 776e 7374 7265 616d 5f61 6e61 6c79  downstream_analy
-00029240: 7369 732e 6567 672d 696e 666f 2f72 6571  sis.egg-info/req
-00029250: 7569 7265 732e 7478 7400 0000 0000 0000  uires.txt.......
-00029260: 0000 0000 3030 3030 3634 3400 3030 3031  ....0000644.0001
-00029270: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
-00029280: 3030 3030 3235 3300 3134 3435 3130 3636  0000253.14451066
-00029290: 3234 3700 3033 3231 3032 0020 3000 0000  247.032102. 0...
+00029200: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+00029210: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00029220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00029230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00029240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00029250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00029260: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+00029270: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00029280: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
+00029290: 3030 3000 3031 3032 3133 0020 7800 0000  000.010213. x...
 000292a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000292b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000292c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000292d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000292e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000292f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00029300: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
+00029300: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
 00029310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00029320: 0000 0000 0000 0000 0064 6f63 6b65 7200  .........docker.
+00029320: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00029330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00029340: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00029350: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00029360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00029370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00029380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00029390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000293a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000293b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000293c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000293d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000293e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000293f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00029400: 6164 6a75 7374 5465 7874 0a67 6f61 746f  adjustText.goato
-00029410: 6f6c 730a 6773 6561 7079 0a6d 6174 706c  ols.gseapy.matpl
-00029420: 6f74 6c69 620a 6d61 7470 6c6f 746c 6962  otlib.matplotlib
-00029430: 2d76 656e 6e0a 6e75 6d62 610a 6e75 6d70  -venn.numba.nump
-00029440: 790a 706c 6f74 6c79 0a70 7961 7272 6f77  y.plotly.pyarrow
-00029450: 0a70 7963 6972 636c 697a 650a 7079 7465  .pycirclize.pyte
-00029460: 6f6d 6963 730a 7363 696b 6974 2d6c 6561  omics.scikit-lea
-00029470: 726e 0a73 6369 7079 0a73 6561 626f 726e  rn.scipy.seaborn
-00029480: 0a73 7461 7473 6d6f 6465 6c73 0a73 7472  .statsmodels.str
-00029490: 6561 6d6c 6974 0a75 6d61 700a 5570 5365  eamlit.umap.UpSe
-000294a0: 7450 6c6f 740a 7665 6e6e 0a00 0000 0000  tPlot.venn......
+00029400: 3232 206d 7469 6d65 3d31 3638 3835 3732  22 mtime=1688572
+00029410: 3130 322e 300a 0000 0000 0000 0000 0000  102.0...........
+00029420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00029430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00029440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00029450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00029460: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00029470: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00029480: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00029490: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000294a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000294b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000294c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000294d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000294e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000294f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00029500: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00029510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -10586,57 +10586,57 @@
 00029590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000295a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000295b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000295c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000295d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000295e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000295f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00029600: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-00029610: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00029620: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00029630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00029640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00029650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00029660: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-00029670: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00029680: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
-00029690: 3030 3000 3031 3032 3133 0020 7800 0000  000.010213. x...
+00029600: 7072 6f74 656f 6d69 6373 5f64 6f77 6e73  proteomics_downs
+00029610: 7472 6561 6d5f 616e 616c 7973 6973 2d30  tream_analysis-0
+00029620: 2e31 2e33 2f70 726f 7465 6f6d 6963 735f  .1.3/proteomics_
+00029630: 646f 776e 7374 7265 616d 5f61 6e61 6c79  downstream_analy
+00029640: 7369 732e 6567 672d 696e 666f 2f72 6571  sis.egg-info/req
+00029650: 7569 7265 732e 7478 7400 0000 0000 0000  uires.txt.......
+00029660: 0000 0000 3030 3030 3634 3400 3030 3031  ....0000644.0001
+00029670: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
+00029680: 3030 3030 3235 3300 3134 3435 3133 3130  0000253.14451310
+00029690: 3330 3600 3033 3230 3637 0020 3000 0000  306.032067. 0...
 000296a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000296b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000296c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000296d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000296e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000296f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00029700: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00029700: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
 00029710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00029720: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00029720: 0000 0000 0000 0000 0064 6f63 6b65 7200  .........docker.
 00029730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00029740: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00029750: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00029760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00029770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00029780: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00029790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000297a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000297b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000297c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000297d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000297e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000297f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00029800: 3232 206d 7469 6d65 3d31 3638 3834 3937  22 mtime=1688497
-00029810: 3331 392e 300a 0000 0000 0000 0000 0000  319.0...........
-00029820: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00029830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00029840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00029850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00029860: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00029870: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00029880: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00029890: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000298a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00029800: 6164 6a75 7374 5465 7874 0a67 6f61 746f  adjustText.goato
+00029810: 6f6c 730a 6773 6561 7079 0a6d 6174 706c  ols.gseapy.matpl
+00029820: 6f74 6c69 620a 6d61 7470 6c6f 746c 6962  otlib.matplotlib
+00029830: 2d76 656e 6e0a 6e75 6d62 610a 6e75 6d70  -venn.numba.nump
+00029840: 790a 706c 6f74 6c79 0a70 7961 7272 6f77  y.plotly.pyarrow
+00029850: 0a70 7963 6972 636c 697a 650a 7079 7465  .pycirclize.pyte
+00029860: 6f6d 6963 730a 7363 696b 6974 2d6c 6561  omics.scikit-lea
+00029870: 726e 0a73 6369 7079 0a73 6561 626f 726e  rn.scipy.seaborn
+00029880: 0a73 7461 7473 6d6f 6465 6c73 0a73 7472  .statsmodels.str
+00029890: 6561 6d6c 6974 0a75 6d61 700a 5570 5365  eamlit.umap.UpSe
+000298a0: 7450 6c6f 740a 7665 6e6e 0a00 0000 0000  tPlot.venn......
 000298b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000298c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000298d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000298e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000298f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00029900: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00029910: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -10650,48 +10650,48 @@
 00029990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000299a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000299b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000299c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000299d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000299e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000299f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00029a00: 7072 6f74 656f 6d69 6373 5f64 6f77 6e73  proteomics_downs
-00029a10: 7472 6561 6d5f 616e 616c 7973 6973 2d30  tream_analysis-0
-00029a20: 2e31 2e32 2f70 726f 7465 6f6d 6963 735f  .1.2/proteomics_
-00029a30: 646f 776e 7374 7265 616d 5f61 6e61 6c79  downstream_analy
-00029a40: 7369 732e 6567 672d 696e 666f 2f74 6f70  sis.egg-info/top
-00029a50: 5f6c 6576 656c 2e74 7874 0000 0000 0000  _level.txt......
-00029a60: 0000 0000 3030 3030 3634 3400 3030 3031  ....0000644.0001
-00029a70: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
-00029a80: 3030 3030 3033 3700 3134 3435 3130 3636  0000037.14451066
-00029a90: 3234 3700 3033 3232 3334 0020 3000 0000  247.032234. 0...
+00029a00: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+00029a10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00029a20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00029a30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00029a40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00029a50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00029a60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+00029a70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00029a80: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
+00029a90: 3030 3000 3031 3032 3133 0020 7800 0000  000.010213. x...
 00029aa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00029ab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00029ac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00029ad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00029ae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00029af0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00029b00: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
+00029b00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
 00029b10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00029b20: 0000 0000 0000 0000 0064 6f63 6b65 7200  .........docker.
+00029b20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00029b30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00029b40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00029b50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00029b60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00029b70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00029b80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00029b90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00029ba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00029bb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00029bc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00029bd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00029be0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00029bf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00029c00: 7072 6f74 656f 6d69 6373 5f64 6f77 6e73  proteomics_downs
-00029c10: 7472 6561 6d5f 616e 616c 7973 6973 0a00  tream_analysis..
+00029c00: 3232 206d 7469 6d65 3d31 3638 3835 3732  22 mtime=1688572
+00029c10: 3130 322e 300a 0000 0000 0000 0000 0000  102.0...........
 00029c20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00029c30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00029c40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00029c50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00029c60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00029c70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00029c80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -10714,48 +10714,48 @@
 00029d90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00029da0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00029db0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00029dc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00029dd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00029de0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00029df0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00029e00: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-00029e10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00029e20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00029e30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00029e40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00029e50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00029e60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-00029e70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00029e80: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
-00029e90: 3030 3000 3031 3032 3133 0020 7800 0000  000.010213. x...
+00029e00: 7072 6f74 656f 6d69 6373 5f64 6f77 6e73  proteomics_downs
+00029e10: 7472 6561 6d5f 616e 616c 7973 6973 2d30  tream_analysis-0
+00029e20: 2e31 2e33 2f70 726f 7465 6f6d 6963 735f  .1.3/proteomics_
+00029e30: 646f 776e 7374 7265 616d 5f61 6e61 6c79  downstream_analy
+00029e40: 7369 732e 6567 672d 696e 666f 2f74 6f70  sis.egg-info/top
+00029e50: 5f6c 6576 656c 2e74 7874 0000 0000 0000  _level.txt......
+00029e60: 0000 0000 3030 3030 3634 3400 3030 3031  ....0000644.0001
+00029e70: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
+00029e80: 3030 3030 3033 3700 3134 3435 3133 3130  0000037.14451310
+00029e90: 3330 3600 3033 3232 3231 0020 3000 0000  306.032221. 0...
 00029ea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00029eb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00029ec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00029ed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00029ee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00029ef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00029f00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00029f00: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
 00029f10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00029f20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00029f20: 0000 0000 0000 0000 0064 6f63 6b65 7200  .........docker.
 00029f30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00029f40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00029f50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00029f60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00029f70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00029f80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00029f90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00029fa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00029fb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00029fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00029fd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00029fe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00029ff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002a000: 3232 206d 7469 6d65 3d31 3638 3834 3937  22 mtime=1688497
-0002a010: 3330 392e 300a 0000 0000 0000 0000 0000  309.0...........
+0002a000: 7072 6f74 656f 6d69 6373 5f64 6f77 6e73  proteomics_downs
+0002a010: 7472 6561 6d5f 616e 616c 7973 6973 0a00  tream_analysis..
 0002a020: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002a030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002a040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002a050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002a060: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002a070: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002a080: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -10778,57 +10778,57 @@
 0002a190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002a1a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002a1b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002a1c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002a1d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002a1e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002a1f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002a200: 7072 6f74 656f 6d69 6373 5f64 6f77 6e73  proteomics_downs
-0002a210: 7472 6561 6d5f 616e 616c 7973 6973 2d30  tream_analysis-0
-0002a220: 2e31 2e32 2f70 7970 726f 6a65 6374 2e74  .1.2/pyproject.t
-0002a230: 6f6d 6c00 0000 0000 0000 0000 0000 0000  oml.............
+0002a200: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+0002a210: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002a220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002a230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002a240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002a250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002a260: 0000 0000 3030 3030 3634 3400 3030 3031  ....0000644.0001
-0002a270: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
-0002a280: 3030 3030 3234 3500 3134 3435 3130 3636  0000245.14451066
-0002a290: 3233 3500 3032 3233 3730 0020 3000 0000  235.022370. 0...
+0002a260: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+0002a270: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+0002a280: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
+0002a290: 3030 3000 3031 3032 3133 0020 7800 0000  000.010213. x...
 0002a2a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002a2b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002a2c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002a2d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002a2e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002a2f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002a300: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
+0002a300: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
 0002a310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002a320: 0000 0000 0000 0000 0064 6f63 6b65 7200  .........docker.
+0002a320: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002a330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002a340: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002a350: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002a360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002a370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002a380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002a390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002a3a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002a3b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002a3c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002a3d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002a3e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002a3f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002a400: 5b62 7569 6c64 2d73 7973 7465 6d5d 0a72  [build-system].r
-0002a410: 6571 7569 7265 7320 3d20 5b0a 2020 2020  equires = [.    
-0002a420: 2273 6574 7570 746f 6f6c 7322 2c0a 2020  "setuptools",.  
-0002a430: 2020 2277 6865 656c 220a 5d0a 6275 696c    "wheel".].buil
-0002a440: 642d 6261 636b 656e 6420 3d20 2273 6574  d-backend = "set
-0002a450: 7570 746f 6f6c 732e 6275 696c 645f 6d65  uptools.build_me
-0002a460: 7461 220a 0a5b 746f 6f6c 2e73 6574 7570  ta"..[tool.setup
-0002a470: 746f 6f6c 735f 7363 6d5d 0a77 7269 7465  tools_scm].write
-0002a480: 5f74 6f20 3d20 2279 6f75 725f 7061 636b  _to = "your_pack
-0002a490: 6167 655f 6e61 6d65 2f5f 7665 7273 696f  age_name/_versio
-0002a4a0: 6e2e 7079 2200 0000 0000 0000 0000 0000  n.py"...........
+0002a400: 3232 206d 7469 6d65 3d31 3638 3835 3732  22 mtime=1688572
+0002a410: 3039 322e 300a 0000 0000 0000 0000 0000  092.0...........
+0002a420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002a430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002a440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002a450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002a460: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002a470: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002a480: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002a490: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002a4a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002a4b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002a4c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002a4d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002a4e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002a4f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002a500: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002a510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -10842,57 +10842,57 @@
 0002a590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002a5a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002a5b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002a5c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002a5d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002a5e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002a5f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002a600: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-0002a610: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002a620: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002a630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002a600: 7072 6f74 656f 6d69 6373 5f64 6f77 6e73  proteomics_downs
+0002a610: 7472 6561 6d5f 616e 616c 7973 6973 2d30  tream_analysis-0
+0002a620: 2e31 2e33 2f70 7970 726f 6a65 6374 2e74  .1.3/pyproject.t
+0002a630: 6f6d 6c00 0000 0000 0000 0000 0000 0000  oml.............
 0002a640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002a650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002a660: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-0002a670: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-0002a680: 3030 3030 3033 3400 3030 3030 3030 3030  0000034.00000000
-0002a690: 3030 3000 3031 3032 3132 0020 7800 0000  000.010212. x...
+0002a660: 0000 0000 3030 3030 3634 3400 3030 3031  ....0000644.0001
+0002a670: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
+0002a680: 3030 3030 3234 3500 3134 3435 3133 3130  0000245.14451310
+0002a690: 3237 3400 3032 3233 3634 0020 3000 0000  274.022364. 0...
 0002a6a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002a6b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002a6c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002a6d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002a6e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002a6f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002a700: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+0002a700: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
 0002a710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002a720: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002a720: 0000 0000 0000 0000 0064 6f63 6b65 7200  .........docker.
 0002a730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002a740: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002a750: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002a760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002a770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002a780: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002a790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002a7a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002a7b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002a7c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002a7d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002a7e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002a7f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002a800: 3238 206d 7469 6d65 3d31 3638 3834 3937  28 mtime=1688497
-0002a810: 3331 392e 3830 3535 3933 350a 0000 0000  319.8055935.....
-0002a820: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002a830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002a840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002a850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002a860: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002a870: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002a880: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002a890: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002a8a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002a800: 5b62 7569 6c64 2d73 7973 7465 6d5d 0a72  [build-system].r
+0002a810: 6571 7569 7265 7320 3d20 5b0a 2020 2020  equires = [.    
+0002a820: 2273 6574 7570 746f 6f6c 7322 2c0a 2020  "setuptools",.  
+0002a830: 2020 2277 6865 656c 220a 5d0a 6275 696c    "wheel".].buil
+0002a840: 642d 6261 636b 656e 6420 3d20 2273 6574  d-backend = "set
+0002a850: 7570 746f 6f6c 732e 6275 696c 645f 6d65  uptools.build_me
+0002a860: 7461 220a 0a5b 746f 6f6c 2e73 6574 7570  ta"..[tool.setup
+0002a870: 746f 6f6c 735f 7363 6d5d 0a77 7269 7465  tools_scm].write
+0002a880: 5f74 6f20 3d20 2279 6f75 725f 7061 636b  _to = "your_pack
+0002a890: 6167 655f 6e61 6d65 2f5f 7665 7273 696f  age_name/_versio
+0002a8a0: 6e2e 7079 2200 0000 0000 0000 0000 0000  n.py"...........
 0002a8b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002a8c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002a8d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002a8e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002a8f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002a900: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002a910: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -10906,49 +10906,49 @@
 0002a990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002a9a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002a9b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002a9c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002a9d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002a9e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002a9f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002aa00: 7072 6f74 656f 6d69 6373 5f64 6f77 6e73  proteomics_downs
-0002aa10: 7472 6561 6d5f 616e 616c 7973 6973 2d30  tream_analysis-0
-0002aa20: 2e31 2e32 2f73 6574 7570 2e63 6667 0000  .1.2/setup.cfg..
+0002aa00: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+0002aa10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002aa20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002aa30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002aa40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002aa50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002aa60: 0000 0000 3030 3030 3634 3400 3030 3031  ....0000644.0001
-0002aa70: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
-0002aa80: 3030 3030 3034 3600 3134 3435 3130 3636  0000046.14451066
-0002aa90: 3235 3000 3032 3132 3731 0020 3000 0000  250.021271. 0...
+0002aa60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+0002aa70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+0002aa80: 3030 3030 3033 3300 3030 3030 3030 3030  0000033.00000000
+0002aa90: 3030 3000 3031 3032 3131 0020 7800 0000  000.010211. x...
 0002aaa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002aab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002aac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002aad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002aae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002aaf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002ab00: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
+0002ab00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
 0002ab10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002ab20: 0000 0000 0000 0000 0064 6f63 6b65 7200  .........docker.
+0002ab20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002ab30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002ab40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002ab50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002ab60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002ab70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002ab80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002ab90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002aba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002abb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002abc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002abd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002abe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002abf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002ac00: 5b65 6767 5f69 6e66 6f5d 0a74 6167 5f62  [egg_info].tag_b
-0002ac10: 7569 6c64 203d 200a 7461 675f 6461 7465  uild = .tag_date
-0002ac20: 203d 2030 0a0a 0000 0000 0000 0000 0000   = 0............
+0002ac00: 3237 206d 7469 6d65 3d31 3638 3835 3732  27 mtime=1688572
+0002ac10: 3130 322e 3531 3438 3134 0a00 0000 0000  102.514814......
+0002ac20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002ac30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002ac40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002ac50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002ac60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002ac70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002ac80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002ac90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -10970,49 +10970,49 @@
 0002ad90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002ada0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002adb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002adc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002add0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002ade0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002adf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002ae00: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-0002ae10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002ae20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002ae00: 7072 6f74 656f 6d69 6373 5f64 6f77 6e73  proteomics_downs
+0002ae10: 7472 6561 6d5f 616e 616c 7973 6973 2d30  tream_analysis-0
+0002ae20: 2e31 2e33 2f73 6574 7570 2e63 6667 0000  .1.3/setup.cfg..
 0002ae30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002ae40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002ae50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002ae60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-0002ae70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-0002ae80: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
-0002ae90: 3030 3000 3031 3032 3133 0020 7800 0000  000.010213. x...
+0002ae60: 0000 0000 3030 3030 3634 3400 3030 3031  ....0000644.0001
+0002ae70: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
+0002ae80: 3030 3030 3034 3600 3134 3435 3133 3130  0000046.14451310
+0002ae90: 3330 3700 3032 3132 3635 0020 3000 0000  307.021265. 0...
 0002aea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002aeb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002aec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002aed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002aee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002aef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002af00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+0002af00: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
 0002af10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002af20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002af20: 0000 0000 0000 0000 0064 6f63 6b65 7200  .........docker.
 0002af30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002af40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002af50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002af60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002af70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002af80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002af90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002afa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002afb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002afc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002afd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002afe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002aff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002b000: 3232 206d 7469 6d65 3d31 3638 3834 3937  22 mtime=1688497
-0002b010: 3330 392e 300a 0000 0000 0000 0000 0000  309.0...........
-0002b020: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002b000: 5b65 6767 5f69 6e66 6f5d 0a74 6167 5f62  [egg_info].tag_b
+0002b010: 7569 6c64 203d 200a 7461 675f 6461 7465  uild = .tag_date
+0002b020: 203d 2030 0a0a 0000 0000 0000 0000 0000   = 0............
 0002b030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002b040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002b050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002b060: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002b070: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002b080: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002b090: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -11034,255 +11034,255 @@
 0002b190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002b1a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002b1b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002b1c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002b1d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002b1e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002b1f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002b200: 7072 6f74 656f 6d69 6373 5f64 6f77 6e73  proteomics_downs
-0002b210: 7472 6561 6d5f 616e 616c 7973 6973 2d30  tream_analysis-0
-0002b220: 2e31 2e32 2f73 6574 7570 2e70 7900 0000  .1.2/setup.py...
+0002b200: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+0002b210: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002b220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002b230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002b240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002b250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002b260: 0000 0000 3030 3030 3634 3400 3030 3031  ....0000644.0001
-0002b270: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
-0002b280: 3030 3032 3632 3600 3134 3435 3130 3636  0002626.14451066
-0002b290: 3233 3500 3032 3131 3733 0020 3000 0000  235.021173. 0...
+0002b260: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+0002b270: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+0002b280: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
+0002b290: 3030 3000 3031 3032 3133 0020 7800 0000  000.010213. x...
 0002b2a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002b2b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002b2c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002b2d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002b2e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002b2f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002b300: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
+0002b300: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
 0002b310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002b320: 0000 0000 0000 0000 0064 6f63 6b65 7200  .........docker.
+0002b320: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002b330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002b340: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002b350: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002b360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002b370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002b380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002b390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002b3a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002b3b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002b3c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002b3d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002b3e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002b3f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002b400: 6672 6f6d 2073 6574 7570 746f 6f6c 7320  from setuptools 
-0002b410: 696d 706f 7274 2073 6574 7570 2c20 6669  import setup, fi
-0002b420: 6e64 5f70 6163 6b61 6765 730a 0a77 6974  nd_packages..wit
-0002b430: 6820 6f70 656e 2822 5245 4144 4d45 2e6d  h open("README.m
-0002b440: 6422 2c20 2272 2229 2061 7320 6668 3a0a  d", "r") as fh:.
-0002b450: 2020 2020 6c6f 6e67 5f64 6573 6372 6970      long_descrip
-0002b460: 7469 6f6e 203d 2066 682e 7265 6164 2829  tion = fh.read()
-0002b470: 0a20 2020 200a 2320 4361 6c6c 2073 6574  .    .# Call set
-0002b480: 7570 2066 756e 6374 696f 6e0a 7365 7475  up function.setu
-0002b490: 7028 0a20 2020 206e 616d 653d 2270 726f  p(.    name="pro
-0002b4a0: 7465 6f6d 6963 735f 646f 776e 7374 7265  teomics_downstre
-0002b4b0: 616d 5f61 6e61 6c79 7369 7322 2c0a 2020  am_analysis",.  
-0002b4c0: 2020 6175 7468 6f72 3d22 5675 2044 7563    author="Vu Duc
-0002b4d0: 2054 756e 6722 2c0a 2020 2020 6175 7468   Tung",.    auth
-0002b4e0: 6f72 5f65 6d61 696c 3d22 7475 6e67 7675  or_email="tungvu
-0002b4f0: 6475 6340 6f75 746c 6f6f 6b2e 6465 222c  duc@outlook.de",
-0002b500: 0a20 2020 2064 6573 6372 6970 7469 6f6e  .    description
-0002b510: 3d22 4120 7061 636b 6167 6520 666f 7220  ="A package for 
-0002b520: 646f 776e 7374 7265 616d 2064 6174 6120  downstream data 
-0002b530: 616e 616c 7973 6973 206f 6620 7072 6f74  analysis of prot
-0002b540: 656f 6d69 6373 2064 6174 6122 2c0a 2020  eomics data",.  
-0002b550: 2020 6c6f 6e67 5f64 6573 6372 6970 7469    long_descripti
-0002b560: 6f6e 3d6c 6f6e 675f 6465 7363 7269 7074  on=long_descript
-0002b570: 696f 6e2c 0a20 2020 206c 6f6e 675f 6465  ion,.    long_de
-0002b580: 7363 7269 7074 696f 6e5f 636f 6e74 656e  scription_conten
-0002b590: 745f 7479 7065 3d22 7465 7874 2f6d 6172  t_type="text/mar
-0002b5a0: 6b64 6f77 6e22 2c0a 2020 2020 6b65 7977  kdown",.    keyw
-0002b5b0: 6f72 6473 203d 205b 2270 726f 7465 6f6d  ords = ["proteom
-0002b5c0: 6963 7322 2c20 2264 6f77 6e73 7472 6561  ics", "downstrea
-0002b5d0: 6d20 616e 616c 7973 6973 222c 2022 6461  m analysis", "da
-0002b5e0: 7461 2061 6e61 6c79 7369 7322 2c20 2264  ta analysis", "d
-0002b5f0: 6174 6120 7669 7375 616c 697a 6174 696f  ata visualizatio
-0002b600: 6e22 2c20 226d 6173 7320 7370 6563 7472  n", "mass spectr
-0002b610: 6f6d 6574 7279 225d 2c0a 2020 2020 7665  ometry"],.    ve
-0002b620: 7273 696f 6e3d 2230 2e31 2e32 222c 0a20  rsion="0.1.2",. 
-0002b630: 2020 2075 726c 3d22 6874 7470 733a 2f2f     url="https://
-0002b640: 6769 7468 7562 2e63 6f6d 2f76 7564 7563  github.com/vuduc
-0002b650: 7475 6e67 2f70 726f 7465 6f6d 6963 732d  tung/proteomics-
-0002b660: 646f 776e 7374 7265 616d 2d61 6e6c 6179  downstream-anlay
-0002b670: 7369 7322 2c0a 2020 2020 7061 636b 6167  sis",.    packag
-0002b680: 6573 3d66 696e 645f 7061 636b 6167 6573  es=find_packages
-0002b690: 2869 6e63 6c75 6465 3d5b 2272 6570 6f73  (include=["repos
-0002b6a0: 222c 2270 726f 7465 6f6d 6963 735f 646f  ","proteomics_do
-0002b6b0: 776e 7374 7265 616d 5f61 6e61 6c79 7369  wnstream_analysi
-0002b6c0: 7322 2c20 2270 726f 7465 6f6d 6963 735f  s", "proteomics_
-0002b6d0: 646f 776e 7374 7265 616d 5f61 6e61 6c79  downstream_analy
-0002b6e0: 7369 732e 2a22 5d29 2c0a 2020 2020 7079  sis.*"]),.    py
-0002b6f0: 7468 6f6e 5f72 6571 7569 7265 733d 223e  thon_requires=">
-0002b700: 3d33 2e36 2e31 222c 0a20 2020 2069 6e73  =3.6.1",.    ins
-0002b710: 7461 6c6c 5f72 6571 7569 7265 733d 5b0a  tall_requires=[.
-0002b720: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002b730: 2020 2020 2261 646a 7573 7454 6578 7422      "adjustText"
-0002b740: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0002b750: 2020 2020 2020 2267 6f61 746f 6f6c 7322        "goatools"
-0002b760: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0002b770: 2020 2020 2020 2267 7365 6170 7922 2c0a        "gseapy",.
-0002b780: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002b790: 2020 2020 226d 6174 706c 6f74 6c69 6222      "matplotlib"
-0002b7a0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0002b7b0: 2020 2020 2020 226d 6174 706c 6f74 6c69        "matplotli
-0002b7c0: 622d 7665 6e6e 222c 0a20 2020 2020 2020  b-venn",.       
-0002b7d0: 2020 2020 2020 2020 2020 2020 2022 6e75               "nu
-0002b7e0: 6d62 6122 2c0a 2020 2020 2020 2020 2020  mba",.          
-0002b7f0: 2020 2020 2020 2020 2020 226e 756d 7079            "numpy
-0002b800: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-0002b810: 2020 2020 2020 2022 706c 6f74 6c79 222c         "plotly",
-0002b820: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002b830: 2020 2020 2022 7079 6172 726f 7722 2c0a       "pyarrow",.
-0002b840: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002b850: 2020 2020 2270 7963 6972 636c 697a 6522      "pycirclize"
-0002b860: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0002b870: 2020 2020 2020 2270 7974 656f 6d69 6373        "pyteomics
-0002b880: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-0002b890: 2020 2020 2020 2022 7363 696b 6974 2d6c         "scikit-l
-0002b8a0: 6561 726e 222c 0a20 2020 2020 2020 2020  earn",.         
-0002b8b0: 2020 2020 2020 2020 2020 2022 7363 6970             "scip
-0002b8c0: 7922 2c0a 2020 2020 2020 2020 2020 2020  y",.            
-0002b8d0: 2020 2020 2020 2020 2273 6561 626f 726e          "seaborn
-0002b8e0: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-0002b8f0: 2020 2020 2020 2022 7374 6174 736d 6f64         "statsmod
-0002b900: 656c 7322 2c0a 2020 2020 2020 2020 2020  els",.          
-0002b910: 2020 2020 2020 2020 2020 2273 7472 6561            "strea
-0002b920: 6d6c 6974 222c 0a20 2020 2020 2020 2020  mlit",.         
-0002b930: 2020 2020 2020 2020 2020 2022 756d 6170             "umap
-0002b940: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-0002b950: 2020 2020 2020 2022 5570 5365 7450 6c6f         "UpSetPlo
-0002b960: 7422 2c0a 2020 2020 2020 2020 2020 2020  t",.            
-0002b970: 2020 2020 2020 2020 2276 656e 6e22 0a20          "venn". 
-0002b980: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002b990: 2020 205d 0a29 0000 0000 0000 0000 0000     ].)..........
-0002b9a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002b9b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002b9c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002b9d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002b9e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002b9f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002ba00: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-0002ba10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002ba20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002ba30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002ba40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002ba50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002ba60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-0002ba70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-0002ba80: 3030 3030 3033 3400 3030 3030 3030 3030  0000034.00000000
-0002ba90: 3030 3000 3031 3032 3132 0020 7800 0000  000.010212. x...
-0002baa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002bab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002bac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002bad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002bae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002baf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002bb00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-0002bb10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002bb20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002bb30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002bb40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002bb50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002bb60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002bb70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002bb80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002bb90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002bba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002bbb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002bbc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002bbd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002bbe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002bbf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002bc00: 3238 206d 7469 6d65 3d31 3638 3834 3937  28 mtime=1688497
-0002bc10: 3331 392e 3830 3535 3933 350a 0000 0000  319.8055935.....
-0002bc20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002bc30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002bc40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002bc50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002bc60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002bc70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002bc80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002bc90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002bca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002bcb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002bcc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002bcd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002bce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002bcf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002bd00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002bd10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002bd20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002bd30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002bd40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002bd50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002bd60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002bd70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002bd80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002bd90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002b400: 3232 206d 7469 6d65 3d31 3638 3835 3732  22 mtime=1688572
+0002b410: 3039 322e 300a 0000 0000 0000 0000 0000  092.0...........
+0002b420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002b430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002b440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002b450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002b460: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002b470: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002b480: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002b490: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002b4a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002b4b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002b4c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002b4d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002b4e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002b4f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002b500: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002b510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002b520: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002b530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002b540: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002b550: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002b560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002b570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002b580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002b590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002b5a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002b5b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002b5c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002b5d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002b5e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002b5f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002b600: 7072 6f74 656f 6d69 6373 5f64 6f77 6e73  proteomics_downs
+0002b610: 7472 6561 6d5f 616e 616c 7973 6973 2d30  tream_analysis-0
+0002b620: 2e31 2e33 2f73 6574 7570 2e70 7900 0000  .1.3/setup.py...
+0002b630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002b640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002b650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002b660: 0000 0000 3030 3030 3634 3400 3030 3031  ....0000644.0001
+0002b670: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
+0002b680: 3030 3032 3632 3600 3134 3435 3133 3130  0002626.14451310
+0002b690: 3237 3400 3032 3131 3637 0020 3000 0000  274.021167. 0...
+0002b6a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002b6b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002b6c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002b6d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002b6e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002b6f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002b700: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
+0002b710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002b720: 0000 0000 0000 0000 0064 6f63 6b65 7200  .........docker.
+0002b730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002b740: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002b750: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002b760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002b770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002b780: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002b790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002b7a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002b7b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002b7c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002b7d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002b7e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002b7f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002b800: 6672 6f6d 2073 6574 7570 746f 6f6c 7320  from setuptools 
+0002b810: 696d 706f 7274 2073 6574 7570 2c20 6669  import setup, fi
+0002b820: 6e64 5f70 6163 6b61 6765 730a 0a77 6974  nd_packages..wit
+0002b830: 6820 6f70 656e 2822 5245 4144 4d45 2e6d  h open("README.m
+0002b840: 6422 2c20 2272 2229 2061 7320 6668 3a0a  d", "r") as fh:.
+0002b850: 2020 2020 6c6f 6e67 5f64 6573 6372 6970      long_descrip
+0002b860: 7469 6f6e 203d 2066 682e 7265 6164 2829  tion = fh.read()
+0002b870: 0a20 2020 200a 2320 4361 6c6c 2073 6574  .    .# Call set
+0002b880: 7570 2066 756e 6374 696f 6e0a 7365 7475  up function.setu
+0002b890: 7028 0a20 2020 206e 616d 653d 2270 726f  p(.    name="pro
+0002b8a0: 7465 6f6d 6963 735f 646f 776e 7374 7265  teomics_downstre
+0002b8b0: 616d 5f61 6e61 6c79 7369 7322 2c0a 2020  am_analysis",.  
+0002b8c0: 2020 6175 7468 6f72 3d22 5675 2044 7563    author="Vu Duc
+0002b8d0: 2054 756e 6722 2c0a 2020 2020 6175 7468   Tung",.    auth
+0002b8e0: 6f72 5f65 6d61 696c 3d22 7475 6e67 7675  or_email="tungvu
+0002b8f0: 6475 6340 6f75 746c 6f6f 6b2e 6465 222c  duc@outlook.de",
+0002b900: 0a20 2020 2064 6573 6372 6970 7469 6f6e  .    description
+0002b910: 3d22 4120 7061 636b 6167 6520 666f 7220  ="A package for 
+0002b920: 646f 776e 7374 7265 616d 2064 6174 6120  downstream data 
+0002b930: 616e 616c 7973 6973 206f 6620 7072 6f74  analysis of prot
+0002b940: 656f 6d69 6373 2064 6174 6122 2c0a 2020  eomics data",.  
+0002b950: 2020 6c6f 6e67 5f64 6573 6372 6970 7469    long_descripti
+0002b960: 6f6e 3d6c 6f6e 675f 6465 7363 7269 7074  on=long_descript
+0002b970: 696f 6e2c 0a20 2020 206c 6f6e 675f 6465  ion,.    long_de
+0002b980: 7363 7269 7074 696f 6e5f 636f 6e74 656e  scription_conten
+0002b990: 745f 7479 7065 3d22 7465 7874 2f6d 6172  t_type="text/mar
+0002b9a0: 6b64 6f77 6e22 2c0a 2020 2020 6b65 7977  kdown",.    keyw
+0002b9b0: 6f72 6473 203d 205b 2270 726f 7465 6f6d  ords = ["proteom
+0002b9c0: 6963 7322 2c20 2264 6f77 6e73 7472 6561  ics", "downstrea
+0002b9d0: 6d20 616e 616c 7973 6973 222c 2022 6461  m analysis", "da
+0002b9e0: 7461 2061 6e61 6c79 7369 7322 2c20 2264  ta analysis", "d
+0002b9f0: 6174 6120 7669 7375 616c 697a 6174 696f  ata visualizatio
+0002ba00: 6e22 2c20 226d 6173 7320 7370 6563 7472  n", "mass spectr
+0002ba10: 6f6d 6574 7279 225d 2c0a 2020 2020 7665  ometry"],.    ve
+0002ba20: 7273 696f 6e3d 2230 2e31 2e33 222c 0a20  rsion="0.1.3",. 
+0002ba30: 2020 2075 726c 3d22 6874 7470 733a 2f2f     url="https://
+0002ba40: 6769 7468 7562 2e63 6f6d 2f76 7564 7563  github.com/vuduc
+0002ba50: 7475 6e67 2f70 726f 7465 6f6d 6963 732d  tung/proteomics-
+0002ba60: 646f 776e 7374 7265 616d 2d61 6e6c 6179  downstream-anlay
+0002ba70: 7369 7322 2c0a 2020 2020 7061 636b 6167  sis",.    packag
+0002ba80: 6573 3d66 696e 645f 7061 636b 6167 6573  es=find_packages
+0002ba90: 2869 6e63 6c75 6465 3d5b 2272 6570 6f73  (include=["repos
+0002baa0: 222c 2270 726f 7465 6f6d 6963 735f 646f  ","proteomics_do
+0002bab0: 776e 7374 7265 616d 5f61 6e61 6c79 7369  wnstream_analysi
+0002bac0: 7322 2c20 2270 726f 7465 6f6d 6963 735f  s", "proteomics_
+0002bad0: 646f 776e 7374 7265 616d 5f61 6e61 6c79  downstream_analy
+0002bae0: 7369 732e 2a22 5d29 2c0a 2020 2020 7079  sis.*"]),.    py
+0002baf0: 7468 6f6e 5f72 6571 7569 7265 733d 223e  thon_requires=">
+0002bb00: 3d33 2e36 2e31 222c 0a20 2020 2069 6e73  =3.6.1",.    ins
+0002bb10: 7461 6c6c 5f72 6571 7569 7265 733d 5b0a  tall_requires=[.
+0002bb20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002bb30: 2020 2020 2261 646a 7573 7454 6578 7422      "adjustText"
+0002bb40: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0002bb50: 2020 2020 2020 2267 6f61 746f 6f6c 7322        "goatools"
+0002bb60: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0002bb70: 2020 2020 2020 2267 7365 6170 7922 2c0a        "gseapy",.
+0002bb80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002bb90: 2020 2020 226d 6174 706c 6f74 6c69 6222      "matplotlib"
+0002bba0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0002bbb0: 2020 2020 2020 226d 6174 706c 6f74 6c69        "matplotli
+0002bbc0: 622d 7665 6e6e 222c 0a20 2020 2020 2020  b-venn",.       
+0002bbd0: 2020 2020 2020 2020 2020 2020 2022 6e75               "nu
+0002bbe0: 6d62 6122 2c0a 2020 2020 2020 2020 2020  mba",.          
+0002bbf0: 2020 2020 2020 2020 2020 226e 756d 7079            "numpy
+0002bc00: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+0002bc10: 2020 2020 2020 2022 706c 6f74 6c79 222c         "plotly",
+0002bc20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002bc30: 2020 2020 2022 7079 6172 726f 7722 2c0a       "pyarrow",.
+0002bc40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002bc50: 2020 2020 2270 7963 6972 636c 697a 6522      "pycirclize"
+0002bc60: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0002bc70: 2020 2020 2020 2270 7974 656f 6d69 6373        "pyteomics
+0002bc80: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+0002bc90: 2020 2020 2020 2022 7363 696b 6974 2d6c         "scikit-l
+0002bca0: 6561 726e 222c 0a20 2020 2020 2020 2020  earn",.         
+0002bcb0: 2020 2020 2020 2020 2020 2022 7363 6970             "scip
+0002bcc0: 7922 2c0a 2020 2020 2020 2020 2020 2020  y",.            
+0002bcd0: 2020 2020 2020 2020 2273 6561 626f 726e          "seaborn
+0002bce0: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+0002bcf0: 2020 2020 2020 2022 7374 6174 736d 6f64         "statsmod
+0002bd00: 656c 7322 2c0a 2020 2020 2020 2020 2020  els",.          
+0002bd10: 2020 2020 2020 2020 2020 2273 7472 6561            "strea
+0002bd20: 6d6c 6974 222c 0a20 2020 2020 2020 2020  mlit",.         
+0002bd30: 2020 2020 2020 2020 2020 2022 756d 6170             "umap
+0002bd40: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+0002bd50: 2020 2020 2020 2022 5570 5365 7450 6c6f         "UpSetPlo
+0002bd60: 7422 2c0a 2020 2020 2020 2020 2020 2020  t",.            
+0002bd70: 2020 2020 2020 2020 2276 656e 6e22 0a20          "venn". 
+0002bd80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002bd90: 2020 205d 0a29 0000 0000 0000 0000 0000     ].)..........
 0002bda0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002bdb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002bdc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002bdd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002bde0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002bdf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002be00: 7072 6f74 656f 6d69 6373 5f64 6f77 6e73  proteomics_downs
-0002be10: 7472 6561 6d5f 616e 616c 7973 6973 2d30  tream_analysis-0
-0002be20: 2e31 2e32 2f74 6573 7473 2f00 0000 0000  .1.2/tests/.....
+0002be00: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+0002be10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002be20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002be30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002be40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002be50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002be60: 0000 0000 3030 3030 3735 3500 3030 3031  ....0000755.0001
-0002be70: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
-0002be80: 3030 3030 3030 3000 3134 3435 3130 3636  0000000.14451066
-0002be90: 3235 3000 3032 3036 3132 0020 3500 0000  250.020612. 5...
+0002be60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+0002be70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+0002be80: 3030 3030 3033 3300 3030 3030 3030 3030  0000033.00000000
+0002be90: 3030 3000 3031 3032 3131 0020 7800 0000  000.010211. x...
 0002bea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002beb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002bec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002bed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002bee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002bef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002bf00: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
+0002bf00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
 0002bf10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002bf20: 0000 0000 0000 0000 0064 6f63 6b65 7200  .........docker.
+0002bf20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002bf30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002bf40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002bf50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002bf60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002bf70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002bf80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002bf90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002bfa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002bfb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002bfc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002bfd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002bfe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002bff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c000: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-0002c010: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c000: 3237 206d 7469 6d65 3d31 3638 3835 3732  27 mtime=1688572
+0002c010: 3130 322e 3531 3438 3134 0a00 0000 0000  102.514814......
 0002c020: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002c030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002c040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002c050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c060: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-0002c070: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-0002c080: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
-0002c090: 3030 3000 3031 3032 3133 0020 7800 0000  000.010213. x...
+0002c060: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c070: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c080: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c090: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002c0a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002c0b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002c0c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002c0d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002c0e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002c0f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c100: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+0002c100: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002c110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002c120: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002c130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002c140: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002c150: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002c160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002c170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -11290,373 +11290,373 @@
 0002c190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002c1a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002c1b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002c1c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002c1d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002c1e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002c1f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c200: 3232 206d 7469 6d65 3d31 3638 3834 3937  22 mtime=1688497
-0002c210: 3330 392e 300a 0000 0000 0000 0000 0000  309.0...........
-0002c220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c200: 7072 6f74 656f 6d69 6373 5f64 6f77 6e73  proteomics_downs
+0002c210: 7472 6561 6d5f 616e 616c 7973 6973 2d30  tream_analysis-0
+0002c220: 2e31 2e33 2f74 6573 7473 2f00 0000 0000  .1.3/tests/.....
 0002c230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002c240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002c250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c260: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c270: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c280: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c290: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c260: 0000 0000 3030 3030 3735 3500 3030 3031  ....0000755.0001
+0002c270: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
+0002c280: 3030 3030 3030 3000 3134 3435 3133 3130  0000000.14451310
+0002c290: 3330 3700 3032 3036 3036 0020 3500 0000  307.020606. 5...
 0002c2a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002c2b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002c2c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002c2d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002c2e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002c2f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c300: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c300: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
 0002c310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c320: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c320: 0000 0000 0000 0000 0064 6f63 6b65 7200  .........docker.
 0002c330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002c340: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002c350: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002c360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002c370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002c380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002c390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002c3a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002c3b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002c3c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002c3d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002c3e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002c3f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c400: 7072 6f74 656f 6d69 6373 5f64 6f77 6e73  proteomics_downs
-0002c410: 7472 6561 6d5f 616e 616c 7973 6973 2d30  tream_analysis-0
-0002c420: 2e31 2e32 2f74 6573 7473 2f74 6573 745f  .1.2/tests/test_
-0002c430: 7072 6570 726f 6365 7373 696e 672e 7079  preprocessing.py
+0002c400: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+0002c410: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002c440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002c450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c460: 0000 0000 3030 3030 3634 3400 3030 3031  ....0000644.0001
-0002c470: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
-0002c480: 3030 3037 3134 3700 3134 3435 3130 3636  0007147.14451066
-0002c490: 3233 3500 3032 3531 3232 0020 3000 0000  235.025122. 0...
+0002c460: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+0002c470: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+0002c480: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
+0002c490: 3030 3000 3031 3032 3133 0020 7800 0000  000.010213. x...
 0002c4a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002c4b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002c4c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002c4d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002c4e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002c4f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c500: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
+0002c500: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
 0002c510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c520: 0000 0000 0000 0000 0064 6f63 6b65 7200  .........docker.
+0002c520: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002c530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002c540: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002c550: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002c560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002c570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002c580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002c590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002c5a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002c5b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002c5c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002c5d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002c5e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002c5f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002c600: 696d 706f 7274 206e 756d 7079 2061 7320  import numpy as 
-0002c610: 6e70 0a69 6d70 6f72 7420 7061 6e64 6173  np.import pandas
-0002c620: 2061 7320 7064 0a66 726f 6d20 7072 6f74   as pd.from prot
-0002c630: 656f 6d69 6373 5f64 6f77 6e73 7472 6561  eomics_downstrea
-0002c640: 6d5f 616e 616c 7973 6973 2e70 7265 7072  m_analysis.prepr
-0002c650: 6f63 6573 7369 6e67 2069 6d70 6f72 7420  ocessing import 
-0002c660: 5072 6570 726f 6365 7373 696e 670a 696d  Preprocessing.im
-0002c670: 706f 7274 2075 6e69 7474 6573 740a 0a63  port unittest..c
-0002c680: 6c61 7373 2054 6573 7450 7265 7072 6f63  lass TestPreproc
-0002c690: 6573 7369 6e67 2875 6e69 7474 6573 742e  essing(unittest.
-0002c6a0: 5465 7374 4361 7365 293a 0a0a 2020 2020  TestCase):..    
-0002c6b0: 6465 6620 7365 7455 7028 7365 6c66 293a  def setUp(self):
-0002c6c0: 0a20 2020 2020 2020 200a 2020 2020 2020  .        .      
-0002c6d0: 2020 7365 6c66 2e68 656c 7065 7220 3d20    self.helper = 
-0002c6e0: 5072 6570 726f 6365 7373 696e 6728 2920  Preprocessing() 
-0002c6f0: 0a20 2020 2020 2020 2073 656c 662e 6461  .        self.da
-0002c700: 7461 203d 2070 642e 4461 7461 4672 616d  ta = pd.DataFram
-0002c710: 6528 7b0a 2020 2020 2020 2020 2020 2020  e({.            
-0002c720: 2750 726f 7465 696e 2e47 726f 7570 273a  'Protein.Group':
-0002c730: 205b 312c 2032 2c20 332c 2034 2c20 355d   [1, 2, 3, 4, 5]
-0002c740: 2c0a 2020 2020 2020 2020 2020 2020 2750  ,.            'P
-0002c750: 726f 7465 696e 2e49 6473 273a 205b 2750  rotein.Ids': ['P
-0002c760: 3132 3327 2c20 2750 3233 3427 2c20 2750  123', 'P234', 'P
-0002c770: 3334 3527 2c20 2750 3435 3627 2c20 2750  345', 'P456', 'P
-0002c780: 3536 3727 5d2c 0a20 2020 2020 2020 2020  567'],.         
-0002c790: 2020 2027 5072 6f74 6569 6e2e 4e61 6d65     'Protein.Name
-0002c7a0: 7327 3a20 5b27 7031 272c 2027 7032 272c  s': ['p1', 'p2',
-0002c7b0: 2027 7033 272c 2027 7034 272c 2027 7035   'p3', 'p4', 'p5
-0002c7c0: 275d 2c0a 2020 2020 2020 2020 2020 2020  '],.            
-0002c7d0: 2747 656e 6573 273a 205b 2767 3127 2c20  'Genes': ['g1', 
-0002c7e0: 2767 3227 2c20 2767 3327 2c20 2767 3427  'g2', 'g3', 'g4'
-0002c7f0: 2c20 2767 3527 5d2c 0a20 2020 2020 2020  , 'g5'],.       
-0002c800: 2020 2020 2027 4669 7273 742e 5072 6f74       'First.Prot
-0002c810: 6569 6e2e 4465 7363 7269 7074 696f 6e27  ein.Description'
-0002c820: 3a20 5b27 6431 272c 2027 6432 272c 2027  : ['d1', 'd2', '
-0002c830: 6433 272c 2027 6434 272c 2027 6435 275d  d3', 'd4', 'd5']
-0002c840: 2c0a 2020 2020 2020 2020 2020 2020 2757  ,.            'W
-0002c850: 5431 273a 205b 312e 302c 2031 2e30 2c20  T1': [1.0, 1.0, 
-0002c860: 312c 2031 2e30 2c20 312e 305d 2c0a 2020  1, 1.0, 1.0],.  
-0002c870: 2020 2020 2020 2020 2020 2757 5432 273a            'WT2':
-0002c880: 205b 312e 302c 2031 2e30 2c20 312e 302c   [1.0, 1.0, 1.0,
-0002c890: 2031 2e30 2c20 312e 305d 2c0a 2020 2020   1.0, 1.0],.    
-0002c8a0: 2020 2020 2020 2020 2757 5433 273a 205b          'WT3': [
-0002c8b0: 312e 302c 2031 2e30 2c20 312e 302c 2031  1.0, 1.0, 1.0, 1
-0002c8c0: 2e30 2c20 312e 305d 2c0a 2020 2020 2020  .0, 1.0],.      
-0002c8d0: 2020 2020 2020 274b 4f31 273a 205b 312e        'KO1': [1.
-0002c8e0: 302c 2031 2e30 2c20 312e 302c 2031 2e30  0, 1.0, 1.0, 1.0
-0002c8f0: 2c20 312e 305d 2c0a 2020 2020 2020 2020  , 1.0],.        
-0002c900: 2020 2020 274b 4f32 273a 205b 312e 302c      'KO2': [1.0,
-0002c910: 2031 2e30 2c20 312e 302c 2031 2e30 2c20   1.0, 1.0, 1.0, 
-0002c920: 312e 305d 2c0a 2020 2020 2020 2020 2020  1.0],.          
-0002c930: 2020 274b 4f33 273a 205b 312e 302c 2031    'KO3': [1.0, 1
-0002c940: 2e30 2c20 312e 302c 2031 2e30 2c20 312e  .0, 1.0, 1.0, 1.
-0002c950: 305d 2c20 2020 0a20 2020 2020 2020 207d  0],   .        }
-0002c960: 290a 2020 2020 2020 2020 0a20 2020 2020  ).        .     
-0002c970: 2020 2073 656c 662e 6461 7461 2e63 6f6c     self.data.col
-0002c980: 756d 6e73 203d 205b 2750 726f 7465 696e  umns = ['Protein
-0002c990: 2e47 726f 7570 272c 0a20 2020 2020 2020  .Group',.       
-0002c9a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c9b0: 2020 2020 2027 5072 6f74 6569 6e2e 4964       'Protein.Id
-0002c9c0: 7327 2c0a 2020 2020 2020 2020 2020 2020  s',.            
-0002c9d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c9e0: 2750 726f 7465 696e 2e4e 616d 6573 272c  'Protein.Names',
-0002c9f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002ca00: 2020 2020 2020 2020 2020 2020 2027 4765               'Ge
-0002ca10: 6e65 7327 2c0a 2020 2020 2020 2020 2020  nes',.          
-0002ca20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ca30: 2020 2746 6972 7374 2e50 726f 7465 696e    'First.Protein
-0002ca40: 2e44 6573 6372 6970 7469 6f6e 272c 0a20  .Description',. 
-0002ca50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ca60: 2020 2020 2020 2020 2020 2027 5754 272c             'WT',
-0002ca70: 200a 2020 2020 2020 2020 2020 2020 2020   .              
-0002ca80: 2020 2020 2020 2020 2020 2020 2020 2757                'W
-0002ca90: 5427 2c0a 2020 2020 2020 2020 2020 2020  T',.            
-0002caa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002cab0: 2757 5427 2c0a 2020 2020 2020 2020 2020  'WT',.          
-0002cac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002cad0: 2020 274b 4f27 2c0a 2020 2020 2020 2020    'KO',.        
-0002cae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002caf0: 2020 2020 274b 4f27 2c0a 2020 2020 2020      'KO',.      
-0002cb00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002cb10: 2020 2020 2020 274b 4f27 5d0a 2020 2020        'KO'].    
-0002cb20: 2020 2020 0a20 2020 2064 6566 2074 6573      .    def tes
-0002cb30: 745f 6368 616e 6765 5f64 6174 6174 7970  t_change_datatyp
-0002cb40: 6573 2873 656c 6629 3a0a 2020 2020 2020  es(self):.      
-0002cb50: 2020 0a20 2020 2020 2020 2023 2063 6861    .        # cha
-0002cb60: 6e67 6520 6461 7461 7970 6520 6f66 2074  nge dataype of t
-0002cb70: 6573 745f 6461 7461 0a20 2020 2020 2020  est_data.       
-0002cb80: 2073 656c 662e 6461 7461 203d 2073 656c   self.data = sel
-0002cb90: 662e 6461 7461 2e61 7374 7970 6528 276f  f.data.astype('o
-0002cba0: 626a 6563 7427 290a 0a20 2020 2020 2020  bject')..       
-0002cbb0: 2063 6f6e 7665 7274 6564 5f64 6174 6120   converted_data 
-0002cbc0: 3d20 7365 6c66 2e68 656c 7065 722e 5f63  = self.helper._c
-0002cbd0: 6861 6e67 655f 6461 7461 7479 7065 7328  hange_datatypes(
-0002cbe0: 7365 6c66 2e64 6174 6129 0a20 2020 2020  self.data).     
-0002cbf0: 2020 2065 7870 6563 7465 645f 636f 6c75     expected_colu
-0002cc00: 6d6e 735f 6474 5f69 6e5f 7374 7269 6e67  mns_dt_in_string
-0002cc10: 203d 205b 2750 726f 7465 696e 2e47 726f   = ['Protein.Gro
-0002cc20: 7570 272c 0a20 2020 2020 2020 2020 2020  up',.           
-0002cc30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002cc40: 2020 2020 2020 2020 2020 2020 2020 2750                'P
-0002cc50: 726f 7465 696e 2e49 6473 272c 0a20 2020  rotein.Ids',.   
-0002cc60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002cc70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002cc80: 2020 2020 2020 2750 726f 7465 696e 2e4e        'Protein.N
-0002cc90: 616d 6573 272c 0a20 2020 2020 2020 2020  ames',.         
-0002cca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ccb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ccc0: 2747 656e 6573 272c 0a20 2020 2020 2020  'Genes',.       
-0002ccd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002cce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ccf0: 2020 2746 6972 7374 2e50 726f 7465 696e    'First.Protein
-0002cd00: 2e44 6573 6372 6970 7469 6f6e 275d 0a20  .Description']. 
-0002cd10: 2020 2020 2020 2065 7870 6563 7465 645f         expected_
-0002cd20: 636f 6c75 6d6e 735f 6474 5f69 6e5f 666c  columns_dt_in_fl
-0002cd30: 6f61 7420 3d20 5b27 5754 272c 2027 4b4f  oat = ['WT', 'KO
-0002cd40: 275d 0a0a 2020 2020 2020 2020 666f 7220  ']..        for 
-0002cd50: 636f 6c20 696e 2065 7870 6563 7465 645f  col in expected_
-0002cd60: 636f 6c75 6d6e 735f 6474 5f69 6e5f 7374  columns_dt_in_st
-0002cd70: 7269 6e67 3a0a 2020 2020 2020 2020 2020  ring:.          
-0002cd80: 2020 7365 6c66 2e61 7373 6572 7454 7275    self.assertTru
-0002cd90: 6528 636f 6e76 6572 7465 645f 6461 7461  e(converted_data
-0002cda0: 5b63 6f6c 5d2e 6474 7970 6520 3d3d 2027  [col].dtype == '
-0002cdb0: 7374 7269 6e67 2729 0a0a 2020 2020 2020  string')..      
-0002cdc0: 2020 666f 7220 636f 6c20 696e 2065 7870    for col in exp
-0002cdd0: 6563 7465 645f 636f 6c75 6d6e 735f 6474  ected_columns_dt
-0002cde0: 5f69 6e5f 666c 6f61 743a 0a20 2020 2020  _in_float:.     
-0002cdf0: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-0002ce00: 7274 5472 7565 2861 6c6c 2863 6f6e 7665  rtTrue(all(conve
-0002ce10: 7274 6564 5f64 6174 615b 636f 6c5d 2e64  rted_data[col].d
-0002ce20: 7479 7065 7320 3d3d 2027 666c 6f61 7427  types == 'float'
-0002ce30: 2929 0a0a 2020 2020 6465 6620 7465 7374  ))..    def test
-0002ce40: 5f6c 6f67 325f 7472 616e 7366 6f72 6d28  _log2_transform(
-0002ce50: 7365 6c66 293a 2020 0a20 2020 2020 2020  self):  .       
-0002ce60: 200a 2020 2020 2020 2020 636f 6e76 6572   .        conver
-0002ce70: 7465 645f 6461 7461 203d 2073 656c 662e  ted_data = self.
-0002ce80: 6865 6c70 6572 2e5f 6c6f 6732 5f74 7261  helper._log2_tra
-0002ce90: 6e73 666f 726d 2873 656c 662e 6461 7461  nsform(self.data
-0002cea0: 290a 0a20 2020 2020 2020 2065 7870 6563  )..        expec
-0002ceb0: 7465 645f 636f 6c75 6d6e 7320 3d20 5b27  ted_columns = ['
-0002cec0: 5754 272c 2027 4b4f 275d 0a0a 2020 2020  WT', 'KO']..    
-0002ced0: 2020 2020 666f 7220 636f 6c20 696e 2065      for col in e
-0002cee0: 7870 6563 7465 645f 636f 6c75 6d6e 733a  xpected_columns:
-0002cef0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-0002cf00: 662e 6173 7365 7274 5472 7565 2861 6c6c  f.assertTrue(all
-0002cf10: 2863 6f6e 7665 7274 6564 5f64 6174 615b  (converted_data[
-0002cf20: 636f 6c5d 203d 3d20 3029 290a 0a20 2020  col] == 0))..   
-0002cf30: 2064 6566 2074 6573 745f 6669 6c74 6572   def test_filter
-0002cf40: 5f66 6f72 5f76 616c 6964 5f76 616c 735f  _for_valid_vals_
-0002cf50: 696e 5f6f 6e65 5f65 7870 5f67 726f 7570  in_one_exp_group
-0002cf60: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-0002cf70: 2020 2020 0a20 2020 2020 2020 2020 2020      .           
-0002cf80: 2023 2069 6e73 6572 7420 6e61 6e20 7661   # insert nan va
-0002cf90: 6c75 6573 0a20 2020 2020 2020 2020 2020  lues.           
-0002cfa0: 2073 656c 662e 6461 7461 2e6c 6f63 5b30   self.data.loc[0
-0002cfb0: 2c20 2757 5427 5d20 3d20 6e70 2e6e 616e  , 'WT'] = np.nan
-0002cfc0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-0002cfd0: 662e 6461 7461 2e6c 6f63 5b30 2c20 274b  f.data.loc[0, 'K
-0002cfe0: 4f27 5d20 3d20 6e70 2e6e 616e 0a20 2020  O'] = np.nan.   
-0002cff0: 2020 2020 2020 2020 2063 6f6e 7665 7274           convert
-0002d000: 6564 5f64 6174 6120 3d20 7365 6c66 2e68  ed_data = self.h
-0002d010: 656c 7065 722e 5f66 696c 7465 725f 666f  elper._filter_fo
-0002d020: 725f 7661 6c69 645f 7661 6c73 5f69 6e5f  r_valid_vals_in_
-0002d030: 6f6e 655f 6578 705f 6772 6f75 7028 7365  one_exp_group(se
-0002d040: 6c66 2e64 6174 6129 0a20 2020 2020 2020  lf.data).       
-0002d050: 2020 2020 200a 2020 2020 2020 2020 2020       .          
-0002d060: 2020 7365 6c66 2e61 7373 6572 7454 7275    self.assertTru
-0002d070: 6528 636f 6e76 6572 7465 645f 6461 7461  e(converted_data
-0002d080: 2e73 6861 7065 5b30 5d20 3d3d 2034 290a  .shape[0] == 4).
-0002d090: 0a20 2020 2064 6566 2074 6573 745f 696d  .    def test_im
-0002d0a0: 7075 7465 5f67 656e 6573 5f77 6974 685f  pute_genes_with_
-0002d0b0: 7072 6f74 6569 6e5f 6964 7328 7365 6c66  protein_ids(self
-0002d0c0: 293a 0a20 2020 2020 2020 2020 2020 200a  ):.            .
-0002d0d0: 2020 2020 2020 2020 2020 2020 2320 696e              # in
-0002d0e0: 7365 7274 206e 616e 2076 616c 7565 730a  sert nan values.
-0002d0f0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0002d100: 2e64 6174 612e 6c6f 635b 302c 2027 4765  .data.loc[0, 'Ge
-0002d110: 6e65 7327 5d20 3d20 6e70 2e6e 616e 0a20  nes'] = np.nan. 
-0002d120: 2020 2020 2020 2020 2020 2063 6f6e 7665             conve
-0002d130: 7274 6564 5f64 6174 6120 3d20 7365 6c66  rted_data = self
-0002d140: 2e68 656c 7065 722e 5f69 6d70 7574 655f  .helper._impute_
-0002d150: 6765 6e65 735f 7769 7468 5f70 726f 7465  genes_with_prote
-0002d160: 696e 5f69 6473 2873 656c 662e 6461 7461  in_ids(self.data
-0002d170: 290a 2020 2020 2020 2020 2020 2020 0a20  ).            . 
-0002d180: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0002d190: 6173 7365 7274 5472 7565 2863 6f6e 7665  assertTrue(conve
-0002d1a0: 7274 6564 5f64 6174 612e 6c6f 635b 302c  rted_data.loc[0,
-0002d1b0: 2027 4765 6e65 7327 5d20 3d3d 2027 5031   'Genes'] == 'P1
-0002d1c0: 3233 2729 0a0a 2020 2020 6465 6620 7465  23')..    def te
-0002d1d0: 7374 5f66 696c 7465 725f 666f 725f 7661  st_filter_for_va
-0002d1e0: 6c69 645f 7661 6c73 5f70 6572 6328 7365  lid_vals_perc(se
-0002d1f0: 6c66 293a 0a20 2020 2020 2020 2020 2320  lf):.         # 
-0002d200: 696e 7365 7274 206e 6120 7661 6c75 6573  insert na values
-0002d210: 0a20 2020 2020 2020 2020 7365 6c66 2e64  .         self.d
-0002d220: 6174 612e 6c6f 635b 303a 332c 2027 5754  ata.loc[0:3, 'WT
-0002d230: 275d 203d 206e 702e 6e61 6e0a 2020 2020  '] = np.nan.    
-0002d240: 2020 2020 2073 656c 662e 6461 7461 2e6c       self.data.l
-0002d250: 6f63 5b31 2c3a 5d20 3d20 6e70 2e6e 616e  oc[1,:] = np.nan
-0002d260: 0a20 2020 2020 2020 2020 636f 6e76 6572  .         conver
+0002c600: 3232 206d 7469 6d65 3d31 3638 3835 3732  22 mtime=1688572
+0002c610: 3039 322e 300a 0000 0000 0000 0000 0000  092.0...........
+0002c620: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c660: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c670: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c680: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c690: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c6a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c6b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c6c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c6d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c6e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c6f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c700: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c720: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c740: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c750: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c780: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c7a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c7b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c7c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c7d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c7e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c7f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c800: 7072 6f74 656f 6d69 6373 5f64 6f77 6e73  proteomics_downs
+0002c810: 7472 6561 6d5f 616e 616c 7973 6973 2d30  tream_analysis-0
+0002c820: 2e31 2e33 2f74 6573 7473 2f74 6573 745f  .1.3/tests/test_
+0002c830: 7072 6570 726f 6365 7373 696e 672e 7079  preprocessing.py
+0002c840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c860: 0000 0000 3030 3030 3634 3400 3030 3031  ....0000644.0001
+0002c870: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
+0002c880: 3030 3037 3134 3700 3134 3435 3133 3130  0007147.14451310
+0002c890: 3237 3400 3032 3531 3136 0020 3000 0000  274.025116. 0...
+0002c8a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c8b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c8c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c8d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c8e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c8f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c900: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
+0002c910: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c920: 0000 0000 0000 0000 0064 6f63 6b65 7200  .........docker.
+0002c930: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c940: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c950: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c960: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c970: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c980: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c9a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c9b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c9c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c9d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c9e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c9f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002ca00: 696d 706f 7274 206e 756d 7079 2061 7320  import numpy as 
+0002ca10: 6e70 0a69 6d70 6f72 7420 7061 6e64 6173  np.import pandas
+0002ca20: 2061 7320 7064 0a66 726f 6d20 7072 6f74   as pd.from prot
+0002ca30: 656f 6d69 6373 5f64 6f77 6e73 7472 6561  eomics_downstrea
+0002ca40: 6d5f 616e 616c 7973 6973 2e70 7265 7072  m_analysis.prepr
+0002ca50: 6f63 6573 7369 6e67 2069 6d70 6f72 7420  ocessing import 
+0002ca60: 5072 6570 726f 6365 7373 696e 670a 696d  Preprocessing.im
+0002ca70: 706f 7274 2075 6e69 7474 6573 740a 0a63  port unittest..c
+0002ca80: 6c61 7373 2054 6573 7450 7265 7072 6f63  lass TestPreproc
+0002ca90: 6573 7369 6e67 2875 6e69 7474 6573 742e  essing(unittest.
+0002caa0: 5465 7374 4361 7365 293a 0a0a 2020 2020  TestCase):..    
+0002cab0: 6465 6620 7365 7455 7028 7365 6c66 293a  def setUp(self):
+0002cac0: 0a20 2020 2020 2020 200a 2020 2020 2020  .        .      
+0002cad0: 2020 7365 6c66 2e68 656c 7065 7220 3d20    self.helper = 
+0002cae0: 5072 6570 726f 6365 7373 696e 6728 2920  Preprocessing() 
+0002caf0: 0a20 2020 2020 2020 2073 656c 662e 6461  .        self.da
+0002cb00: 7461 203d 2070 642e 4461 7461 4672 616d  ta = pd.DataFram
+0002cb10: 6528 7b0a 2020 2020 2020 2020 2020 2020  e({.            
+0002cb20: 2750 726f 7465 696e 2e47 726f 7570 273a  'Protein.Group':
+0002cb30: 205b 312c 2032 2c20 332c 2034 2c20 355d   [1, 2, 3, 4, 5]
+0002cb40: 2c0a 2020 2020 2020 2020 2020 2020 2750  ,.            'P
+0002cb50: 726f 7465 696e 2e49 6473 273a 205b 2750  rotein.Ids': ['P
+0002cb60: 3132 3327 2c20 2750 3233 3427 2c20 2750  123', 'P234', 'P
+0002cb70: 3334 3527 2c20 2750 3435 3627 2c20 2750  345', 'P456', 'P
+0002cb80: 3536 3727 5d2c 0a20 2020 2020 2020 2020  567'],.         
+0002cb90: 2020 2027 5072 6f74 6569 6e2e 4e61 6d65     'Protein.Name
+0002cba0: 7327 3a20 5b27 7031 272c 2027 7032 272c  s': ['p1', 'p2',
+0002cbb0: 2027 7033 272c 2027 7034 272c 2027 7035   'p3', 'p4', 'p5
+0002cbc0: 275d 2c0a 2020 2020 2020 2020 2020 2020  '],.            
+0002cbd0: 2747 656e 6573 273a 205b 2767 3127 2c20  'Genes': ['g1', 
+0002cbe0: 2767 3227 2c20 2767 3327 2c20 2767 3427  'g2', 'g3', 'g4'
+0002cbf0: 2c20 2767 3527 5d2c 0a20 2020 2020 2020  , 'g5'],.       
+0002cc00: 2020 2020 2027 4669 7273 742e 5072 6f74       'First.Prot
+0002cc10: 6569 6e2e 4465 7363 7269 7074 696f 6e27  ein.Description'
+0002cc20: 3a20 5b27 6431 272c 2027 6432 272c 2027  : ['d1', 'd2', '
+0002cc30: 6433 272c 2027 6434 272c 2027 6435 275d  d3', 'd4', 'd5']
+0002cc40: 2c0a 2020 2020 2020 2020 2020 2020 2757  ,.            'W
+0002cc50: 5431 273a 205b 312e 302c 2031 2e30 2c20  T1': [1.0, 1.0, 
+0002cc60: 312c 2031 2e30 2c20 312e 305d 2c0a 2020  1, 1.0, 1.0],.  
+0002cc70: 2020 2020 2020 2020 2020 2757 5432 273a            'WT2':
+0002cc80: 205b 312e 302c 2031 2e30 2c20 312e 302c   [1.0, 1.0, 1.0,
+0002cc90: 2031 2e30 2c20 312e 305d 2c0a 2020 2020   1.0, 1.0],.    
+0002cca0: 2020 2020 2020 2020 2757 5433 273a 205b          'WT3': [
+0002ccb0: 312e 302c 2031 2e30 2c20 312e 302c 2031  1.0, 1.0, 1.0, 1
+0002ccc0: 2e30 2c20 312e 305d 2c0a 2020 2020 2020  .0, 1.0],.      
+0002ccd0: 2020 2020 2020 274b 4f31 273a 205b 312e        'KO1': [1.
+0002cce0: 302c 2031 2e30 2c20 312e 302c 2031 2e30  0, 1.0, 1.0, 1.0
+0002ccf0: 2c20 312e 305d 2c0a 2020 2020 2020 2020  , 1.0],.        
+0002cd00: 2020 2020 274b 4f32 273a 205b 312e 302c      'KO2': [1.0,
+0002cd10: 2031 2e30 2c20 312e 302c 2031 2e30 2c20   1.0, 1.0, 1.0, 
+0002cd20: 312e 305d 2c0a 2020 2020 2020 2020 2020  1.0],.          
+0002cd30: 2020 274b 4f33 273a 205b 312e 302c 2031    'KO3': [1.0, 1
+0002cd40: 2e30 2c20 312e 302c 2031 2e30 2c20 312e  .0, 1.0, 1.0, 1.
+0002cd50: 305d 2c20 2020 0a20 2020 2020 2020 207d  0],   .        }
+0002cd60: 290a 2020 2020 2020 2020 0a20 2020 2020  ).        .     
+0002cd70: 2020 2073 656c 662e 6461 7461 2e63 6f6c     self.data.col
+0002cd80: 756d 6e73 203d 205b 2750 726f 7465 696e  umns = ['Protein
+0002cd90: 2e47 726f 7570 272c 0a20 2020 2020 2020  .Group',.       
+0002cda0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002cdb0: 2020 2020 2027 5072 6f74 6569 6e2e 4964       'Protein.Id
+0002cdc0: 7327 2c0a 2020 2020 2020 2020 2020 2020  s',.            
+0002cdd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002cde0: 2750 726f 7465 696e 2e4e 616d 6573 272c  'Protein.Names',
+0002cdf0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002ce00: 2020 2020 2020 2020 2020 2020 2027 4765               'Ge
+0002ce10: 6e65 7327 2c0a 2020 2020 2020 2020 2020  nes',.          
+0002ce20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ce30: 2020 2746 6972 7374 2e50 726f 7465 696e    'First.Protein
+0002ce40: 2e44 6573 6372 6970 7469 6f6e 272c 0a20  .Description',. 
+0002ce50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ce60: 2020 2020 2020 2020 2020 2027 5754 272c             'WT',
+0002ce70: 200a 2020 2020 2020 2020 2020 2020 2020   .              
+0002ce80: 2020 2020 2020 2020 2020 2020 2020 2757                'W
+0002ce90: 5427 2c0a 2020 2020 2020 2020 2020 2020  T',.            
+0002cea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ceb0: 2757 5427 2c0a 2020 2020 2020 2020 2020  'WT',.          
+0002cec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ced0: 2020 274b 4f27 2c0a 2020 2020 2020 2020    'KO',.        
+0002cee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002cef0: 2020 2020 274b 4f27 2c0a 2020 2020 2020      'KO',.      
+0002cf00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002cf10: 2020 2020 2020 274b 4f27 5d0a 2020 2020        'KO'].    
+0002cf20: 2020 2020 0a20 2020 2064 6566 2074 6573      .    def tes
+0002cf30: 745f 6368 616e 6765 5f64 6174 6174 7970  t_change_datatyp
+0002cf40: 6573 2873 656c 6629 3a0a 2020 2020 2020  es(self):.      
+0002cf50: 2020 0a20 2020 2020 2020 2023 2063 6861    .        # cha
+0002cf60: 6e67 6520 6461 7461 7970 6520 6f66 2074  nge dataype of t
+0002cf70: 6573 745f 6461 7461 0a20 2020 2020 2020  est_data.       
+0002cf80: 2073 656c 662e 6461 7461 203d 2073 656c   self.data = sel
+0002cf90: 662e 6461 7461 2e61 7374 7970 6528 276f  f.data.astype('o
+0002cfa0: 626a 6563 7427 290a 0a20 2020 2020 2020  bject')..       
+0002cfb0: 2063 6f6e 7665 7274 6564 5f64 6174 6120   converted_data 
+0002cfc0: 3d20 7365 6c66 2e68 656c 7065 722e 5f63  = self.helper._c
+0002cfd0: 6861 6e67 655f 6461 7461 7479 7065 7328  hange_datatypes(
+0002cfe0: 7365 6c66 2e64 6174 6129 0a20 2020 2020  self.data).     
+0002cff0: 2020 2065 7870 6563 7465 645f 636f 6c75     expected_colu
+0002d000: 6d6e 735f 6474 5f69 6e5f 7374 7269 6e67  mns_dt_in_string
+0002d010: 203d 205b 2750 726f 7465 696e 2e47 726f   = ['Protein.Gro
+0002d020: 7570 272c 0a20 2020 2020 2020 2020 2020  up',.           
+0002d030: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d040: 2020 2020 2020 2020 2020 2020 2020 2750                'P
+0002d050: 726f 7465 696e 2e49 6473 272c 0a20 2020  rotein.Ids',.   
+0002d060: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d070: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d080: 2020 2020 2020 2750 726f 7465 696e 2e4e        'Protein.N
+0002d090: 616d 6573 272c 0a20 2020 2020 2020 2020  ames',.         
+0002d0a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d0b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d0c0: 2747 656e 6573 272c 0a20 2020 2020 2020  'Genes',.       
+0002d0d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d0e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d0f0: 2020 2746 6972 7374 2e50 726f 7465 696e    'First.Protein
+0002d100: 2e44 6573 6372 6970 7469 6f6e 275d 0a20  .Description']. 
+0002d110: 2020 2020 2020 2065 7870 6563 7465 645f         expected_
+0002d120: 636f 6c75 6d6e 735f 6474 5f69 6e5f 666c  columns_dt_in_fl
+0002d130: 6f61 7420 3d20 5b27 5754 272c 2027 4b4f  oat = ['WT', 'KO
+0002d140: 275d 0a0a 2020 2020 2020 2020 666f 7220  ']..        for 
+0002d150: 636f 6c20 696e 2065 7870 6563 7465 645f  col in expected_
+0002d160: 636f 6c75 6d6e 735f 6474 5f69 6e5f 7374  columns_dt_in_st
+0002d170: 7269 6e67 3a0a 2020 2020 2020 2020 2020  ring:.          
+0002d180: 2020 7365 6c66 2e61 7373 6572 7454 7275    self.assertTru
+0002d190: 6528 636f 6e76 6572 7465 645f 6461 7461  e(converted_data
+0002d1a0: 5b63 6f6c 5d2e 6474 7970 6520 3d3d 2027  [col].dtype == '
+0002d1b0: 7374 7269 6e67 2729 0a0a 2020 2020 2020  string')..      
+0002d1c0: 2020 666f 7220 636f 6c20 696e 2065 7870    for col in exp
+0002d1d0: 6563 7465 645f 636f 6c75 6d6e 735f 6474  ected_columns_dt
+0002d1e0: 5f69 6e5f 666c 6f61 743a 0a20 2020 2020  _in_float:.     
+0002d1f0: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+0002d200: 7274 5472 7565 2861 6c6c 2863 6f6e 7665  rtTrue(all(conve
+0002d210: 7274 6564 5f64 6174 615b 636f 6c5d 2e64  rted_data[col].d
+0002d220: 7479 7065 7320 3d3d 2027 666c 6f61 7427  types == 'float'
+0002d230: 2929 0a0a 2020 2020 6465 6620 7465 7374  ))..    def test
+0002d240: 5f6c 6f67 325f 7472 616e 7366 6f72 6d28  _log2_transform(
+0002d250: 7365 6c66 293a 2020 0a20 2020 2020 2020  self):  .       
+0002d260: 200a 2020 2020 2020 2020 636f 6e76 6572   .        conver
 0002d270: 7465 645f 6461 7461 203d 2073 656c 662e  ted_data = self.
-0002d280: 6865 6c70 6572 2e5f 6669 6c74 6572 5f66  helper._filter_f
-0002d290: 6f72 5f76 616c 6964 5f76 616c 735f 7065  or_valid_vals_pe
-0002d2a0: 7263 2873 656c 662e 6461 7461 2c20 302e  rc(self.data, 0.
-0002d2b0: 3529 0a20 2020 2020 2020 2020 7365 6c66  5).         self
-0002d2c0: 2e61 7373 6572 7454 7275 6528 636f 6e76  .assertTrue(conv
-0002d2d0: 6572 7465 645f 6461 7461 2e73 6861 7065  erted_data.shape
-0002d2e0: 5b30 5d20 3d3d 2034 290a 0a20 2020 2064  [0] == 4)..    d
-0002d2f0: 6566 2074 6573 745f 6669 6c74 6572 5f66  ef test_filter_f
-0002d300: 6f72 5f76 616c 6964 5f76 616c 735f 696e  or_valid_vals_in
-0002d310: 5f6f 6e65 5f65 7870 5f67 726f 7570 5f70  _one_exp_group_p
-0002d320: 6572 6328 7365 6c66 293a 0a20 2020 2020  erc(self):.     
-0002d330: 2020 2020 0a20 2020 2020 2020 2023 696e      .        #in
-0002d340: 7365 7274 206e 6120 7661 6c75 6573 0a20  sert na values. 
-0002d350: 2020 2020 2020 2073 656c 662e 6461 7461         self.data
-0002d360: 2e6c 6f63 5b30 2c20 2757 5427 5d20 3d20  .loc[0, 'WT'] = 
-0002d370: 6e70 2e6e 616e 0a20 2020 2020 2020 2073  np.nan.        s
-0002d380: 656c 662e 6461 7461 2e6c 6f63 5b30 2c20  elf.data.loc[0, 
-0002d390: 274b 4f27 5d20 3d20 6e70 2e6e 616e 0a0a  'KO'] = np.nan..
-0002d3a0: 2020 2020 2020 2020 636f 6e76 6572 7465          converte
-0002d3b0: 645f 6461 7461 203d 2073 656c 662e 6865  d_data = self.he
-0002d3c0: 6c70 6572 2e5f 6669 6c74 6572 5f66 6f72  lper._filter_for
-0002d3d0: 5f76 616c 6964 5f76 616c 735f 696e 5f6f  _valid_vals_in_o
-0002d3e0: 6e65 5f65 7870 5f67 726f 7570 5f70 6572  ne_exp_group_per
-0002d3f0: 6328 7365 6c66 2e64 6174 612c 2030 2e37  c(self.data, 0.7
-0002d400: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
-0002d410: 7373 6572 7454 7275 6528 636f 6e76 6572  ssertTrue(conver
-0002d420: 7465 645f 6461 7461 2e73 6861 7065 5b30  ted_data.shape[0
-0002d430: 5d20 3d3d 2034 290a 0a69 6620 5f5f 6e61  ] == 4)..if __na
-0002d440: 6d65 5f5f 203d 3d20 275f 5f6d 6169 6e5f  me__ == '__main_
-0002d450: 5f27 3a0a 2020 2020 756e 6974 7465 7374  _':.    unittest
-0002d460: 2e6d 6169 6e28 2900 0000 0000 0000 0000  .main().........
-0002d470: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d480: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d490: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d4a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d4b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d4c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d4d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d4e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d4f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d500: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d520: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d540: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d550: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d5a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d5b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d5c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d5d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d5e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d5f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d600: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-0002d610: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d620: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d660: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-0002d670: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-0002d680: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
-0002d690: 3030 3000 3031 3032 3133 0020 7800 0000  000.010213. x...
-0002d6a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d6b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d6c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d6d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d6e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d6f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d700: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-0002d710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d720: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d740: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d750: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d780: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d7a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d7b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d7c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d7d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d7e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d7f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d800: 3232 206d 7469 6d65 3d31 3638 3834 3937  22 mtime=1688497
-0002d810: 3330 392e 300a 0000 0000 0000 0000 0000  309.0...........
-0002d820: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002d860: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002d280: 6865 6c70 6572 2e5f 6c6f 6732 5f74 7261  helper._log2_tra
+0002d290: 6e73 666f 726d 2873 656c 662e 6461 7461  nsform(self.data
+0002d2a0: 290a 0a20 2020 2020 2020 2065 7870 6563  )..        expec
+0002d2b0: 7465 645f 636f 6c75 6d6e 7320 3d20 5b27  ted_columns = ['
+0002d2c0: 5754 272c 2027 4b4f 275d 0a0a 2020 2020  WT', 'KO']..    
+0002d2d0: 2020 2020 666f 7220 636f 6c20 696e 2065      for col in e
+0002d2e0: 7870 6563 7465 645f 636f 6c75 6d6e 733a  xpected_columns:
+0002d2f0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+0002d300: 662e 6173 7365 7274 5472 7565 2861 6c6c  f.assertTrue(all
+0002d310: 2863 6f6e 7665 7274 6564 5f64 6174 615b  (converted_data[
+0002d320: 636f 6c5d 203d 3d20 3029 290a 0a20 2020  col] == 0))..   
+0002d330: 2064 6566 2074 6573 745f 6669 6c74 6572   def test_filter
+0002d340: 5f66 6f72 5f76 616c 6964 5f76 616c 735f  _for_valid_vals_
+0002d350: 696e 5f6f 6e65 5f65 7870 5f67 726f 7570  in_one_exp_group
+0002d360: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+0002d370: 2020 2020 0a20 2020 2020 2020 2020 2020      .           
+0002d380: 2023 2069 6e73 6572 7420 6e61 6e20 7661   # insert nan va
+0002d390: 6c75 6573 0a20 2020 2020 2020 2020 2020  lues.           
+0002d3a0: 2073 656c 662e 6461 7461 2e6c 6f63 5b30   self.data.loc[0
+0002d3b0: 2c20 2757 5427 5d20 3d20 6e70 2e6e 616e  , 'WT'] = np.nan
+0002d3c0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+0002d3d0: 662e 6461 7461 2e6c 6f63 5b30 2c20 274b  f.data.loc[0, 'K
+0002d3e0: 4f27 5d20 3d20 6e70 2e6e 616e 0a20 2020  O'] = np.nan.   
+0002d3f0: 2020 2020 2020 2020 2063 6f6e 7665 7274           convert
+0002d400: 6564 5f64 6174 6120 3d20 7365 6c66 2e68  ed_data = self.h
+0002d410: 656c 7065 722e 5f66 696c 7465 725f 666f  elper._filter_fo
+0002d420: 725f 7661 6c69 645f 7661 6c73 5f69 6e5f  r_valid_vals_in_
+0002d430: 6f6e 655f 6578 705f 6772 6f75 7028 7365  one_exp_group(se
+0002d440: 6c66 2e64 6174 6129 0a20 2020 2020 2020  lf.data).       
+0002d450: 2020 2020 200a 2020 2020 2020 2020 2020       .          
+0002d460: 2020 7365 6c66 2e61 7373 6572 7454 7275    self.assertTru
+0002d470: 6528 636f 6e76 6572 7465 645f 6461 7461  e(converted_data
+0002d480: 2e73 6861 7065 5b30 5d20 3d3d 2034 290a  .shape[0] == 4).
+0002d490: 0a20 2020 2064 6566 2074 6573 745f 696d  .    def test_im
+0002d4a0: 7075 7465 5f67 656e 6573 5f77 6974 685f  pute_genes_with_
+0002d4b0: 7072 6f74 6569 6e5f 6964 7328 7365 6c66  protein_ids(self
+0002d4c0: 293a 0a20 2020 2020 2020 2020 2020 200a  ):.            .
+0002d4d0: 2020 2020 2020 2020 2020 2020 2320 696e              # in
+0002d4e0: 7365 7274 206e 616e 2076 616c 7565 730a  sert nan values.
+0002d4f0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0002d500: 2e64 6174 612e 6c6f 635b 302c 2027 4765  .data.loc[0, 'Ge
+0002d510: 6e65 7327 5d20 3d20 6e70 2e6e 616e 0a20  nes'] = np.nan. 
+0002d520: 2020 2020 2020 2020 2020 2063 6f6e 7665             conve
+0002d530: 7274 6564 5f64 6174 6120 3d20 7365 6c66  rted_data = self
+0002d540: 2e68 656c 7065 722e 5f69 6d70 7574 655f  .helper._impute_
+0002d550: 6765 6e65 735f 7769 7468 5f70 726f 7465  genes_with_prote
+0002d560: 696e 5f69 6473 2873 656c 662e 6461 7461  in_ids(self.data
+0002d570: 290a 2020 2020 2020 2020 2020 2020 0a20  ).            . 
+0002d580: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0002d590: 6173 7365 7274 5472 7565 2863 6f6e 7665  assertTrue(conve
+0002d5a0: 7274 6564 5f64 6174 612e 6c6f 635b 302c  rted_data.loc[0,
+0002d5b0: 2027 4765 6e65 7327 5d20 3d3d 2027 5031   'Genes'] == 'P1
+0002d5c0: 3233 2729 0a0a 2020 2020 6465 6620 7465  23')..    def te
+0002d5d0: 7374 5f66 696c 7465 725f 666f 725f 7661  st_filter_for_va
+0002d5e0: 6c69 645f 7661 6c73 5f70 6572 6328 7365  lid_vals_perc(se
+0002d5f0: 6c66 293a 0a20 2020 2020 2020 2020 2320  lf):.         # 
+0002d600: 696e 7365 7274 206e 6120 7661 6c75 6573  insert na values
+0002d610: 0a20 2020 2020 2020 2020 7365 6c66 2e64  .         self.d
+0002d620: 6174 612e 6c6f 635b 303a 332c 2027 5754  ata.loc[0:3, 'WT
+0002d630: 275d 203d 206e 702e 6e61 6e0a 2020 2020  '] = np.nan.    
+0002d640: 2020 2020 2073 656c 662e 6461 7461 2e6c       self.data.l
+0002d650: 6f63 5b31 2c3a 5d20 3d20 6e70 2e6e 616e  oc[1,:] = np.nan
+0002d660: 0a20 2020 2020 2020 2020 636f 6e76 6572  .         conver
+0002d670: 7465 645f 6461 7461 203d 2073 656c 662e  ted_data = self.
+0002d680: 6865 6c70 6572 2e5f 6669 6c74 6572 5f66  helper._filter_f
+0002d690: 6f72 5f76 616c 6964 5f76 616c 735f 7065  or_valid_vals_pe
+0002d6a0: 7263 2873 656c 662e 6461 7461 2c20 302e  rc(self.data, 0.
+0002d6b0: 3529 0a20 2020 2020 2020 2020 7365 6c66  5).         self
+0002d6c0: 2e61 7373 6572 7454 7275 6528 636f 6e76  .assertTrue(conv
+0002d6d0: 6572 7465 645f 6461 7461 2e73 6861 7065  erted_data.shape
+0002d6e0: 5b30 5d20 3d3d 2034 290a 0a20 2020 2064  [0] == 4)..    d
+0002d6f0: 6566 2074 6573 745f 6669 6c74 6572 5f66  ef test_filter_f
+0002d700: 6f72 5f76 616c 6964 5f76 616c 735f 696e  or_valid_vals_in
+0002d710: 5f6f 6e65 5f65 7870 5f67 726f 7570 5f70  _one_exp_group_p
+0002d720: 6572 6328 7365 6c66 293a 0a20 2020 2020  erc(self):.     
+0002d730: 2020 2020 0a20 2020 2020 2020 2023 696e      .        #in
+0002d740: 7365 7274 206e 6120 7661 6c75 6573 0a20  sert na values. 
+0002d750: 2020 2020 2020 2073 656c 662e 6461 7461         self.data
+0002d760: 2e6c 6f63 5b30 2c20 2757 5427 5d20 3d20  .loc[0, 'WT'] = 
+0002d770: 6e70 2e6e 616e 0a20 2020 2020 2020 2073  np.nan.        s
+0002d780: 656c 662e 6461 7461 2e6c 6f63 5b30 2c20  elf.data.loc[0, 
+0002d790: 274b 4f27 5d20 3d20 6e70 2e6e 616e 0a0a  'KO'] = np.nan..
+0002d7a0: 2020 2020 2020 2020 636f 6e76 6572 7465          converte
+0002d7b0: 645f 6461 7461 203d 2073 656c 662e 6865  d_data = self.he
+0002d7c0: 6c70 6572 2e5f 6669 6c74 6572 5f66 6f72  lper._filter_for
+0002d7d0: 5f76 616c 6964 5f76 616c 735f 696e 5f6f  _valid_vals_in_o
+0002d7e0: 6e65 5f65 7870 5f67 726f 7570 5f70 6572  ne_exp_group_per
+0002d7f0: 6328 7365 6c66 2e64 6174 612c 2030 2e37  c(self.data, 0.7
+0002d800: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
+0002d810: 7373 6572 7454 7275 6528 636f 6e76 6572  ssertTrue(conver
+0002d820: 7465 645f 6461 7461 2e73 6861 7065 5b30  ted_data.shape[0
+0002d830: 5d20 3d3d 2034 290a 0a69 6620 5f5f 6e61  ] == 4)..if __na
+0002d840: 6d65 5f5f 203d 3d20 275f 5f6d 6169 6e5f  me__ == '__main_
+0002d850: 5f27 3a0a 2020 2020 756e 6974 7465 7374  _':.    unittest
+0002d860: 2e6d 6169 6e28 2900 0000 0000 0000 0000  .main().........
 0002d870: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002d880: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002d890: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002d8a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002d8b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002d8c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002d8d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -11674,229 +11674,229 @@
 0002d990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002d9a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002d9b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002d9c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002d9d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002d9e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002d9f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002da00: 7072 6f74 656f 6d69 6373 5f64 6f77 6e73  proteomics_downs
-0002da10: 7472 6561 6d5f 616e 616c 7973 6973 2d30  tream_analysis-0
-0002da20: 2e31 2e32 2f74 6573 7473 2f74 6573 745f  .1.2/tests/test_
-0002da30: 7374 6174 6973 7469 6373 2e70 7900 0000  statistics.py...
+0002da00: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+0002da10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002da20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002da30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002da40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002da50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002da60: 0000 0000 3030 3030 3634 3400 3030 3031  ....0000644.0001
-0002da70: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
-0002da80: 3030 3033 3535 3100 3134 3435 3130 3636  0003551.14451066
-0002da90: 3233 3500 3032 3434 3234 0020 3000 0000  235.024424. 0...
+0002da60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+0002da70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+0002da80: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
+0002da90: 3030 3000 3031 3032 3133 0020 7800 0000  000.010213. x...
 0002daa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002dab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002dac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002dad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002dae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002daf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002db00: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
+0002db00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
 0002db10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002db20: 0000 0000 0000 0000 0064 6f63 6b65 7200  .........docker.
+0002db20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002db30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002db40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002db50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002db60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002db70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002db80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002db90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002dba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002dbb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002dbc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002dbd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002dbe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002dbf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002dc00: 696d 706f 7274 206e 756d 7079 2061 7320  import numpy as 
-0002dc10: 6e70 0a69 6d70 6f72 7420 7061 6e64 6173  np.import pandas
-0002dc20: 2061 7320 7064 0a66 726f 6d20 7072 6f74   as pd.from prot
-0002dc30: 656f 6d69 6373 5f64 6f77 6e73 7472 6561  eomics_downstrea
-0002dc40: 6d5f 616e 616c 7973 6973 2e73 7461 7469  m_analysis.stati
-0002dc50: 7374 6963 7320 696d 706f 7274 2053 7461  stics import Sta
-0002dc60: 7469 7374 6963 730a 696d 706f 7274 2075  tistics.import u
-0002dc70: 6e69 7474 6573 740a 0a63 6c61 7373 2054  nittest..class T
-0002dc80: 6573 7453 7461 7469 7374 6963 7328 756e  estStatistics(un
-0002dc90: 6974 7465 7374 2e54 6573 7443 6173 6529  ittest.TestCase)
-0002dca0: 3a0a 0a20 2020 2064 6566 2073 6574 5570  :..    def setUp
-0002dcb0: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-0002dcc0: 0a20 2020 2020 2020 2073 656c 662e 6865  .        self.he
-0002dcd0: 6c70 6572 203d 2053 7461 7469 7374 6963  lper = Statistic
-0002dce0: 7328 2920 0a20 2020 2020 2020 2073 656c  s() .        sel
-0002dcf0: 662e 6461 7461 203d 2070 642e 4461 7461  f.data = pd.Data
-0002dd00: 4672 616d 6528 7b0a 2020 2020 2020 2020  Frame({.        
-0002dd10: 2020 2020 2750 726f 7465 696e 2e47 726f      'Protein.Gro
-0002dd20: 7570 273a 205b 312c 2032 2c20 332c 2034  up': [1, 2, 3, 4
-0002dd30: 2c20 355d 2c0a 2020 2020 2020 2020 2020  , 5],.          
-0002dd40: 2020 2750 726f 7465 696e 2e49 6473 273a    'Protein.Ids':
-0002dd50: 205b 2750 3132 3327 2c20 2750 3233 3427   ['P123', 'P234'
-0002dd60: 2c20 2750 3334 3527 2c20 2750 3435 3627  , 'P345', 'P456'
-0002dd70: 2c20 2750 3536 3727 5d2c 0a20 2020 2020  , 'P567'],.     
-0002dd80: 2020 2020 2020 2027 5072 6f74 6569 6e2e         'Protein.
-0002dd90: 4e61 6d65 7327 3a20 5b27 7031 272c 2027  Names': ['p1', '
-0002dda0: 7032 272c 2027 7033 272c 2027 7034 272c  p2', 'p3', 'p4',
-0002ddb0: 2027 7035 275d 2c0a 2020 2020 2020 2020   'p5'],.        
-0002ddc0: 2020 2020 2747 656e 6573 273a 205b 2767      'Genes': ['g
-0002ddd0: 3127 2c20 2767 3227 2c20 2767 3327 2c20  1', 'g2', 'g3', 
-0002dde0: 2767 3427 2c20 2767 3527 5d2c 0a20 2020  'g4', 'g5'],.   
-0002ddf0: 2020 2020 2020 2020 2027 4669 7273 742e           'First.
-0002de00: 5072 6f74 6569 6e2e 4465 7363 7269 7074  Protein.Descript
-0002de10: 696f 6e27 3a20 5b27 6431 272c 2027 6432  ion': ['d1', 'd2
-0002de20: 272c 2027 6433 272c 2027 6434 272c 2027  ', 'd3', 'd4', '
-0002de30: 6435 275d 2c0a 2020 2020 2020 2020 2020  d5'],.          
-0002de40: 2020 2757 5431 273a 205b 312e 302c 2031    'WT1': [1.0, 1
-0002de50: 2e30 2c20 312c 2031 2e30 2c20 312e 305d  .0, 1, 1.0, 1.0]
-0002de60: 2c0a 2020 2020 2020 2020 2020 2020 2757  ,.            'W
-0002de70: 5432 273a 205b 312e 302c 2031 2e30 2c20  T2': [1.0, 1.0, 
-0002de80: 312e 302c 2031 2e30 2c20 312e 305d 2c0a  1.0, 1.0, 1.0],.
-0002de90: 2020 2020 2020 2020 2020 2020 2757 5433              'WT3
-0002dea0: 273a 205b 312e 302c 2031 2e30 2c20 312e  ': [1.0, 1.0, 1.
-0002deb0: 302c 2031 2e30 2c20 312e 305d 2c0a 2020  0, 1.0, 1.0],.  
-0002dec0: 2020 2020 2020 2020 2020 274b 4f31 273a            'KO1':
-0002ded0: 205b 312e 302c 2031 2e30 2c20 312e 302c   [1.0, 1.0, 1.0,
-0002dee0: 2031 2e30 2c20 312e 305d 2c0a 2020 2020   1.0, 1.0],.    
-0002def0: 2020 2020 2020 2020 274b 4f32 273a 205b          'KO2': [
-0002df00: 312e 302c 2031 2e30 2c20 312e 302c 2031  1.0, 1.0, 1.0, 1
-0002df10: 2e30 2c20 312e 305d 2c0a 2020 2020 2020  .0, 1.0],.      
-0002df20: 2020 2020 2020 274b 4f33 273a 205b 312e        'KO3': [1.
-0002df30: 302c 2031 2e30 2c20 312e 302c 2031 2e30  0, 1.0, 1.0, 1.0
-0002df40: 2c20 312e 305d 2c20 2020 0a20 2020 2020  , 1.0],   .     
-0002df50: 2020 207d 290a 2020 2020 2020 2020 0a20     }).        . 
-0002df60: 2020 2020 2020 2073 656c 662e 6461 7461         self.data
-0002df70: 2e63 6f6c 756d 6e73 203d 205b 2750 726f  .columns = ['Pro
-0002df80: 7465 696e 2e47 726f 7570 272c 0a20 2020  tein.Group',.   
-0002df90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002dfa0: 2020 2020 2020 2020 2027 5072 6f74 6569           'Protei
-0002dfb0: 6e2e 4964 7327 2c0a 2020 2020 2020 2020  n.Ids',.        
-0002dfc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002dfd0: 2020 2020 2750 726f 7465 696e 2e4e 616d      'Protein.Nam
-0002dfe0: 6573 272c 0a20 2020 2020 2020 2020 2020  es',.           
-0002dff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e000: 2027 4765 6e65 7327 2c0a 2020 2020 2020   'Genes',.      
-0002e010: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e020: 2020 2020 2020 2746 6972 7374 2e50 726f        'First.Pro
-0002e030: 7465 696e 2e44 6573 6372 6970 7469 6f6e  tein.Description
-0002e040: 272c 0a20 2020 2020 2020 2020 2020 2020  ',.             
-0002e050: 2020 2020 2020 2020 2020 2020 2020 2027                 '
-0002e060: 5754 272c 200a 2020 2020 2020 2020 2020  WT', .          
-0002e070: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e080: 2020 2757 5427 2c0a 2020 2020 2020 2020    'WT',.        
-0002e090: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e0a0: 2020 2020 2757 5427 2c0a 2020 2020 2020      'WT',.      
-0002e0b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e0c0: 2020 2020 2020 274b 4f27 2c0a 2020 2020        'KO',.    
-0002e0d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e0e0: 2020 2020 2020 2020 274b 4f27 2c0a 2020          'KO',.  
-0002e0f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e100: 2020 2020 2020 2020 2020 274b 4f27 5d0a            'KO'].
-0002e110: 2020 2020 2020 2020 0a20 2020 2064 6566          .    def
-0002e120: 2074 6573 745f 666f 6c64 5f63 6861 6e67   test_fold_chang
-0002e130: 6528 7365 6c66 293a 0a0a 2020 2020 2020  e(self):..      
-0002e140: 2020 636f 6d70 6172 6973 6f6e 203d 205b    comparison = [
-0002e150: 2827 5754 272c 2027 4b4f 2729 5d0a 2020  ('WT', 'KO')].  
-0002e160: 2020 2020 2020 7365 6c66 2e68 656c 7065        self.helpe
-0002e170: 722e 6461 7461 203d 2073 656c 662e 6461  r.data = self.da
-0002e180: 7461 0a20 2020 2020 2020 2073 656c 662e  ta.        self.
-0002e190: 6865 6c70 6572 2e73 7475 6465 6e74 5f74  helper.student_t
-0002e1a0: 7465 7374 2863 6f6d 7061 7269 736f 6e73  test(comparisons
-0002e1b0: 3d63 6f6d 7061 7269 736f 6e29 0a20 2020  =comparison).   
-0002e1c0: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
-0002e1d0: 5472 7565 2861 6c6c 2873 656c 662e 6865  True(all(self.he
-0002e1e0: 6c70 6572 2e66 635f 6461 7461 2e73 656c  lper.fc_data.sel
-0002e1f0: 6563 745f 6474 7970 6573 2827 666c 6f61  ect_dtypes('floa
-0002e200: 7427 2920 3d3d 2031 2929 0a0a 2020 2020  t') == 1))..    
-0002e210: 6465 6620 7465 7374 5f67 6574 5f75 6e69  def test_get_uni
-0002e220: 7175 655f 636f 6d62 2873 656c 6629 3a0a  que_comb(self):.
-0002e230: 2020 2020 2020 2020 6120 3d20 5b27 5754          a = ['WT
-0002e240: 275d 0a20 2020 2020 2020 2062 203d 205b  '].        b = [
-0002e250: 274b 4f31 272c 2027 4b4f 3227 2c20 274b  'KO1', 'KO2', 'K
-0002e260: 4f33 275d 0a20 2020 2020 2020 2065 7870  O3'].        exp
-0002e270: 6563 7465 6420 3d20 5b28 2757 5427 2c20  ected = [('WT', 
-0002e280: 274b 4f31 2729 2c20 0a20 2020 2020 2020  'KO1'), .       
-0002e290: 2020 2020 2020 2020 2020 2020 2028 2757               ('W
-0002e2a0: 5427 2c20 274b 4f32 2729 2c0a 2020 2020  T', 'KO2'),.    
-0002e2b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e2c0: 2827 5754 272c 2027 4b4f 3327 292c 5d0a  ('WT', 'KO3'),].
-0002e2d0: 2020 2020 2020 2020 636f 6d70 6172 6973          comparis
-0002e2e0: 6f6e 7320 3d20 7365 6c66 2e68 656c 7065  ons = self.helpe
-0002e2f0: 722e 6765 745f 756e 6971 7565 5f63 6f6d  r.get_unique_com
-0002e300: 6228 612c 2062 290a 2020 2020 2020 2020  b(a, b).        
-0002e310: 7365 6c66 2e61 7373 6572 7454 7275 6528  self.assertTrue(
-0002e320: 636f 6d70 6172 6973 6f6e 7320 3d3d 2065  comparisons == e
-0002e330: 7870 6563 7465 6429 200a 0a69 6620 5f5f  xpected) ..if __
-0002e340: 6e61 6d65 5f5f 203d 3d20 275f 5f6d 6169  name__ == '__mai
-0002e350: 6e5f 5f27 3a0a 2020 2020 756e 6974 7465  n__':.    unitte
-0002e360: 7374 2e6d 6169 6e28 2900 0000 0000 0000  st.main().......
-0002e370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002e380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002e390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002e3a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002e3b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002e3c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002e3d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002e3e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002e3f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002e400: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002e410: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002e420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002e430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002e440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002e450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002e460: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002e470: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002e480: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002e490: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002e4a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002e4b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002e4c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002e4d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002e4e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002e4f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002e500: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002e510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002e520: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002e530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002e540: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002e550: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002e560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002e570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002e580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002e590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002e5a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002e5b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002e5c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002e5d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002e5e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002e5f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002e600: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002e610: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002e620: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002e630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002e640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002e650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002e660: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002e670: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002e680: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002e690: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002e6a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002e6b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002e6c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002e6d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002e6e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002e6f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002e700: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002e710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002e720: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002e730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002e740: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002e750: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0002e760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002dc00: 3232 206d 7469 6d65 3d31 3638 3835 3732  22 mtime=1688572
+0002dc10: 3039 322e 300a 0000 0000 0000 0000 0000  092.0...........
+0002dc20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002dc30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002dc40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002dc50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002dc60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002dc70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002dc80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002dc90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002dca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002dcb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002dcc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002dcd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002dce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002dcf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002dd00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002dd10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002dd20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002dd30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002dd40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002dd50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002dd60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002dd70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002dd80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002dd90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002dda0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002ddb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002ddc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002ddd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002dde0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002ddf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002de00: 7072 6f74 656f 6d69 6373 5f64 6f77 6e73  proteomics_downs
+0002de10: 7472 6561 6d5f 616e 616c 7973 6973 2d30  tream_analysis-0
+0002de20: 2e31 2e33 2f74 6573 7473 2f74 6573 745f  .1.3/tests/test_
+0002de30: 7374 6174 6973 7469 6373 2e70 7900 0000  statistics.py...
+0002de40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002de50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002de60: 0000 0000 3030 3030 3634 3400 3030 3031  ....0000644.0001
+0002de70: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
+0002de80: 3030 3033 3535 3100 3134 3435 3133 3130  0003551.14451310
+0002de90: 3237 3400 3032 3434 3230 0020 3000 0000  274.024420. 0...
+0002dea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002deb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002dec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002ded0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002dee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002def0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002df00: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
+0002df10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002df20: 0000 0000 0000 0000 0064 6f63 6b65 7200  .........docker.
+0002df30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002df40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002df50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002df60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002df70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002df80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002df90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002dfa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002dfb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002dfc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002dfd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002dfe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002dff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002e000: 696d 706f 7274 206e 756d 7079 2061 7320  import numpy as 
+0002e010: 6e70 0a69 6d70 6f72 7420 7061 6e64 6173  np.import pandas
+0002e020: 2061 7320 7064 0a66 726f 6d20 7072 6f74   as pd.from prot
+0002e030: 656f 6d69 6373 5f64 6f77 6e73 7472 6561  eomics_downstrea
+0002e040: 6d5f 616e 616c 7973 6973 2e73 7461 7469  m_analysis.stati
+0002e050: 7374 6963 7320 696d 706f 7274 2053 7461  stics import Sta
+0002e060: 7469 7374 6963 730a 696d 706f 7274 2075  tistics.import u
+0002e070: 6e69 7474 6573 740a 0a63 6c61 7373 2054  nittest..class T
+0002e080: 6573 7453 7461 7469 7374 6963 7328 756e  estStatistics(un
+0002e090: 6974 7465 7374 2e54 6573 7443 6173 6529  ittest.TestCase)
+0002e0a0: 3a0a 0a20 2020 2064 6566 2073 6574 5570  :..    def setUp
+0002e0b0: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+0002e0c0: 0a20 2020 2020 2020 2073 656c 662e 6865  .        self.he
+0002e0d0: 6c70 6572 203d 2053 7461 7469 7374 6963  lper = Statistic
+0002e0e0: 7328 2920 0a20 2020 2020 2020 2073 656c  s() .        sel
+0002e0f0: 662e 6461 7461 203d 2070 642e 4461 7461  f.data = pd.Data
+0002e100: 4672 616d 6528 7b0a 2020 2020 2020 2020  Frame({.        
+0002e110: 2020 2020 2750 726f 7465 696e 2e47 726f      'Protein.Gro
+0002e120: 7570 273a 205b 312c 2032 2c20 332c 2034  up': [1, 2, 3, 4
+0002e130: 2c20 355d 2c0a 2020 2020 2020 2020 2020  , 5],.          
+0002e140: 2020 2750 726f 7465 696e 2e49 6473 273a    'Protein.Ids':
+0002e150: 205b 2750 3132 3327 2c20 2750 3233 3427   ['P123', 'P234'
+0002e160: 2c20 2750 3334 3527 2c20 2750 3435 3627  , 'P345', 'P456'
+0002e170: 2c20 2750 3536 3727 5d2c 0a20 2020 2020  , 'P567'],.     
+0002e180: 2020 2020 2020 2027 5072 6f74 6569 6e2e         'Protein.
+0002e190: 4e61 6d65 7327 3a20 5b27 7031 272c 2027  Names': ['p1', '
+0002e1a0: 7032 272c 2027 7033 272c 2027 7034 272c  p2', 'p3', 'p4',
+0002e1b0: 2027 7035 275d 2c0a 2020 2020 2020 2020   'p5'],.        
+0002e1c0: 2020 2020 2747 656e 6573 273a 205b 2767      'Genes': ['g
+0002e1d0: 3127 2c20 2767 3227 2c20 2767 3327 2c20  1', 'g2', 'g3', 
+0002e1e0: 2767 3427 2c20 2767 3527 5d2c 0a20 2020  'g4', 'g5'],.   
+0002e1f0: 2020 2020 2020 2020 2027 4669 7273 742e           'First.
+0002e200: 5072 6f74 6569 6e2e 4465 7363 7269 7074  Protein.Descript
+0002e210: 696f 6e27 3a20 5b27 6431 272c 2027 6432  ion': ['d1', 'd2
+0002e220: 272c 2027 6433 272c 2027 6434 272c 2027  ', 'd3', 'd4', '
+0002e230: 6435 275d 2c0a 2020 2020 2020 2020 2020  d5'],.          
+0002e240: 2020 2757 5431 273a 205b 312e 302c 2031    'WT1': [1.0, 1
+0002e250: 2e30 2c20 312c 2031 2e30 2c20 312e 305d  .0, 1, 1.0, 1.0]
+0002e260: 2c0a 2020 2020 2020 2020 2020 2020 2757  ,.            'W
+0002e270: 5432 273a 205b 312e 302c 2031 2e30 2c20  T2': [1.0, 1.0, 
+0002e280: 312e 302c 2031 2e30 2c20 312e 305d 2c0a  1.0, 1.0, 1.0],.
+0002e290: 2020 2020 2020 2020 2020 2020 2757 5433              'WT3
+0002e2a0: 273a 205b 312e 302c 2031 2e30 2c20 312e  ': [1.0, 1.0, 1.
+0002e2b0: 302c 2031 2e30 2c20 312e 305d 2c0a 2020  0, 1.0, 1.0],.  
+0002e2c0: 2020 2020 2020 2020 2020 274b 4f31 273a            'KO1':
+0002e2d0: 205b 312e 302c 2031 2e30 2c20 312e 302c   [1.0, 1.0, 1.0,
+0002e2e0: 2031 2e30 2c20 312e 305d 2c0a 2020 2020   1.0, 1.0],.    
+0002e2f0: 2020 2020 2020 2020 274b 4f32 273a 205b          'KO2': [
+0002e300: 312e 302c 2031 2e30 2c20 312e 302c 2031  1.0, 1.0, 1.0, 1
+0002e310: 2e30 2c20 312e 305d 2c0a 2020 2020 2020  .0, 1.0],.      
+0002e320: 2020 2020 2020 274b 4f33 273a 205b 312e        'KO3': [1.
+0002e330: 302c 2031 2e30 2c20 312e 302c 2031 2e30  0, 1.0, 1.0, 1.0
+0002e340: 2c20 312e 305d 2c20 2020 0a20 2020 2020  , 1.0],   .     
+0002e350: 2020 207d 290a 2020 2020 2020 2020 0a20     }).        . 
+0002e360: 2020 2020 2020 2073 656c 662e 6461 7461         self.data
+0002e370: 2e63 6f6c 756d 6e73 203d 205b 2750 726f  .columns = ['Pro
+0002e380: 7465 696e 2e47 726f 7570 272c 0a20 2020  tein.Group',.   
+0002e390: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e3a0: 2020 2020 2020 2020 2027 5072 6f74 6569           'Protei
+0002e3b0: 6e2e 4964 7327 2c0a 2020 2020 2020 2020  n.Ids',.        
+0002e3c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e3d0: 2020 2020 2750 726f 7465 696e 2e4e 616d      'Protein.Nam
+0002e3e0: 6573 272c 0a20 2020 2020 2020 2020 2020  es',.           
+0002e3f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e400: 2027 4765 6e65 7327 2c0a 2020 2020 2020   'Genes',.      
+0002e410: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e420: 2020 2020 2020 2746 6972 7374 2e50 726f        'First.Pro
+0002e430: 7465 696e 2e44 6573 6372 6970 7469 6f6e  tein.Description
+0002e440: 272c 0a20 2020 2020 2020 2020 2020 2020  ',.             
+0002e450: 2020 2020 2020 2020 2020 2020 2020 2027                 '
+0002e460: 5754 272c 200a 2020 2020 2020 2020 2020  WT', .          
+0002e470: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e480: 2020 2757 5427 2c0a 2020 2020 2020 2020    'WT',.        
+0002e490: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e4a0: 2020 2020 2757 5427 2c0a 2020 2020 2020      'WT',.      
+0002e4b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e4c0: 2020 2020 2020 274b 4f27 2c0a 2020 2020        'KO',.    
+0002e4d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e4e0: 2020 2020 2020 2020 274b 4f27 2c0a 2020          'KO',.  
+0002e4f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e500: 2020 2020 2020 2020 2020 274b 4f27 5d0a            'KO'].
+0002e510: 2020 2020 2020 2020 0a20 2020 2064 6566          .    def
+0002e520: 2074 6573 745f 666f 6c64 5f63 6861 6e67   test_fold_chang
+0002e530: 6528 7365 6c66 293a 0a0a 2020 2020 2020  e(self):..      
+0002e540: 2020 636f 6d70 6172 6973 6f6e 203d 205b    comparison = [
+0002e550: 2827 5754 272c 2027 4b4f 2729 5d0a 2020  ('WT', 'KO')].  
+0002e560: 2020 2020 2020 7365 6c66 2e68 656c 7065        self.helpe
+0002e570: 722e 6461 7461 203d 2073 656c 662e 6461  r.data = self.da
+0002e580: 7461 0a20 2020 2020 2020 2073 656c 662e  ta.        self.
+0002e590: 6865 6c70 6572 2e73 7475 6465 6e74 5f74  helper.student_t
+0002e5a0: 7465 7374 2863 6f6d 7061 7269 736f 6e73  test(comparisons
+0002e5b0: 3d63 6f6d 7061 7269 736f 6e29 0a20 2020  =comparison).   
+0002e5c0: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+0002e5d0: 5472 7565 2861 6c6c 2873 656c 662e 6865  True(all(self.he
+0002e5e0: 6c70 6572 2e66 635f 6461 7461 2e73 656c  lper.fc_data.sel
+0002e5f0: 6563 745f 6474 7970 6573 2827 666c 6f61  ect_dtypes('floa
+0002e600: 7427 2920 3d3d 2031 2929 0a0a 2020 2020  t') == 1))..    
+0002e610: 6465 6620 7465 7374 5f67 6574 5f75 6e69  def test_get_uni
+0002e620: 7175 655f 636f 6d62 2873 656c 6629 3a0a  que_comb(self):.
+0002e630: 2020 2020 2020 2020 6120 3d20 5b27 5754          a = ['WT
+0002e640: 275d 0a20 2020 2020 2020 2062 203d 205b  '].        b = [
+0002e650: 274b 4f31 272c 2027 4b4f 3227 2c20 274b  'KO1', 'KO2', 'K
+0002e660: 4f33 275d 0a20 2020 2020 2020 2065 7870  O3'].        exp
+0002e670: 6563 7465 6420 3d20 5b28 2757 5427 2c20  ected = [('WT', 
+0002e680: 274b 4f31 2729 2c20 0a20 2020 2020 2020  'KO1'), .       
+0002e690: 2020 2020 2020 2020 2020 2020 2028 2757               ('W
+0002e6a0: 5427 2c20 274b 4f32 2729 2c0a 2020 2020  T', 'KO2'),.    
+0002e6b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e6c0: 2827 5754 272c 2027 4b4f 3327 292c 5d0a  ('WT', 'KO3'),].
+0002e6d0: 2020 2020 2020 2020 636f 6d70 6172 6973          comparis
+0002e6e0: 6f6e 7320 3d20 7365 6c66 2e68 656c 7065  ons = self.helpe
+0002e6f0: 722e 6765 745f 756e 6971 7565 5f63 6f6d  r.get_unique_com
+0002e700: 6228 612c 2062 290a 2020 2020 2020 2020  b(a, b).        
+0002e710: 7365 6c66 2e61 7373 6572 7454 7275 6528  self.assertTrue(
+0002e720: 636f 6d70 6172 6973 6f6e 7320 3d3d 2065  comparisons == e
+0002e730: 7870 6563 7465 6429 200a 0a69 6620 5f5f  xpected) ..if __
+0002e740: 6e61 6d65 5f5f 203d 3d20 275f 5f6d 6169  name__ == '__mai
+0002e750: 6e5f 5f27 3a0a 2020 2020 756e 6974 7465  n__':.    unitte
+0002e760: 7374 2e6d 6169 6e28 2900 0000 0000 0000  st.main().......
 0002e770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002e780: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002e790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002e7a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002e7b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002e7c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0002e7d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
```

