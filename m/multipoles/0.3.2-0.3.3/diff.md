# Comparing `tmp/multipoles-0.3.2.tar.gz` & `tmp/multipoles-0.3.3.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "multipoles-0.3.2.tar", last modified: Tue Jul  4 19:25:32 2023, max compression
+gzip compressed data, was "multipoles-0.3.3.tar", last modified: Wed Jul  5 10:37:18 2023, max compression
```

## Comparing `multipoles-0.3.2.tar` & `multipoles-0.3.3.tar`

### file list

```diff
@@ -1,14 +1,14 @@
-drwxr-xr-x   0 mbaer    (671849960) 579947404        0 2023-07-04 19:25:32.642702 multipoles-0.3.2/
--rw-r--r--   0 mbaer    (671849960) 579947404      793 2023-07-04 19:25:32.642898 multipoles-0.3.2/PKG-INFO
--rw-r--r--   0 mbaer    (671849960) 579947404     4447 2023-07-04 18:48:59.000000 multipoles-0.3.2/README.md
-drwxr-xr-x   0 mbaer    (671849960) 579947404        0 2023-07-04 19:25:32.640349 multipoles-0.3.2/multipoles/
--rw-r--r--   0 mbaer    (671849960) 579947404       66 2022-11-15 16:55:52.000000 multipoles-0.3.2/multipoles/__init__.py
--rw-r--r--   0 mbaer    (671849960) 579947404    13815 2023-07-04 19:18:44.000000 multipoles-0.3.2/multipoles/expansion.py
-drwxr-xr-x   0 mbaer    (671849960) 579947404        0 2023-07-04 19:25:32.642317 multipoles-0.3.2/multipoles.egg-info/
--rw-r--r--   0 mbaer    (671849960) 579947404      793 2023-07-04 19:25:32.000000 multipoles-0.3.2/multipoles.egg-info/PKG-INFO
--rw-r--r--   0 mbaer    (671849960) 579947404      244 2023-07-04 19:25:32.000000 multipoles-0.3.2/multipoles.egg-info/SOURCES.txt
--rw-r--r--   0 mbaer    (671849960) 579947404        1 2023-07-04 19:25:32.000000 multipoles-0.3.2/multipoles.egg-info/dependency_links.txt
--rw-r--r--   0 mbaer    (671849960) 579947404       12 2023-07-04 19:25:32.000000 multipoles-0.3.2/multipoles.egg-info/requires.txt
--rw-r--r--   0 mbaer    (671849960) 579947404       11 2023-07-04 19:25:32.000000 multipoles-0.3.2/multipoles.egg-info/top_level.txt
--rw-r--r--   0 mbaer    (671849960) 579947404       79 2023-07-04 19:25:32.643652 multipoles-0.3.2/setup.cfg
--rw-r--r--   0 mbaer    (671849960) 579947404      968 2023-07-04 19:24:34.000000 multipoles-0.3.2/setup.py
+drwxr-xr-x   0 mbaer    (671849960) 579947404        0 2023-07-05 10:37:18.256460 multipoles-0.3.3/
+-rw-r--r--   0 mbaer    (671849960) 579947404      793 2023-07-05 10:37:18.256602 multipoles-0.3.3/PKG-INFO
+-rw-r--r--   0 mbaer    (671849960) 579947404     4678 2023-07-05 05:51:03.000000 multipoles-0.3.3/README.md
+drwxr-xr-x   0 mbaer    (671849960) 579947404        0 2023-07-05 10:37:18.254203 multipoles-0.3.3/multipoles/
+-rw-r--r--   0 mbaer    (671849960) 579947404       66 2023-07-05 10:36:59.000000 multipoles-0.3.3/multipoles/__init__.py
+-rw-r--r--   0 mbaer    (671849960) 579947404    14138 2023-07-05 10:23:31.000000 multipoles-0.3.3/multipoles/expansion.py
+drwxr-xr-x   0 mbaer    (671849960) 579947404        0 2023-07-05 10:37:18.256141 multipoles-0.3.3/multipoles.egg-info/
+-rw-r--r--   0 mbaer    (671849960) 579947404      793 2023-07-05 10:37:18.000000 multipoles-0.3.3/multipoles.egg-info/PKG-INFO
+-rw-r--r--   0 mbaer    (671849960) 579947404      244 2023-07-05 10:37:18.000000 multipoles-0.3.3/multipoles.egg-info/SOURCES.txt
+-rw-r--r--   0 mbaer    (671849960) 579947404        1 2023-07-05 10:37:18.000000 multipoles-0.3.3/multipoles.egg-info/dependency_links.txt
+-rw-r--r--   0 mbaer    (671849960) 579947404       12 2023-07-05 10:37:18.000000 multipoles-0.3.3/multipoles.egg-info/requires.txt
+-rw-r--r--   0 mbaer    (671849960) 579947404       11 2023-07-05 10:37:18.000000 multipoles-0.3.3/multipoles.egg-info/top_level.txt
+-rw-r--r--   0 mbaer    (671849960) 579947404       79 2023-07-05 10:37:18.257129 multipoles-0.3.3/setup.cfg
+-rw-r--r--   0 mbaer    (671849960) 579947404      968 2023-07-05 10:36:52.000000 multipoles-0.3.3/setup.py
```

### Comparing `multipoles-0.3.2/PKG-INFO` & `multipoles-0.3.3/PKG-INFO`

 * *Files 1% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: multipoles
-Version: 0.3.2
+Version: 0.3.3
 Summary: A Python package for multipole expansions of electrostatic or gravitational potentials
 Home-page: https://github.com/maroba/multipoles
 Author: Matthias Baer
 Author-email: matthias.r.baer@googlemail.com
 License: MIT
 Keywords: multipole expansion,physics,scientific-computing
 Platform: UNKNOWN
```

### Comparing `multipoles-0.3.2/README.md` & `multipoles-0.3.3/README.md`

 * *Files 9% similar despite different names*

```diff
@@ -1,278 +1,293 @@
-00000000: 5b21 5b50 7950 4920 7665 7273 696f 6e5d  [![PyPI version]
-00000010: 2868 7474 7073 3a2f 2f62 6164 6765 2e66  (https://badge.f
-00000020: 7572 792e 696f 2f70 792f 6d75 6c74 6970  ury.io/py/multip
-00000030: 6f6c 6573 2e73 7667 295d 2868 7474 7073  oles.svg)](https
-00000040: 3a2f 2f62 6164 6765 2e66 7572 792e 696f  ://badge.fury.io
-00000050: 2f70 792f 6d75 6c74 6970 6f6c 6573 290a  /py/multipoles).
-00000060: 0a23 206d 756c 7469 706f 6c65 730a 0a2a  .# multipoles..*
-00000070: 6d75 6c74 6970 6f6c 6573 2a20 6973 2061  multipoles* is a
-00000080: 2050 7974 686f 6e20 7061 636b 6167 6520   Python package 
-00000090: 666f 7220 6d75 6c74 6970 6f6c 6520 6578  for multipole ex
-000000a0: 7061 6e73 696f 6e73 206f 6620 7468 6520  pansions of the 
-000000b0: 736f 6c75 7469 6f6e 7320 6f66 2074 6865  solutions of the
-000000c0: 2050 6f69 7373 6f6e 2065 7175 6174 696f   Poisson equatio
-000000d0: 6e20 2865 2e67 2e20 656c 6563 7472 6f73  n (e.g. electros
-000000e0: 7461 7469 6320 6f72 2067 7261 7669 7461  tatic or gravita
-000000f0: 7469 6f6e 616c 2070 6f74 656e 7469 616c  tional potential
-00000100: 7329 2e20 4974 2063 616e 2068 616e 646c  s). It can handl
-00000110: 6520 6469 7363 7265 7465 2061 6e64 2063  e discrete and c
-00000120: 6f6e 7469 6e75 6f75 7320 6368 6172 6765  ontinuous charge
-00000130: 206f 7220 6d61 7373 2064 6973 7472 6962   or mass distrib
-00000140: 7574 696f 6e73 2e0a 0a23 2320 4261 636b  utions...## Back
-00000150: 6772 6f75 6e64 0a0a 466f 7220 6120 6769  ground..For a gi
-00000160: 7665 6e20 6675 6e63 7469 6f6e 2024 5c72  ven function $\r
-00000170: 686f 2878 2c79 2c7a 2924 2c20 7468 6520  ho(x,y,z)$, the 
-00000180: 736f 6c75 7469 6f6e 2024 5c50 6869 2878  solution $\Phi(x
-00000190: 2c79 2c7a 2924 206f 6620 7468 6520 506f  ,y,z)$ of the Po
-000001a0: 6973 736f 6e20 6571 7561 7469 6f6e 2024  isson equation $
-000001b0: 5c6e 6162 6c61 5e32 5c50 6869 3d5c 7268  \nabla^2\Phi=\rh
-000001c0: 6f24 2077 6974 6820 7661 6e69 7368 696e  o$ with vanishin
-000001d0: 6720 4469 7269 6368 6c65 7420 626f 756e  g Dirichlet boun
-000001e0: 6461 7279 2063 6f6e 6469 7469 6f6e 7320  dary conditions 
-000001f0: 6174 2069 6e66 696e 6974 7920 6973 0a0a  at infinity is..
-00000200: 2424 5c50 6869 2878 2c79 2c7a 293d 5c69  $$\Phi(x,y,z)=\i
-00000210: 6e74 2064 5e33 7227 5c66 7261 637b 5c72  nt d^3r'\frac{\r
-00000220: 686f 2872 2729 7d7b 7c72 2d72 277c 7d24  ho(r')}{|r-r'|}$
-00000230: 240a 0a45 7861 6d70 6c65 7320 6f66 2074  $..Examples of t
-00000240: 6869 7320 6172 6520 7468 6520 656c 6563  his are the elec
-00000250: 7472 6f73 7461 7469 6320 616e 6420 4e65  trostatic and Ne
-00000260: 7774 6f6e 6961 6e20 6772 6176 6974 6174  wtonian gravitat
-00000270: 696f 6e61 6c20 706f 7465 6e74 6961 6c2e  ional potential.
-00000280: 0a49 6620 796f 7520 6e65 6564 2074 6f20  .If you need to 
-00000290: 6576 616c 7561 7465 2024 5c50 6869 2878  evaluate $\Phi(x
-000002a0: 2c79 2c7a 2924 2061 7420 6d61 6e79 2070  ,y,z)$ at many p
-000002b0: 6f69 6e74 732c 2063 616c 6375 6c61 7469  oints, calculati
-000002c0: 6e67 2074 6865 2069 6e74 6567 7261 6c20  ng the integral 
-000002d0: 666f 7220 6561 6368 2070 6f69 6e74 2069  for each point i
-000002e0: 7320 636f 6d70 7574 6174 696f 6e61 6c6c  s computationall
-000002f0: 7920 6578 7065 6e73 6976 652e 2041 7320  y expensive. As 
-00000300: 6120 6661 7374 6572 2061 6c74 6572 6e61  a faster alterna
-00000310: 7469 7665 2c20 7765 2063 616e 2065 7870  tive, we can exp
-00000320: 7265 7373 2024 5c50 6869 2878 2c79 2c7a  ress $\Phi(x,y,z
-00000330: 2924 2069 6e20 7465 726d 7320 6f66 2074  )$ in terms of t
-00000340: 6865 206d 756c 7469 706f 6c65 206d 6f6d  he multipole mom
-00000350: 656e 7473 2024 715f 7b6c 6d7d 2420 6f72  ents $q_{lm}$ or
-00000360: 2024 495f 7b6c 6d7d 2420 286e 6f74 6520   $I_{lm}$ (note 
-00000370: 736f 6d65 206c 6974 6572 6174 7572 6520  some literature 
-00000380: 7573 6573 2074 6865 2073 7562 7363 7269  uses the subscri
-00000390: 7074 7320 2428 5c63 646f 7429 5f7b 6e6d  pts $(\cdot)_{nm
-000003a0: 7d24 293a 0a0a 2424 5c50 6869 2878 2c79  }$):..$$\Phi(x,y
-000003b0: 2c7a 293d 5c73 756d 5f7b 6c3d 307d 5e5c  ,z)=\sum_{l=0}^\
-000003c0: 696e 6674 795c 756e 6465 7262 7261 6365  infty\underbrace
-000003d0: 7b5c 7371 7274 7b5c 6672 6163 7b34 5c70  {\sqrt{\frac{4\p
-000003e0: 697d 7b32 6c2b 317d 7d5c 7375 6d5f 7b6d  i}{2l+1}}\sum_{m
-000003f0: 3d2d 6c7d 5e6c 595f 7b6c 6d7d 285c 7468  =-l}^lY_{lm}(\th
-00000400: 6574 612c 205c 7661 7270 6869 295c 6672  eta, \varphi)\fr
-00000410: 6163 7b71 5f7b 6c6d 7d7d 7b72 5e7b 6c2b  ac{q_{lm}}{r^{l+
-00000420: 317d 7d7d 5f7b 5c50 6869 5e7b 286c 297d  1}}}_{\Phi^{(l)}
-00000430: 7d24 240a 0a66 6f72 2061 2065 7874 6572  }$$..for a exter
-00000440: 696f 7220 6578 7061 6e73 696f 6e2c 206f  ior expansion, o
-00000450: 720a 0a24 245c 5068 6928 782c 792c 7a29  r..$$\Phi(x,y,z)
-00000460: 3d5c 7375 6d5f 7b6c 3d30 7d5e 5c69 6e66  =\sum_{l=0}^\inf
-00000470: 7479 5c75 6e64 6572 6272 6163 657b 5c73  ty\underbrace{\s
-00000480: 7172 747b 5c66 7261 637b 345c 7069 7d7b  qrt{\frac{4\pi}{
-00000490: 326c 2b31 7d7d 5c73 756d 5f7b 6d3d 2d6c  2l+1}}\sum_{m=-l
-000004a0: 7d5e 6c59 5f7b 6c6d 7d28 5c74 6865 7461  }^lY_{lm}(\theta
-000004b0: 2c20 5c76 6172 7068 6929 495f 7b6c 6d7d  , \varphi)I_{lm}
-000004c0: 725e 7b6c 7d7d 5f7b 5c50 6869 5e7b 286c  r^{l}}_{\Phi^{(l
-000004d0: 297d 7d24 240a 0a66 6f72 2061 6e20 696e  )}}$$..for an in
-000004e0: 7465 7269 6f72 2065 7870 616e 7369 6f6e  terior expansion
-000004f0: 3b20 7768 6572 6520 2472 2c20 5c74 6865  ; where $r, \the
-00000500: 7461 2c20 5c76 6172 7068 6924 2061 7265  ta, \varphi$ are
-00000510: 2074 6865 2075 7375 616c 2073 7068 6572   the usual spher
-00000520: 6963 616c 2063 6f6f 7264 696e 6174 6573  ical coordinates
-00000530: 2063 6f72 7265 7370 6f6e 6469 6e67 2074   corresponding t
-00000540: 6f20 7468 6520 6361 7274 6573 6961 6e20  o the cartesian 
-00000550: 636f 6f72 6469 6e61 7465 7320 2478 2c20  coordinates $x, 
-00000560: 792c 207a 2420 616e 6420 2459 5f7b 6c6d  y, z$ and $Y_{lm
-00000570: 7d28 5c74 6865 7461 2c20 5c76 6172 7068  }(\theta, \varph
-00000580: 6929 2420 6172 6520 7468 6520 7370 6865  i)$ are the sphe
-00000590: 7269 6361 6c20 6861 726d 6f6e 6963 732e  rical harmonics.
-000005a0: 0a0a 5468 6520 6d75 6c74 6970 6f6c 6520  ..The multipole 
-000005b0: 6d6f 6d65 6e74 7320 666f 7220 7468 6520  moments for the 
-000005c0: 6578 7465 7269 6f72 2065 7870 616e 7369  exterior expansi
-000005d0: 6f6e 2061 7265 3a0a 0a24 2471 5f7b 6c6d  on are:..$$q_{lm
-000005e0: 7d20 3d20 5c73 7172 747b 5c66 7261 637b  } = \sqrt{\frac{
-000005f0: 345c 7069 7d7b 326c 2b31 7d7d 5c69 6e74  4\pi}{2l+1}}\int
-00000600: 2064 5e33 2072 2720 5c72 686f 2872 2729   d^3 r' \rho(r')
-00000610: 7227 5e6c 2059 5e2a 5f7b 6c6d 7d28 5c74  r'^l Y^*_{lm}(\t
-00000620: 6865 7461 272c 205c 7661 7270 6869 2729  heta', \varphi')
-00000630: 2424 0a0a 616e 6420 7468 6520 6d75 6c74  $$..and the mult
-00000640: 6970 6f6c 6520 6d6f 6d65 6e74 7320 666f  ipole moments fo
-00000650: 7220 7468 6520 696e 7465 7269 6f72 2065  r the interior e
-00000660: 7870 616e 7369 6f6e 2061 7265 3a0a 0a24  xpansion are:..$
-00000670: 2449 5f7b 6c6d 7d20 3d20 5c73 7172 747b  $I_{lm} = \sqrt{
-00000680: 5c66 7261 637b 345c 7069 7d7b 326c 2b31  \frac{4\pi}{2l+1
-00000690: 7d7d 5c69 6e74 2064 5e33 2072 2720 5c66  }}\int d^3 r' \f
-000006a0: 7261 637b 5c72 686f 2872 2729 7d7b 7227  rac{\rho(r')}{r'
-000006b0: 5e7b 6c2b 317d 7d20 595e 2a5f 7b6c 6d7d  ^{l+1}} Y^*_{lm}
-000006c0: 285c 7468 6574 6127 2c20 5c76 6172 7068  (\theta', \varph
-000006d0: 6927 2924 240a 0a54 6869 7320 6170 7072  i')$$..This appr
-000006e0: 6f61 6368 2069 7320 7573 7561 6c6c 7920  oach is usually 
-000006f0: 6d75 6368 2066 6173 7465 7220 6265 6361  much faster beca
-00000700: 7573 6520 7468 6520 636f 6e74 7269 6275  use the contribu
-00000710: 7469 6f6e 7320 245c 5068 695e 7b28 6c29  tions $\Phi^{(l)
-00000720: 7d24 2061 7265 2067 6574 7469 6e67 2073  }$ are getting s
-00000730: 6d61 6c6c 6572 2077 6974 6820 696e 6372  maller with incr
-00000740: 6561 7369 6e67 203c 693e 6c3c 2f69 3e2e  easing <i>l</i>.
-00000750: 2053 6f20 7765 206a 7573 7420 6861 7665   So we just have
-00000760: 2074 6f20 6361 6c63 756c 6174 6520 6120   to calculate a 
-00000770: 6665 7720 696e 7465 6772 616c 7320 666f  few integrals fo
-00000780: 7220 6f62 7461 696e 696e 6720 736f 6d65  r obtaining some
-00000790: 2020 2471 5f7b 6c6d 7d24 206f 7220 2024    $q_{lm}$ or  $
-000007a0: 495f 7b6c 6d7d 242e 0a0a 536f 6d65 206c  I_{lm}$...Some l
-000007b0: 6974 6572 6174 7572 6520 636f 6e73 6964  iterature consid
-000007c0: 6572 7320 7468 6520 245c 7371 7274 7b5c  ers the $\sqrt{\
-000007d0: 6672 6163 7b34 5c70 697d 7b32 6c2b 317d  frac{4\pi}{2l+1}
-000007e0: 7d24 2061 7320 7061 7274 206f 6620 7468  }$ as part of th
-000007f0: 6520 6465 6669 6e69 7469 6f6e 206f 6620  e definition of 
-00000800: 2459 5f7b 6c6d 7d28 5c74 6865 7461 2c20  $Y_{lm}(\theta, 
-00000810: 5c76 6172 7068 6929 242e 0a0a 2323 2045  \varphi)$...## E
-00000820: 7861 6d70 6c65 730a 0a23 2323 2044 6973  xamples..### Dis
-00000830: 6372 6574 6520 4368 6172 6765 2044 6973  crete Charge Dis
-00000840: 7472 6962 7574 696f 6e0a 0a41 7320 6578  tribution..As ex
-00000850: 616d 706c 6520 666f 7220 6120 6469 7363  ample for a disc
-00000860: 7265 7465 2063 6861 7267 6520 6469 7374  rete charge dist
-00000870: 7269 6275 7469 6f6e 2077 6520 6d6f 6465  ribution we mode
-00000880: 6c20 7477 6f20 706f 696e 7420 6368 6172  l two point char
-00000890: 6765 7320 7769 7468 2070 6f73 6974 6976  ges with positiv
-000008a0: 6520 616e 6420 6e65 6761 7469 7665 2075  e and negative u
-000008b0: 6e69 7420 6368 6172 6765 206c 6f63 6174  nit charge locat
-000008c0: 6564 206f 6e20 7468 6520 7a2d 6178 6973  ed on the z-axis
-000008d0: 3a0a 0a60 6060 7079 7468 6f6e 0a66 726f  :..```python.fro
-000008e0: 6d20 6d75 6c74 6970 6f6c 6573 2069 6d70  m multipoles imp
-000008f0: 6f72 7420 4d75 6c74 6970 6f6c 6545 7870  ort MultipoleExp
-00000900: 616e 7369 6f6e 0a0a 2320 5072 6570 6172  ansion..# Prepar
-00000910: 6520 7468 6520 6368 6172 6765 2064 6973  e the charge dis
-00000920: 7472 6962 7574 696f 6e20 6469 6374 2066  tribution dict f
-00000930: 6f72 2074 6865 204d 756c 7469 706f 6c65  or the Multipole
-00000940: 4578 7061 6e73 696f 6e20 6f62 6a65 6374  Expansion object
-00000950: 3a0a 0a63 6861 7267 655f 6469 7374 203d  :..charge_dist =
-00000960: 207b 0a20 2020 2027 6469 7363 7265 7465   {.    'discrete
-00000970: 273a 2054 7275 652c 2020 2020 2023 2070  ': True,     # p
-00000980: 6f69 6e74 2063 6861 7267 6573 2061 7265  oint charges are
-00000990: 2064 6973 6372 6574 6520 6368 6172 6765   discrete charge
-000009a0: 2064 6973 7472 6962 7574 696f 6e73 0a20   distributions. 
-000009b0: 2020 2027 6368 6172 6765 7327 3a20 5b0a     'charges': [.
-000009c0: 2020 2020 2020 2020 7b27 7127 3a20 312c          {'q': 1,
-000009d0: 2027 7879 7a27 3a20 2830 2c20 302c 2031   'xyz': (0, 0, 1
-000009e0: 297d 2c0a 2020 2020 2020 2020 7b27 7127  )},.        {'q'
-000009f0: 3a20 2d31 2c20 2778 797a 273a 2028 302c  : -1, 'xyz': (0,
-00000a00: 2030 2c20 2d31 297d 2c0a 2020 2020 5d0a   0, -1)},.    ].
-00000a10: 7d0a 0a6c 5f6d 6178 203d 2032 2020 2023  }..l_max = 2   #
-00000a20: 2077 6865 7265 2074 6f20 7374 6f70 2074   where to stop t
-00000a30: 6865 2069 6e66 696e 6974 6520 6d75 6c74  he infinite mult
-00000a40: 6970 6f6c 6520 7375 6d3b 2068 6572 6520  ipole sum; here 
-00000a50: 7765 2065 7870 616e 6420 7570 2074 6f20  we expand up to 
-00000a60: 7468 6520 7175 6164 7275 706f 6c65 2028  the quadrupole (
-00000a70: 6c3d 3229 0a0a 5068 6920 3d20 4d75 6c74  l=2)..Phi = Mult
-00000a80: 6970 6f6c 6545 7870 616e 7369 6f6e 2863  ipoleExpansion(c
-00000a90: 6861 7267 655f 6469 7374 2c20 6c5f 6d61  harge_dist, l_ma
-00000aa0: 7829 0a0a 2320 5765 2063 616e 2065 7661  x)..# We can eva
-00000ab0: 6c75 6174 6520 7468 6520 6d75 6c74 6970  luate the multip
-00000ac0: 6f6c 6520 6578 7061 6e64 6564 2070 6f74  ole expanded pot
-00000ad0: 656e 7469 616c 2061 7420 6120 6769 7665  ential at a give
-00000ae0: 6e20 706f 696e 7420 6c69 6b65 2074 6869  n point like thi
-00000af0: 733a 0a0a 782c 2079 2c20 7a20 3d20 3330  s:..x, y, z = 30
-00000b00: 2e35 2c20 3330 2e36 2c20 3330 2e37 0a76  .5, 30.6, 30.7.v
-00000b10: 616c 7565 203d 2050 6869 2878 2c20 792c  alue = Phi(x, y,
-00000b20: 207a 290a 0a23 2054 6865 206d 756c 7469   z)..# The multi
-00000b30: 706f 6c65 206d 6f6d 656e 7473 2061 7265  pole moments are
-00000b40: 2073 746f 7265 6420 696e 2061 2064 6963   stored in a dic
-00000b50: 742c 2077 6865 7265 2074 6865 206b 6579  t, where the key
-00000b60: 7320 6172 6520 286c 2c20 6d29 2061 6e64  s are (l, m) and
-00000b70: 2074 6865 2076 616c 7565 7320 715f 6c6d   the values q_lm
-00000b80: 3a0a 5068 692e 6d75 6c74 6970 6f6c 655f  :.Phi.multipole_
-00000b90: 6d6f 6d65 6e74 730a 6060 600a 0a23 2323  moments.```..###
-00000ba0: 2043 6f6e 7469 6e75 6f75 7320 4368 6172   Continuous Char
-00000bb0: 6765 2044 6973 7472 6962 7574 696f 6e0a  ge Distribution.
-00000bc0: 0a41 7320 616e 2065 7861 6d70 6c65 2066  .As an example f
-00000bd0: 6f72 2061 2063 6f6e 7469 6e75 6f75 7320  or a continuous 
-00000be0: 6368 6172 6765 2064 6973 7472 6962 7574  charge distribut
-00000bf0: 696f 6e2c 2077 6520 736d 6561 7220 6f75  ion, we smear ou
-00000c00: 7420 7468 6520 706f 696e 7420 6368 6172  t the point char
-00000c10: 6765 7320 6672 6f6d 2074 6865 2070 7265  ges from the pre
-00000c20: 7669 6f75 730a 6578 616d 706c 653a 0a0a  vious.example:..
-00000c30: 6060 6070 7974 686f 6e0a 6672 6f6d 206d  ```python.from m
-00000c40: 756c 7469 706f 6c65 7320 696d 706f 7274  ultipoles import
-00000c50: 204d 756c 7469 706f 6c65 4578 7061 6e73   MultipoleExpans
-00000c60: 696f 6e0a 696d 706f 7274 206e 756d 7079  ion.import numpy
-00000c70: 2061 7320 6e70 0a0a 2320 4669 7273 7420   as np..# First 
-00000c80: 7765 2073 6574 2075 7020 6f75 7220 6772  we set up our gr
-00000c90: 6964 2c20 6120 6375 6265 206f 6620 6c65  id, a cube of le
-00000ca0: 6e67 7468 2031 3020 6365 6e74 6572 6564  ngth 10 centered
-00000cb0: 2061 7420 7468 6520 6f72 6967 696e 3a0a   at the origin:.
-00000cc0: 0a6e 706f 696e 7473 203d 2031 3031 0a65  .npoints = 101.e
-00000cd0: 6467 6520 3d20 3130 0a78 2c20 792c 207a  dge = 10.x, y, z
-00000ce0: 203d 205b 6e70 2e6c 696e 7370 6163 6528   = [np.linspace(
-00000cf0: 2d65 6467 652f 322e 2c20 6564 6765 2f32  -edge/2., edge/2
-00000d00: 2e2c 206e 706f 696e 7473 295d 2a33 0a58  ., npoints)]*3.X
-00000d10: 595a 203d 206e 702e 6d65 7368 6772 6964  YZ = np.meshgrid
-00000d20: 2878 2c20 792c 207a 2c20 696e 6465 7869  (x, y, z, indexi
-00000d30: 6e67 3d27 696a 2729 0a0a 0a23 2057 6520  ng='ij')...# We 
-00000d40: 6d6f 6465 6c20 6f75 7220 736d 6561 7265  model our smeare
-00000d50: 6420 6f75 7420 6368 6172 6765 7320 6173  d out charges as
-00000d60: 2067 6175 7373 6961 6e20 6675 6e63 7469   gaussian functi
-00000d70: 6f6e 733a 0a0a 6465 6620 6761 7573 7369  ons:..def gaussi
-00000d80: 616e 2858 595a 2c20 7879 7a30 2c20 7369  an(XYZ, xyz0, si
-00000d90: 676d 6129 3a0a 2020 2020 6720 3d20 6e70  gma):.    g = np
-00000da0: 2e6f 6e65 735f 6c69 6b65 2858 595a 5b30  .ones_like(XYZ[0
-00000db0: 5d29 0a20 2020 2066 6f72 206b 2069 6e20  ]).    for k in 
-00000dc0: 7261 6e67 6528 3329 3a0a 2020 2020 2020  range(3):.      
-00000dd0: 2020 6720 2a3d 206e 702e 6578 7028 2d28    g *= np.exp(-(
-00000de0: 5859 5a5b 6b5d 202d 2078 797a 305b 6b5d  XYZ[k] - xyz0[k]
-00000df0: 292a 2a32 202f 2073 6967 6d61 2a2a 3229  )**2 / sigma**2)
-00000e00: 0a20 2020 2067 202a 3d20 2873 6967 6d61  .    g *= (sigma
-00000e10: 2a2a 322a 6e70 2e70 6929 2a2a 2d31 2e35  **2*np.pi)**-1.5
-00000e20: 0a20 2020 2072 6574 7572 6e20 670a 0a73  .    return g..s
-00000e30: 6967 6d61 203d 2031 2e35 2020 2023 2074  igma = 1.5   # t
-00000e40: 6865 2077 6964 7468 206f 6620 6f75 7220  he width of our 
-00000e50: 6761 7573 7369 616e 730a 0a23 2049 6e69  gaussians..# Ini
-00000e60: 7469 616c 697a 6520 7468 6520 6368 6172  tialize the char
-00000e70: 6765 2064 656e 7369 7479 2072 686f 2c20  ge density rho, 
-00000e80: 7768 6963 6820 6973 2061 2033 4420 6e75  which is a 3D nu
-00000e90: 6d70 7920 6172 7261 793a 0a72 686f 203d  mpy array:.rho =
-00000ea0: 2067 6175 7373 6961 6e28 5859 5a2c 2028   gaussian(XYZ, (
-00000eb0: 302c 2030 2c20 3129 2c20 7369 676d 6129  0, 0, 1), sigma)
-00000ec0: 202d 2067 6175 7373 6961 6e28 5859 5a2c   - gaussian(XYZ,
-00000ed0: 2028 302c 2030 2c20 2d31 292c 2073 6967   (0, 0, -1), sig
-00000ee0: 6d61 290a 0a0a 2320 5072 6570 6172 6520  ma)...# Prepare 
-00000ef0: 7468 6520 6368 6172 6765 2064 6973 7472  the charge distr
-00000f00: 6962 7574 696f 6e20 6469 6374 2066 6f72  ibution dict for
-00000f10: 2074 6865 204d 756c 7469 706f 6c65 4578   the MultipoleEx
-00000f20: 7061 6e73 696f 6e20 6f62 6a65 6374 3a0a  pansion object:.
-00000f30: 0a63 6861 7267 655f 6469 7374 203d 207b  .charge_dist = {
-00000f40: 0a20 2020 2027 6469 7363 7265 7465 273a  .    'discrete':
-00000f50: 2046 616c 7365 2c20 2020 2020 2320 7765   False,     # we
-00000f60: 2068 6176 6520 6120 636f 6e74 696e 756f   have a continuo
-00000f70: 7573 2063 6861 7267 6520 6469 7374 7269  us charge distri
-00000f80: 6275 7469 6f6e 2068 6572 650a 2020 2020  bution here.    
-00000f90: 2772 686f 273a 2072 686f 2c0a 2020 2020  'rho': rho,.    
-00000fa0: 2778 797a 273a 2058 595a 0a7d 0a0a 2320  'xyz': XYZ.}..# 
-00000fb0: 5468 6520 7265 7374 2069 7320 7468 6520  The rest is the 
-00000fc0: 7361 6d65 2061 7320 666f 7220 7468 6520  same as for the 
-00000fd0: 6469 7363 7265 7465 2063 6173 653a 0a0a  discrete case:..
-00000fe0: 6c5f 6d61 7820 3d20 3220 2020 2320 7768  l_max = 2   # wh
-00000ff0: 6572 6520 746f 2073 746f 7020 7468 6520  ere to stop the 
-00001000: 696e 6669 6e69 7465 206d 756c 7469 706f  infinite multipo
-00001010: 6c65 2073 756d 3b20 6865 7265 2077 6520  le sum; here we 
-00001020: 6578 7061 6e64 2075 7020 746f 2074 6865  expand up to the
-00001030: 2071 7561 6472 7570 6f6c 6520 286c 3d32   quadrupole (l=2
-00001040: 290a 0a50 6869 203d 204d 756c 7469 706f  )..Phi = Multipo
-00001050: 6c65 4578 7061 6e73 696f 6e28 6368 6172  leExpansion(char
-00001060: 6765 5f64 6973 742c 206c 5f6d 6178 290a  ge_dist, l_max).
-00001070: 0a78 2c20 792c 207a 203d 2033 302e 352c  .x, y, z = 30.5,
-00001080: 2033 302e 362c 2033 302e 370a 7661 6c75   30.6, 30.7.valu
-00001090: 6520 3d20 5068 6928 782c 2079 2c20 7a29  e = Phi(x, y, z)
-000010a0: 0a60 6060 0a0a 2323 2049 6e73 7461 6c6c  .```..## Install
-000010b0: 6174 696f 6e0a 0a53 696d 706c 7920 7573  ation..Simply us
-000010c0: 6520 6070 6970 603a 0a0a 6060 600a 7069  e `pip`:..```.pi
-000010d0: 7020 696e 7374 616c 6c20 6d75 6c74 6970  p install multip
-000010e0: 6f6c 6573 0a60 6060 0a0a 2323 2044 6570  oles.```..## Dep
-000010f0: 656e 6465 6e63 6965 730a 0a60 6d75 6c74  endencies..`mult
-00001100: 6970 6f6c 6573 6020 7573 6573 2060 6e75  ipoles` uses `nu
-00001110: 6d70 7960 2066 6f72 2066 6173 7420 6172  mpy` for fast ar
-00001120: 7261 7920 7072 6f63 6573 7369 6e67 2061  ray processing a
-00001130: 6e64 2060 7363 6970 7960 2066 6f72 2073  nd `scipy` for s
-00001140: 7570 706f 7274 206f 6620 7370 6865 7269  upport of spheri
-00001150: 6361 6c20 6861 726d 6f6e 6963 732e 0a    cal harmonics..
+00000000: 2320 6d75 6c74 6970 6f6c 6573 0a3c 703e  # multipoles.<p>
+00000010: 3c61 2068 7265 663d 2268 7474 7073 3a2f  <a href="https:/
+00000020: 2f62 6164 6765 2e66 7572 792e 696f 2f70  /badge.fury.io/p
+00000030: 792f 6d75 6c74 6970 6f6c 6573 223e 203c  y/multipoles"> <
+00000040: 696d 6720 7372 633d 2268 7474 7073 3a2f  img src="https:/
+00000050: 2f62 6164 6765 2e66 7572 792e 696f 2f70  /badge.fury.io/p
+00000060: 792f 6d75 6c74 6970 6f6c 6573 2e73 7667  y/multipoles.svg
+00000070: 3f62 7261 6e63 683d 6d61 7374 6572 266b  ?branch=master&k
+00000080: 696c 6c5f 6361 6368 653d 3122 2061 6c74  ill_cache=1" alt
+00000090: 3d22 5079 5049 2076 6572 7369 6f6e 223e  ="PyPI version">
+000000a0: 3c2f 613e 203c 6120 6872 6566 3d22 223e  </a> <a href="">
+000000b0: 203c 696d 6720 7372 633d 2268 7474 7073   <img src="https
+000000c0: 3a2f 2f67 6974 6875 622e 636f 6d2f 6d61  ://github.com/ma
+000000d0: 726f 6261 2f6d 756c 7469 706f 6c65 732f  roba/multipoles/
+000000e0: 6163 7469 6f6e 732f 776f 726b 666c 6f77  actions/workflow
+000000f0: 732f 7079 7468 6f6e 2d61 7070 2e79 6d6c  s/python-app.yml
+00000100: 2f62 6164 6765 2e73 7667 2220 616c 743d  /badge.svg" alt=
+00000110: 2262 7569 6c64 223e 3c2f 613e 3c61 2068  "build"></a><a h
+00000120: 7265 663d 2268 7474 7073 3a2f 2f63 6f64  ref="https://cod
+00000130: 6563 6f76 2e69 6f2f 6768 2f6d 6172 6f62  ecov.io/gh/marob
+00000140: 612f 6d75 6c74 6970 6f6c 6573 223e 203c  a/multipoles"> <
+00000150: 696d 6720 7372 633d 2268 7474 7073 3a2f  img src="https:/
+00000160: 2f63 6f64 6563 6f76 2e69 6f2f 6768 2f6d  /codecov.io/gh/m
+00000170: 6172 6f62 612f 6d75 6c74 6970 6f6c 6573  aroba/multipoles
+00000180: 2f62 7261 6e63 682f 6d61 7374 6572 2f67  /branch/master/g
+00000190: 7261 7068 2f62 6164 6765 2e73 7667 3f74  raph/badge.svg?t
+000001a0: 6f6b 656e 3d4a 4e48 3953 5037 4252 4722  oken=JNH9SP7BRG"
+000001b0: 2061 6c74 3d22 223e 3c2f 613e 3c2f 703e   alt=""></a></p>
+000001c0: 0a0a 2a6d 756c 7469 706f 6c65 732a 2069  ..*multipoles* i
+000001d0: 7320 6120 5079 7468 6f6e 2070 6163 6b61  s a Python packa
+000001e0: 6765 2066 6f72 206d 756c 7469 706f 6c65  ge for multipole
+000001f0: 2065 7870 616e 7369 6f6e 7320 6f66 2074   expansions of t
+00000200: 6865 2073 6f6c 7574 696f 6e73 206f 6620  he solutions of 
+00000210: 7468 6520 506f 6973 736f 6e20 6571 7561  the Poisson equa
+00000220: 7469 6f6e 2028 652e 672e 2065 6c65 6374  tion (e.g. elect
+00000230: 726f 7374 6174 6963 206f 7220 6772 6176  rostatic or grav
+00000240: 6974 6174 696f 6e61 6c20 706f 7465 6e74  itational potent
+00000250: 6961 6c73 292e 2049 7420 6361 6e20 6861  ials). It can ha
+00000260: 6e64 6c65 2064 6973 6372 6574 6520 616e  ndle discrete an
+00000270: 6420 636f 6e74 696e 756f 7573 2063 6861  d continuous cha
+00000280: 7267 6520 6f72 206d 6173 7320 6469 7374  rge or mass dist
+00000290: 7269 6275 7469 6f6e 732e 0a0a 2323 2042  ributions...## B
+000002a0: 6163 6b67 726f 756e 640a 0a46 6f72 2061  ackground..For a
+000002b0: 2067 6976 656e 2066 756e 6374 696f 6e20   given function 
+000002c0: 245c 7268 6f28 782c 792c 7a29 242c 2074  $\rho(x,y,z)$, t
+000002d0: 6865 2073 6f6c 7574 696f 6e20 245c 5068  he solution $\Ph
+000002e0: 2020 2069 2878 2c79 2c7a 2924 206f 6620     i(x,y,z)$ of 
+000002f0: 7468 6520 506f 6973 736f 6e20 6571 7561  the Poisson equa
+00000300: 7469 6f6e 2024 5c6e 6162 6c61 5e32 5c50  tion $\nabla^2\P
+00000310: 6869 3d2d 345c 7069 205c 7268 6f24 2077  hi=-4\pi \rho$ w
+00000320: 6974 6820 7661 6e69 7368 696e 6720 4469  ith vanishing Di
+00000330: 7269 6368 6c65 7420 626f 756e 6461 7279  richlet boundary
+00000340: 2063 6f6e 6469 7469 6f6e 7320 6174 2069   conditions at i
+00000350: 6e66 696e 6974 7920 6973 0a0a 2424 5c50  nfinity is..$$\P
+00000360: 6869 2878 2c79 2c7a 293d 2d5c 696e 7420  hi(x,y,z)=-\int 
+00000370: 645e 3372 275c 6672 6163 7b5c 7268 6f28  d^3r'\frac{\rho(
+00000380: 7227 297d 7b7c 722d 7227 7c7d 2424 0a0a  r')}{|r-r'|}$$..
+00000390: 4578 616d 706c 6573 206f 6620 7468 6973  Examples of this
+000003a0: 2061 7265 2074 6865 2065 6c65 6374 726f   are the electro
+000003b0: 7374 6174 6963 2061 6e64 204e 6577 746f  static and Newto
+000003c0: 6e69 616e 2067 7261 7669 7461 7469 6f6e  nian gravitation
+000003d0: 616c 2070 6f74 656e 7469 616c 2e0a 4966  al potential..If
+000003e0: 2079 6f75 206e 6565 6420 746f 2065 7661   you need to eva
+000003f0: 6c75 6174 6520 245c 5068 6928 782c 792c  luate $\Phi(x,y,
+00000400: 7a29 2420 6174 206d 616e 7920 706f 696e  z)$ at many poin
+00000410: 7473 2c20 6361 6c63 756c 6174 696e 6720  ts, calculating 
+00000420: 7468 6520 696e 7465 6772 616c 2066 6f72  the integral for
+00000430: 2065 6163 6820 706f 696e 7420 6973 2063   each point is c
+00000440: 6f6d 7075 7461 7469 6f6e 616c 6c79 2065  omputationally e
+00000450: 7870 656e 7369 7665 2e20 4173 2061 2066  xpensive. As a f
+00000460: 6173 7465 7220 616c 7465 726e 6174 6976  aster alternativ
+00000470: 652c 2077 6520 6361 6e20 6578 7072 6573  e, we can expres
+00000480: 7320 245c 5068 6928 782c 792c 7a29 2420  s $\Phi(x,y,z)$ 
+00000490: 696e 2074 6572 6d73 206f 6620 7468 6520  in terms of the 
+000004a0: 6d75 6c74 6970 6f6c 6520 6d6f 6d65 6e74  multipole moment
+000004b0: 7320 2471 5f7b 6c6d 7d24 206f 7220 2449  s $q_{lm}$ or $I
+000004c0: 5f7b 6c6d 7d24 2028 6e6f 7465 2073 6f6d  _{lm}$ (note som
+000004d0: 6520 6c69 7465 7261 7475 7265 2075 7365  e literature use
+000004e0: 7320 7468 6520 7375 6273 6372 6970 7473  s the subscripts
+000004f0: 2024 285c 6364 6f74 295f 7b6e 6d7d 2429   $(\cdot)_{nm}$)
+00000500: 3a0a 0a24 245c 5068 6928 782c 792c 7a29  :..$$\Phi(x,y,z)
+00000510: 3d5c 7375 6d5f 7b6c 3d30 7d5e 5c69 6e66  =\sum_{l=0}^\inf
+00000520: 7479 5c75 6e64 6572 6272 6163 657b 5c73  ty\underbrace{\s
+00000530: 7172 747b 5c66 7261 637b 345c 7069 7d7b  qrt{\frac{4\pi}{
+00000540: 326c 2b31 7d7d 5c73 756d 5f7b 6d3d 2d6c  2l+1}}\sum_{m=-l
+00000550: 7d5e 6c59 5f7b 6c6d 7d28 5c74 6865 7461  }^lY_{lm}(\theta
+00000560: 2c20 5c76 6172 7068 6929 5c66 7261 637b  , \varphi)\frac{
+00000570: 715f 7b6c 6d7d 7d7b 725e 7b6c 2b31 7d7d  q_{lm}}{r^{l+1}}
+00000580: 7d5f 7b5c 5068 695e 7b28 6c29 7d7d 2424  }_{\Phi^{(l)}}$$
+00000590: 0a0a 666f 7220 6120 6578 7465 7269 6f72  ..for a exterior
+000005a0: 2065 7870 616e 7369 6f6e 2c20 6f72 0a0a   expansion, or..
+000005b0: 2424 5c50 6869 2878 2c79 2c7a 293d 5c73  $$\Phi(x,y,z)=\s
+000005c0: 756d 5f7b 6c3d 307d 5e5c 696e 6674 795c  um_{l=0}^\infty\
+000005d0: 756e 6465 7262 7261 6365 7b5c 7371 7274  underbrace{\sqrt
+000005e0: 7b5c 6672 6163 7b34 5c70 697d 7b32 6c2b  {\frac{4\pi}{2l+
+000005f0: 317d 7d5c 7375 6d5f 7b6d 3d2d 6c7d 5e6c  1}}\sum_{m=-l}^l
+00000600: 595f 7b6c 6d7d 285c 7468 6574 612c 205c  Y_{lm}(\theta, \
+00000610: 7661 7270 6869 2949 5f7b 6c6d 7d72 5e7b  varphi)I_{lm}r^{
+00000620: 6c7d 7d5f 7b5c 5068 695e 7b28 6c29 7d7d  l}}_{\Phi^{(l)}}
+00000630: 2424 0a0a 666f 7220 616e 2069 6e74 6572  $$..for an inter
+00000640: 696f 7220 6578 7061 6e73 696f 6e3b 2077  ior expansion; w
+00000650: 6865 7265 2024 722c 205c 7468 6574 612c  here $r, \theta,
+00000660: 205c 7661 7270 6869 2420 6172 6520 7468   \varphi$ are th
+00000670: 6520 7573 7561 6c20 7370 6865 7269 6361  e usual spherica
+00000680: 6c20 636f 6f72 6469 6e61 7465 7320 636f  l coordinates co
+00000690: 7272 6573 706f 6e64 696e 6720 746f 2074  rresponding to t
+000006a0: 6865 2063 6172 7465 7369 616e 2063 6f6f  he cartesian coo
+000006b0: 7264 696e 6174 6573 2024 782c 2079 2c20  rdinates $x, y, 
+000006c0: 7a24 2061 6e64 2024 595f 7b6c 6d7d 285c  z$ and $Y_{lm}(\
+000006d0: 7468 6574 612c 205c 7661 7270 6869 2924  theta, \varphi)$
+000006e0: 2061 7265 2074 6865 2073 7068 6572 6963   are the spheric
+000006f0: 616c 2068 6172 6d6f 6e69 6373 2e0a 0a54  al harmonics...T
+00000700: 6865 206d 756c 7469 706f 6c65 206d 6f6d  he multipole mom
+00000710: 656e 7473 2066 6f72 2074 6865 2065 7874  ents for the ext
+00000720: 6572 696f 7220 6578 7061 6e73 696f 6e20  erior expansion 
+00000730: 6172 653a 0a0a 2424 715f 7b6c 6d7d 203d  are:..$$q_{lm} =
+00000740: 205c 7371 7274 7b5c 6672 6163 7b34 5c70   \sqrt{\frac{4\p
+00000750: 697d 7b32 6c2b 317d 7d5c 696e 7420 645e  i}{2l+1}}\int d^
+00000760: 3320 7227 205c 7268 6f28 7227 2972 275e  3 r' \rho(r')r'^
+00000770: 6c20 595e 2a5f 7b6c 6d7d 285c 7468 6574  l Y^*_{lm}(\thet
+00000780: 6127 2c20 5c76 6172 7068 6927 2924 240a  a', \varphi')$$.
+00000790: 0a61 6e64 2074 6865 206d 756c 7469 706f  .and the multipo
+000007a0: 6c65 206d 6f6d 656e 7473 2066 6f72 2074  le moments for t
+000007b0: 6865 2069 6e74 6572 696f 7220 6578 7061  he interior expa
+000007c0: 6e73 696f 6e20 6172 653a 0a0a 2424 495f  nsion are:..$$I_
+000007d0: 7b6c 6d7d 203d 205c 7371 7274 7b5c 6672  {lm} = \sqrt{\fr
+000007e0: 6163 7b34 5c70 697d 7b32 6c2b 317d 7d5c  ac{4\pi}{2l+1}}\
+000007f0: 696e 7420 645e 3320 7227 205c 6672 6163  int d^3 r' \frac
+00000800: 7b5c 7268 6f28 7227 297d 7b72 275e 7b6c  {\rho(r')}{r'^{l
+00000810: 2b31 7d7d 2059 5e2a 5f7b 6c6d 7d28 5c74  +1}} Y^*_{lm}(\t
+00000820: 6865 7461 272c 205c 7661 7270 6869 2729  heta', \varphi')
+00000830: 2424 0a0a 5468 6973 2061 7070 726f 6163  $$..This approac
+00000840: 6820 6973 2075 7375 616c 6c79 206d 7563  h is usually muc
+00000850: 6820 6661 7374 6572 2062 6563 6175 7365  h faster because
+00000860: 2074 6865 2063 6f6e 7472 6962 7574 696f   the contributio
+00000870: 6e73 2024 5c50 6869 5e7b 286c 297d 2420  ns $\Phi^{(l)}$ 
+00000880: 6172 6520 6765 7474 696e 6720 736d 616c  are getting smal
+00000890: 6c65 7220 7769 7468 2069 6e63 7265 6173  ler with increas
+000008a0: 696e 6720 3c69 3e6c 3c2f 693e 2e20 536f  ing <i>l</i>. So
+000008b0: 2077 6520 6a75 7374 2068 6176 6520 746f   we just have to
+000008c0: 2063 616c 6375 6c61 7465 2061 2066 6577   calculate a few
+000008d0: 2069 6e74 6567 7261 6c73 2066 6f72 206f   integrals for o
+000008e0: 6274 6169 6e69 6e67 2073 6f6d 6520 2024  btaining some  $
+000008f0: 715f 7b6c 6d7d 2420 6f72 2020 2449 5f7b  q_{lm}$ or  $I_{
+00000900: 6c6d 7d24 2e0a 0a53 6f6d 6520 6c69 7465  lm}$...Some lite
+00000910: 7261 7475 7265 2063 6f6e 7369 6465 7273  rature considers
+00000920: 2074 6865 2024 5c73 7172 747b 5c66 7261   the $\sqrt{\fra
+00000930: 637b 345c 7069 7d7b 326c 2b31 7d7d 2420  c{4\pi}{2l+1}}$ 
+00000940: 6173 2070 6172 7420 6f66 2074 6865 2064  as part of the d
+00000950: 6566 696e 6974 696f 6e20 6f66 2024 595f  efinition of $Y_
+00000960: 7b6c 6d7d 285c 7468 6574 612c 205c 7661  {lm}(\theta, \va
+00000970: 7270 6869 2924 2e0a 0a23 2320 4578 616d  rphi)$...## Exam
+00000980: 706c 6573 0a0a 2323 2320 4469 7363 7265  ples..### Discre
+00000990: 7465 2043 6861 7267 6520 4469 7374 7269  te Charge Distri
+000009a0: 6275 7469 6f6e 0a0a 4173 2065 7861 6d70  bution..As examp
+000009b0: 6c65 2066 6f72 2061 2064 6973 6372 6574  le for a discret
+000009c0: 6520 6368 6172 6765 2064 6973 7472 6962  e charge distrib
+000009d0: 7574 696f 6e20 7765 206d 6f64 656c 2074  ution we model t
+000009e0: 776f 2070 6f69 6e74 2063 6861 7267 6573  wo point charges
+000009f0: 2077 6974 6820 706f 7369 7469 7665 2061   with positive a
+00000a00: 6e64 206e 6567 6174 6976 6520 756e 6974  nd negative unit
+00000a10: 2063 6861 7267 6520 6c6f 6361 7465 6420   charge located 
+00000a20: 6f6e 2074 6865 207a 2d61 7869 733a 0a0a  on the z-axis:..
+00000a30: 6060 6070 7974 686f 6e0a 6672 6f6d 206d  ```python.from m
+00000a40: 756c 7469 706f 6c65 7320 696d 706f 7274  ultipoles import
+00000a50: 204d 756c 7469 706f 6c65 4578 7061 6e73   MultipoleExpans
+00000a60: 696f 6e0a 0a23 2050 7265 7061 7265 2074  ion..# Prepare t
+00000a70: 6865 2063 6861 7267 6520 6469 7374 7269  he charge distri
+00000a80: 6275 7469 6f6e 2064 6963 7420 666f 7220  bution dict for 
+00000a90: 7468 6520 4d75 6c74 6970 6f6c 6545 7870  the MultipoleExp
+00000aa0: 616e 7369 6f6e 206f 626a 6563 743a 0a0a  ansion object:..
+00000ab0: 6368 6172 6765 5f64 6973 7420 3d20 7b0a  charge_dist = {.
+00000ac0: 2020 2020 2764 6973 6372 6574 6527 3a20      'discrete': 
+00000ad0: 5472 7565 2c20 2020 2020 2320 706f 696e  True,     # poin
+00000ae0: 7420 6368 6172 6765 7320 6172 6520 6469  t charges are di
+00000af0: 7363 7265 7465 2063 6861 7267 6520 6469  screte charge di
+00000b00: 7374 7269 6275 7469 6f6e 730a 2020 2020  stributions.    
+00000b10: 2763 6861 7267 6573 273a 205b 0a20 2020  'charges': [.   
+00000b20: 2020 2020 207b 2771 273a 2031 2c20 2778       {'q': 1, 'x
+00000b30: 797a 273a 2028 302c 2030 2c20 3129 7d2c  yz': (0, 0, 1)},
+00000b40: 0a20 2020 2020 2020 207b 2771 273a 202d  .        {'q': -
+00000b50: 312c 2027 7879 7a27 3a20 2830 2c20 302c  1, 'xyz': (0, 0,
+00000b60: 202d 3129 7d2c 0a20 2020 205d 0a7d 0a0a   -1)},.    ].}..
+00000b70: 6c5f 6d61 7820 3d20 3220 2020 2320 7768  l_max = 2   # wh
+00000b80: 6572 6520 746f 2073 746f 7020 7468 6520  ere to stop the 
+00000b90: 696e 6669 6e69 7465 206d 756c 7469 706f  infinite multipo
+00000ba0: 6c65 2073 756d 3b20 6865 7265 2077 6520  le sum; here we 
+00000bb0: 6578 7061 6e64 2075 7020 746f 2074 6865  expand up to the
+00000bc0: 2071 7561 6472 7570 6f6c 6520 286c 3d32   quadrupole (l=2
+00000bd0: 290a 0a50 6869 203d 204d 756c 7469 706f  )..Phi = Multipo
+00000be0: 6c65 4578 7061 6e73 696f 6e28 6368 6172  leExpansion(char
+00000bf0: 6765 5f64 6973 742c 206c 5f6d 6178 290a  ge_dist, l_max).
+00000c00: 0a23 2057 6520 6361 6e20 6576 616c 7561  .# We can evalua
+00000c10: 7465 2074 6865 206d 756c 7469 706f 6c65  te the multipole
+00000c20: 2065 7870 616e 6465 6420 706f 7465 6e74   expanded potent
+00000c30: 6961 6c20 6174 2061 2067 6976 656e 2070  ial at a given p
+00000c40: 6f69 6e74 206c 696b 6520 7468 6973 3a0a  oint like this:.
+00000c50: 0a78 2c20 792c 207a 203d 2033 302e 352c  .x, y, z = 30.5,
+00000c60: 2033 302e 362c 2033 302e 370a 7661 6c75   30.6, 30.7.valu
+00000c70: 6520 3d20 5068 6928 782c 2079 2c20 7a29  e = Phi(x, y, z)
+00000c80: 0a0a 2320 5468 6520 6d75 6c74 6970 6f6c  ..# The multipol
+00000c90: 6520 6d6f 6d65 6e74 7320 6172 6520 7374  e moments are st
+00000ca0: 6f72 6564 2069 6e20 6120 6469 6374 2c20  ored in a dict, 
+00000cb0: 7768 6572 6520 7468 6520 6b65 7973 2061  where the keys a
+00000cc0: 7265 2028 6c2c 206d 2920 616e 6420 7468  re (l, m) and th
+00000cd0: 6520 7661 6c75 6573 2071 5f6c 6d3a 0a50  e values q_lm:.P
+00000ce0: 6869 2e6d 756c 7469 706f 6c65 5f6d 6f6d  hi.multipole_mom
+00000cf0: 656e 7473 0a60 6060 0a0a 2323 2320 436f  ents.```..### Co
+00000d00: 6e74 696e 756f 7573 2043 6861 7267 6520  ntinuous Charge 
+00000d10: 4469 7374 7269 6275 7469 6f6e 0a0a 4173  Distribution..As
+00000d20: 2061 6e20 6578 616d 706c 6520 666f 7220   an example for 
+00000d30: 6120 636f 6e74 696e 756f 7573 2063 6861  a continuous cha
+00000d40: 7267 6520 6469 7374 7269 6275 7469 6f6e  rge distribution
+00000d50: 2c20 7765 2073 6d65 6172 206f 7574 2074  , we smear out t
+00000d60: 6865 2070 6f69 6e74 2063 6861 7267 6573  he point charges
+00000d70: 2066 726f 6d20 7468 6520 7072 6576 696f   from the previo
+00000d80: 7573 0a65 7861 6d70 6c65 3a0a 0a60 6060  us.example:..```
+00000d90: 7079 7468 6f6e 0a66 726f 6d20 6d75 6c74  python.from mult
+00000da0: 6970 6f6c 6573 2069 6d70 6f72 7420 4d75  ipoles import Mu
+00000db0: 6c74 6970 6f6c 6545 7870 616e 7369 6f6e  ltipoleExpansion
+00000dc0: 0a69 6d70 6f72 7420 6e75 6d70 7920 6173  .import numpy as
+00000dd0: 206e 700a 0a23 2046 6972 7374 2077 6520   np..# First we 
+00000de0: 7365 7420 7570 206f 7572 2067 7269 642c  set up our grid,
+00000df0: 2061 2063 7562 6520 6f66 206c 656e 6774   a cube of lengt
+00000e00: 6820 3130 2063 656e 7465 7265 6420 6174  h 10 centered at
+00000e10: 2074 6865 206f 7269 6769 6e3a 0a0a 6e70   the origin:..np
+00000e20: 6f69 6e74 7320 3d20 3130 310a 6564 6765  oints = 101.edge
+00000e30: 203d 2031 300a 782c 2079 2c20 7a20 3d20   = 10.x, y, z = 
+00000e40: 5b6e 702e 6c69 6e73 7061 6365 282d 6564  [np.linspace(-ed
+00000e50: 6765 2f32 2e2c 2065 6467 652f 322e 2c20  ge/2., edge/2., 
+00000e60: 6e70 6f69 6e74 7329 5d2a 330a 5859 5a20  npoints)]*3.XYZ 
+00000e70: 3d20 6e70 2e6d 6573 6867 7269 6428 782c  = np.meshgrid(x,
+00000e80: 2079 2c20 7a2c 2069 6e64 6578 696e 673d   y, z, indexing=
+00000e90: 2769 6a27 290a 0a0a 2320 5765 206d 6f64  'ij')...# We mod
+00000ea0: 656c 206f 7572 2073 6d65 6172 6564 206f  el our smeared o
+00000eb0: 7574 2063 6861 7267 6573 2061 7320 6761  ut charges as ga
+00000ec0: 7573 7369 616e 2066 756e 6374 696f 6e73  ussian functions
+00000ed0: 3a0a 0a64 6566 2067 6175 7373 6961 6e28  :..def gaussian(
+00000ee0: 5859 5a2c 2078 797a 302c 2073 6967 6d61  XYZ, xyz0, sigma
+00000ef0: 293a 0a20 2020 2067 203d 206e 702e 6f6e  ):.    g = np.on
+00000f00: 6573 5f6c 696b 6528 5859 5a5b 305d 290a  es_like(XYZ[0]).
+00000f10: 2020 2020 666f 7220 6b20 696e 2072 616e      for k in ran
+00000f20: 6765 2833 293a 0a20 2020 2020 2020 2067  ge(3):.        g
+00000f30: 202a 3d20 6e70 2e65 7870 282d 2858 595a   *= np.exp(-(XYZ
+00000f40: 5b6b 5d20 2d20 7879 7a30 5b6b 5d29 2a2a  [k] - xyz0[k])**
+00000f50: 3220 2f20 7369 676d 612a 2a32 290a 2020  2 / sigma**2).  
+00000f60: 2020 6720 2a3d 2028 7369 676d 612a 2a32    g *= (sigma**2
+00000f70: 2a6e 702e 7069 292a 2a2d 312e 350a 2020  *np.pi)**-1.5.  
+00000f80: 2020 7265 7475 726e 2067 0a0a 7369 676d    return g..sigm
+00000f90: 6120 3d20 312e 3520 2020 2320 7468 6520  a = 1.5   # the 
+00000fa0: 7769 6474 6820 6f66 206f 7572 2067 6175  width of our gau
+00000fb0: 7373 6961 6e73 0a0a 2320 496e 6974 6961  ssians..# Initia
+00000fc0: 6c69 7a65 2074 6865 2063 6861 7267 6520  lize the charge 
+00000fd0: 6465 6e73 6974 7920 7268 6f2c 2077 6869  density rho, whi
+00000fe0: 6368 2069 7320 6120 3344 206e 756d 7079  ch is a 3D numpy
+00000ff0: 2061 7272 6179 3a0a 7268 6f20 3d20 6761   array:.rho = ga
+00001000: 7573 7369 616e 2858 595a 2c20 2830 2c20  ussian(XYZ, (0, 
+00001010: 302c 2031 292c 2073 6967 6d61 2920 2d20  0, 1), sigma) - 
+00001020: 6761 7573 7369 616e 2858 595a 2c20 2830  gaussian(XYZ, (0
+00001030: 2c20 302c 202d 3129 2c20 7369 676d 6129  , 0, -1), sigma)
+00001040: 0a0a 0a23 2050 7265 7061 7265 2074 6865  ...# Prepare the
+00001050: 2063 6861 7267 6520 6469 7374 7269 6275   charge distribu
+00001060: 7469 6f6e 2064 6963 7420 666f 7220 7468  tion dict for th
+00001070: 6520 4d75 6c74 6970 6f6c 6545 7870 616e  e MultipoleExpan
+00001080: 7369 6f6e 206f 626a 6563 743a 0a0a 6368  sion object:..ch
+00001090: 6172 6765 5f64 6973 7420 3d20 7b0a 2020  arge_dist = {.  
+000010a0: 2020 2764 6973 6372 6574 6527 3a20 4661    'discrete': Fa
+000010b0: 6c73 652c 2020 2020 2023 2077 6520 6861  lse,     # we ha
+000010c0: 7665 2061 2063 6f6e 7469 6e75 6f75 7320  ve a continuous 
+000010d0: 6368 6172 6765 2064 6973 7472 6962 7574  charge distribut
+000010e0: 696f 6e20 6865 7265 0a20 2020 2027 7268  ion here.    'rh
+000010f0: 6f27 3a20 7268 6f2c 0a20 2020 2027 7879  o': rho,.    'xy
+00001100: 7a27 3a20 5859 5a0a 7d0a 0a23 2054 6865  z': XYZ.}..# The
+00001110: 2072 6573 7420 6973 2074 6865 2073 616d   rest is the sam
+00001120: 6520 6173 2066 6f72 2074 6865 2064 6973  e as for the dis
+00001130: 6372 6574 6520 6361 7365 3a0a 0a6c 5f6d  crete case:..l_m
+00001140: 6178 203d 2032 2020 2023 2077 6865 7265  ax = 2   # where
+00001150: 2074 6f20 7374 6f70 2074 6865 2069 6e66   to stop the inf
+00001160: 696e 6974 6520 6d75 6c74 6970 6f6c 6520  inite multipole 
+00001170: 7375 6d3b 2068 6572 6520 7765 2065 7870  sum; here we exp
+00001180: 616e 6420 7570 2074 6f20 7468 6520 7175  and up to the qu
+00001190: 6164 7275 706f 6c65 2028 6c3d 3229 0a0a  adrupole (l=2)..
+000011a0: 5068 6920 3d20 4d75 6c74 6970 6f6c 6545  Phi = MultipoleE
+000011b0: 7870 616e 7369 6f6e 2863 6861 7267 655f  xpansion(charge_
+000011c0: 6469 7374 2c20 6c5f 6d61 7829 0a0a 782c  dist, l_max)..x,
+000011d0: 2079 2c20 7a20 3d20 3330 2e35 2c20 3330   y, z = 30.5, 30
+000011e0: 2e36 2c20 3330 2e37 0a76 616c 7565 203d  .6, 30.7.value =
+000011f0: 2050 6869 2878 2c20 792c 207a 290a 6060   Phi(x, y, z).``
+00001200: 600a 0a23 2320 496e 7374 616c 6c61 7469  `..## Installati
+00001210: 6f6e 0a0a 5369 6d70 6c79 2075 7365 2060  on..Simply use `
+00001220: 7069 7060 3a0a 0a60 6060 0a70 6970 2069  pip`:..```.pip i
+00001230: 6e73 7461 6c6c 206d 756c 7469 706f 6c65  nstall multipole
+00001240: 730a 6060 600a                           s.```.
```

### Comparing `multipoles-0.3.2/multipoles/expansion.py` & `multipoles-0.3.3/multipoles/expansion.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,9 +1,10 @@
 import numpy as np
 from scipy.special import sph_harm
+from scipy.integrate import simpson
 
 
 class MultipoleExpansion(object):
     """
     Perform a multipole expansion for a given charge or mass distribution.
 
     Determines the spherical multipole moments of the given distribution and
@@ -148,15 +149,16 @@
 
             self.center_of_charge = center
 
         else:
             rho = charge_dist['rho']
             X, Y, Z = charge_dist['xyz']
 
-            self.dvol = (X[1, 0, 0] - X[0, 0, 0]) * (Y[0, 1, 0] - Y[0, 0, 0]) * (Z[0, 0, 1] - Z[0, 0, 0])
+            self.dxyz = (X[1, 0, 0] - X[0, 0, 0]), (Y[0, 1, 0] - Y[0, 0, 0]), (Z[0, 0, 1] - Z[0, 0, 0])
+            self.dvol = np.prod(self.dxyz)
             self.external_coords = X, Y, Z
             self.rho = rho
             self.total_charge = np.sum(rho) * self.dvol
 
             # The center of charge expressed in the external coordinate system
             q_abs = np.sum(np.abs(rho)) * self.dvol
             self.center_of_charge = np.array([np.sum(np.abs(rho) * c) for c in [X, Y, Z]]) * self.dvol / q_abs
@@ -285,24 +287,23 @@
                 Y_lm = sph_harm(m, l, phi, theta)
                 q_lm = self.multipole_moments[(l, m)]
                 if self.exterior:
                     phi_l += np.sqrt(4 * np.pi / (2 * l + 1)) * q_lm * Y_lm / r ** (l + 1)
                 else:
                     phi_l += np.sqrt(4 * np.pi / (2 * l + 1)) * q_lm * Y_lm * r ** l
             mp_contribs.append(phi_l.real)
-
         return mp_contribs
 
     def _calc_multipole_moments(self):
         moments = {}
         for l in range(0, self.l_max + 1):
-            for m in range(0, l + 1):
+            for m in range(-l, l + 1):
                 moments[(l, m)] = self._calc_multipole_coef(l, m)
-                if m != 0:
-                    moments[(l, -m)] = (-1) ** m * np.conj(moments[(l, m)])
+                #if m != 0:
+                #    moments[(l, -m)] = (-1) ** m * np.conj(moments[(l, m)])
         return moments
 
     def _calc_multipole_coef(self, l, m):
 
         prefac = np.sqrt(4 * np.pi / (2 * l + 1))
 
         if self.charge_dist['discrete']:
@@ -321,15 +322,23 @@
         else:
             R, Phi, Theta = self.internal_coords_spherical
             Y_lm = sph_harm(m, l, Phi, Theta)
             if self.exterior:
                 integrand = R ** l * self.rho * np.conj(Y_lm)
             else:
                 integrand = 1 / R ** (l + 1) * self.rho * np.conj(Y_lm)
-            return integrand.sum() * self.dvol * prefac
+            return self._integrate(integrand) * prefac
+
+    def _integrate(self, integrand):
+        return simpson(
+            simpson(
+                simpson(integrand,
+                        dx=self.dxyz[2], axis=-1),
+                dx=self.dxyz[1], axis=-1
+            ), dx=self.dxyz[0], axis=-1)
 
     def _assert_charge_dist(self):
 
         if 'discrete' not in self.charge_dist:
             raise InvalidChargeDistributionException("Parameter 'discrete' missing.")
 
         if self.charge_dist['discrete']:
@@ -361,23 +370,23 @@
     # the 'where' argument in np.arccos is not working as expected,
     # so handle invalid points manually and turn off floating point
     # errors temporarily
     old_settings = np.geterr()
     np.seterr(all='ignore')
 
     if hasattr(R_xy, '__len__'):
-        Phi = np.arccos(X / R_xy)
+        Phi = np.arctan2(Y, X)
         Phi[R_xy == 0] = 0
         Theta = np.arccos(Z / R)
         Theta[R == 0] = np.pi / 2
     else:
         if R_xy == 0:
             Phi = 0
         else:
-            Phi = np.arccos(X / R_xy)
+            Phi = np.arctan2(Y, X)
         if R == 0:
             Theta = np.pi / 2
         else:
             Theta = np.arccos(Z / R)
 
     np.seterr(**old_settings)
     return R, Phi, Theta
```

### Comparing `multipoles-0.3.2/multipoles.egg-info/PKG-INFO` & `multipoles-0.3.3/multipoles.egg-info/PKG-INFO`

 * *Files 1% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: multipoles
-Version: 0.3.2
+Version: 0.3.3
 Summary: A Python package for multipole expansions of electrostatic or gravitational potentials
 Home-page: https://github.com/maroba/multipoles
 Author: Matthias Baer
 Author-email: matthias.r.baer@googlemail.com
 License: MIT
 Keywords: multipole expansion,physics,scientific-computing
 Platform: UNKNOWN
```

### Comparing `multipoles-0.3.2/setup.py` & `multipoles-0.3.3/setup.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,12 +1,12 @@
 from setuptools import setup
 
 setup(
     name='multipoles',
-    version='0.3.2',
+    version='0.3.3',
     description='A Python package for multipole expansions of electrostatic or gravitational potentials',
     long_description="""*multipoles* is a Python package for multipole expansions of the solutions of the Poisson equation     
        (e.g. electrostatic or gravitational potentials). It can handle discrete and continuous charge or mass distributions.
     """,
 
     license='MIT',
     url='https://github.com/maroba/multipoles',
```

